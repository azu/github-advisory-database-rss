<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/actions.rss</id>
    <title>Security Advisory for Github Actions</title>
    <updated>2022-09-14T01:29:24.016Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Aactions"/>
    <subtitle>Security Advisory for Github Actions on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[hashicorp/vault-action] Vault GitHub Action did not correctly mask multi-line secrets in output]]></title>
        <id>https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</id>
        <link href="https://github.com/advisories/GHSA-4mgv-m5cm-f9h7"/>
        <updated>2022-08-04T15:10:58.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp vault-action (aka Vault GitHub Action) before 2.2.0 allows attackers to obtain sensitive information from log files because a multi-line secret was not correctly registered with GitHub Actions for log masking.</p>
<p>The vault-action implementation did not correctly handle the marking of multi-line variables. As a result, multi-line secrets were not correctly masked in vault-action output.</p>
<p>Remediation:
Customers using vault-action should evaluate the risk associated with this issue, and consider upgrading to vault-action 2.2.0 or newer. Please refer to <a href="https://github.com/marketplace/actions/vault-secrets">https://github.com/marketplace/actions/vault-secrets</a> for more information.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32074">https://nvd.nist.gov/vuln/detail/CVE-2021-32074</a></li>
<li><a href="https://github.com/hashicorp/vault-action/issues/205">https://github.com/hashicorp/vault-action/issues/205</a></li>
<li><a href="https://github.com/hashicorp/vault-action/pull/208">https://github.com/hashicorp/vault-action/pull/208</a></li>
<li><a href="https://discuss.hashicorp.com/t/hcsec-2021-13-vault-github-action-did-not-correctly-mask-multi-line-secrets-in-output/24128">https://discuss.hashicorp.com/t/hcsec-2021-13-vault-github-action-did-not-correctly-mask-multi-line-secrets-in-output/24128</a></li>
<li><a href="https://github.com/hashicorp/vault-action/blob/master/CHANGELOG.md">https://github.com/hashicorp/vault-action/blob/master/CHANGELOG.md</a></li>
<li><a href="https://github.com/advisories/GHSA-4mgv-m5cm-f9h7">https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mgv-m5cm-f9h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-24T19:01:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[check-spelling/check-spelling] check-spelling workflow vulnerable to token leakage via symlink attack]]></title>
        <id>https://github.com/advisories/GHSA-g86g-chm8-7r2p</id>
        <link href="https://github.com/advisories/GHSA-g86g-chm8-7r2p"/>
        <updated>2022-08-04T15:10:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>For a repository with the <a href="https://github.com/marketplace/actions/check-spelling">check-spelling action</a> enabled that triggers on <code>pull_request_target</code> (or <code>schedule</code>), an attacker can send a crafted Pull Request that causes a <code>GITHUB_TOKEN</code> to be exposed.</p>
<p>With the <code>GITHUB_TOKEN</code>, it's possible to push commits to the repository bypassing standard approval processes. Commits to the repository could then steal any/all secrets available to the repository.</p>
<h3 id="workarounds">Workarounds</h3>
<p>You can either:</p>
<ul>
<li><a href="https://docs.github.com/en/actions/managing-workflow-runs/disabling-and-enabling-a-workflow">Disable the workflow</a> until you've fixed <strong>all branches</strong>.</li>
</ul>
<p>or</p>
<ul>
<li>Set repository to <a href="https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/disabling-or-limiting-github-actions-for-a-repository#allowing-specific-actions-to-run">Allow specific actions</a>. You can check: <ul>
<li><input type="checkbox" disabled="" checked=""> <code>Allow actions created by GitHub</code></li>
<li><input type="checkbox" disabled="" checked=""> <code>Allow Marketplace actions by verified creators</code></li>
</ul>
</li>
</ul>
<p><a href="https://github.com/check-spelling">check-spelling</a> isn't a verified creator and it certainly won't be anytime soon. You could then explicitly add other actions that your repository uses.</p>
<p>or</p>
<ul>
<li>Set repository <a href="https://docs.github.com/en/github/administering-a-repository/managing-repository-settings/disabling-or-limiting-github-actions-for-a-repository#setting-the-permissions-of-the-github_token-for-your-repository">Workflow permissions</a> to <code>Read repository contents permission</code>.</li>
</ul>
<h3 id="solution">Solution</h3>
<p>Workflows using <code>check-spelling/check-spelling@main</code> were fixed automatically with the release of <a href="https://github.com/check-spelling/check-spelling/releases/tag/v0.0.19">v0.0.19</a>.</p>
<p>Workflows using a pinned sha or tagged version will need to change the affected workflows for <em>all</em> repository branches to the latest version.</p>
<h4 id="the-simple-case">The simple case</h4>
<p>In the simple case, you have few enough open branches that you can do the following on <strong>all branches</strong>.</p>
<ul>
<li>Edit the workflow to use <code>check-spelling/check-spelling@main</code>, or</li>
<li>Edit the workflow to use <code>check-spelling/check-spelling@v0.0.19</code>, or</li>
<li>Delete the workflow file, or</li>
<li>Change the workflow to only use <code>on: push</code><ul>
<li>this will result in PRs losing status checks (commits will still have statuses)</li>
</ul>
</li>
</ul>
<h4 id="the-complex-case">The complex case</h4>
<p>If you have too many open branches to feasibly fix all of them as per the above, you can instead do the following:</p>
<ol>
<li>Perform the above solution on all open branches for which you need <code>check-spelling</code> to be active.</li>
<li>On all open branches on which you need <code>check-spelling</code> to be active, rename the workflow file (e.g. to <code>spelling2.yml</code>)</li>
<li>On the default branch, create a dummy workflow file with the old name (this is usually <code>spelling.yml</code>).</li>
<li>Use the GitHub Actions UI to disable the workflow with the old name (this is usually <code>spelling.yml</code>).</li>
</ol>
<p>This should prevent the vulnerable workflow from executing on any branches that you have not applied the proper solution to.</p>
<p>The reason for creating the dummy file (Step 3) before disabling the workflow (Step 4) is that, in our testing, GitHub may un-disable a workflow if it does not exist on your default branch.</p>
<p>Example dummy workflow file (For step 3):</p>
<pre><code class="language-yml"># spelling.yml is disabled per https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p
name: Workflow should not run!
on:
  push:
    branches: ''

jobs:
  placeholder:
    name: Should be disabled
    runs-on: ubuntu-latest
    if: false
    steps:
    - name: Task
      run: |
        echo 'Running this task would be bad'
        exit 1
</code></pre>
<p>You <em>should also</em> include a comment in the new workflow to remind people not to resurrect the old name, for example:</p>
<pre><code class="language-yml"># spelling.yml is disabled per https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p
</code></pre>
<p>Finally, you should consider sending a Pull Request to an open branch in which you have not performed the proper solution to verify that the old version of <code>check-spelling</code> does not execute.</p>
<h4 id="how-to-upgrade">How to upgrade</h4>
<p>Perform this change to your impacted workflow file (typically <code>.github/workflows/spelling.yml</code>):</p>
<pre><code class="language-diff">@@ -24 +24 @@
-    - uses: check-spelling/check-spelling@v0.0.18
+    - uses: check-spelling/check-spelling@v0.0.19
</code></pre>
<p>As noted above, if you have many branches, you should additionally rename the workflow and include a comment to remind people not to use the old workflow file name:</p>
<pre><code># spelling.yml is blocked per https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p
</code></pre>
<h3 id="reviewing-workflow-runs">Reviewing workflow runs</h3>
<p>Users can verify who and which Pull Requests have been running the action by looking up the spelling.yml action in the Actions tab of their repositories, e.g., <a href="https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml">https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml</a> - you can filter PRs by adding <code>?query=event%3Apull_request_target</code>, e.g., <a href="https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml?query=event%3Apull_request_target">https://github.com/check-spelling/check-spelling/actions/workflows/spelling.yml?query=event%3Apull_request_target</a>.</p>
<h3 id="references">References</h3>
<ul>
<li>For more information on <code>pull_request_target</code> attacks, see <a href="https://securitylab.github.com/research/github-actions-preventing-pwn-requests/">GitHub Security Lab: Keeping your GitHub Actions and workflows secure: Preventing pwn requests</a></li>
<li>For information on workflow hardening techniques, see <a href="https://docs.github.com/en/actions/learn-github-actions/security-hardening-for-github-actions">GitHub: Security hardening for GitHub Actions</a></li>
</ul>
<h3 id="credit">Credit</h3>
<p>Thanks to <a href="https://twitter.com/justinsteven">@justinsteven</a> for reporting as well as in helping validate the fix.</p>
<h3 id="for-more-information">For more information</h3>
<p>For questions or comments about this advisory:</p>
<ul>
<li>Email us at <a href="mailto:check-spelling@check-spelling.dev">check-spelling@check-spelling.dev</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p">https://github.com/check-spelling/check-spelling/security/advisories/GHSA-g86g-chm8-7r2p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-32724">https://nvd.nist.gov/vuln/detail/CVE-2021-32724</a></li>
<li><a href="https://github.com/check-spelling/check-spelling/commit/436362fc6b588d9d561cbdb575260ca593c8dc56">https://github.com/check-spelling/check-spelling/commit/436362fc6b588d9d561cbdb575260ca593c8dc56</a></li>
<li><a href="https://github.com/check-spelling/check-spelling/releases/tag/v0.0.19">https://github.com/check-spelling/check-spelling/releases/tag/v0.0.19</a></li>
<li><a href="https://github.com/advisories/GHSA-g86g-chm8-7r2p">https://github.com/advisories/GHSA-g86g-chm8-7r2p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g86g-chm8-7r2p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-07-29T19:56:34.000Z</published>
    </entry>
</feed>