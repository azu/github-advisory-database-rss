{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for PHP packages hosted at packagist.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/composer.json",
    "description": "Security Advisory for PHP packages hosted at packagist.org on GitHub",
    "items": [
        {
            "content_html": "<h2 id=\"description\">Description</h2>\n<p>The <code>CachingHttpClient</code> class from the HttpClient Symfony component relies on the <code>HttpCache</code> class to handle requests. <code>HttpCache</code> uses internal headers like <code>X-Body-Eval</code> and <code>X-Body-File</code> to control the restoration of cached responses. The class was initially written with surrogate caching and ESI support in mind (all HTTP calls come from a trusted backend in that scenario). But when used by <code>CachingHttpClient</code> and if an attacker can control the response for a request being made by the <code>CachingHttpClient</code>, remote code execution is possible.</p>\n<h2 id=\"resolution\">Resolution</h2>\n<p>HTTP headers designed for internal use in <code>HttpCache</code> are now stripped from remote responses before being passed to <code>HttpCache</code>.</p>\n<p>The patch for this issue is available <a href=\"https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78\">here</a> for the 4.4 branch.</p>\n<h2 id=\"credits\">Credits</h2>\n<p>I would like to thank Matthias Pigulla (webfactory GmbH) for reporting and fixing the issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/symfony/symfony/security/advisories/GHSA-754h-5r27-7x3r\">https://github.com/symfony/symfony/security/advisories/GHSA-754h-5r27-7x3r</a></li>\n<li><a href=\"https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78\">https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78</a></li>\n<li><a href=\"https://packagist.org/packages/symfony/http-kernel\">https://packagist.org/packages/symfony/http-kernel</a></li>\n<li><a href=\"https://packagist.org/packages/symfony/symfony\">https://packagist.org/packages/symfony/symfony</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-15094\">https://nvd.nist.gov/vuln/detail/CVE-2020-15094</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VAQJXAKWPMWB7OL6QPG2ZSEQZYYPU5RC/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VAQJXAKWPMWB7OL6QPG2ZSEQZYYPU5RC/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HNGUWOEETOFVH4PN3I3YO4QZHQ4AUKF3/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HNGUWOEETOFVH4PN3I3YO4QZHQ4AUKF3/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-754h-5r27-7x3r\">https://github.com/advisories/GHSA-754h-5r27-7x3r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-754h-5r27-7x3r",
            "title": "[symfony/symfony] RCE in Symfony",
            "date_modified": "2022-03-18T18:31:50.000Z",
            "date_published": "2020-09-02T17:29:56.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-754h-5r27-7x3r"
            }
        },
        {
            "content_html": "<h2 id=\"description\">Description</h2>\n<p>The <code>CachingHttpClient</code> class from the HttpClient Symfony component relies on the <code>HttpCache</code> class to handle requests. <code>HttpCache</code> uses internal headers like <code>X-Body-Eval</code> and <code>X-Body-File</code> to control the restoration of cached responses. The class was initially written with surrogate caching and ESI support in mind (all HTTP calls come from a trusted backend in that scenario). But when used by <code>CachingHttpClient</code> and if an attacker can control the response for a request being made by the <code>CachingHttpClient</code>, remote code execution is possible.</p>\n<h2 id=\"resolution\">Resolution</h2>\n<p>HTTP headers designed for internal use in <code>HttpCache</code> are now stripped from remote responses before being passed to <code>HttpCache</code>.</p>\n<p>The patch for this issue is available <a href=\"https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78\">here</a> for the 4.4 branch.</p>\n<h2 id=\"credits\">Credits</h2>\n<p>I would like to thank Matthias Pigulla (webfactory GmbH) for reporting and fixing the issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/symfony/symfony/security/advisories/GHSA-754h-5r27-7x3r\">https://github.com/symfony/symfony/security/advisories/GHSA-754h-5r27-7x3r</a></li>\n<li><a href=\"https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78\">https://github.com/symfony/symfony/commit/d9910e0b33a2e0f993abff41c6fbc86951b66d78</a></li>\n<li><a href=\"https://packagist.org/packages/symfony/http-kernel\">https://packagist.org/packages/symfony/http-kernel</a></li>\n<li><a href=\"https://packagist.org/packages/symfony/symfony\">https://packagist.org/packages/symfony/symfony</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-15094\">https://nvd.nist.gov/vuln/detail/CVE-2020-15094</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VAQJXAKWPMWB7OL6QPG2ZSEQZYYPU5RC/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VAQJXAKWPMWB7OL6QPG2ZSEQZYYPU5RC/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HNGUWOEETOFVH4PN3I3YO4QZHQ4AUKF3/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/HNGUWOEETOFVH4PN3I3YO4QZHQ4AUKF3/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-754h-5r27-7x3r\">https://github.com/advisories/GHSA-754h-5r27-7x3r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-754h-5r27-7x3r",
            "title": "[symfony/http-kernel] RCE in Symfony",
            "date_modified": "2022-03-18T18:31:50.000Z",
            "date_published": "2020-09-02T17:29:56.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-754h-5r27-7x3r"
            }
        },
        {
            "content_html": "<p>matyhtf framework v3.0.5 is affected by a path manipulation vulnerability in Smarty.class.php. The issue was fixed in version 3.0.6.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43676\">https://nvd.nist.gov/vuln/detail/CVE-2021-43676</a></li>\n<li><a href=\"https://github.com/matyhtf/framework/issues/206\">https://github.com/matyhtf/framework/issues/206</a></li>\n<li><a href=\"https://github.com/matyhtf/framework/commit/25084603b7ea771eebe263d39744fe6abf1f8d61\">https://github.com/matyhtf/framework/commit/25084603b7ea771eebe263d39744fe6abf1f8d61</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mh9j-v6mq-pfch\">https://github.com/advisories/GHSA-mh9j-v6mq-pfch</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mh9j-v6mq-pfch",
            "title": "[matyhtf/framework] Path manipulation in matyhtf/framework",
            "date_modified": "2022-03-18T15:08:05.000Z",
            "date_published": "2021-12-04T00:01:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mh9j-v6mq-pfch"
            }
        },
        {
            "content_html": "<p>A Server-side Template Injection (SSTI) vulnerability exists in Nystudio107 Seomatic prior to 3.4.12 in src/helpers/UrlHelper.php via the host header.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44618\">https://nvd.nist.gov/vuln/detail/CVE-2021-44618</a></li>\n<li><a href=\"https://github.com/nystudio107/craft-seomatic/commit/0c5c0c0e0cb61000d12ec55ebf174745a5bf6469\">https://github.com/nystudio107/craft-seomatic/commit/0c5c0c0e0cb61000d12ec55ebf174745a5bf6469</a></li>\n<li><a href=\"https://github.com/nystudio107/craft-seomatic/releases/tag/3.4.12\">https://github.com/nystudio107/craft-seomatic/releases/tag/3.4.12</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m3xv-x3ph-mq22\">https://github.com/advisories/GHSA-m3xv-x3ph-mq22</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m3xv-x3ph-mq22",
            "title": "[nystudio107/craft-seomatic] Server-side Template Injection in nystudio107/craft-seomatic",
            "date_modified": "2022-03-18T13:10:15.000Z",
            "date_published": "2022-03-12T00:00:34.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m3xv-x3ph-mq22"
            }
        },
        {
            "content_html": "<p>PhpMyAdmin before 5.1.3 allows an attacker to retrieve potentially sensitive information by creating invalid requests. This affects the lang parameter, the pma_parameter, and the cookie section.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0813\">https://nvd.nist.gov/vuln/detail/CVE-2022-0813</a></li>\n<li><a href=\"https://www.incibe-cert.es/en/early-warning/security-advisories/phpmyadmin-exposure-sensitive-information\">https://www.incibe-cert.es/en/early-warning/security-advisories/phpmyadmin-exposure-sensitive-information</a></li>\n<li><a href=\"https://www.phpmyadmin.net/news/2022/2/11/phpmyadmin-4910-and-513-are-released/\">https://www.phpmyadmin.net/news/2022/2/11/phpmyadmin-4910-and-513-are-released/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vx8q-j7h9-vf6q\">https://github.com/advisories/GHSA-vx8q-j7h9-vf6q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vx8q-j7h9-vf6q",
            "title": "[phpmyadmin/phpmyadmin] Exposure of Sensitive Information to an Unauthorized Actor in PhpMyAdmin",
            "date_modified": "2022-03-17T21:44:09.000Z",
            "date_published": "2022-03-11T00:02:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vx8q-j7h9-vf6q"
            }
        },
        {
            "content_html": "<p>showdoc/showdoc allows .properties files to upload which lead to stored XSS in versions prior to 2.10.4. This allows attackers to execute malicious scripts in the user's browser.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0960\">https://nvd.nist.gov/vuln/detail/CVE-2022-0960</a></li>\n<li><a href=\"https://github.com/star7th/showdoc/commit/92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f\">https://github.com/star7th/showdoc/commit/92bc6a83a3a60e01a0d2effb98ab47d8d7eab28f</a></li>\n<li><a href=\"https://huntr.dev/bounties/462cd8a7-b1a9-4e93-af71-b56ba1d7ad4e\">https://huntr.dev/bounties/462cd8a7-b1a9-4e93-af71-b56ba1d7ad4e</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rphc-h572-2x9f\">https://github.com/advisories/GHSA-rphc-h572-2x9f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rphc-h572-2x9f",
            "title": "[showdoc/showdoc] Cross-site Scripting in showdoc/showdoc",
            "date_modified": "2022-03-18T13:37:27.000Z",
            "date_published": "2022-03-15T00:00:55.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rphc-h572-2x9f"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Values added at the end of query sorting were passed directly to the DB. We don't know, if it could lead to direct SQL injections, however, we should not allow for easy injection of values there anyway.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in version 1.10.1 and in 1.11-rc.1</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>You have to overwrite your <code>Sylius\\Component\\Grid\\Sorting\\Sorter.php</code> class:</p>\n<pre><code class=\"language-php\">&lt;?php\n\n// src/App/Sorting/Sorter.php\n\ndeclare(strict_types=1);\n\nnamespace App\\Sorting;\n\nuse Symfony\\Component\\HttpKernel\\Exception\\BadRequestHttpException;\nuse Sylius\\Component\\Grid\\Data\\DataSourceInterface;\nuse Sylius\\Component\\Grid\\Definition\\Grid;\nuse Sylius\\Component\\Grid\\Parameters;\nuse Sylius\\Component\\Grid\\Sorting\\SorterInterface;\n\nfinal class Sorter implements SorterInterface\n{\n    public function sort(DataSourceInterface $dataSource, Grid $grid, Parameters $parameters): void\n    {\n        $enabledFields = $grid-&gt;getFields();\n        $expressionBuilder = $dataSource-&gt;getExpressionBuilder();\n\n        $sorting = $parameters-&gt;get('sorting', $grid-&gt;getSorting());\n        $this-&gt;validateSortingParams($sorting, $enabledFields);\n\n        foreach ($sorting as $field =&gt; $order) {\n            $this-&gt;validateFieldNames($field, $enabledFields);\n\n            $gridField = $grid-&gt;getField($field);\n            $property = $gridField-&gt;getSortable();\n\n            if (null !== $property) {\n                $expressionBuilder-&gt;addOrderBy($property, $order);\n            }\n        }\n    }\n\n    private function validateSortingParams(array $sorting, array $enabledFields): void\n    {\n        foreach (array_keys($enabledFields) as $key) {\n            if (array_key_exists($key, $sorting) &amp;&amp; !in_array($sorting[$key], ['asc', 'desc'])) {\n                throw new BadRequestHttpException(sprintf('%s is not valid, use asc or desc instead.', $sorting[$key]));\n            }\n        }\n    }\n\n    private function validateFieldNames(string $fieldName, array $enabledFields): void\n    {\n        $enabledFieldsNames = array_keys($enabledFields);\n\n        if (!in_array($fieldName, $enabledFieldsNames, true)) {\n            throw new BadRequestHttpException(sprintf('%s is not valid field, did you mean one of these: %s?', $fieldName, implode(', ', $enabledFieldsNames)));\n        }\n    }\n}\n</code></pre>\n<p>and register it in your container: </p>\n<pre><code class=\"language-yaml\"># config/services.yaml\nservices:\n    # ...\n    sylius.grid.sorter:\n        class: App\\Sorting\\Sorter\n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a><h3 id=\"references\">References</h3>\n</li>\n</ul>\n<ul>\n<li><a href=\"https://github.com/Sylius/SyliusGridBundle/security/advisories/GHSA-2xmm-g482-4439\">https://github.com/Sylius/SyliusGridBundle/security/advisories/GHSA-2xmm-g482-4439</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24752\">https://nvd.nist.gov/vuln/detail/CVE-2022-24752</a></li>\n<li><a href=\"https://github.com/Sylius/SyliusGridBundle/pull/222\">https://github.com/Sylius/SyliusGridBundle/pull/222</a></li>\n<li><a href=\"https://github.com/Sylius/SyliusGridBundle/commit/73d0791d0575f955e830a3da4c3345f420d2f784\">https://github.com/Sylius/SyliusGridBundle/commit/73d0791d0575f955e830a3da4c3345f420d2f784</a></li>\n<li><a href=\"https://github.com/Sylius/SyliusGridBundle/releases/tag/v1.10.1\">https://github.com/Sylius/SyliusGridBundle/releases/tag/v1.10.1</a></li>\n<li><a href=\"https://github.com/Sylius/SyliusGridBundle/releases/tag/v1.11.0-RC.2\">https://github.com/Sylius/SyliusGridBundle/releases/tag/v1.11.0-RC.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2xmm-g482-4439\">https://github.com/advisories/GHSA-2xmm-g482-4439</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2xmm-g482-4439",
            "title": "[sylius/grid-bundle] DQL injection through sorting parameters blocked",
            "date_modified": "2022-03-18T13:39:17.000Z",
            "date_published": "2022-03-15T19:09:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2xmm-g482-4439"
            }
        },
        {
            "content_html": "<p>Cross-site Scripting (XSS) - Stored in GitHub repository microweber/microweber prior to 1.2.12.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0928\">https://nvd.nist.gov/vuln/detail/CVE-2022-0928</a></li>\n<li><a href=\"https://github.com/microweber/microweber/commit/fc9137c031f7edec5f50d73b300919fb519c924a\">https://github.com/microweber/microweber/commit/fc9137c031f7edec5f50d73b300919fb519c924a</a></li>\n<li><a href=\"https://huntr.dev/bounties/085aafdd-ba50-44c7-9650-fa573da29bcd\">https://huntr.dev/bounties/085aafdd-ba50-44c7-9650-fa573da29bcd</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jjp3-m93h-5jm4\">https://github.com/advisories/GHSA-jjp3-m93h-5jm4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jjp3-m93h-5jm4",
            "title": "[microweber/microweber] Cross-site Scripting in microweber",
            "date_modified": "2022-03-17T21:54:01.000Z",
            "date_published": "2022-03-12T00:00:34.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jjp3-m93h-5jm4"
            }
        },
        {
            "content_html": "<p>Unrestricted Upload of File with Dangerous Type in GitHub repository microweber/microweber prior to 1.2.11.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0912\">https://nvd.nist.gov/vuln/detail/CVE-2022-0912</a></li>\n<li><a href=\"https://github.com/microweber/microweber/commit/24245297231f5dc88bb3a2b20d0e4e25b0ebc789\">https://github.com/microweber/microweber/commit/24245297231f5dc88bb3a2b20d0e4e25b0ebc789</a></li>\n<li><a href=\"https://huntr.dev/bounties/ae5bb359-7e53-498b-848e-540c05b44c54\">https://huntr.dev/bounties/ae5bb359-7e53-498b-848e-540c05b44c54</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6vx5-cg2p-7g5v\">https://github.com/advisories/GHSA-6vx5-cg2p-7g5v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6vx5-cg2p-7g5v",
            "title": "[microweber/microweber] Unrestricted Upload of File with Dangerous Type in microweber",
            "date_modified": "2022-03-17T21:54:05.000Z",
            "date_published": "2022-03-12T00:00:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6vx5-cg2p-7g5v"
            }
        },
        {
            "content_html": "<p>Cross Site Request Forgery (CSRF) vulnerability exists in Intelliants Subrion CMS v4.2.1 via the Members administrator function, which could let a remote unauthenticated malicious user send an authorised request to victim and successfully create an arbitrary administrator user.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-18326\">https://nvd.nist.gov/vuln/detail/CVE-2020-18326</a></li>\n<li><a href=\"https://github.com/hamm0nz/CVE-2020-18326\">https://github.com/hamm0nz/CVE-2020-18326</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9cc3-5w85-pxvx\">https://github.com/advisories/GHSA-9cc3-5w85-pxvx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9cc3-5w85-pxvx",
            "title": "[intelliants/subrion] Cross Site Request Forgery in intelliants/subrion",
            "date_modified": "2022-03-17T21:38:41.000Z",
            "date_published": "2022-03-05T00:00:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9cc3-5w85-pxvx"
            }
        },
        {
            "content_html": "<p>Multilple Cross Site Scripting (XSS) vulnerability exists in Intelliants Subrion CMS v4.2.1 in the Configuration panel.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-18325\">https://nvd.nist.gov/vuln/detail/CVE-2020-18325</a></li>\n<li><a href=\"https://github.com/hamm0nz/CVE-2020-18325\">https://github.com/hamm0nz/CVE-2020-18325</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pcwq-7wrw-r8jv\">https://github.com/advisories/GHSA-pcwq-7wrw-r8jv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pcwq-7wrw-r8jv",
            "title": "[intelliants/subrion] Cross-site Scripting in intelliants/subrion",
            "date_modified": "2022-03-17T21:38:56.000Z",
            "date_published": "2022-03-05T00:00:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pcwq-7wrw-r8jv"
            }
        },
        {
            "content_html": "<p>XSS on dynamic_text module in GitHub repository microweber/microweber prior to 1.2.11.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0929\">https://nvd.nist.gov/vuln/detail/CVE-2022-0929</a></li>\n<li><a href=\"https://github.com/microweber/microweber/commit/de6d17b52d261902653fbdd2ecefcaac82e54256\">https://github.com/microweber/microweber/commit/de6d17b52d261902653fbdd2ecefcaac82e54256</a></li>\n<li><a href=\"https://huntr.dev/bounties/66abf7ec-2dd7-4cb7-87f5-e91375883f03\">https://huntr.dev/bounties/66abf7ec-2dd7-4cb7-87f5-e91375883f03</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5fxf-x22x-5q38\">https://github.com/advisories/GHSA-5fxf-x22x-5q38</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5fxf-x22x-5q38",
            "title": "[microweber/microweber] Cross-site Scripting in microweber",
            "date_modified": "2022-03-17T22:23:53.000Z",
            "date_published": "2022-03-13T00:00:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5fxf-x22x-5q38"
            }
        },
        {
            "content_html": "<p>File upload filter bypass leading to stored XSS in GitHub repository microweber/microweber prior to 1.2.12.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0930\">https://nvd.nist.gov/vuln/detail/CVE-2022-0930</a></li>\n<li><a href=\"https://github.com/microweber/microweber/commit/33eb4cc0f80c1f86388c1862a8aee1061fa5d72e\">https://github.com/microweber/microweber/commit/33eb4cc0f80c1f86388c1862a8aee1061fa5d72e</a></li>\n<li><a href=\"https://huntr.dev/bounties/d184ce19-9608-42f1-bc3d-06ece2d9a993\">https://huntr.dev/bounties/d184ce19-9608-42f1-bc3d-06ece2d9a993</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2cv6-6437-39p2\">https://github.com/advisories/GHSA-2cv6-6437-39p2</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2cv6-6437-39p2",
            "title": "[microweber/microweber] Cross-site Scripting in microweber",
            "date_modified": "2022-03-17T22:23:56.000Z",
            "date_published": "2022-03-13T00:00:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2cv6-6437-39p2"
            }
        },
        {
            "content_html": "<p>File upload filter bypass leading to stored XSS in GitHub repository microweber/microweber prior to 1.2.12.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0926\">https://nvd.nist.gov/vuln/detail/CVE-2022-0926</a></li>\n<li><a href=\"https://github.com/microweber/microweber/commit/89200cfcc2cfefe5554721e7fa3cf52f6a2a9120\">https://github.com/microweber/microweber/commit/89200cfcc2cfefe5554721e7fa3cf52f6a2a9120</a></li>\n<li><a href=\"https://huntr.dev/bounties/dc5d1555-0108-4627-b542-93352f35fa17\">https://huntr.dev/bounties/dc5d1555-0108-4627-b542-93352f35fa17</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-3q55-66g3-p8xq\">https://github.com/advisories/GHSA-3q55-66g3-p8xq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-3q55-66g3-p8xq",
            "title": "[microweber/microweber] Cross-site Scripting in microweber",
            "date_modified": "2022-03-17T22:23:50.000Z",
            "date_published": "2022-03-13T00:00:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-3q55-66g3-p8xq"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>There is a possibility to upload an SVG file containing XSS code in the admin panel. In order to perform an XSS attack, the file itself has to be opened in a new card (or loaded outside of the IMG tag). The problem applies both to the files opened on the admin panel and shop pages.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.9.10, 1.10.11, 1.11.2, and above.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If there is a need to upload an SVG image type, on-upload sanitization has to be added. The way to achieve this is to require a library that will do the trick:</p>\n<pre><code>composer require enshrined/svg-sanitize\n</code></pre>\n<p>The second step is all about performing a file content sanitization before writing it to the filesystem. It can be done by overwriting the service:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Uploader;\n\nuse enshrined\\svgSanitize\\Sanitizer;\nuse Gaufrette\\Filesystem;\nuse Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface;\nuse Sylius\\Component\\Core\\Generator\\UploadedImagePathGenerator;\nuse Sylius\\Component\\Core\\Model\\ImageInterface;\nuse Sylius\\Component\\Core\\Uploader\\ImageUploaderInterface;\nuse Symfony\\Component\\HttpFoundation\\File\\File;\nuse Webmozart\\Assert\\Assert;\n\nfinal class ImageUploader implements ImageUploaderInterface\n{\n    private const MIME_SVG_XML = 'image/svg+xml';\n    private const MIME_SVG = 'image/svg';\n\n    /** @var Filesystem */\n    protected $filesystem;\n\n    /** @var ImagePathGeneratorInterface */\n    protected $imagePathGenerator;\n\n    /** @var Sanitizer */\n    protected $sanitizer;\n\n    public function __construct(\n        Filesystem $filesystem,\n        ?ImagePathGeneratorInterface $imagePathGenerator = null\n    ) {\n        $this-&gt;filesystem = $filesystem;\n\n        if ($imagePathGenerator === null) {\n            @trigger_error(sprintf(\n                'Not passing an $imagePathGenerator to %s constructor is deprecated since Sylius 1.6 and will be not possible in Sylius 2.0.', self::class\n            ), \\E_USER_DEPRECATED);\n        }\n\n        $this-&gt;imagePathGenerator = $imagePathGenerator ?? new UploadedImagePathGenerator();\n        $this-&gt;sanitizer = new Sanitizer();\n    }\n\n    public function upload(ImageInterface $image): void\n    {\n        if (!$image-&gt;hasFile()) {\n            return;\n        }\n\n        /** @var File $file */\n        $file = $image-&gt;getFile();\n\n        Assert::isInstanceOf($file, File::class);\n\n        $fileContent = $this-&gt;sanitizeContent(file_get_contents($file-&gt;getPathname()), $file-&gt;getMimeType());\n\n        if (null !== $image-&gt;getPath() &amp;&amp; $this-&gt;has($image-&gt;getPath())) {\n            $this-&gt;remove($image-&gt;getPath());\n        }\n\n        do {\n            $path = $this-&gt;imagePathGenerator-&gt;generate($image);\n        } while ($this-&gt;isAdBlockingProne($path) || $this-&gt;filesystem-&gt;has($path));\n\n        $image-&gt;setPath($path);\n\n        $this-&gt;filesystem-&gt;write($image-&gt;getPath(), $fileContent);\n    }\n\n    public function remove(string $path): bool\n    {\n        if ($this-&gt;filesystem-&gt;has($path)) {\n            return $this-&gt;filesystem-&gt;delete($path);\n        }\n\n        return false;\n    }\n\n    protected function sanitizeContent(string $fileContent, string $mimeType): string\n    {\n        if (self::MIME_SVG_XML === $mimeType || self::MIME_SVG === $mimeType) {\n            $fileContent = $this-&gt;sanitizer-&gt;sanitize($fileContent);\n        }\n\n        return $fileContent;\n    }\n\n    private function has(string $path): bool\n    {\n        return $this-&gt;filesystem-&gt;has($path);\n    }\n\n    /**\n     * Will return true if the path is prone to be blocked by ad blockers\n     */\n    private function isAdBlockingProne(string $path): bool\n    {\n        return strpos($path, 'ad') !== false;\n    }\n}\n</code></pre>\n<p>After that, register service in the container:</p>\n<pre><code class=\"language-yaml\">services:\n    sylius.image_uploader:\n        class: App\\Uploader\\ImageUploader\n        arguments:\n            - '@gaufrette.sylius_image_filesystem'\n            - '@Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface'\n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.9.10\">https://github.com/Sylius/Sylius/releases/tag/v1.9.10</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24749\">https://nvd.nist.gov/vuln/detail/CVE-2022-24749</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/advisories/GHSA-4qrp-27r3-66fj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj",
            "title": "[Sylius/Sylius] Improper sanitize of SVG files during content upload ('Cross-site Scripting') in sylius/sylius",
            "date_modified": "2022-03-18T15:22:21.000Z",
            "date_published": "2022-03-14T22:38:14.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>There is a possibility to upload an SVG file containing XSS code in the admin panel. In order to perform an XSS attack, the file itself has to be opened in a new card (or loaded outside of the IMG tag). The problem applies both to the files opened on the admin panel and shop pages.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.9.10, 1.10.11, 1.11.2, and above.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If there is a need to upload an SVG image type, on-upload sanitization has to be added. The way to achieve this is to require a library that will do the trick:</p>\n<pre><code>composer require enshrined/svg-sanitize\n</code></pre>\n<p>The second step is all about performing a file content sanitization before writing it to the filesystem. It can be done by overwriting the service:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Uploader;\n\nuse enshrined\\svgSanitize\\Sanitizer;\nuse Gaufrette\\Filesystem;\nuse Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface;\nuse Sylius\\Component\\Core\\Generator\\UploadedImagePathGenerator;\nuse Sylius\\Component\\Core\\Model\\ImageInterface;\nuse Sylius\\Component\\Core\\Uploader\\ImageUploaderInterface;\nuse Symfony\\Component\\HttpFoundation\\File\\File;\nuse Webmozart\\Assert\\Assert;\n\nfinal class ImageUploader implements ImageUploaderInterface\n{\n    private const MIME_SVG_XML = 'image/svg+xml';\n    private const MIME_SVG = 'image/svg';\n\n    /** @var Filesystem */\n    protected $filesystem;\n\n    /** @var ImagePathGeneratorInterface */\n    protected $imagePathGenerator;\n\n    /** @var Sanitizer */\n    protected $sanitizer;\n\n    public function __construct(\n        Filesystem $filesystem,\n        ?ImagePathGeneratorInterface $imagePathGenerator = null\n    ) {\n        $this-&gt;filesystem = $filesystem;\n\n        if ($imagePathGenerator === null) {\n            @trigger_error(sprintf(\n                'Not passing an $imagePathGenerator to %s constructor is deprecated since Sylius 1.6 and will be not possible in Sylius 2.0.', self::class\n            ), \\E_USER_DEPRECATED);\n        }\n\n        $this-&gt;imagePathGenerator = $imagePathGenerator ?? new UploadedImagePathGenerator();\n        $this-&gt;sanitizer = new Sanitizer();\n    }\n\n    public function upload(ImageInterface $image): void\n    {\n        if (!$image-&gt;hasFile()) {\n            return;\n        }\n\n        /** @var File $file */\n        $file = $image-&gt;getFile();\n\n        Assert::isInstanceOf($file, File::class);\n\n        $fileContent = $this-&gt;sanitizeContent(file_get_contents($file-&gt;getPathname()), $file-&gt;getMimeType());\n\n        if (null !== $image-&gt;getPath() &amp;&amp; $this-&gt;has($image-&gt;getPath())) {\n            $this-&gt;remove($image-&gt;getPath());\n        }\n\n        do {\n            $path = $this-&gt;imagePathGenerator-&gt;generate($image);\n        } while ($this-&gt;isAdBlockingProne($path) || $this-&gt;filesystem-&gt;has($path));\n\n        $image-&gt;setPath($path);\n\n        $this-&gt;filesystem-&gt;write($image-&gt;getPath(), $fileContent);\n    }\n\n    public function remove(string $path): bool\n    {\n        if ($this-&gt;filesystem-&gt;has($path)) {\n            return $this-&gt;filesystem-&gt;delete($path);\n        }\n\n        return false;\n    }\n\n    protected function sanitizeContent(string $fileContent, string $mimeType): string\n    {\n        if (self::MIME_SVG_XML === $mimeType || self::MIME_SVG === $mimeType) {\n            $fileContent = $this-&gt;sanitizer-&gt;sanitize($fileContent);\n        }\n\n        return $fileContent;\n    }\n\n    private function has(string $path): bool\n    {\n        return $this-&gt;filesystem-&gt;has($path);\n    }\n\n    /**\n     * Will return true if the path is prone to be blocked by ad blockers\n     */\n    private function isAdBlockingProne(string $path): bool\n    {\n        return strpos($path, 'ad') !== false;\n    }\n}\n</code></pre>\n<p>After that, register service in the container:</p>\n<pre><code class=\"language-yaml\">services:\n    sylius.image_uploader:\n        class: App\\Uploader\\ImageUploader\n        arguments:\n            - '@gaufrette.sylius_image_filesystem'\n            - '@Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface'\n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.9.10\">https://github.com/Sylius/Sylius/releases/tag/v1.9.10</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24749\">https://nvd.nist.gov/vuln/detail/CVE-2022-24749</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/advisories/GHSA-4qrp-27r3-66fj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj",
            "title": "[Sylius/Sylius] Improper sanitize of SVG files during content upload ('Cross-site Scripting') in sylius/sylius",
            "date_modified": "2022-03-18T15:22:21.000Z",
            "date_published": "2022-03-14T22:38:14.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>There is a possibility to upload an SVG file containing XSS code in the admin panel. In order to perform an XSS attack, the file itself has to be opened in a new card (or loaded outside of the IMG tag). The problem applies both to the files opened on the admin panel and shop pages.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.9.10, 1.10.11, 1.11.2, and above.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If there is a need to upload an SVG image type, on-upload sanitization has to be added. The way to achieve this is to require a library that will do the trick:</p>\n<pre><code>composer require enshrined/svg-sanitize\n</code></pre>\n<p>The second step is all about performing a file content sanitization before writing it to the filesystem. It can be done by overwriting the service:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\Uploader;\n\nuse enshrined\\svgSanitize\\Sanitizer;\nuse Gaufrette\\Filesystem;\nuse Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface;\nuse Sylius\\Component\\Core\\Generator\\UploadedImagePathGenerator;\nuse Sylius\\Component\\Core\\Model\\ImageInterface;\nuse Sylius\\Component\\Core\\Uploader\\ImageUploaderInterface;\nuse Symfony\\Component\\HttpFoundation\\File\\File;\nuse Webmozart\\Assert\\Assert;\n\nfinal class ImageUploader implements ImageUploaderInterface\n{\n    private const MIME_SVG_XML = 'image/svg+xml';\n    private const MIME_SVG = 'image/svg';\n\n    /** @var Filesystem */\n    protected $filesystem;\n\n    /** @var ImagePathGeneratorInterface */\n    protected $imagePathGenerator;\n\n    /** @var Sanitizer */\n    protected $sanitizer;\n\n    public function __construct(\n        Filesystem $filesystem,\n        ?ImagePathGeneratorInterface $imagePathGenerator = null\n    ) {\n        $this-&gt;filesystem = $filesystem;\n\n        if ($imagePathGenerator === null) {\n            @trigger_error(sprintf(\n                'Not passing an $imagePathGenerator to %s constructor is deprecated since Sylius 1.6 and will be not possible in Sylius 2.0.', self::class\n            ), \\E_USER_DEPRECATED);\n        }\n\n        $this-&gt;imagePathGenerator = $imagePathGenerator ?? new UploadedImagePathGenerator();\n        $this-&gt;sanitizer = new Sanitizer();\n    }\n\n    public function upload(ImageInterface $image): void\n    {\n        if (!$image-&gt;hasFile()) {\n            return;\n        }\n\n        /** @var File $file */\n        $file = $image-&gt;getFile();\n\n        Assert::isInstanceOf($file, File::class);\n\n        $fileContent = $this-&gt;sanitizeContent(file_get_contents($file-&gt;getPathname()), $file-&gt;getMimeType());\n\n        if (null !== $image-&gt;getPath() &amp;&amp; $this-&gt;has($image-&gt;getPath())) {\n            $this-&gt;remove($image-&gt;getPath());\n        }\n\n        do {\n            $path = $this-&gt;imagePathGenerator-&gt;generate($image);\n        } while ($this-&gt;isAdBlockingProne($path) || $this-&gt;filesystem-&gt;has($path));\n\n        $image-&gt;setPath($path);\n\n        $this-&gt;filesystem-&gt;write($image-&gt;getPath(), $fileContent);\n    }\n\n    public function remove(string $path): bool\n    {\n        if ($this-&gt;filesystem-&gt;has($path)) {\n            return $this-&gt;filesystem-&gt;delete($path);\n        }\n\n        return false;\n    }\n\n    protected function sanitizeContent(string $fileContent, string $mimeType): string\n    {\n        if (self::MIME_SVG_XML === $mimeType || self::MIME_SVG === $mimeType) {\n            $fileContent = $this-&gt;sanitizer-&gt;sanitize($fileContent);\n        }\n\n        return $fileContent;\n    }\n\n    private function has(string $path): bool\n    {\n        return $this-&gt;filesystem-&gt;has($path);\n    }\n\n    /**\n     * Will return true if the path is prone to be blocked by ad blockers\n     */\n    private function isAdBlockingProne(string $path): bool\n    {\n        return strpos($path, 'ad') !== false;\n    }\n}\n</code></pre>\n<p>After that, register service in the container:</p>\n<pre><code class=\"language-yaml\">services:\n    sylius.image_uploader:\n        class: App\\Uploader\\ImageUploader\n        arguments:\n            - '@gaufrette.sylius_image_filesystem'\n            - '@Sylius\\Component\\Core\\Generator\\ImagePathGeneratorInterface'\n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/Sylius/Sylius/security/advisories/GHSA-4qrp-27r3-66fj</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.9.10\">https://github.com/Sylius/Sylius/releases/tag/v1.9.10</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24749\">https://nvd.nist.gov/vuln/detail/CVE-2022-24749</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4qrp-27r3-66fj\">https://github.com/advisories/GHSA-4qrp-27r3-66fj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj",
            "title": "[Sylius/Sylius] Improper sanitize of SVG files during content upload ('Cross-site Scripting') in sylius/sylius",
            "date_modified": "2022-03-18T15:22:21.000Z",
            "date_published": "2022-03-14T22:38:14.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4qrp-27r3-66fj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The reset password token was not set to null after the password was changed. This is causing behaviour in which the same token can be used several times, so it can result in a leak of the existing token and an unauthorised password change.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.10.11, 1.11.2 and above</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>You have to overwrite your <code>Sylius\\Bundle\\ApiBundle\\CommandHandler\\ResetPasswordHandler</code> class using this code:</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nnamespace App\\CommandHandler\\Account;\n\nuse Sylius\\Bundle\\ApiBundle\\Command\\Account\\ResetPassword;\nuse Sylius\\Component\\Core\\Model\\ShopUserInterface;\nuse Sylius\\Component\\Resource\\Metadata\\MetadataInterface;\nuse Sylius\\Component\\User\\Repository\\UserRepositoryInterface;\nuse Sylius\\Component\\User\\Security\\PasswordUpdaterInterface;\nuse Symfony\\Component\\Messenger\\Handler\\MessageHandlerInterface;\nuse Webmozart\\Assert\\Assert;\n\nfinal class ResetPasswordHandler implements MessageHandlerInterface\n{\n    private UserRepositoryInterface $userRepository;\n    private MetadataInterface $metadata;\n    private PasswordUpdaterInterface $passwordUpdater;\n\n    public function __construct(\n        UserRepositoryInterface $userRepository,\n        MetadataInterface $metadata,\n        PasswordUpdaterInterface $passwordUpdater\n    ) {\n        $this-&gt;userRepository = $userRepository;\n        $this-&gt;metadata = $metadata;\n        $this-&gt;passwordUpdater = $passwordUpdater;\n    }\n\n    public function __invoke(ResetPassword $command): void\n    {\n        /** @var ShopUserInterface|null $user */\n        $user = $this-&gt;userRepository-&gt;findOneBy(['passwordResetToken' =&gt; $command-&gt;resetPasswordToken]);\n\n        Assert::notNull($user, 'No user found with reset token: ' . $command-&gt;resetPasswordToken);\n\n        $resetting = $this-&gt;metadata-&gt;getParameter('resetting');\n        $lifetime = new \\DateInterval($resetting['token']['ttl']);\n\n        if (!$user-&gt;isPasswordRequestNonExpired($lifetime)) {\n            throw new \\InvalidArgumentException('Password reset token has expired');\n        }\n\n        if ($command-&gt;resetPasswordToken !== $user-&gt;getPasswordResetToken()) {\n            throw new \\InvalidArgumentException('Password reset token does not match.');\n        }\n\n        $user-&gt;setPlainPassword($command-&gt;newPassword);\n\n        $this-&gt;passwordUpdater-&gt;updatePassword($user);\n        $user-&gt;setPasswordResetToken(null);\n    }\n}\n</code></pre>\n<p>And register it in container:</p>\n<pre><code class=\"language-yaml\">\nApp\\CommandHandler\\Account\\ResetPasswordHandler:\n    arguments:\n        - '@sylius.repository.shop_user'\n        - !service\n              class: Sylius\\Component\\Resource\\Metadata\\MetadataInterface\n              factory: [ '@sylius.resource_registry', 'get' ]\n              arguments:\n                    - 'sylius.shop_user'\n                    - '@sylius.security.password_updater'\n    tags:\n        - { name: messenger.message_handler, bus: sylius.command_bus }\n        - { name: messenger.message_handler, bus: sylius_default.bus }\n         \n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-mf3v-f2qq-pf9g\">https://github.com/Sylius/Sylius/security/advisories/GHSA-mf3v-f2qq-pf9g</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24743\">https://nvd.nist.gov/vuln/detail/CVE-2022-24743</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mf3v-f2qq-pf9g\">https://github.com/advisories/GHSA-mf3v-f2qq-pf9g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mf3v-f2qq-pf9g",
            "title": "[sylius/sylius] Insufficient Session Expiration in Sylius",
            "date_modified": "2022-03-18T13:11:57.000Z",
            "date_published": "2022-03-14T22:30:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mf3v-f2qq-pf9g"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The reset password token was not set to null after the password was changed. This is causing behaviour in which the same token can be used several times, so it can result in a leak of the existing token and an unauthorised password change.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.10.11, 1.11.2 and above</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>You have to overwrite your <code>Sylius\\Bundle\\ApiBundle\\CommandHandler\\ResetPasswordHandler</code> class using this code:</p>\n<pre><code class=\"language-php\">&lt;?php\ndeclare(strict_types=1);\n\nnamespace App\\CommandHandler\\Account;\n\nuse Sylius\\Bundle\\ApiBundle\\Command\\Account\\ResetPassword;\nuse Sylius\\Component\\Core\\Model\\ShopUserInterface;\nuse Sylius\\Component\\Resource\\Metadata\\MetadataInterface;\nuse Sylius\\Component\\User\\Repository\\UserRepositoryInterface;\nuse Sylius\\Component\\User\\Security\\PasswordUpdaterInterface;\nuse Symfony\\Component\\Messenger\\Handler\\MessageHandlerInterface;\nuse Webmozart\\Assert\\Assert;\n\nfinal class ResetPasswordHandler implements MessageHandlerInterface\n{\n    private UserRepositoryInterface $userRepository;\n    private MetadataInterface $metadata;\n    private PasswordUpdaterInterface $passwordUpdater;\n\n    public function __construct(\n        UserRepositoryInterface $userRepository,\n        MetadataInterface $metadata,\n        PasswordUpdaterInterface $passwordUpdater\n    ) {\n        $this-&gt;userRepository = $userRepository;\n        $this-&gt;metadata = $metadata;\n        $this-&gt;passwordUpdater = $passwordUpdater;\n    }\n\n    public function __invoke(ResetPassword $command): void\n    {\n        /** @var ShopUserInterface|null $user */\n        $user = $this-&gt;userRepository-&gt;findOneBy(['passwordResetToken' =&gt; $command-&gt;resetPasswordToken]);\n\n        Assert::notNull($user, 'No user found with reset token: ' . $command-&gt;resetPasswordToken);\n\n        $resetting = $this-&gt;metadata-&gt;getParameter('resetting');\n        $lifetime = new \\DateInterval($resetting['token']['ttl']);\n\n        if (!$user-&gt;isPasswordRequestNonExpired($lifetime)) {\n            throw new \\InvalidArgumentException('Password reset token has expired');\n        }\n\n        if ($command-&gt;resetPasswordToken !== $user-&gt;getPasswordResetToken()) {\n            throw new \\InvalidArgumentException('Password reset token does not match.');\n        }\n\n        $user-&gt;setPlainPassword($command-&gt;newPassword);\n\n        $this-&gt;passwordUpdater-&gt;updatePassword($user);\n        $user-&gt;setPasswordResetToken(null);\n    }\n}\n</code></pre>\n<p>And register it in container:</p>\n<pre><code class=\"language-yaml\">\nApp\\CommandHandler\\Account\\ResetPasswordHandler:\n    arguments:\n        - '@sylius.repository.shop_user'\n        - !service\n              class: Sylius\\Component\\Resource\\Metadata\\MetadataInterface\n              factory: [ '@sylius.resource_registry', 'get' ]\n              arguments:\n                    - 'sylius.shop_user'\n                    - '@sylius.security.password_updater'\n    tags:\n        - { name: messenger.message_handler, bus: sylius.command_bus }\n        - { name: messenger.message_handler, bus: sylius_default.bus }\n         \n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-mf3v-f2qq-pf9g\">https://github.com/Sylius/Sylius/security/advisories/GHSA-mf3v-f2qq-pf9g</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24743\">https://nvd.nist.gov/vuln/detail/CVE-2022-24743</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mf3v-f2qq-pf9g\">https://github.com/advisories/GHSA-mf3v-f2qq-pf9g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mf3v-f2qq-pf9g",
            "title": "[sylius/sylius] Insufficient Session Expiration in Sylius",
            "date_modified": "2022-03-18T13:11:57.000Z",
            "date_published": "2022-03-14T22:30:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mf3v-f2qq-pf9g"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any other user can view the data if the browser tab remains open after logging out. Once someone logs out and leaves the browser open, the potential attacker may use the back button to see the content exposed on given screens. No action may be performed though, and any website refresh will block further reads. It may, however, lead to a data leak, like for example customer details, payment gateway configuration, etc.- but only if these were pages checked by the administrator. </p>\n<p>This vulnerability requires full access to the computer to take advantage of it.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed in versions: 1.9.10, 1.10.11, 1.11.2 and above.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The application must strictly redirect to the login page even when the browser back button is pressed. Another possibility is to set more strict cache policies for restricted content (like no-store). It can be achieved with the following class:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\EventListener;\n\nuse App\\SectionResolver\\ShopCustomerAccountSubSection;\nuse Sylius\\Bundle\\AdminBundle\\SectionResolver\\AdminSection;\nuse Sylius\\Bundle\\CoreBundle\\SectionResolver\\SectionProviderInterface;\nuse Symfony\\Component\\EventDispatcher\\EventSubscriberInterface;\nuse Symfony\\Component\\HttpKernel\\Event\\ResponseEvent;\nuse Symfony\\Component\\HttpKernel\\KernelEvents;\n\nfinal class CacheControlSubscriber implements EventSubscriberInterface\n{\n    /** @var SectionProviderInterface */\n    private $sectionProvider;\n\n    public function __construct(SectionProviderInterface $sectionProvider)\n    {\n        $this-&gt;sectionProvider = $sectionProvider;\n    }\n\n    public static function getSubscribedEvents(): array\n    {\n        return [\n            KernelEvents::RESPONSE =&gt; 'setCacheControlDirectives',\n        ];\n    }\n\n    public function setCacheControlDirectives(ResponseEvent $event): void\n    {\n        if (\n            !$this-&gt;sectionProvider-&gt;getSection() instanceof AdminSection &amp;&amp;\n            !$this-&gt;sectionProvider-&gt;getSection() instanceof ShopCustomerAccountSubSection\n        ) {\n            return;\n        }\n\n        $response = $event-&gt;getResponse();\n\n        $response-&gt;headers-&gt;addCacheControlDirective('no-cache', true);\n        $response-&gt;headers-&gt;addCacheControlDirective('max-age', '0');\n        $response-&gt;headers-&gt;addCacheControlDirective('must-revalidate', true);\n        $response-&gt;headers-&gt;addCacheControlDirective('no-store', true);\n    }\n}\n</code></pre>\n<p>After that register service in the container:</p>\n<pre><code class=\"language-yaml\">services:\n    App\\EventListener\\CacheControlSubscriber:\n        arguments: ['@sylius.section_resolver.uri_based_section_resolver']\n        tags:\n            - { name: kernel.event_subscriber, event: kernel.response }\n</code></pre>\n<p>The code above requires changes in <code>ShopUriBasedSectionResolver</code> in order to work. To backport mentioned logic, you need to replace the <code>Sylius\\Bundle\\ShopBundle\\SectionResolver\\ShopUriBasedSectionResolver</code> class with:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\SectionResolver;\n\nuse Sylius\\Bundle\\CoreBundle\\SectionResolver\\SectionInterface;\nuse Sylius\\Bundle\\CoreBundle\\SectionResolver\\UriBasedSectionResolverInterface;\nuse Sylius\\Bundle\\ShopBundle\\SectionResolver\\ShopSection;\n\nfinal class ShopUriBasedSectionResolver implements UriBasedSectionResolverInterface\n{\n    /** @var string */\n    private $shopCustomerAccountUri;\n\n    public function __construct(string $shopCustomerAccountUri = 'account')\n    {\n        $this-&gt;shopCustomerAccountUri = $shopCustomerAccountUri;\n    }\n\n    public function getSection(string $uri): SectionInterface\n    {\n        if (str_contains($uri, $this-&gt;shopCustomerAccountUri)) {\n            return new ShopCustomerAccountSubSection();\n        }\n\n        return new ShopSection();\n    }\n}\n</code></pre>\n<pre><code class=\"language-yaml\">services:\n    sylius.section_resolver.shop_uri_based_section_resolver:\n        class: App\\SectionResolver\\ShopUriBasedSectionResolver\n        tags:\n            - { name: sylius.uri_based_section_resolver, priority: -10 }\n</code></pre>\n<p>You also need to define a new subsection for the Customer Account that is used in the above services:</p>\n<pre><code class=\"language-php\">&lt;?php\n\ndeclare(strict_types=1);\n\nnamespace App\\SectionResolver;\n\nuse Sylius\\Bundle\\ShopBundle\\SectionResolver\\ShopSection;\n\nclass ShopCustomerAccountSubSection extends ShopSection\n{\n}\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>Originally published at <a href=\"https://huntr.dev/\">https://huntr.dev/</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/Sylius/Sylius/issues\">Sylius issues</a></li>\n<li>Email us at <a href=\"mailto:security@sylius.com\">security@sylius.com</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Sylius/Sylius/security/advisories/GHSA-7563-75j9-6h5p\">https://github.com/Sylius/Sylius/security/advisories/GHSA-7563-75j9-6h5p</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24742\">https://nvd.nist.gov/vuln/detail/CVE-2022-24742</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.10.11\">https://github.com/Sylius/Sylius/releases/tag/v1.10.11</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.11.2\">https://github.com/Sylius/Sylius/releases/tag/v1.11.2</a></li>\n<li><a href=\"https://github.com/Sylius/Sylius/releases/tag/v1.9.10\">https://github.com/Sylius/Sylius/releases/tag/v1.9.10</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7563-75j9-6h5p\">https://github.com/advisories/GHSA-7563-75j9-6h5p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7563-75j9-6h5p",
            "title": "[sylius/sylius] Sensitive Information Exposure in Sylius",
            "date_modified": "2022-03-18T13:11:43.000Z",
            "date_published": "2022-03-14T22:26:58.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7563-75j9-6h5p"
            }
        }
    ]
}