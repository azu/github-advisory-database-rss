{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Python packages hosted at PyPI.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/pip.json",
    "description": "Security Advisory for Python packages hosted at PyPI.org on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Due to an unsanitized input, visiting maliciously crafted links could result in arbitrary code execution in the user environment.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>0.10.2</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>None, other than upgrade to 0.10.2 or downgrade to 0.8.x.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/jupyterhub/nbgitpuller/issues\">nbgitpuller</a></li>\n<li>Email our security team at <a href=\"mailto:security@ipython.org\">security@ipython.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyterhub/nbgitpuller/security/advisories/GHSA-mq5p-2mcr-m52j\">https://github.com/jupyterhub/nbgitpuller/security/advisories/GHSA-mq5p-2mcr-m52j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-39160\">https://nvd.nist.gov/vuln/detail/CVE-2021-39160</a></li>\n<li><a href=\"https://github.com/jupyterhub/nbgitpuller/commit/07690644f29a566011dd0d7ba14cae3eb0490481\">https://github.com/jupyterhub/nbgitpuller/commit/07690644f29a566011dd0d7ba14cae3eb0490481</a></li>\n<li><a href=\"https://github.com/jupyterhub/nbgitpuller/blob/main/CHANGELOG.md#0102---2021-08-25\">https://github.com/jupyterhub/nbgitpuller/blob/main/CHANGELOG.md#0102---2021-08-25</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbgitpuller/PYSEC-2021-315.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbgitpuller/PYSEC-2021-315.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mq5p-2mcr-m52j\">https://github.com/advisories/GHSA-mq5p-2mcr-m52j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mq5p-2mcr-m52j",
            "title": "[nbgitpuller] Code injection in nbgitpuller",
            "date_modified": "2024-10-03T21:28:39.000Z",
            "date_published": "2021-08-30T16:17:06.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mq5p-2mcr-m52j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The \"download image from remote URL\" feature can be abused by a malicious actor to potentially extract information about server side resources. Submitting a crafted URL (in place of a valid image) can raise a server side error, which is reported back to the user. </p>\n<p>This error message may contain sensitive information about the server side request, including information about the availability of the remote resource.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The solution to this vulnerability is to prevent the server from returning any specific information about the observed exception. Instead, a generic error message is returned to the client.</p>\n<p>This patch has been applied to the upcoming 0.17.0 release, and also back-ported to the 0.16.5 stable release.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>To avoid this issue with unpatched versions, the \"download image from remote URL\" feature can be disabled in InvenTree, preventing users from accessing this information. </p>\n<h3 id=\"references\">References</h3>\n<p>Thanks to @febin0x10 for identifying this vulnerability and reporting it to us as per our security policy.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/inventree/InvenTree/security/advisories/GHSA-vx3h-qwqw-r2wq\">https://github.com/inventree/InvenTree/security/advisories/GHSA-vx3h-qwqw-r2wq</a></li>\n<li><a href=\"https://github.com/inventree/InvenTree/commit/5759b60a48e7e178fb417a900ed543f29dc5dc86\">https://github.com/inventree/InvenTree/commit/5759b60a48e7e178fb417a900ed543f29dc5dc86</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vx3h-qwqw-r2wq\">https://github.com/advisories/GHSA-vx3h-qwqw-r2wq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vx3h-qwqw-r2wq",
            "title": "[inventree] Inventree Server-Side Request Forgery vulnerability exposes server port/internal IP",
            "date_modified": "2024-10-02T17:58:45.000Z",
            "date_published": "2024-10-02T17:58:44.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vx3h-qwqw-r2wq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>pgAdmin versions 8.11 and earlier are vulnerable to a security flaw in OAuth2 authentication. This vulnerability allows an attacker to potentially obtain the client ID and secret, leading to unauthorized access to user data.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-9014\">https://nvd.nist.gov/vuln/detail/CVE-2024-9014</a></li>\n<li><a href=\"https://github.com/pgadmin-org/pgadmin4/issues/7945\">https://github.com/pgadmin-org/pgadmin4/issues/7945</a></li>\n<li><a href=\"https://www.pgadmin.org/docs/pgadmin4/8.12/release_notes_8_12.html\">https://www.pgadmin.org/docs/pgadmin4/8.12/release_notes_8_12.html</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jm9x-rx9x-wpqj\">https://github.com/advisories/GHSA-jm9x-rx9x-wpqj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jm9x-rx9x-wpqj",
            "title": "[pgadmin4] OAuth2 client ID and secret exposed through the web browser",
            "date_modified": "2024-10-01T20:35:11.000Z",
            "date_published": "2024-09-23T18:30:34.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jm9x-rx9x-wpqj"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>MoinMoin 1.9.8 allows remote attackers to conduct \"JavaScript injection\" attacks by using the \"page creation\" approach, related to a \"Cross Site Scripting (XSS)\" issue affecting the action=AttachFile (via page name) component. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2016-7148\">https://nvd.nist.gov/vuln/detail/CVE-2016-7148</a></li>\n<li><a href=\"https://web.archive.org/web/20200227212542/http://www.securityfocus.com/bid/94259\">https://web.archive.org/web/20200227212542/http://www.securityfocus.com/bid/94259</a></li>\n<li><a href=\"https://web.archive.org/web/20230601130846/https://www.curesec.com/blog/article/blog/MoinMoin-198-XSS-175.html\">https://web.archive.org/web/20230601130846/https://www.curesec.com/blog/article/blog/MoinMoin-198-XSS-175.html</a></li>\n<li><a href=\"https://www.debian.org/security/2016/dsa-3715\">https://www.debian.org/security/2016/dsa-3715</a></li>\n<li><a href=\"https://www.ubuntu.com/usn/USN-3137-1\">https://www.ubuntu.com/usn/USN-3137-1</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/moin/PYSEC-2016-31.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/moin/PYSEC-2016-31.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-3x76-j3jj-439j\">https://github.com/advisories/GHSA-3x76-j3jj-439j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-3x76-j3jj-439j",
            "title": "[moin] MoinMoin Cross-site Scripting (XSS) vulnerability",
            "date_modified": "2024-10-01T19:32:33.000Z",
            "date_published": "2022-05-17T03:02:29.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-3x76-j3jj-439j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>mitmweb in mitmproxy before v4.0.4 allows DNS Rebinding attacks, related to tools/web/app.py.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-14505\">https://nvd.nist.gov/vuln/detail/CVE-2018-14505</a></li>\n<li><a href=\"https://github.com/mitmproxy/mitmproxy/issues/3234\">https://github.com/mitmproxy/mitmproxy/issues/3234</a></li>\n<li><a href=\"https://github.com/mitmproxy/mitmproxy/pull/3243\">https://github.com/mitmproxy/mitmproxy/pull/3243</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6m53-c78q-7qmg\">https://github.com/advisories/GHSA-6m53-c78q-7qmg</a></li>\n<li><a href=\"https://github.com/mitmproxy/mitmproxy/commit/7f464b89296881f4d9ec032378c4418e832d17e3\">https://github.com/mitmproxy/mitmproxy/commit/7f464b89296881f4d9ec032378c4418e832d17e3</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mitmproxy/PYSEC-2018-56.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mitmproxy/PYSEC-2018-56.yaml</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6m53-c78q-7qmg",
            "title": "[mitmproxy] Mitmweb in mitmproxy allows DNS Rebinding attacks",
            "date_modified": "2024-10-01T19:30:00.000Z",
            "date_published": "2018-07-31T18:18:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6m53-c78q-7qmg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A malicious web server can read arbitrary files on the client using a <code>&lt;input type=\"file\" ...&gt;</code> inside HTML form.</p>\n<h3 id=\"details\">Details</h3>\n<p>This affects the extremely common pattern of form submission:</p>\n<pre><code class=\"language-python\">b = mechanicalsoup.StatefulBrowser()\nb.select_form(...)\nb.submit_selected()\n</code></pre>\n<p>The problem is with the code in <code>browser.Browser.get_request_kwargs</code>:</p>\n<pre><code class=\"language-python\">    if tag.get(\"type\", \"\").lower() == \"file\" and multipart:\n        filepath = value\n        if filepath != \"\" and isinstance(filepath, str):\n            content = open(filepath, \"rb\")\n        else:\n            content = \"\"\n        filename = os.path.basename(filepath)\n        # If value is the empty string, we still pass it\n        # for consistency with browsers (see\n        # https://github.com/MechanicalSoup/MechanicalSoup/issues/250).\n        files[name] = (filename, content)\n</code></pre>\n<p>The file path is taken from the bs4 tag \"value\" attribute. However, this path will default to whatever the server sends. So if a malicious web server were to send something like:</p>\n<pre><code class=\"language-html\">&lt;html&gt;&lt;body&gt;\n  &lt;form method=\"post\" enctype=\"multipart/form-data\"&gt;\n    &lt;input type=\"text\" name=\"greeting\" value=\"hello\" /&gt;\n    &lt;input type=\"file\" name=\"evil\" value=\"/home/user/.ssh/id_rsa\" /&gt;\n  &lt;/form&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>\n<p>then upon <code>.submit_selected()</code> the mechanicalsoup browser will happily send over the contents of your SSH private key.</p>\n<h3 id=\"poc\">PoC</h3>\n<pre><code class=\"language-python\">import attr\nimport mechanicalsoup\nimport requests\n\n\nclass NevermindError(Exception):\n    pass\n\n\n@attr.s\nclass FakeSession:\n    session = attr.ib()\n\n    headers = property(lambda self: self.session.headers)\n\n    def request(self, *args, **kwargs):\n        print(\"requested\", args, kwargs)\n        raise NevermindError  # don't actually send request\n\n\ndef demonstrate(inputs=None):\n    b = mechanicalsoup.StatefulBrowser(FakeSession(requests.Session()))\n    b.open_fake_page(\"\"\"\\\n&lt;html&gt;&lt;body&gt;\n&lt;form method=\"post\" enctype=\"multipart/form-data\"&gt;\n&lt;input type=\"text\" name=\"greeting\" value=\"hello\" /&gt;\n&lt;input type=\"file\" name=\"evil\" value=\"/etc/passwd\" /&gt;\n&lt;input type=\"file\" name=\"second\" /&gt;\n&lt;/form&gt;\n&lt;/body&gt;&lt;/html&gt;\n\"\"\", url=\"http://127.0.0.1:9/\")\n    b.select_form()\n    if inputs is not None:\n        b.form.set_input(inputs)\n    try:\n        b.submit_selected()\n    except NevermindError:\n        pass\n\n# %%\n\n# unpatched\ndemonstrate()\n# OUTPUT: requested () {'method': 'post', 'url': 'http://127.0.0.1:9/', 'files': {'evil': ('passwd', &lt;_io.BufferedReader name='/etc/passwd'&gt;), 'second': ('', '')}, 'headers': {'Referer': 'http://127.0.0.1:9/'}, 'data': [('greeting', 'hello')]}\n\n# %%\n\n# with the patch, this now works. users MUST open the file manually and\n# use browser.set_input() using the file object.\ndemonstrate({\"greeting\": \"hiya\", \"evil\": open(\"/etc/hostname\", \"rb\").name, \"second\": open(\"/dev/null\", \"rb\")})\n# OUTPUT: requested () {'method': 'post', 'url': 'http://127.0.0.1:9/', 'files': {'evil': ('hostname', &lt;_io.BufferedReader name='/etc/hostname'&gt;), 'second': ('null', &lt;_io.BufferedReader name='/dev/null'&gt;)}, 'headers': {'Referer': 'http://127.0.0.1:9/'}, 'data': [('greeting', 'hiya')]}\n\n# %%\n\n# with the patch, this raises a ValueError with a helpful string\ndemonstrate({\"evil\": \"/etc/hostname\"})\n\n# %%\n\n# with the patch, we silently send no file if a malicious server tries the attack:\ndemonstrate()\n</code></pre>\n<h3 id=\"suggested-patch\">Suggested patch</h3>\n<pre><code class=\"language-diff\">diff --git a/mechanicalsoup/browser.py b/mechanicalsoup/browser.py\nindex 285f8bb..68bc65e 100644\n--- a/mechanicalsoup/browser.py\n+++ b/mechanicalsoup/browser.py\n@@ -1,7 +1,8 @@\n+import io\n import os\n import tempfile\n import urllib\n import weakref\n import webbrowser\n \n import bs4\n@@ -227,15 +228,21 @@ class Browser:\n                     value = tag.get(\"value\", \"\")\n \n                 # If the enctype is not multipart, the filename is put in\n                 # the form as a text input and the file is not sent.\n                 if tag.get(\"type\", \"\").lower() == \"file\" and multipart:\n                     filepath = value\n                     if filepath != \"\" and isinstance(filepath, str):\n-                        content = open(filepath, \"rb\")\n+                        content = getattr(tag, \"_mechanicalsoup_file\", None)\n+                        if content is False:\n+                            raise ValueError(\n+                                \"\"\"From v1.3.0 onwards, you must pass an open file object directly, for example using `form.set_input({\"name\": open(\"/path/to/filename\", \"rb\")})`. This change is to mitigate a security vulnerability where a malicious web server could read arbitrary files from the client.\"\"\"\n+                            )\n+                        elif not isinstance(content, io.IOBase):\n+                            content = \"\"\n                     else:\n                         content = \"\"\n                     filename = os.path.basename(filepath)\n                     # If value is the empty string, we still pass it\n                     # for consistency with browsers (see\n                     # https://github.com/MechanicalSoup/MechanicalSoup/issues/250).\n                     files[name] = (filename, content)\ndiff --git a/mechanicalsoup/form.py b/mechanicalsoup/form.py\nindex a67195c..82f6015 100644\n--- a/mechanicalsoup/form.py\n+++ b/mechanicalsoup/form.py\n@@ -1,8 +1,9 @@\n import copy\n+import io\n import warnings\n \n from bs4 import BeautifulSoup\n \n from .utils import LinkNotFoundError\n \n \n@@ -64,15 +65,24 @@ class Form:\n         give it the value ``password``.\n         \"\"\"\n \n         for (name, value) in data.items():\n             i = self.form.find(\"input\", {\"name\": name})\n             if not i:\n                 raise InvalidFormMethod(\"No input field named \" + name)\n-            i[\"value\"] = value\n+\n+            if isinstance(value, io.IOBase):\n+                # Store the actual file object for &lt;input type=\"file\"&gt;\n+                i._mechanicalsoup_file = value\n+                i[\"value\"] = value.name\n+            else:\n+                # We set `_mechanicalsoup_file` to `False` so that we can\n+                # check for deprecated use of the API.\n+                i._mechanicalsoup_file = False\n+                i[\"value\"] = value\n \n     def uncheck_all(self, name):\n         \"\"\"Remove the *checked*-attribute of all input elements with\n         a *name*-attribute given by ``name``.\n         \"\"\"\n         for option in self.form.find_all(\"input\", {\"name\": name}):\n             if \"checked\" in option.attrs:\n@@ -257,20 +267,20 @@ class Form:\n         .. code-block:: python\n \n             form.set(\"login\", username)\n             form.set(\"password\", password)\n             form.set(\"eula-checkbox\", True)\n \n         Example: uploading a file through a ``&lt;input type=\"file\"\n-        name=\"tagname\"&gt;`` field (provide the path to the local file,\n+        name=\"tagname\"&gt;`` field (provide an open file object,\n         and its content will be uploaded):\n \n         .. code-block:: python\n \n-            form.set(\"tagname\", path_to_local_file)\n+            form.set(\"tagname\", open(path_to_local_file, \"rb\"))\n \n         \"\"\"\n         for func in (\"checkbox\", \"radio\", \"input\", \"textarea\", \"select\"):\n             try:\n                 getattr(self, \"set_\" + func)({name: value})\n                 return\n             except InvalidFormMethod:\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>All users of MechanicalSoup's form submission are affected, unless they took very specific (and manual) steps to reset HTML form field values.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/MechanicalSoup/MechanicalSoup/security/advisories/GHSA-x456-3ccm-m6j4\">https://github.com/MechanicalSoup/MechanicalSoup/security/advisories/GHSA-x456-3ccm-m6j4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-34457\">https://nvd.nist.gov/vuln/detail/CVE-2023-34457</a></li>\n<li><a href=\"https://github.com/MechanicalSoup/MechanicalSoup/commit/d57c4a269bba3b9a0c5bfa20292955b849006d9e\">https://github.com/MechanicalSoup/MechanicalSoup/commit/d57c4a269bba3b9a0c5bfa20292955b849006d9e</a></li>\n<li><a href=\"https://github.com/MechanicalSoup/MechanicalSoup/releases/tag/v1.3.0\">https://github.com/MechanicalSoup/MechanicalSoup/releases/tag/v1.3.0</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mechanicalsoup/PYSEC-2023-108.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mechanicalsoup/PYSEC-2023-108.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-x456-3ccm-m6j4\">https://github.com/advisories/GHSA-x456-3ccm-m6j4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-x456-3ccm-m6j4",
            "title": "[MechanicalSoup] MechanicalSoup vulnerable to malicious web server reading arbitrary files on client using file input inside HTML form",
            "date_modified": "2024-10-01T19:29:08.000Z",
            "date_published": "2023-07-05T21:35:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-x456-3ccm-m6j4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>In Mercurial before 4.1.3, \"hg serve --stdio\" allows remote authenticated users to launch the Python debugger, and consequently execute arbitrary code, by using --debugger as a repository name.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2017-9462\">https://nvd.nist.gov/vuln/detail/CVE-2017-9462</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2017:1576\">https://access.redhat.com/errata/RHSA-2017:1576</a></li>\n<li><a href=\"https://bugs.debian.org/861243\">https://bugs.debian.org/861243</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-ghjx-3jg5-h6r2\">https://github.com/advisories/GHSA-ghjx-3jg5-h6r2</a></li>\n<li><a href=\"https://lists.debian.org/debian-lts-announce/2018/07/msg00005.html\">https://lists.debian.org/debian-lts-announce/2018/07/msg00005.html</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/201709-18\">https://security.gentoo.org/glsa/201709-18</a></li>\n<li><a href=\"https://www.mercurial-scm.org/repo/hg/rev/77eaf9539499\">https://www.mercurial-scm.org/repo/hg/rev/77eaf9539499</a></li>\n<li><a href=\"https://www.mercurial-scm.org/wiki/WhatsNew#Mercurial_4.1.3_.282017-4-18.29\">https://www.mercurial-scm.org/wiki/WhatsNew#Mercurial_4.1.3_.282017-4-18.29</a></li>\n<li><a href=\"http://www.debian.org/security/2017/dsa-3963\">http://www.debian.org/security/2017/dsa-3963</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mercurial/PYSEC-2017-91.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mercurial/PYSEC-2017-91.yaml</a></li>\n<li><a href=\"https://web.archive.org/web/20200227162318/http://www.securityfocus.com/bid/99123\">https://web.archive.org/web/20200227162318/http://www.securityfocus.com/bid/99123</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-ghjx-3jg5-h6r2",
            "title": "[mercurial] Mercurial has Incorrect Permission Assignment for Critical Resource",
            "date_modified": "2024-10-01T19:23:43.000Z",
            "date_published": "2018-07-13T15:17:10.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-ghjx-3jg5-h6r2"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A vulnerability classified as problematic was found in Langflow up to 1.0.18. Affected by this vulnerability is an unknown functionality of the file \\src\\backend\\base\\langflow\\interface\\utils.py of the component HTTP POST Request Handler. The manipulation of the argument remaining_text leads to inefficient regular expression complexity. The exploit has been disclosed to the public and may be used. The vendor was contacted early about this disclosure but did not respond in any way.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-9277\">https://nvd.nist.gov/vuln/detail/CVE-2024-9277</a></li>\n<li><a href=\"https://rumbling-slice-eb0.notion.site/Remote-Redos-in-https-github-com-langflow-ai-langflow-067159ced0d5494e91b06071384969c4?pvs=4\">https://rumbling-slice-eb0.notion.site/Remote-Redos-in-https-github-com-langflow-ai-langflow-067159ced0d5494e91b06071384969c4?pvs=4</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.278659\">https://vuldb.com/?ctiid.278659</a></li>\n<li><a href=\"https://vuldb.com/?id.278659\">https://vuldb.com/?id.278659</a></li>\n<li><a href=\"https://vuldb.com/?submit.410043\">https://vuldb.com/?submit.410043</a></li>\n<li><a href=\"https://github.com/langflow-ai/langflow/blob/main/src/backend/base/langflow/interface/utils.py#L65\">https://github.com/langflow-ai/langflow/blob/main/src/backend/base/langflow/interface/utils.py#L65</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-355v-2rjx-fpx7\">https://github.com/advisories/GHSA-355v-2rjx-fpx7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-355v-2rjx-fpx7",
            "title": "[langflow] Inefficient Regular Expression Complexity in langflow",
            "date_modified": "2024-10-01T18:32:42.000Z",
            "date_published": "2024-09-27T12:31:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-355v-2rjx-fpx7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cross-site Scripting (XSS) - Stored in GitHub repository modoboa/modoboa prior to 2.0.4.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-0470\">https://nvd.nist.gov/vuln/detail/CVE-2023-0470</a></li>\n<li><a href=\"https://github.com/modoboa/modoboa/commit/354ab6884019009249097a7f3a1881d81ecd2fd2\">https://github.com/modoboa/modoboa/commit/354ab6884019009249097a7f3a1881d81ecd2fd2</a></li>\n<li><a href=\"https://huntr.dev/bounties/baae3180-b63b-4880-b2af-1a3f30056c2b\">https://huntr.dev/bounties/baae3180-b63b-4880-b2af-1a3f30056c2b</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/modoboa/PYSEC-2023-30.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/modoboa/PYSEC-2023-30.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c467-5c2g-jp86\">https://github.com/advisories/GHSA-c467-5c2g-jp86</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c467-5c2g-jp86",
            "title": "[modoboa] Cross-site Scripting in modoboa",
            "date_modified": "2024-09-30T20:48:21.000Z",
            "date_published": "2023-01-27T00:30:18.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c467-5c2g-jp86"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Modoboa 2.0.5 and prior allows users to set unsafe passwords, such as <code>1</code> or <code>HACK</code>. This issue is fixed in commit 130257c96a2392ada795785a91178e656e27015c and is part of version 2.1.0.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-2160\">https://nvd.nist.gov/vuln/detail/CVE-2023-2160</a></li>\n<li><a href=\"https://github.com/modoboa/modoboa/commit/130257c96a2392ada795785a91178e656e27015c\">https://github.com/modoboa/modoboa/commit/130257c96a2392ada795785a91178e656e27015c</a></li>\n<li><a href=\"https://huntr.dev/bounties/54fb6d6a-6b39-45b6-b62a-930260ba484b\">https://huntr.dev/bounties/54fb6d6a-6b39-45b6-b62a-930260ba484b</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/modoboa/PYSEC-2023-34.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/modoboa/PYSEC-2023-34.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9gxx-32p7-ff7m\">https://github.com/advisories/GHSA-9gxx-32p7-ff7m</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9gxx-32p7-ff7m",
            "title": "[modoboa] Modoboa has Weak Password Requirements",
            "date_modified": "2024-09-30T20:47:31.000Z",
            "date_published": "2023-04-18T18:30:29.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9gxx-32p7-ff7m"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>\"Push rules\" can specify <a href=\"https://matrix.org/docs/spec/client_server/r0.6.1#conditions\">conditions</a> under which they will match, including <code>event_match</code>, which matches event content against a pattern including wildcards.</p>\n<p>Certain patterns can cause very poor performance in the matching engine, leading to a denial-of-service when processing moderate length events.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is patched by <a href=\"https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c\">https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c</a>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>A potential workaround might be to prevent users from making custom push rules, by blocking such requests at a reverse-proxy.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, email us at <a href=\"mailto:security@matrix.org\">security@matrix.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/matrix-org/synapse/security/advisories/GHSA-x345-32rc-8h85\">https://github.com/matrix-org/synapse/security/advisories/GHSA-x345-32rc-8h85</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c\">https://github.com/matrix-org/synapse/commit/03318a766cac9f8b053db2214d9c332a977d226c</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-29471\">https://nvd.nist.gov/vuln/detail/CVE-2021-29471</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/releases/tag/v1.33.2\">https://github.com/matrix-org/synapse/releases/tag/v1.33.2</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-135.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-135.yaml</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-x345-32rc-8h85\">https://github.com/advisories/GHSA-x345-32rc-8h85</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-x345-32rc-8h85",
            "title": "[matrix-synapse] Denial of service attack via push rule patterns in matrix-synapse",
            "date_modified": "2024-09-30T20:43:41.000Z",
            "date_published": "2021-05-13T20:22:51.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-x345-32rc-8h85"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Sydent can be induced to send HTTP GET requests to internal systems, due to lack of parameter validation or IP address blacklisting.</p>\n<p>It is not possible to exfiltrate data or control request headers, but it might be possible to use the attack to perform an internal port enumeration.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed in 9e57334, 8936925, 3d531ed, 0f00412</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>A potential workaround would be to use a firewall to ensure that Sydent cannot reach internal HTTP resources.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, email us at <a href=\"mailto:security@matrix.org\">security@matrix.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/matrix-org/sydent/security/advisories/GHSA-9jhm-8m8c-c3f4\">https://github.com/matrix-org/sydent/security/advisories/GHSA-9jhm-8m8c-c3f4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-29431\">https://nvd.nist.gov/vuln/detail/CVE-2021-29431</a></li>\n<li><a href=\"https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a\">https://github.com/matrix-org/sydent/commit/0f00412017f25619bc36c264b29ea96808bf310a</a></li>\n<li><a href=\"https://github.com/matrix-org/sydent/commit/3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3\">https://github.com/matrix-org/sydent/commit/3d531ed50d2fd41ac387f36d44d3fb2c62dd22d3</a></li>\n<li><a href=\"https://github.com/matrix-org/sydent/commit/8936925f561b0c352c2fa922d5097d7245aad00a\">https://github.com/matrix-org/sydent/commit/8936925f561b0c352c2fa922d5097d7245aad00a</a></li>\n<li><a href=\"https://github.com/matrix-org/sydent/commit/9e573348d81df8191bbe8c266c01999c9d57cd5f\">https://github.com/matrix-org/sydent/commit/9e573348d81df8191bbe8c266c01999c9d57cd5f</a></li>\n<li><a href=\"https://github.com/matrix-org/sydent/releases/tag/v2.3.0\">https://github.com/matrix-org/sydent/releases/tag/v2.3.0</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2021-22.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/matrix-sydent/PYSEC-2021-22.yaml</a></li>\n<li><a href=\"https://pypi.org/project/matrix-sydent\">https://pypi.org/project/matrix-sydent</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9jhm-8m8c-c3f4\">https://github.com/advisories/GHSA-9jhm-8m8c-c3f4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9jhm-8m8c-c3f4",
            "title": "[matrix-sydent] SSRF in Sydent due to missing validation of hostnames",
            "date_modified": "2024-09-30T20:40:51.000Z",
            "date_published": "2021-04-19T14:54:15.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9jhm-8m8c-c3f4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Missing input validation of some parameters on the groups (also known as communities) endpoints could cause excessive use of disk space and memory leading to resource exhaustion. Additionally clients may have issues rendering large fields.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This issue is fixed by #9321 and #9393.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The groups feature can be disabled (by setting <code>enable_group_creation</code> to <code>False</code>) to mitigate this issue. Note that it is disabled by default.</p>\n<h3 id=\"other-information\">Other information</h3>\n<p>Note that the groups feature is not part of the <a href=\"https://matrix.org/docs/spec/\">Matrix specification</a> and the chosen maximum lengths are arbitrary. Not all clients might abide by them.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/matrix-org/synapse/security/advisories/GHSA-jrh7-mhhx-6h88\">https://github.com/matrix-org/synapse/security/advisories/GHSA-jrh7-mhhx-6h88</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21393\">https://nvd.nist.gov/vuln/detail/CVE-2021-21393</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/pull/9321\">https://github.com/matrix-org/synapse/pull/9321</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/pull/9393\">https://github.com/matrix-org/synapse/pull/9393</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/commit/3f58fc848d0002de4605bed91603a1f9f245d128\">https://github.com/matrix-org/synapse/commit/3f58fc848d0002de4605bed91603a1f9f245d128</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/commit/d2f0ec12d5c8f113095408888e87e191ac546499\">https://github.com/matrix-org/synapse/commit/d2f0ec12d5c8f113095408888e87e191ac546499</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-26.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-26.yaml</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY</a></li>\n<li><a href=\"https://pypi.org/project/matrix-synapse\">https://pypi.org/project/matrix-synapse</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jrh7-mhhx-6h88\">https://github.com/advisories/GHSA-jrh7-mhhx-6h88</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jrh7-mhhx-6h88",
            "title": "[matrix-synapse] Denial of service (via resource exhaustion) due to improper input validation on groups/communities endpoints",
            "date_modified": "2024-09-30T20:39:16.000Z",
            "date_published": "2021-04-13T15:12:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jrh7-mhhx-6h88"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The notification emails sent for notifications for missed messages or for an expiring account are subject to HTML injection. In the case of the notification for missed messages, this could allow an attacker to insert forged content into the email.</p>\n<p>The account expiry feature is not enabled by default and the HTML injection is not controllable by an attacker.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This issue is fixed in #9200.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>For the missed messages notifications:</p>\n<p>The <code>notif.html</code>, <code>notif_mail.html</code>, and <code>room.html</code> templates can be overridden with custom templates that manually escapes the variables using <a href=\"https://jinja.palletsprojects.com/en/2.11.x/templates/#escape\">JInja2's <code>escape</code> filter</a>. See the <code>email.template_dir</code> setting.</p>\n<p>For the account expiry notifications:</p>\n<ol>\n<li><p>Account expiry can be disabled via the <code>account_validity.enabled</code> setting.</p>\n</li>\n<li><p>The <code>notice_expiry.html</code> template can be overridden with a custom template that manually escapes the variables using <a href=\"https://jinja.palletsprojects.com/en/2.11.x/templates/#escape\">JInja2's <code>escape</code> filter</a>. See the <code>email.template_dir</code> setting.</p>\n</li>\n</ol>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm\">https://github.com/matrix-org/synapse/security/advisories/GHSA-c5f8-35qr-q4fm</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/pull/9200\">https://github.com/matrix-org/synapse/pull/9200</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df\">https://github.com/matrix-org/synapse/commit/e54746bdf7d5c831eabe4dcea76a7626f1de73df</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/releases/tag/v1.27.0\">https://github.com/matrix-org/synapse/releases/tag/v1.27.0</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21333\">https://nvd.nist.gov/vuln/detail/CVE-2021-21333</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-134.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2021-134.yaml</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/TNNAJOZNMVMXM6AS7RFFKB4QLUJ4IFEY</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c5f8-35qr-q4fm\">https://github.com/advisories/GHSA-c5f8-35qr-q4fm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c5f8-35qr-q4fm",
            "title": "[matrix-synapse] HTML injection in email and account expiry notifications",
            "date_modified": "2024-09-30T20:35:36.000Z",
            "date_published": "2021-03-26T19:53:04.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c5f8-35qr-q4fm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A discovered oEmbed or image URL can bypass the <code>url_preview_url_blacklist</code> setting potentially allowing server side request forgery or bypassing network policies. Impact is limited to IP addresses allowed by the <code>url_preview_ip_range_blacklist</code> setting (by default this only allows public IPs) and by the limited information returned to the client:</p>\n<ul>\n<li>For discovered oEmbed URLs, any non-JSON response or a JSON response which includes non-oEmbed information is discarded.</li>\n<li>For discovered image URLs, any non-image response is discarded.</li>\n</ul>\n<p>Systems which have URL preview disabled (via the <code>url_preview_enabled</code> setting) or have not configured a <code>url_preview_url_blacklist</code> are not affected.</p>\n<p>Because of the uncommon configuration required, the limited information a malicious user, and the amount of guesses/time the attack would need; the severity is rated as low.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue is fixed by #15601.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The default configuration of the <code>url_preview_ip_range_blacklist</code> should protect against requests being made to internal infrastructure, URL previews of public URLs is expected.</p>\n<p>Alternately URL previews could be disabled using the <code>url_preview_enabled</code> setting.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/matrix-org/synapse/security/advisories/GHSA-98px-6486-j7qc\">https://github.com/matrix-org/synapse/security/advisories/GHSA-98px-6486-j7qc</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/pull/15601\">https://github.com/matrix-org/synapse/pull/15601</a></li>\n<li><a href=\"https://github.com/matrix-org/synapse/releases/tag/v1.85.0\">https://github.com/matrix-org/synapse/releases/tag/v1.85.0</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-32683\">https://nvd.nist.gov/vuln/detail/CVE-2023-32683</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-85.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/matrix-synapse/PYSEC-2023-85.yaml</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/X6DH5A5YEB5LRIPP32OUW25FCGZFCZU2\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/X6DH5A5YEB5LRIPP32OUW25FCGZFCZU2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-98px-6486-j7qc\">https://github.com/advisories/GHSA-98px-6486-j7qc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-98px-6486-j7qc",
            "title": "[matrix-synapse] Synapse has URL deny list bypass via oEmbed and image URLs when generating previews",
            "date_modified": "2024-09-30T20:34:44.000Z",
            "date_published": "2023-06-06T16:41:34.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-98px-6486-j7qc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue was discovered in Mayan EDMS before 3.0.2. The Appearance app sets window.location directly, leading to XSS.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-16405\">https://nvd.nist.gov/vuln/detail/CVE-2018-16405</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fpcv-j2q9-vqhw\">https://github.com/advisories/GHSA-fpcv-j2q9-vqhw</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/blob/master/HISTORY.rst\">https://gitlab.com/mayan-edms/mayan-edms/blob/master/HISTORY.rst</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e\">https://gitlab.com/mayan-edms/mayan-edms/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/issues/494\">https://gitlab.com/mayan-edms/mayan-edms/issues/494</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms-ng/PYSEC-2018-16.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms-ng/PYSEC-2018-16.yaml</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms/PYSEC-2018-106.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms/PYSEC-2018-106.yaml</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fpcv-j2q9-vqhw",
            "title": "[mayan-edms-ng] mayan-edms Cross-site Scripting vulnerability",
            "date_modified": "2024-09-30T20:33:36.000Z",
            "date_published": "2018-09-06T03:24:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fpcv-j2q9-vqhw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue was discovered in Mayan EDMS before 3.0.2. The Appearance app sets window.location directly, leading to XSS.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-16405\">https://nvd.nist.gov/vuln/detail/CVE-2018-16405</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fpcv-j2q9-vqhw\">https://github.com/advisories/GHSA-fpcv-j2q9-vqhw</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/blob/master/HISTORY.rst\">https://gitlab.com/mayan-edms/mayan-edms/blob/master/HISTORY.rst</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e\">https://gitlab.com/mayan-edms/mayan-edms/commit/9ebe80595afe4fdd1e2c74358d6a9421f4ce130e</a></li>\n<li><a href=\"https://gitlab.com/mayan-edms/mayan-edms/issues/494\">https://gitlab.com/mayan-edms/mayan-edms/issues/494</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms-ng/PYSEC-2018-16.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms-ng/PYSEC-2018-16.yaml</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms/PYSEC-2018-106.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/mayan-edms/PYSEC-2018-106.yaml</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fpcv-j2q9-vqhw",
            "title": "[mayan-edms] mayan-edms Cross-site Scripting vulnerability",
            "date_modified": "2024-09-30T20:33:36.000Z",
            "date_published": "2018-09-06T03:24:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fpcv-j2q9-vqhw"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}