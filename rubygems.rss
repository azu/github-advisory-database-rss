<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/rubygems.rss</id>
    <title>Security Advisory for Ruby gems hosted at RubyGems.org</title>
    <updated>2024-02-20T10:01:23.460Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Arubygems"/>
    <subtitle>Security Advisory for Ruby gems hosted at RubyGems.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[rails] rails vulnerable to improper authentication]]></title>
        <id>https://github.com/advisories/GHSA-rxq3-gm4p-5fj4</id>
        <link href="https://github.com/advisories/GHSA-rxq3-gm4p-5fj4"/>
        <updated>2024-02-13T19:37:19.000Z</updated>
        <content type="html"><![CDATA[<p>The example code for the digest authentication functionality (http_authentication.rb) in Ruby on Rails before 2.3.3 defines an authenticate_or_request_with_http_digest block that returns nil instead of false when the user does not exist, which allows context-dependent attackers to bypass authentication for applications that are derived from this example by sending an invalid username without a password.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2009-2422">https://nvd.nist.gov/vuln/detail/CVE-2009-2422</a></li>
<li><a href="https://exchange.xforce.ibmcloud.com/vulnerabilities/51528">https://exchange.xforce.ibmcloud.com/vulnerabilities/51528</a></li>
<li><a href="http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html">http://lists.apple.com/archives/security-announce/2010//Mar/msg00001.html</a></li>
<li><a href="http://n8.tumblr.com/post/117477059/security-hole-found-in-rails-2-3s">http://n8.tumblr.com/post/117477059/security-hole-found-in-rails-2-3s</a></li>
<li><a href="http://support.apple.com/kb/HT4077">http://support.apple.com/kb/HT4077</a></li>
<li><a href="http://weblog.rubyonrails.org/2009/6/3/security-problem-with-authenticate_with_http_digest">http://weblog.rubyonrails.org/2009/6/3/security-problem-with-authenticate_with_http_digest</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails/CVE-2009-2422.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rails/CVE-2009-2422.yml</a></li>
<li><a href="https://web.archive.org/web/20090711160153/http://secunia.com/advisories/35702">https://web.archive.org/web/20090711160153/http://secunia.com/advisories/35702</a></li>
<li><a href="https://web.archive.org/web/20200229192617/http://www.securityfocus.com/bid/35579">https://web.archive.org/web/20200229192617/http://www.securityfocus.com/bid/35579</a></li>
<li><a href="https://github.com/advisories/GHSA-rxq3-gm4p-5fj4">https://github.com/advisories/GHSA-rxq3-gm4p-5fj4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rxq3-gm4p-5fj4</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2017-10-24T18:33:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sidekiq-unique-jobs] sidekiq-unique-jobs UI server vulnerable to XSS & RCE in Redis]]></title>
        <id>https://github.com/advisories/GHSA-cmh9-rx85-xj38</id>
        <link href="https://github.com/advisories/GHSA-cmh9-rx85-xj38"/>
        <updated>2024-02-15T06:32:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Cross site scripting (XSS) potentially exposing cookies / sessions / localStorage, fixed by <code>sidekiq-unique-jobs</code> v8.0.7.</p>
<p>Specifically, this is a Reflected (Server-Side), Non-Self, Cross Site Scripting vulnerability, considered a <strong><em>P3</em></strong> on the BugCrowd <a href="https://bugcrowd.com/vulnerability-rating-taxonomy">taxonomy</a> with the following categorization:
Cross-Site Scripting (XSS) &gt; Reflected &gt; Non-Self</p>
<p>It was initially thought there was a second vulnerability (RCE), but it was a false alarm.  Injection is impossible with Redis:</p>
<blockquote>
<p>String escaping and NoSQL injection
The Redis protocol has no concept of string escaping, so injection is impossible under normal circumstances using a normal client library. The protocol uses prefixed-length strings and is completely binary safe.</p>
</blockquote>
<p>Ref: <a href="https://redis.io/docs/management/security/">https://redis.io/docs/management/security/</a></p>
<p><strong>XSS Vulnerability</strong></p>
<p>Specially crafted <code>GET</code> request parameters handled by any of the following endpoints of <code>sidekiq-unique-jobs</code>' "admin" web UI, allow a super-user attacker, or an unwitting, but authorized, victim, who has received a disguised / crafted link, to successfully execute malicious code, which could potentially steal cookies, session data, or local storage data from the app the <code>sidekiq-unique-jobs</code> web UI is mounted in.</p>
<ol>
<li><code>/changelogs</code></li>
<li><code>/locks</code></li>
<li><code>/expiring_locks</code></li>
</ol>
<p>This means if your <code>sidekiq-unique-jobs</code> web UI is mounted at <code>/sidekiq</code>, the vulnerable paths are:</p>
<ol>
<li><code>/sidekiq/changelogs</code></li>
<li><code>/sidekiq/locks</code></li>
<li><code>/sidekiq/expiring_locks</code></li>
</ol>
<p>XSS vulnerability is an instance of <a href="https://capec.mitre.org/data/definitions/32.html">CAPEC-32: XSS Through HTTP Query Strings</a>, which is related to <a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80</a>. In certain cases where it results in a server error with status 500, it could be considered a vector for uncontrolled resource consumption, given that errors can be much more resource intensive that normal requests, and thus <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a> &amp; <a href="https://cwe.mitre.org/data/definitions/754.html">CWE-754</a> may also be relevant.</p>
<h3 id="details">Details</h3>
<p>Fix for the XSS vulnerability was released in <code>sidekiq-unique-jobs</code> <a href="https://github.com/mhenrixon/sidekiq-unique-jobs/releases/tag/v8.0.7">v8.0.7</a>.</p>
<p>This is an analogous attack vector to that which affected <code>sidekiq</code> gem from version v7.0.4 to v7.0.7, and was given identifiers <a href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35">GHSA-h3r8-h5qw-4r35</a> &amp; <a href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35">CVE-2023-1892</a>.</p>
<p>The vulnerability in <code>sidekiq-unique-jobs</code>' was <em>not</em> fixed by <code>sidekiq</code> <a href="https://github.com/sidekiq/sidekiq/blob/main/Changes.md#708">v7.0.8</a>, nor the more recent <code>sidekiq</code> <a href="https://github.com/sidekiq/sidekiq/blob/main/Changes.md#720">v7.2.0</a> releases; they are similar but unrelated, distinct vulnerabilities in adjacent projects.</p>
<p>Note #1: The admin web UI for <code>sidekiq-unique-jobs</code> is not protected by any authorization constraint in the default configuration. Auth constraints must be configured by the programmer.  It is recommended and expected that users will configure authorization constrains on the "admin" UI.  This is not specifically related to the vulnerability but may make users who fail to constrain their "admin" UI even more vulnerable.</p>
<p>Note #2: Most users of the library will not have configured the UI on a sandboxed subdomain, making all their cookies, localStorage data and session secrets <a href="https://liveoverflow.com/do-not-use-alert-1-in-xss/">vulnerable to exposure</a>.  The purpose of a sandboxed subdomain is expressly to prevent leaking sensitive data through XSS attacks.</p>
<p>XSS Fix PR: <a href="https://github.com/mhenrixon/sidekiq-unique-jobs/pull/829">https://github.com/mhenrixon/sidekiq-unique-jobs/pull/829</a></p>
<h3 id="poc">PoC</h3>
<p><strong>XSS</strong></p>
<p>Use a string like:</p>
<pre><code>%22%3E%3Cimg/src/onerror=alert(document.domain)%3E
</code></pre>
<p>as the value for one of the parameters that are handled without escaping.
Reference: <a href="https://liveoverflow.com/do-not-use-alert-1-in-xss/">https://liveoverflow.com/do-not-use-alert-1-in-xss/</a></p>
<ol>
<li>Visit <a href="http://localhost:3000/sidekiq/changelogs">/sidekiq/changelogs</a> -  with a crafted query string like one of the following:
  a. Screenshot: <img alt="XSS changelogs sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/61788878-96af-4f97-8c11-b4c343b30c89">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code>
  c. <code>count</code> is vulnerable to triggering an application error (status 500), potentially allowing resource exhaustion <code>?count=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code><ol>
<li>Screenshot: <img alt="1c changelogs count" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/4c2cfe41-b8f5-49ef-90eb-4a20841874f9"></li>
</ol>
</li>
<li>Visit <a href="http://localhost:3000/sidekiq/locks">/sidekiq/locks</a> - with a crafted query string like one of the following:
  a. Screenshot: <img alt="XSS locks sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/4a60cf44-8caa-42a3-a812-3ace81c21e0c">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code>
  c. <code>count</code> is vulnerable to triggering an application error (status 500), potentially allowing resource exhaustion <code>?count=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code><ol>
<li>Screenshot: <img alt="2c locks count" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/630d98a6-a3b4-46c8-b7a4-ca8c0e306c13"></li>
</ol>
</li>
<li>Visit <a href="http://localhost:3000/sidekiq/expiring_locks">/sidekiq/expiring_locks</a> - with a crafted query string like one of the following: 
  a. Screenshot: <img alt="XSS expiring_locks sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/7566515e-1edb-4436-8ec4-672c28437534">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code></li>
</ol>
<h3 id="impact">Impact</h3>
<p>This is a vulnerability of critical severity, which impacts many thousands of sites, since <code>sidekiq-unique-jobs</code> is widely deployed across the industry, with multiple attack vectors.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/security/advisories/GHSA-cmh9-rx85-xj38">https://github.com/mhenrixon/sidekiq-unique-jobs/security/advisories/GHSA-cmh9-rx85-xj38</a></li>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/commit/cd09ba6108f98973b6649a6149790c3d4502b4cc">https://github.com/mhenrixon/sidekiq-unique-jobs/commit/cd09ba6108f98973b6649a6149790c3d4502b4cc</a></li>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/commit/ec3afd920c1b55843c72f748a87baac7f8be82ed">https://github.com/mhenrixon/sidekiq-unique-jobs/commit/ec3afd920c1b55843c72f748a87baac7f8be82ed</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-25122">https://nvd.nist.gov/vuln/detail/CVE-2024-25122</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq-unique-jobs/CVE-2024-25122.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq-unique-jobs/CVE-2024-25122.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-cmh9-rx85-xj38">https://github.com/advisories/GHSA-cmh9-rx85-xj38</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cmh9-rx85-xj38</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-02-13T18:34:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sidekiq-unique-jobs] sidekiq-unique-jobs UI server vulnerable to XSS & RCE in Redis]]></title>
        <id>https://github.com/advisories/GHSA-cmh9-rx85-xj38</id>
        <link href="https://github.com/advisories/GHSA-cmh9-rx85-xj38"/>
        <updated>2024-02-15T06:32:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Cross site scripting (XSS) potentially exposing cookies / sessions / localStorage, fixed by <code>sidekiq-unique-jobs</code> v8.0.7.</p>
<p>Specifically, this is a Reflected (Server-Side), Non-Self, Cross Site Scripting vulnerability, considered a <strong><em>P3</em></strong> on the BugCrowd <a href="https://bugcrowd.com/vulnerability-rating-taxonomy">taxonomy</a> with the following categorization:
Cross-Site Scripting (XSS) &gt; Reflected &gt; Non-Self</p>
<p>It was initially thought there was a second vulnerability (RCE), but it was a false alarm.  Injection is impossible with Redis:</p>
<blockquote>
<p>String escaping and NoSQL injection
The Redis protocol has no concept of string escaping, so injection is impossible under normal circumstances using a normal client library. The protocol uses prefixed-length strings and is completely binary safe.</p>
</blockquote>
<p>Ref: <a href="https://redis.io/docs/management/security/">https://redis.io/docs/management/security/</a></p>
<p><strong>XSS Vulnerability</strong></p>
<p>Specially crafted <code>GET</code> request parameters handled by any of the following endpoints of <code>sidekiq-unique-jobs</code>' "admin" web UI, allow a super-user attacker, or an unwitting, but authorized, victim, who has received a disguised / crafted link, to successfully execute malicious code, which could potentially steal cookies, session data, or local storage data from the app the <code>sidekiq-unique-jobs</code> web UI is mounted in.</p>
<ol>
<li><code>/changelogs</code></li>
<li><code>/locks</code></li>
<li><code>/expiring_locks</code></li>
</ol>
<p>This means if your <code>sidekiq-unique-jobs</code> web UI is mounted at <code>/sidekiq</code>, the vulnerable paths are:</p>
<ol>
<li><code>/sidekiq/changelogs</code></li>
<li><code>/sidekiq/locks</code></li>
<li><code>/sidekiq/expiring_locks</code></li>
</ol>
<p>XSS vulnerability is an instance of <a href="https://capec.mitre.org/data/definitions/32.html">CAPEC-32: XSS Through HTTP Query Strings</a>, which is related to <a href="https://cwe.mitre.org/data/definitions/80.html">CWE-80</a>. In certain cases where it results in a server error with status 500, it could be considered a vector for uncontrolled resource consumption, given that errors can be much more resource intensive that normal requests, and thus <a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a> &amp; <a href="https://cwe.mitre.org/data/definitions/754.html">CWE-754</a> may also be relevant.</p>
<h3 id="details">Details</h3>
<p>Fix for the XSS vulnerability was released in <code>sidekiq-unique-jobs</code> <a href="https://github.com/mhenrixon/sidekiq-unique-jobs/releases/tag/v8.0.7">v8.0.7</a>.</p>
<p>This is an analogous attack vector to that which affected <code>sidekiq</code> gem from version v7.0.4 to v7.0.7, and was given identifiers <a href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35">GHSA-h3r8-h5qw-4r35</a> &amp; <a href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35">CVE-2023-1892</a>.</p>
<p>The vulnerability in <code>sidekiq-unique-jobs</code>' was <em>not</em> fixed by <code>sidekiq</code> <a href="https://github.com/sidekiq/sidekiq/blob/main/Changes.md#708">v7.0.8</a>, nor the more recent <code>sidekiq</code> <a href="https://github.com/sidekiq/sidekiq/blob/main/Changes.md#720">v7.2.0</a> releases; they are similar but unrelated, distinct vulnerabilities in adjacent projects.</p>
<p>Note #1: The admin web UI for <code>sidekiq-unique-jobs</code> is not protected by any authorization constraint in the default configuration. Auth constraints must be configured by the programmer.  It is recommended and expected that users will configure authorization constrains on the "admin" UI.  This is not specifically related to the vulnerability but may make users who fail to constrain their "admin" UI even more vulnerable.</p>
<p>Note #2: Most users of the library will not have configured the UI on a sandboxed subdomain, making all their cookies, localStorage data and session secrets <a href="https://liveoverflow.com/do-not-use-alert-1-in-xss/">vulnerable to exposure</a>.  The purpose of a sandboxed subdomain is expressly to prevent leaking sensitive data through XSS attacks.</p>
<p>XSS Fix PR: <a href="https://github.com/mhenrixon/sidekiq-unique-jobs/pull/829">https://github.com/mhenrixon/sidekiq-unique-jobs/pull/829</a></p>
<h3 id="poc">PoC</h3>
<p><strong>XSS</strong></p>
<p>Use a string like:</p>
<pre><code>%22%3E%3Cimg/src/onerror=alert(document.domain)%3E
</code></pre>
<p>as the value for one of the parameters that are handled without escaping.
Reference: <a href="https://liveoverflow.com/do-not-use-alert-1-in-xss/">https://liveoverflow.com/do-not-use-alert-1-in-xss/</a></p>
<ol>
<li>Visit <a href="http://localhost:3000/sidekiq/changelogs">/sidekiq/changelogs</a> -  with a crafted query string like one of the following:
  a. Screenshot: <img alt="XSS changelogs sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/61788878-96af-4f97-8c11-b4c343b30c89">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code>
  c. <code>count</code> is vulnerable to triggering an application error (status 500), potentially allowing resource exhaustion <code>?count=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code><ol>
<li>Screenshot: <img alt="1c changelogs count" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/4c2cfe41-b8f5-49ef-90eb-4a20841874f9"></li>
</ol>
</li>
<li>Visit <a href="http://localhost:3000/sidekiq/locks">/sidekiq/locks</a> - with a crafted query string like one of the following:
  a. Screenshot: <img alt="XSS locks sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/4a60cf44-8caa-42a3-a812-3ace81c21e0c">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code>
  c. <code>count</code> is vulnerable to triggering an application error (status 500), potentially allowing resource exhaustion <code>?count=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code><ol>
<li>Screenshot: <img alt="2c locks count" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/630d98a6-a3b4-46c8-b7a4-ca8c0e306c13"></li>
</ol>
</li>
<li>Visit <a href="http://localhost:3000/sidekiq/expiring_locks">/sidekiq/expiring_locks</a> - with a crafted query string like one of the following: 
  a. Screenshot: <img alt="XSS expiring_locks sidekiq-unique-jobs lte v8 0 6" src="https://github.com/mhenrixon/sidekiq-unique-jobs/assets/19505/7566515e-1edb-4436-8ec4-672c28437534">
  b. <code>filter</code> is XSS vulnerable: <code>?filter=%22%3E%3Cimg/src/onerror=alert(document.domain)%3E</code></li>
</ol>
<h3 id="impact">Impact</h3>
<p>This is a vulnerability of critical severity, which impacts many thousands of sites, since <code>sidekiq-unique-jobs</code> is widely deployed across the industry, with multiple attack vectors.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/security/advisories/GHSA-cmh9-rx85-xj38">https://github.com/mhenrixon/sidekiq-unique-jobs/security/advisories/GHSA-cmh9-rx85-xj38</a></li>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/commit/cd09ba6108f98973b6649a6149790c3d4502b4cc">https://github.com/mhenrixon/sidekiq-unique-jobs/commit/cd09ba6108f98973b6649a6149790c3d4502b4cc</a></li>
<li><a href="https://github.com/mhenrixon/sidekiq-unique-jobs/commit/ec3afd920c1b55843c72f748a87baac7f8be82ed">https://github.com/mhenrixon/sidekiq-unique-jobs/commit/ec3afd920c1b55843c72f748a87baac7f8be82ed</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-25122">https://nvd.nist.gov/vuln/detail/CVE-2024-25122</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq-unique-jobs/CVE-2024-25122.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq-unique-jobs/CVE-2024-25122.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-cmh9-rx85-xj38">https://github.com/advisories/GHSA-cmh9-rx85-xj38</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cmh9-rx85-xj38</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-02-13T18:34:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[grpc] Denial of Service Vulnerability in gRPC TCP Server (Posix-compatible platforms)]]></title>
        <id>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</id>
        <link href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr"/>
        <updated>2024-02-11T05:08:25.000Z</updated>
        <content type="html"><![CDATA[<p>Lack of error handling in the TCP server in Google's gRPC starting version 1.23 on posix-compatible platforms (ex. Linux) allows an attacker to cause a denial of service by initiating a significant number of connections with the server. Note that gRPC C++ Python, and Ruby are affected, but gRPC Java, and Go are NOT affected.&nbsp;</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-4785">https://nvd.nist.gov/vuln/detail/CVE-2023-4785</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33656">https://github.com/grpc/grpc/pull/33656</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33667">https://github.com/grpc/grpc/pull/33667</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33669">https://github.com/grpc/grpc/pull/33669</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33670">https://github.com/grpc/grpc/pull/33670</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33672">https://github.com/grpc/grpc/pull/33672</a></li>
<li><a href="https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U">https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.53.2">https://rubygems.org/gems/grpc/versions/1.53.2</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.54.3">https://rubygems.org/gems/grpc/versions/1.54.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.55.3">https://rubygems.org/gems/grpc/versions/1.55.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.56.2">https://rubygems.org/gems/grpc/versions/1.56.2</a></li>
<li><a href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr">https://github.com/advisories/GHSA-p25m-jpj4-qcrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-09-13T18:31:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[grpc] Denial of Service Vulnerability in gRPC TCP Server (Posix-compatible platforms)]]></title>
        <id>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</id>
        <link href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr"/>
        <updated>2024-02-11T05:08:25.000Z</updated>
        <content type="html"><![CDATA[<p>Lack of error handling in the TCP server in Google's gRPC starting version 1.23 on posix-compatible platforms (ex. Linux) allows an attacker to cause a denial of service by initiating a significant number of connections with the server. Note that gRPC C++ Python, and Ruby are affected, but gRPC Java, and Go are NOT affected.&nbsp;</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-4785">https://nvd.nist.gov/vuln/detail/CVE-2023-4785</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33656">https://github.com/grpc/grpc/pull/33656</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33667">https://github.com/grpc/grpc/pull/33667</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33669">https://github.com/grpc/grpc/pull/33669</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33670">https://github.com/grpc/grpc/pull/33670</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33672">https://github.com/grpc/grpc/pull/33672</a></li>
<li><a href="https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U">https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.53.2">https://rubygems.org/gems/grpc/versions/1.53.2</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.54.3">https://rubygems.org/gems/grpc/versions/1.54.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.55.3">https://rubygems.org/gems/grpc/versions/1.55.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.56.2">https://rubygems.org/gems/grpc/versions/1.56.2</a></li>
<li><a href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr">https://github.com/advisories/GHSA-p25m-jpj4-qcrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-09-13T18:31:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[grpc] Denial of Service Vulnerability in gRPC TCP Server (Posix-compatible platforms)]]></title>
        <id>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</id>
        <link href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr"/>
        <updated>2024-02-11T05:08:25.000Z</updated>
        <content type="html"><![CDATA[<p>Lack of error handling in the TCP server in Google's gRPC starting version 1.23 on posix-compatible platforms (ex. Linux) allows an attacker to cause a denial of service by initiating a significant number of connections with the server. Note that gRPC C++ Python, and Ruby are affected, but gRPC Java, and Go are NOT affected.&nbsp;</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-4785">https://nvd.nist.gov/vuln/detail/CVE-2023-4785</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33656">https://github.com/grpc/grpc/pull/33656</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33667">https://github.com/grpc/grpc/pull/33667</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33669">https://github.com/grpc/grpc/pull/33669</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33670">https://github.com/grpc/grpc/pull/33670</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33672">https://github.com/grpc/grpc/pull/33672</a></li>
<li><a href="https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U">https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.53.2">https://rubygems.org/gems/grpc/versions/1.53.2</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.54.3">https://rubygems.org/gems/grpc/versions/1.54.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.55.3">https://rubygems.org/gems/grpc/versions/1.55.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.56.2">https://rubygems.org/gems/grpc/versions/1.56.2</a></li>
<li><a href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr">https://github.com/advisories/GHSA-p25m-jpj4-qcrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-09-13T18:31:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[grpc] Denial of Service Vulnerability in gRPC TCP Server (Posix-compatible platforms)]]></title>
        <id>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</id>
        <link href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr"/>
        <updated>2024-02-11T05:08:25.000Z</updated>
        <content type="html"><![CDATA[<p>Lack of error handling in the TCP server in Google's gRPC starting version 1.23 on posix-compatible platforms (ex. Linux) allows an attacker to cause a denial of service by initiating a significant number of connections with the server. Note that gRPC C++ Python, and Ruby are affected, but gRPC Java, and Go are NOT affected.&nbsp;</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-4785">https://nvd.nist.gov/vuln/detail/CVE-2023-4785</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33656">https://github.com/grpc/grpc/pull/33656</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33667">https://github.com/grpc/grpc/pull/33667</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33669">https://github.com/grpc/grpc/pull/33669</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33670">https://github.com/grpc/grpc/pull/33670</a></li>
<li><a href="https://github.com/grpc/grpc/pull/33672">https://github.com/grpc/grpc/pull/33672</a></li>
<li><a href="https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U">https://groups.google.com/g/grpc-io/c/LlLkB1CeE4U</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.53.2">https://rubygems.org/gems/grpc/versions/1.53.2</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.54.3">https://rubygems.org/gems/grpc/versions/1.54.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.55.3">https://rubygems.org/gems/grpc/versions/1.55.3</a></li>
<li><a href="https://rubygems.org/gems/grpc/versions/1.56.2">https://rubygems.org/gems/grpc/versions/1.56.2</a></li>
<li><a href="https://github.com/advisories/GHSA-p25m-jpj4-qcrr">https://github.com/advisories/GHSA-p25m-jpj4-qcrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p25m-jpj4-qcrr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-09-13T18:31:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[webrick] WEBrick Denial of Service Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-wfrc-r6c6-7j9r</id>
        <link href="https://github.com/advisories/GHSA-wfrc-r6c6-7j9r"/>
        <updated>2024-02-09T21:52:34.000Z</updated>
        <content type="html"><![CDATA[<p>httputils.rb in WEBrick in Ruby 1.8.1 and 1.8.5, as used in Red Hat Enterprise Linux 4 and 5, allows remote attackers to cause a denial of service (CPU consumption) via a crafted HTTP request.  NOTE: this issue exists because of an incomplete fix for CVE-2008-3656.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2008-4310">https://nvd.nist.gov/vuln/detail/CVE-2008-4310</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=470252">https://bugzilla.redhat.com/show_bug.cgi?id=470252</a></li>
<li><a href="https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10250">https://oval.cisecurity.org/repository/search/definition/oval%3Aorg.mitre.oval%3Adef%3A10250</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2008/12/04/2">http://www.openwall.com/lists/oss-security/2008/12/04/2</a></li>
<li><a href="http://www.redhat.com/support/errata/RHSA-2008-0981.html">http://www.redhat.com/support/errata/RHSA-2008-0981.html</a></li>
<li><a href="https://github.com/ruby/webrick/commit/b2ccd5ff7ddd67a4548299e110dcc5a4728a5534">https://github.com/ruby/webrick/commit/b2ccd5ff7ddd67a4548299e110dcc5a4728a5534</a></li>
<li><a href="https://web.archive.org/web/20111230125610/http://secunia.com/advisories/33013">https://web.archive.org/web/20111230125610/http://secunia.com/advisories/33013</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/webrick/CVE-2008-4310.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/webrick/CVE-2008-4310.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-wfrc-r6c6-7j9r">https://github.com/advisories/GHSA-wfrc-r6c6-7j9r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wfrc-r6c6-7j9r</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-02T00:08:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[chef] Chef Improper Access Control vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-f68m-q26r-64f6</id>
        <link href="https://github.com/advisories/GHSA-f68m-q26r-64f6"/>
        <updated>2024-02-09T21:53:22.000Z</updated>
        <content type="html"><![CDATA[<p><code>chef-server-api/app/controllers/users.rb</code> in the API in Chef before 0.9.0 does not require administrative privileges for the create, destroy, and update methods, which allows remote authenticated users to manage user accounts via requests to the /users URI.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-5142">https://nvd.nist.gov/vuln/detail/CVE-2010-5142</a></li>
<li><a href="https://github.com/opscode/chef/commit/c3bb41f727fbe00e5de719d687757b24c8dcdfc8">https://github.com/opscode/chef/commit/c3bb41f727fbe00e5de719d687757b24c8dcdfc8</a></li>
<li><a href="http://tickets.opscode.com/browse/CHEF-1289">http://tickets.opscode.com/browse/CHEF-1289</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/chef/CVE-2010-5142.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/chef/CVE-2010-5142.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-f68m-q26r-64f6">https://github.com/advisories/GHSA-f68m-q26r-64f6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f68m-q26r-64f6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T05:26:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[puppet] Puppet arbitrary files overwrite via a symlink attack]]></title>
        <id>https://github.com/advisories/GHSA-vrh7-99jh-3fmm</id>
        <link href="https://github.com/advisories/GHSA-vrh7-99jh-3fmm"/>
        <updated>2024-02-07T19:33:37.000Z</updated>
        <content type="html"><![CDATA[<p>Puppet 0.24.x before 0.24.9 and 0.25.x before 0.25.2 allows local users to overwrite arbitrary files via a symlink attack on the (1) /tmp/daemonout, (2) /tmp/puppetdoc.txt, (3) /tmp/puppetdoc.tex, or (4) /tmp/puppetdoc.aux temporary file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-0156">https://nvd.nist.gov/vuln/detail/CVE-2010-0156</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=502881">https://bugzilla.redhat.com/show_bug.cgi?id=502881</a></li>
<li><a href="https://puppet.com/security/cve/cve-2010-0156">https://puppet.com/security/cve/cve-2010-0156</a></li>
<li><a href="http://groups.google.com/group/puppet-announce/browse_thread/thread/4401823f6cbf6087">http://groups.google.com/group/puppet-announce/browse_thread/thread/4401823f6cbf6087</a></li>
<li><a href="http://groups.google.com/group/puppet-announce/browse_thread/thread/73cd1b2896d986c2">http://groups.google.com/group/puppet-announce/browse_thread/thread/73cd1b2896d986c2</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036083.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036083.html</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036166.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036166.html</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2010-06/msg00001.html">http://lists.opensuse.org/opensuse-security-announce/2010-06/msg00001.html</a></li>
<li><a href="https://github.com/puppetlabs/puppet/commit/0aae57f91dc69b22fb674f8de3a13c22edd07128">https://github.com/puppetlabs/puppet/commit/0aae57f91dc69b22fb674f8de3a13c22edd07128</a></li>
<li><a href="https://github.com/puppetlabs/puppet/commit/6111ba80f2c6f6d1541af971f565119e6e03d77d">https://github.com/puppetlabs/puppet/commit/6111ba80f2c6f6d1541af971f565119e6e03d77d</a></li>
<li><a href="https://web.archive.org/web/20100316113904/http://secunia.com/advisories/38766">https://web.archive.org/web/20100316113904/http://secunia.com/advisories/38766</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2010-0156.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2010-0156.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-vrh7-99jh-3fmm">https://github.com/advisories/GHSA-vrh7-99jh-3fmm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vrh7-99jh-3fmm</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-05-02T06:10:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[puppet] Puppet arbitrary files overwrite via a symlink attack]]></title>
        <id>https://github.com/advisories/GHSA-vrh7-99jh-3fmm</id>
        <link href="https://github.com/advisories/GHSA-vrh7-99jh-3fmm"/>
        <updated>2024-02-07T19:33:37.000Z</updated>
        <content type="html"><![CDATA[<p>Puppet 0.24.x before 0.24.9 and 0.25.x before 0.25.2 allows local users to overwrite arbitrary files via a symlink attack on the (1) /tmp/daemonout, (2) /tmp/puppetdoc.txt, (3) /tmp/puppetdoc.tex, or (4) /tmp/puppetdoc.aux temporary file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-0156">https://nvd.nist.gov/vuln/detail/CVE-2010-0156</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=502881">https://bugzilla.redhat.com/show_bug.cgi?id=502881</a></li>
<li><a href="https://puppet.com/security/cve/cve-2010-0156">https://puppet.com/security/cve/cve-2010-0156</a></li>
<li><a href="http://groups.google.com/group/puppet-announce/browse_thread/thread/4401823f6cbf6087">http://groups.google.com/group/puppet-announce/browse_thread/thread/4401823f6cbf6087</a></li>
<li><a href="http://groups.google.com/group/puppet-announce/browse_thread/thread/73cd1b2896d986c2">http://groups.google.com/group/puppet-announce/browse_thread/thread/73cd1b2896d986c2</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036083.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036083.html</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036166.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-March/036166.html</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2010-06/msg00001.html">http://lists.opensuse.org/opensuse-security-announce/2010-06/msg00001.html</a></li>
<li><a href="https://github.com/puppetlabs/puppet/commit/0aae57f91dc69b22fb674f8de3a13c22edd07128">https://github.com/puppetlabs/puppet/commit/0aae57f91dc69b22fb674f8de3a13c22edd07128</a></li>
<li><a href="https://github.com/puppetlabs/puppet/commit/6111ba80f2c6f6d1541af971f565119e6e03d77d">https://github.com/puppetlabs/puppet/commit/6111ba80f2c6f6d1541af971f565119e6e03d77d</a></li>
<li><a href="https://web.archive.org/web/20100316113904/http://secunia.com/advisories/38766">https://web.archive.org/web/20100316113904/http://secunia.com/advisories/38766</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2010-0156.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/puppet/CVE-2010-0156.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-vrh7-99jh-3fmm">https://github.com/advisories/GHSA-vrh7-99jh-3fmm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vrh7-99jh-3fmm</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-05-02T06:10:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nokogiri] Nokogiri update packaged libxml2 to v2.12.5 to resolve CVE-2024-25062]]></title>
        <id>https://github.com/advisories/GHSA-xc9x-jj77-9p9j</id>
        <link href="https://github.com/advisories/GHSA-xc9x-jj77-9p9j"/>
        <updated>2024-02-05T20:22:57.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>Nokogiri v1.16.2 upgrades the version of its dependency libxml2 to <a href="https://gitlab.gnome.org/GNOME/libxml2/-/releases/v2.12.5">v2.12.5</a>.</p>
<p>libxml2 v2.12.5 addresses the following vulnerability:</p>
<ul>
<li>CVE-2024-25062 / <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25062">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-25062</a><ul>
<li>described at <a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/604">https://gitlab.gnome.org/GNOME/libxml2/-/issues/604</a></li>
<li>patched by <a href="https://gitlab.gnome.org/GNOME/libxml2/-/commit/92721970">https://gitlab.gnome.org/GNOME/libxml2/-/commit/92721970</a></li>
</ul>
</li>
</ul>
<p>Please note that this advisory only applies to the CRuby implementation of Nokogiri <code>&lt; 1.16.2</code>, and only if the <em>packaged</em> libraries are being used. If you've overridden defaults at installation time to use <em>system</em> libraries instead of packaged libraries, you should instead pay attention to your distro's <code>libxml2</code> release announcements.</p>
<h2 id="mitigation">Mitigation</h2>
<p>Upgrade to Nokogiri <code>&gt;= 1.16.2</code>.</p>
<p>Users who are unable to upgrade Nokogiri may also choose a more complicated mitigation: compile and link Nokogiri against external libraries libxml2 <code>&gt;= 2.12.5</code> which will also address these same issues.</p>
<h2 id="impact">Impact</h2>
<p>From the CVE description, this issue applies to the <code>xmlTextReader</code> module (which underlies <code>Nokogiri::XML::Reader</code>):</p>
<blockquote>
<p>When using the XML Reader interface with DTD validation and XInclude expansion enabled, processing crafted XML documents can lead to an xmlValidatePopElement use-after-free.</p>
</blockquote>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-02-04 10:35 EST - this GHSA is drafted without complete details about when the upstream issue was introduced; a request is made of libxml2 maintainers for more detailed information</li>
<li>2024-02-04 10:48 EST - updated GHSA to reflect libxml2 maintainers' confirmation of affected versions</li>
<li>2024-02-04 11:54 EST - v1.16.2 published, this GHSA made public</li>
<li>2024-02-05 10:18 EST - updated with MITRE link to the CVE information, and updated "Impact" section</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xc9x-jj77-9p9j">https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-xc9x-jj77-9p9j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-25062">https://nvd.nist.gov/vuln/detail/CVE-2024-25062</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/commit/92721970">https://gitlab.gnome.org/GNOME/libxml2/-/commit/92721970</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/604">https://gitlab.gnome.org/GNOME/libxml2/-/issues/604</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/releases/v2.12.5">https://gitlab.gnome.org/GNOME/libxml2/-/releases/v2.12.5</a></li>
<li><a href="https://github.com/advisories/GHSA-xc9x-jj77-9p9j">https://github.com/advisories/GHSA-xc9x-jj77-9p9j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc9x-jj77-9p9j</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-05T20:22:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] ReDoS based DoS vulnerability in Action Dispatch]]></title>
        <id>https://github.com/advisories/GHSA-p84v-45xj-wwqj</id>
        <link href="https://github.com/advisories/GHSA-p84v-45xj-wwqj"/>
        <updated>2024-02-02T16:50:45.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.</p>
<p>Versions Affected: &gt;= 3.0.0 Not affected: &lt; 3.0.0 Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1
Impact</p>
<p>Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<p><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml</a></li>
<li><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22792">https://nvd.nist.gov/vuln/detail/CVE-2023-22792</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115">https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0007/">https://security.netapp.com/advisory/ntap-20240202-0007/</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://github.com/advisories/GHSA-p84v-45xj-wwqj">https://github.com/advisories/GHSA-p84v-45xj-wwqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p84v-45xj-wwqj</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-01-18T18:23:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] ReDoS based DoS vulnerability in Action Dispatch]]></title>
        <id>https://github.com/advisories/GHSA-p84v-45xj-wwqj</id>
        <link href="https://github.com/advisories/GHSA-p84v-45xj-wwqj"/>
        <updated>2024-02-02T16:50:45.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.</p>
<p>Versions Affected: &gt;= 3.0.0 Not affected: &lt; 3.0.0 Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1
Impact</p>
<p>Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<p><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml</a></li>
<li><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22792">https://nvd.nist.gov/vuln/detail/CVE-2023-22792</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115">https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0007/">https://security.netapp.com/advisory/ntap-20240202-0007/</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://github.com/advisories/GHSA-p84v-45xj-wwqj">https://github.com/advisories/GHSA-p84v-45xj-wwqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p84v-45xj-wwqj</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-01-18T18:23:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] ReDoS based DoS vulnerability in Action Dispatch]]></title>
        <id>https://github.com/advisories/GHSA-p84v-45xj-wwqj</id>
        <link href="https://github.com/advisories/GHSA-p84v-45xj-wwqj"/>
        <updated>2024-02-02T16:50:45.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible regular expression based DoS vulnerability in Action Dispatch. This vulnerability has been assigned the CVE identifier CVE-2023-22792.</p>
<p>Versions Affected: &gt;= 3.0.0 Not affected: &lt; 3.0.0 Fixed Versions: 5.2.8.15 (Rails LTS), 6.1.7.1, 7.0.4.1
Impact</p>
<p>Specially crafted cookies, in combination with a specially crafted X_FORWARDED_HOST header can cause the regular expression engine to enter a state of catastrophic backtracking. This can cause the process to use large amounts of CPU and memory, leading to a possible DoS vulnerability All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>We recommend that all users upgrade to one of the FIXED versions. In the meantime, users can mitigate this vulnerability by using a load balancer or other device to filter out malicious X_FORWARDED_HOST headers before they reach the application.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-1-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 6.1 series
7-0-Use-string-split-instead-of-regex-for-domain-parts.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<p><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2023-22792.yml</a></li>
<li><a href="https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released">https://rubyonrails.org/2023/1/17/Rails-Versions-6-0-6-1-6-1-7-1-7-0-4-1-have-been-released</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22792">https://nvd.nist.gov/vuln/detail/CVE-2023-22792</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115">https://discuss.rubyonrails.org/t/cve-2023-22792-possible-redos-based-dos-vulnerability-in-action-dispatch/82115</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0007/">https://security.netapp.com/advisory/ntap-20240202-0007/</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://github.com/advisories/GHSA-p84v-45xj-wwqj">https://github.com/advisories/GHSA-p84v-45xj-wwqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p84v-45xj-wwqj</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-01-18T18:23:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[activerecord] SQL Injection Vulnerability via ActiveRecord comments]]></title>
        <id>https://github.com/advisories/GHSA-hq7p-j377-6v63</id>
        <link href="https://github.com/advisories/GHSA-hq7p-j377-6v63"/>
        <updated>2024-02-02T16:49:28.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible vulnerability in ActiveRecord related to the sanitization of comments. This vulnerability has been assigned the CVE identifier CVE-2023-22794.</p>
<p>Versions Affected: &gt;= 6.0.0 Not affected: &lt; 6.0.0 Fixed Versions: 6.0.6.1, 6.1.7.1, 7.0.4.1
Impact</p>
<p>Previously the implementation of escaping for comments was insufficient for</p>
<p>If malicious user input is passed to either the annotate query method, the optimizer_hints query method, or through the QueryLogs interface which automatically adds annotations, it may be sent to the database with insufficient sanitization and be able to inject SQL outside of the comment.</p>
<p>In most cases these interfaces wonâ€™t be used with user input and users should avoid doing so.</p>
<p>Example vulnerable code:</p>
<pre><code>Post.where(id: 1).annotate("#{params[:user_input]}")

Post.where(id: 1).optimizer_hints("#{params[:user_input]}")
</code></pre>
<p>Example vulnerable QueryLogs configuration (the default configuration is not vulnerable):</p>
<pre><code>config.active_record.query_log_tags = [
  {
    something: -&gt; { &lt;some value including user input&gt; }
  }
]
</code></pre>
<p>All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>Avoid passing user input to annotate and avoid using QueryLogs configuration which can include user input.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.0 series
6-1-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.1 series
7-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de">https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22794">https://nvd.nist.gov/vuln/detail/CVE-2023-22794</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117">https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0008/">https://security.netapp.com/advisory/ntap-20240202-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-hq7p-j377-6v63">https://github.com/advisories/GHSA-hq7p-j377-6v63</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq7p-j377-6v63</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-18T18:20:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[activerecord] SQL Injection Vulnerability via ActiveRecord comments]]></title>
        <id>https://github.com/advisories/GHSA-hq7p-j377-6v63</id>
        <link href="https://github.com/advisories/GHSA-hq7p-j377-6v63"/>
        <updated>2024-02-02T16:49:28.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible vulnerability in ActiveRecord related to the sanitization of comments. This vulnerability has been assigned the CVE identifier CVE-2023-22794.</p>
<p>Versions Affected: &gt;= 6.0.0 Not affected: &lt; 6.0.0 Fixed Versions: 6.0.6.1, 6.1.7.1, 7.0.4.1
Impact</p>
<p>Previously the implementation of escaping for comments was insufficient for</p>
<p>If malicious user input is passed to either the annotate query method, the optimizer_hints query method, or through the QueryLogs interface which automatically adds annotations, it may be sent to the database with insufficient sanitization and be able to inject SQL outside of the comment.</p>
<p>In most cases these interfaces wonâ€™t be used with user input and users should avoid doing so.</p>
<p>Example vulnerable code:</p>
<pre><code>Post.where(id: 1).annotate("#{params[:user_input]}")

Post.where(id: 1).optimizer_hints("#{params[:user_input]}")
</code></pre>
<p>Example vulnerable QueryLogs configuration (the default configuration is not vulnerable):</p>
<pre><code>config.active_record.query_log_tags = [
  {
    something: -&gt; { &lt;some value including user input&gt; }
  }
]
</code></pre>
<p>All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>Avoid passing user input to annotate and avoid using QueryLogs configuration which can include user input.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.0 series
6-1-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.1 series
7-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de">https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22794">https://nvd.nist.gov/vuln/detail/CVE-2023-22794</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117">https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0008/">https://security.netapp.com/advisory/ntap-20240202-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-hq7p-j377-6v63">https://github.com/advisories/GHSA-hq7p-j377-6v63</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq7p-j377-6v63</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-18T18:20:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[activerecord] SQL Injection Vulnerability via ActiveRecord comments]]></title>
        <id>https://github.com/advisories/GHSA-hq7p-j377-6v63</id>
        <link href="https://github.com/advisories/GHSA-hq7p-j377-6v63"/>
        <updated>2024-02-02T16:49:28.000Z</updated>
        <content type="html"><![CDATA[<p>There is a possible vulnerability in ActiveRecord related to the sanitization of comments. This vulnerability has been assigned the CVE identifier CVE-2023-22794.</p>
<p>Versions Affected: &gt;= 6.0.0 Not affected: &lt; 6.0.0 Fixed Versions: 6.0.6.1, 6.1.7.1, 7.0.4.1
Impact</p>
<p>Previously the implementation of escaping for comments was insufficient for</p>
<p>If malicious user input is passed to either the annotate query method, the optimizer_hints query method, or through the QueryLogs interface which automatically adds annotations, it may be sent to the database with insufficient sanitization and be able to inject SQL outside of the comment.</p>
<p>In most cases these interfaces wonâ€™t be used with user input and users should avoid doing so.</p>
<p>Example vulnerable code:</p>
<pre><code>Post.where(id: 1).annotate("#{params[:user_input]}")

Post.where(id: 1).optimizer_hints("#{params[:user_input]}")
</code></pre>
<p>Example vulnerable QueryLogs configuration (the default configuration is not vulnerable):</p>
<pre><code>config.active_record.query_log_tags = [
  {
    something: -&gt; { &lt;some value including user input&gt; }
  }
]
</code></pre>
<p>All users running an affected release should either upgrade or use one of the workarounds immediately.
Releases</p>
<p>The FIXED releases are available at the normal locations.
Workarounds</p>
<p>Avoid passing user input to annotate and avoid using QueryLogs configuration which can include user input.
Patches</p>
<p>To aid users who arenâ€™t able to upgrade immediately we have provided patches for the two supported release series. They are in git-am format and consist of a single changeset.</p>
<pre><code>6-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.0 series
6-1-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 6.1 series
7-0-Make-sanitize_as_sql_comment-more-strict.patch - Patch for 7.0 series
</code></pre>
<p>Please note that only the 7.0.Z and 6.1.Z series are supported at present, and 6.0.Z for severe vulnerabilities. Users of earlier unsupported releases are advised to upgrade as soon as possible as we cannot guarantee the continued availability of security fixes for unsupported releases.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/releases/tag/v7.0.4.1">https://github.com/rails/rails/releases/tag/v7.0.4.1</a></li>
<li><a href="https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de">https://github.com/rails/rails/commit/d7aba06953f9fa789c411676b941d20df8ef73de</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activerecord/CVE-2023-22794.yml</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22794">https://nvd.nist.gov/vuln/detail/CVE-2023-22794</a></li>
<li><a href="https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117">https://discuss.rubyonrails.org/t/cve-2023-22794-sql-injection-vulnerability-via-activerecord-comments/82117</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0008/">https://security.netapp.com/advisory/ntap-20240202-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-hq7p-j377-6v63">https://github.com/advisories/GHSA-hq7p-j377-6v63</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq7p-j377-6v63</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-18T18:20:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] Open Redirect in ActionPack]]></title>
        <id>https://github.com/advisories/GHSA-2rqw-v265-jf8c</id>
        <link href="https://github.com/advisories/GHSA-2rqw-v265-jf8c"/>
        <updated>2024-02-02T16:47:03.000Z</updated>
        <content type="html"><![CDATA[<h1 id="overview">Overview</h1>
<p>There is a possible open redirect vulnerability in the Host Authorization middleware in Action Pack. This vulnerability has been assigned the CVE identifier CVE-2021-22942.</p>
<p>Versions Affected: &gt;= 6.0.0.
Not affected: &lt; 6.0.0
Fixed Versions: 6.1.4.1, 6.0.4.1</p>
<h1 id="impact">Impact</h1>
<p>Specially crafted â€œX-Forwarded-Hostâ€ headers in combination with certain â€œallowed hostâ€ formats can cause the Host Authorization middleware in Action Pack to redirect users to a malicious website.</p>
<p>Impacted applications will have allowed hosts with a leading dot. For example, configuration files that look like this:</p>
<pre><code class="language-ruby">config.hosts &lt;&lt;  '.EXAMPLE.com'
</code></pre>
<p>When an allowed host contains a leading dot, a specially crafted Host header can be used to redirect to a malicious website.</p>
<p>This vulnerability is similar to CVE-2021-22881, but CVE-2021-22881 did not take in to account domain name case sensitivity.</p>
<h1 id="releases">Releases</h1>
<p>The fixed releases are available at the normal locations.</p>
<h1 id="workarounds">Workarounds</h1>
<p>In the case a patch canâ€™t be applied, the following monkey patch can be used in an initializer:</p>
<pre><code class="language-ruby">module ActionDispatch
  class HostAuthorization
    HOSTNAME = /[a-z0-9.-]+|\[[a-f0-9]*:[a-f0-9.:]+\]/i
    VALID_ORIGIN_HOST = /\A(#{HOSTNAME})(?::\d+)?\z/
    VALID_FORWARDED_HOST = /(?:\A|,[ ]?)(#{HOSTNAME})(?::\d+)?\z/

    private
      def authorized?(request)
        origin_host =
          request.get_header("HTTP_HOST")&amp;.slice(VALID_ORIGIN_HOST, 1) || ""
        forwarded_host =
          request.x_forwarded_host&amp;.slice(VALID_FORWARDED_HOST, 1) || ""
        @permissions.allows?(origin_host) &amp;&amp;
          (forwarded_host.blank? || @permissions.allows?(forwarded_host))
      end
  end
end
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-22942">https://nvd.nist.gov/vuln/detail/CVE-2021-22942</a></li>
<li><a href="https://access.redhat.com/security/cve/cve-2021-22942">https://access.redhat.com/security/cve/cve-2021-22942</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22942.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22942.yml</a></li>
<li><a href="https://groups.google.com/g/rubyonrails-security/c/wB5tRn7h36c">https://groups.google.com/g/rubyonrails-security/c/wB5tRn7h36c</a></li>
<li><a href="https://rubygems.org/gems/actionpack">https://rubygems.org/gems/actionpack</a></li>
<li><a href="https://weblog.rubyonrails.org/2021/8/19/Rails-6-0-4-1-and-6-1-4-1-have-been-released/">https://weblog.rubyonrails.org/2021/8/19/Rails-6-0-4-1-and-6-1-4-1-have-been-released/</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2021/12/14/5">http://www.openwall.com/lists/oss-security/2021/12/14/5</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0005/">https://security.netapp.com/advisory/ntap-20240202-0005/</a></li>
<li><a href="https://github.com/advisories/GHSA-2rqw-v265-jf8c">https://github.com/advisories/GHSA-2rqw-v265-jf8c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2rqw-v265-jf8c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-08-26T20:36:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] Open Redirect in ActionPack]]></title>
        <id>https://github.com/advisories/GHSA-2rqw-v265-jf8c</id>
        <link href="https://github.com/advisories/GHSA-2rqw-v265-jf8c"/>
        <updated>2024-02-02T16:47:03.000Z</updated>
        <content type="html"><![CDATA[<h1 id="overview">Overview</h1>
<p>There is a possible open redirect vulnerability in the Host Authorization middleware in Action Pack. This vulnerability has been assigned the CVE identifier CVE-2021-22942.</p>
<p>Versions Affected: &gt;= 6.0.0.
Not affected: &lt; 6.0.0
Fixed Versions: 6.1.4.1, 6.0.4.1</p>
<h1 id="impact">Impact</h1>
<p>Specially crafted â€œX-Forwarded-Hostâ€ headers in combination with certain â€œallowed hostâ€ formats can cause the Host Authorization middleware in Action Pack to redirect users to a malicious website.</p>
<p>Impacted applications will have allowed hosts with a leading dot. For example, configuration files that look like this:</p>
<pre><code class="language-ruby">config.hosts &lt;&lt;  '.EXAMPLE.com'
</code></pre>
<p>When an allowed host contains a leading dot, a specially crafted Host header can be used to redirect to a malicious website.</p>
<p>This vulnerability is similar to CVE-2021-22881, but CVE-2021-22881 did not take in to account domain name case sensitivity.</p>
<h1 id="releases">Releases</h1>
<p>The fixed releases are available at the normal locations.</p>
<h1 id="workarounds">Workarounds</h1>
<p>In the case a patch canâ€™t be applied, the following monkey patch can be used in an initializer:</p>
<pre><code class="language-ruby">module ActionDispatch
  class HostAuthorization
    HOSTNAME = /[a-z0-9.-]+|\[[a-f0-9]*:[a-f0-9.:]+\]/i
    VALID_ORIGIN_HOST = /\A(#{HOSTNAME})(?::\d+)?\z/
    VALID_FORWARDED_HOST = /(?:\A|,[ ]?)(#{HOSTNAME})(?::\d+)?\z/

    private
      def authorized?(request)
        origin_host =
          request.get_header("HTTP_HOST")&amp;.slice(VALID_ORIGIN_HOST, 1) || ""
        forwarded_host =
          request.x_forwarded_host&amp;.slice(VALID_FORWARDED_HOST, 1) || ""
        @permissions.allows?(origin_host) &amp;&amp;
          (forwarded_host.blank? || @permissions.allows?(forwarded_host))
      end
  end
end
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-22942">https://nvd.nist.gov/vuln/detail/CVE-2021-22942</a></li>
<li><a href="https://access.redhat.com/security/cve/cve-2021-22942">https://access.redhat.com/security/cve/cve-2021-22942</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22942.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2021-22942.yml</a></li>
<li><a href="https://groups.google.com/g/rubyonrails-security/c/wB5tRn7h36c">https://groups.google.com/g/rubyonrails-security/c/wB5tRn7h36c</a></li>
<li><a href="https://rubygems.org/gems/actionpack">https://rubygems.org/gems/actionpack</a></li>
<li><a href="https://weblog.rubyonrails.org/2021/8/19/Rails-6-0-4-1-and-6-1-4-1-have-been-released/">https://weblog.rubyonrails.org/2021/8/19/Rails-6-0-4-1-and-6-1-4-1-have-been-released/</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2021/12/14/5">http://www.openwall.com/lists/oss-security/2021/12/14/5</a></li>
<li><a href="https://www.debian.org/security/2023/dsa-5372">https://www.debian.org/security/2023/dsa-5372</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20240202-0005/">https://security.netapp.com/advisory/ntap-20240202-0005/</a></li>
<li><a href="https://github.com/advisories/GHSA-2rqw-v265-jf8c">https://github.com/advisories/GHSA-2rqw-v265-jf8c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2rqw-v265-jf8c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-08-26T20:36:51.000Z</published>
    </entry>
</feed>