{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Java artifacts hosted at the Maven central repository",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Amaven",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/maven.json",
    "description": "Security Advisory for Java artifacts hosted at the Maven central repository on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>User without the right to view documents can deduce their existence by repeated Livetable queries.</p>\n<h4 id=\"reproduction-steps\">Reproduction steps</h4>\n<ol>\n<li>Restrict \"view\" access to <code>Sandbox.TestPage3</code> by setting an explicit view right for admins</li>\n<li>As a user who is not an admin, open <code>&lt;server&gt;/bin/get/XWiki/LiveTableResults?outputSyntax=plain&amp;classname=&amp;collist=doc.title%2Cdoc.location%2Cdoc.content&amp;doc.title=Sandbo&amp;doc.location=Sandbox.TestPage3&amp;doc.content=dummy&amp;limit=0</code> where <code>&lt;server&gt;</code> is the URL of your XWiki installation.</li>\n</ol>\n<h4 id=\"expect-result\">Expect Result:</h4>\n<p>No results are displayed as the user doesn't have view rights on Sandbox.TestPage3.</p>\n<h5 id=\"actual-result\">Actual Result:</h5>\n<p>The result</p>\n<pre><code class=\"language-json\">{\n  \"reqNo\": null,\n  \"matchingtags\": {},\n  \"tags\": [],\n  \"totalrows\": 1,\n  \"returnedrows\": 0,\n  \"offset\": 1,\n  \"rows\": [\n    {\n      \"doc_viewable\": false,\n      \"doc_fullName\": \"obfuscated\"\n    }\n  ]\n}\n</code></pre>\n<p>is displayed.</p>\n<p>This reveals that a document <code>Sandbox.TestPage3</code> exists (we explicitly searched for this name) which has a title containing <code>\"Sandbo\"</code> and a content containing <code>\"dummy\"</code>. By starting with a single letter and then iteratively extending the match, the full content of the title/content or XObject properties can be discovered. Several tests can be combined in a single request to use binary search to narrow down the actual match from a list of possible characters/words. If the used alphabet is known and smaller than 128 distinct characters, it is possible to discover one character with 7 requests. Alternatively, frequencies of words and word pairs (2-gram frequencies) can be used to first guess whole words and only resort to guessing individual characters if none of the predicted words match, allowing a much faster recovery of the textual content. As it also depends on the content how easy the attack is and how much recovered content would be a \"successful\" attack, it is hard to quantify how many requests are necessary.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been patched in XWiki 14.6RC1, 13.10.8, and 14.4.3, the response is not properly cleaned up of obfuscated entries.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">patch</a> for the document <code>XWiki.LiveTableResultsMacros</code> can be manually applied or a XAR archive of a patched version can be <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/Imports#HImportingXWikipages\">imported</a>, on versions &gt;= 12.10.11, &gt;= 13.9-rc-1, and &gt;= 13.4.4.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19999\">https://jira.xwiki.org/browse/XWIKI-19999</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq",
            "title": "[org.xwiki.platform:xwiki-platform-livetable-ui] Exposure of Sensitive Information to an Unauthorized Actor in org.xwiki.platform:xwiki-platform-livetable-ui",
            "date_modified": "2022-11-21T22:37:49.000Z",
            "date_published": "2022-11-21T22:37:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>User without the right to view documents can deduce their existence by repeated Livetable queries.</p>\n<h4 id=\"reproduction-steps\">Reproduction steps</h4>\n<ol>\n<li>Restrict \"view\" access to <code>Sandbox.TestPage3</code> by setting an explicit view right for admins</li>\n<li>As a user who is not an admin, open <code>&lt;server&gt;/bin/get/XWiki/LiveTableResults?outputSyntax=plain&amp;classname=&amp;collist=doc.title%2Cdoc.location%2Cdoc.content&amp;doc.title=Sandbo&amp;doc.location=Sandbox.TestPage3&amp;doc.content=dummy&amp;limit=0</code> where <code>&lt;server&gt;</code> is the URL of your XWiki installation.</li>\n</ol>\n<h4 id=\"expect-result\">Expect Result:</h4>\n<p>No results are displayed as the user doesn't have view rights on Sandbox.TestPage3.</p>\n<h5 id=\"actual-result\">Actual Result:</h5>\n<p>The result</p>\n<pre><code class=\"language-json\">{\n  \"reqNo\": null,\n  \"matchingtags\": {},\n  \"tags\": [],\n  \"totalrows\": 1,\n  \"returnedrows\": 0,\n  \"offset\": 1,\n  \"rows\": [\n    {\n      \"doc_viewable\": false,\n      \"doc_fullName\": \"obfuscated\"\n    }\n  ]\n}\n</code></pre>\n<p>is displayed.</p>\n<p>This reveals that a document <code>Sandbox.TestPage3</code> exists (we explicitly searched for this name) which has a title containing <code>\"Sandbo\"</code> and a content containing <code>\"dummy\"</code>. By starting with a single letter and then iteratively extending the match, the full content of the title/content or XObject properties can be discovered. Several tests can be combined in a single request to use binary search to narrow down the actual match from a list of possible characters/words. If the used alphabet is known and smaller than 128 distinct characters, it is possible to discover one character with 7 requests. Alternatively, frequencies of words and word pairs (2-gram frequencies) can be used to first guess whole words and only resort to guessing individual characters if none of the predicted words match, allowing a much faster recovery of the textual content. As it also depends on the content how easy the attack is and how much recovered content would be a \"successful\" attack, it is hard to quantify how many requests are necessary.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been patched in XWiki 14.6RC1, 13.10.8, and 14.4.3, the response is not properly cleaned up of obfuscated entries.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">patch</a> for the document <code>XWiki.LiveTableResultsMacros</code> can be manually applied or a XAR archive of a patched version can be <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/Imports#HImportingXWikipages\">imported</a>, on versions &gt;= 12.10.11, &gt;= 13.9-rc-1, and &gt;= 13.4.4.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19999\">https://jira.xwiki.org/browse/XWIKI-19999</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq",
            "title": "[org.xwiki.platform:xwiki-platform-livetable-ui] Exposure of Sensitive Information to an Unauthorized Actor in org.xwiki.platform:xwiki-platform-livetable-ui",
            "date_modified": "2022-11-21T22:37:49.000Z",
            "date_published": "2022-11-21T22:37:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>User without the right to view documents can deduce their existence by repeated Livetable queries.</p>\n<h4 id=\"reproduction-steps\">Reproduction steps</h4>\n<ol>\n<li>Restrict \"view\" access to <code>Sandbox.TestPage3</code> by setting an explicit view right for admins</li>\n<li>As a user who is not an admin, open <code>&lt;server&gt;/bin/get/XWiki/LiveTableResults?outputSyntax=plain&amp;classname=&amp;collist=doc.title%2Cdoc.location%2Cdoc.content&amp;doc.title=Sandbo&amp;doc.location=Sandbox.TestPage3&amp;doc.content=dummy&amp;limit=0</code> where <code>&lt;server&gt;</code> is the URL of your XWiki installation.</li>\n</ol>\n<h4 id=\"expect-result\">Expect Result:</h4>\n<p>No results are displayed as the user doesn't have view rights on Sandbox.TestPage3.</p>\n<h5 id=\"actual-result\">Actual Result:</h5>\n<p>The result</p>\n<pre><code class=\"language-json\">{\n  \"reqNo\": null,\n  \"matchingtags\": {},\n  \"tags\": [],\n  \"totalrows\": 1,\n  \"returnedrows\": 0,\n  \"offset\": 1,\n  \"rows\": [\n    {\n      \"doc_viewable\": false,\n      \"doc_fullName\": \"obfuscated\"\n    }\n  ]\n}\n</code></pre>\n<p>is displayed.</p>\n<p>This reveals that a document <code>Sandbox.TestPage3</code> exists (we explicitly searched for this name) which has a title containing <code>\"Sandbo\"</code> and a content containing <code>\"dummy\"</code>. By starting with a single letter and then iteratively extending the match, the full content of the title/content or XObject properties can be discovered. Several tests can be combined in a single request to use binary search to narrow down the actual match from a list of possible characters/words. If the used alphabet is known and smaller than 128 distinct characters, it is possible to discover one character with 7 requests. Alternatively, frequencies of words and word pairs (2-gram frequencies) can be used to first guess whole words and only resort to guessing individual characters if none of the predicted words match, allowing a much faster recovery of the textual content. As it also depends on the content how easy the attack is and how much recovered content would be a \"successful\" attack, it is hard to quantify how many requests are necessary.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been patched in XWiki 14.6RC1, 13.10.8, and 14.4.3, the response is not properly cleaned up of obfuscated entries.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">patch</a> for the document <code>XWiki.LiveTableResultsMacros</code> can be manually applied or a XAR archive of a patched version can be <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/Imports#HImportingXWikipages\">imported</a>, on versions &gt;= 12.10.11, &gt;= 13.9-rc-1, and &gt;= 13.4.4.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a\">https://github.com/xwiki/xwiki-platform/commit/1450b6e3c69ac7df25e5a2571186d1f43402facd#diff-5a739e5865b1f1ad9d79b724791be51b0095a0170cc078911c940478b13b949a</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19999\">https://jira.xwiki.org/browse/XWIKI-19999</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p2x4-6ghr-6vmq\">https://github.com/advisories/GHSA-p2x4-6ghr-6vmq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq",
            "title": "[org.xwiki.platform:xwiki-platform-livetable-ui] Exposure of Sensitive Information to an Unauthorized Actor in org.xwiki.platform:xwiki-platform-livetable-ui",
            "date_modified": "2022-11-21T22:37:49.000Z",
            "date_published": "2022-11-21T22:37:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p2x4-6ghr-6vmq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with view rights on commonly accessible documents including the menu macro can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation due to improper escaping of the macro content and parameters of the menu macro.</p>\n<p>The issue can be demonstrated by opening <code>&lt;server&gt;/xwiki/bin/view/Main?sheet=CKEditor.HTMLConverter&amp;language=en&amp;sourceSyntax=xwiki%2F2.1&amp;stripHTMLEnvelope=true&amp;fromHTML=false&amp;toHTML=true&amp;text=%7B%7Bmenu%7D%7D%7B%7Bcache+id%3D%22menuMacro%22%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello+from+Groovy%21%22%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%7B%7B%2Fmenu%7D%7D</code> where <code>&lt;server&gt;</code> is the URL of the XWiki installation. If this displays \"Hello from Groovy!\", the installation is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 14.6RC1, 13.10.8 and 14.4.3.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d\">patch</a> for the document <code>Menu.MenuMacro</code> can be manually applied or a XAR archive of a patched version can be <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/Imports#HImportingXWikipages\">imported</a>. The menu macro was basically unchanged since XWiki 11.6 so on XWiki 11.6 or later the <a href=\"https://github.com/xwiki/xwiki-platform/commit/59ccca24a8465a19f40c51d65fcc2c09c1edea16\">patch for version of 13.10.8</a> can most likely be applied, on XWiki version 14.0 and later the versions in XWiki 14.6 and 14.4.3 should be appropriate.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d\">https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19857\">https://jira.xwiki.org/browse/XWIKI-19857</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-6w8h-26xx-cf8q\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-6w8h-26xx-cf8q</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6w8h-26xx-cf8q\">https://github.com/advisories/GHSA-6w8h-26xx-cf8q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6w8h-26xx-cf8q",
            "title": "[org.xwiki.platform:xwiki-platform-menu-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in org.xwiki.platform:xwiki-platform-menu-ui",
            "date_modified": "2022-11-21T22:37:29.000Z",
            "date_published": "2022-11-21T22:37:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6w8h-26xx-cf8q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with view rights on commonly accessible documents including the menu macro can execute arbitrary Groovy, Python or Velocity code in XWiki leading to full access to the XWiki installation due to improper escaping of the macro content and parameters of the menu macro.</p>\n<p>The issue can be demonstrated by opening <code>&lt;server&gt;/xwiki/bin/view/Main?sheet=CKEditor.HTMLConverter&amp;language=en&amp;sourceSyntax=xwiki%2F2.1&amp;stripHTMLEnvelope=true&amp;fromHTML=false&amp;toHTML=true&amp;text=%7B%7Bmenu%7D%7D%7B%7Bcache+id%3D%22menuMacro%22%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello+from+Groovy%21%22%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%7B%7B%2Fmenu%7D%7D</code> where <code>&lt;server&gt;</code> is the URL of the XWiki installation. If this displays \"Hello from Groovy!\", the installation is vulnerable.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 14.6RC1, 13.10.8 and 14.4.3.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d\">patch</a> for the document <code>Menu.MenuMacro</code> can be manually applied or a XAR archive of a patched version can be <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/UserGuide/Features/Imports#HImportingXWikipages\">imported</a>. The menu macro was basically unchanged since XWiki 11.6 so on XWiki 11.6 or later the <a href=\"https://github.com/xwiki/xwiki-platform/commit/59ccca24a8465a19f40c51d65fcc2c09c1edea16\">patch for version of 13.10.8</a> can most likely be applied, on XWiki version 14.0 and later the versions in XWiki 14.6 and 14.4.3 should be appropriate.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d\">https://github.com/xwiki/xwiki-platform/commit/2fc20891e6c6b0ca05ee07e315e7f435e8919f8d</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19857\">https://jira.xwiki.org/browse/XWIKI-19857</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-6w8h-26xx-cf8q\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-6w8h-26xx-cf8q</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6w8h-26xx-cf8q\">https://github.com/advisories/GHSA-6w8h-26xx-cf8q</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6w8h-26xx-cf8q",
            "title": "[org.xwiki.platform:xwiki-platform-menu-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in org.xwiki.platform:xwiki-platform-menu-ui",
            "date_modified": "2022-11-21T22:37:29.000Z",
            "date_published": "2022-11-21T22:37:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6w8h-26xx-cf8q"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>We discovered that when the reset a forgotten password feature of XWiki was used, the password was then stored in plain text in database. This only concerns XWiki 13.1RC1 and next versions.\nNote that it only concerns the reset password feature available from the \"Forgot your password\" link in the login view: the features allowing a user to change their password, or for an admin to change a user password are not impacted.</p>\n<p>This vulnerability is particularly dangerous in combination with other vulnerabilities allowing to perform data leak of personal data from users, such as <a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm</a>. </p>\n<p>Note that this vulnerability only concerns the users of the main wiki: in case of farms, the users registered on subwiki are not impacted thanks to a bug we discovered when investigating this.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in version 14.6RC1, 14.4.3 and 13.10.8.</p>\n<p>The patch involves a migration of the impacted users as well as the history of the page, to ensure no password remains in plain text in the database. This migration also involves to inform the users about the possible disclosure of their passwords: by default, two emails are automatically sent to the impacted users. A first email to inform about the possibility that their password have been leaked, and a second email using the reset password feature to ask them to set a new password. See below for the configuration options to disable the mail sending.</p>\n<p>The first email contains by default the following text (could be translated depending on the wiki language settings):</p>\n<pre><code>Subject: Important security issue\nDear user,\n\ndue to a bug your password was stored in plain text in our wiki. We cannot exclude that your plain text password was exposed in a data leak. Therefore, you might receive a second email to choose a new password. \nPlease contact the administrator in case of problem or for further questions.\n</code></pre>\n<p>It's possible to specify another text by creating a file at the root of the permanent directory named <code>140600000XWIKI19869-mail.txt</code>, this file should have same structure as used above:</p>\n<pre><code>Subject: [your custom subject]\n[your custom mail content]\n</code></pre>\n<p>This mail is sent plain text and cannot contain any variable. \nNote that the second mail for the reset password is using the standard feature, so you can find information about the email templates <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/#HMailTemplates\">there</a>.\nAlso note that if the users doesn't have any registered email address obviously no mail will be sent, so it's the administrators responsibility to find a way to contact the user (through comment on the user profile, or any other channel used for that wiki). The administrator should be particularly careful on the presence of logs such as: </p>\n<pre><code>WARN  WIKI19869DataMigrationListener - Reset email cannot be sent for user [reference = [xwiki:XWiki.Foo]] as no email address is provided\n</code></pre>\n<p>It's also possible for administrators to set some properties for the migration: it's possible to decide if the user password should be reset (default) or if the passwords should be kept but only hashed. Note that in the first option, the users won't be able to login anymore until they set a new password if they were impacted. Note that in both options, mails will be sent to users to inform them and encourage them to change their passwords.</p>\n<p>Two other properties are available to chose the behaviour regarding the mails to be sent: it's possible to chose to only send the first security email, or to only send the reset password email. It's important to note that those emails are sent after the migration during the initialization of the wiki, by reading a file creating by the migration in the permanent directory (the file is named <code>140600000XWIKI19869DataMigration-users.txt</code>): then it's possible for an administrator to chose to not sent any email when the migration is performed (by setting the properties to false), and to send them later in a future restart by then setting back the properties to true before the restart of the wiki. Also note that the file is deleted after the mails are sent. </p>\n<p>The mentioned properties can be found in <code>xwiki.properties</code> in the <code>[Security]</code> section:</p>\n<pre><code>#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioning above.\n#-# This parameter defines if as part of the migration R140600000XWIKI19869 the passwords of impacted user should be\n#-# reset or not. It's advised to keep this value as true, now for some usecases advertised administrators might want\n#-# their users to keep their passwords nevertheless, then enable the configuration and set it to false before the\n#-# migration is executed.\n# security.migration.R140600000XWIKI19869.resetPassword = true\n\n#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioned above.\n#-#\n#-# This parameter defines if reset password emails should be sent as part of the migration R140600000XWIKI19869.\n#-# By default this value is set to true, so emails will be automatically produced. Now it's possible for admin to set\n#-# this option to false: note that in such case a file containing the list of users for whom a reset password email\n#-# should be sent will still be created in the permanent directory (named 140600000XWIKI19869DataMigration-users.txt).\n#-# If this file exists and this property is set back to true after the migration, the file will still be consumed to\n#-# send the emails, so it's possible to perform the migration and send the emails only later if needed.\n# security.migration.R140600000XWIKI19869.sendResetPasswordEmail = true\n\n#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioned above.\n#-#\n#-# This parameter defines if a security email information should be sent as part of the migration R140600000XWIKI19869.\n#-# By default this value is set to true, so emails will be automatically produced. Now it's possible for admin to set\n#-# this option to false: note that in such case a file containing the list of users for whom a reset password email\n#-# should be sent will still be created in the permanent directory (named 140600000XWIKI19869DataMigration-users.txt).\n#-# If this file exists and this property is set back to true after the migration, the file will still be consumed to\n#-# send the emails, so it's possible to perform the migration and send the emails only later if needed.\n# security.migration.R140600000XWIKI19869.sendSecurityEmail = true\n</code></pre>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is actually 2 parts of the vulnerability:</p>\n<ol>\n<li>users who might have use the reset feature should get their password protected. We provide some instructions how to identify and fix those. </li>\n<li>the next usage of the reset password feature shouldn't lead to plain text password: sadly there is no easy workaround for that, except by recompiling <code>xwiki-platform-security-authentication-default</code> with that change: <a href=\"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a#diff-f8a8f8ba80dfc55f044e2e60b521ce379176430ca6921b0f87b79cf682531f79L322\">https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a#diff-f8a8f8ba80dfc55f044e2e60b521ce379176430ca6921b0f87b79cf682531f79L322</a></li>\n</ol>\n<p>It's possible to identify all impacted users and to manually reset their passwords with an Admin account. For identifying the impacted users, a query such as the following is possible:</p>\n<pre><code>{{velocity}}\n## The statement is put on multiple lines for readability of the snippet\n#set ($statement = \"select distinct doc.fullName from Document doc, doc.object(XWiki.XWikiUsers) objUser \nwhere objUser.password not like 'hash:%' and objUser.password &lt;&gt; '' \norder by doc.fullName\")\n$services.query.xwql($statement).execute()\n{{/velocity}}\n</code></pre>\n<p>Once impacted users are identified at least 2 options are possible:</p>\n<ol>\n<li>Set a new password (manually by going to the user profile, or automatically with a groovy script for example)</li>\n<li>rollback to a previous version of the user document: in such case the password will be automatically processed properly</li>\n</ol>\n<p>Be aware that those workarounds won't remove the clear password entry that might remain in database due to history.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>Jira ticket: <a href=\"https://jira.xwiki.org/browse/XWIKI-19869\">https://jira.xwiki.org/browse/XWIKI-19869</a></li>\n<li>Advisory of a data leak vulnerability that increases the criticality of this vulnerability: <a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm</a></li>\n<li>Bug discovered \"protecting\" subwiki from this vulnerability: <a href=\"https://jira.xwiki.org/browse/XWIKI-19945\">https://jira.xwiki.org/browse/XWIKI-19945</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">Jira</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q2hm-2h45-v5g3\">https://github.com/advisories/GHSA-q2hm-2h45-v5g3</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q2hm-2h45-v5g3",
            "title": "[org.xwiki.platform:xwiki-platform-security-authentication-default] Plaintext storage of password after a reset in org.xwiki.platform:xwiki-platform-security-authentication-default",
            "date_modified": "2022-11-21T22:37:14.000Z",
            "date_published": "2022-11-21T22:37:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q2hm-2h45-v5g3"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>We discovered that when the reset a forgotten password feature of XWiki was used, the password was then stored in plain text in database. This only concerns XWiki 13.1RC1 and next versions.\nNote that it only concerns the reset password feature available from the \"Forgot your password\" link in the login view: the features allowing a user to change their password, or for an admin to change a user password are not impacted.</p>\n<p>This vulnerability is particularly dangerous in combination with other vulnerabilities allowing to perform data leak of personal data from users, such as <a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm</a>. </p>\n<p>Note that this vulnerability only concerns the users of the main wiki: in case of farms, the users registered on subwiki are not impacted thanks to a bug we discovered when investigating this.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in version 14.6RC1, 14.4.3 and 13.10.8.</p>\n<p>The patch involves a migration of the impacted users as well as the history of the page, to ensure no password remains in plain text in the database. This migration also involves to inform the users about the possible disclosure of their passwords: by default, two emails are automatically sent to the impacted users. A first email to inform about the possibility that their password have been leaked, and a second email using the reset password feature to ask them to set a new password. See below for the configuration options to disable the mail sending.</p>\n<p>The first email contains by default the following text (could be translated depending on the wiki language settings):</p>\n<pre><code>Subject: Important security issue\nDear user,\n\ndue to a bug your password was stored in plain text in our wiki. We cannot exclude that your plain text password was exposed in a data leak. Therefore, you might receive a second email to choose a new password. \nPlease contact the administrator in case of problem or for further questions.\n</code></pre>\n<p>It's possible to specify another text by creating a file at the root of the permanent directory named <code>140600000XWIKI19869-mail.txt</code>, this file should have same structure as used above:</p>\n<pre><code>Subject: [your custom subject]\n[your custom mail content]\n</code></pre>\n<p>This mail is sent plain text and cannot contain any variable. \nNote that the second mail for the reset password is using the standard feature, so you can find information about the email templates <a href=\"https://www.xwiki.org/xwiki/bin/view/Documentation/AdminGuide/Authentication/#HMailTemplates\">there</a>.\nAlso note that if the users doesn't have any registered email address obviously no mail will be sent, so it's the administrators responsibility to find a way to contact the user (through comment on the user profile, or any other channel used for that wiki). The administrator should be particularly careful on the presence of logs such as: </p>\n<pre><code>WARN  WIKI19869DataMigrationListener - Reset email cannot be sent for user [reference = [xwiki:XWiki.Foo]] as no email address is provided\n</code></pre>\n<p>It's also possible for administrators to set some properties for the migration: it's possible to decide if the user password should be reset (default) or if the passwords should be kept but only hashed. Note that in the first option, the users won't be able to login anymore until they set a new password if they were impacted. Note that in both options, mails will be sent to users to inform them and encourage them to change their passwords.</p>\n<p>Two other properties are available to chose the behaviour regarding the mails to be sent: it's possible to chose to only send the first security email, or to only send the reset password email. It's important to note that those emails are sent after the migration during the initialization of the wiki, by reading a file creating by the migration in the permanent directory (the file is named <code>140600000XWIKI19869DataMigration-users.txt</code>): then it's possible for an administrator to chose to not sent any email when the migration is performed (by setting the properties to false), and to send them later in a future restart by then setting back the properties to true before the restart of the wiki. Also note that the file is deleted after the mails are sent. </p>\n<p>The mentioned properties can be found in <code>xwiki.properties</code> in the <code>[Security]</code> section:</p>\n<pre><code>#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioning above.\n#-# This parameter defines if as part of the migration R140600000XWIKI19869 the passwords of impacted user should be\n#-# reset or not. It's advised to keep this value as true, now for some usecases advertised administrators might want\n#-# their users to keep their passwords nevertheless, then enable the configuration and set it to false before the\n#-# migration is executed.\n# security.migration.R140600000XWIKI19869.resetPassword = true\n\n#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioned above.\n#-#\n#-# This parameter defines if reset password emails should be sent as part of the migration R140600000XWIKI19869.\n#-# By default this value is set to true, so emails will be automatically produced. Now it's possible for admin to set\n#-# this option to false: note that in such case a file containing the list of users for whom a reset password email\n#-# should be sent will still be created in the permanent directory (named 140600000XWIKI19869DataMigration-users.txt).\n#-# If this file exists and this property is set back to true after the migration, the file will still be consumed to\n#-# send the emails, so it's possible to perform the migration and send the emails only later if needed.\n# security.migration.R140600000XWIKI19869.sendResetPasswordEmail = true\n\n#-# [Since 14.6RC1]\n#-# [Since 14.4.3]\n#-# [Since 13.10.8]\n#-# This option is only used when performing a migration from a wiki before the versions mentioned above.\n#-#\n#-# This parameter defines if a security email information should be sent as part of the migration R140600000XWIKI19869.\n#-# By default this value is set to true, so emails will be automatically produced. Now it's possible for admin to set\n#-# this option to false: note that in such case a file containing the list of users for whom a reset password email\n#-# should be sent will still be created in the permanent directory (named 140600000XWIKI19869DataMigration-users.txt).\n#-# If this file exists and this property is set back to true after the migration, the file will still be consumed to\n#-# send the emails, so it's possible to perform the migration and send the emails only later if needed.\n# security.migration.R140600000XWIKI19869.sendSecurityEmail = true\n</code></pre>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is actually 2 parts of the vulnerability:</p>\n<ol>\n<li>users who might have use the reset feature should get their password protected. We provide some instructions how to identify and fix those. </li>\n<li>the next usage of the reset password feature shouldn't lead to plain text password: sadly there is no easy workaround for that, except by recompiling <code>xwiki-platform-security-authentication-default</code> with that change: <a href=\"https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a#diff-f8a8f8ba80dfc55f044e2e60b521ce379176430ca6921b0f87b79cf682531f79L322\">https://github.com/xwiki/xwiki-platform/commit/443e8398b75a1295067d74afb5898370782d863a#diff-f8a8f8ba80dfc55f044e2e60b521ce379176430ca6921b0f87b79cf682531f79L322</a></li>\n</ol>\n<p>It's possible to identify all impacted users and to manually reset their passwords with an Admin account. For identifying the impacted users, a query such as the following is possible:</p>\n<pre><code>{{velocity}}\n## The statement is put on multiple lines for readability of the snippet\n#set ($statement = \"select distinct doc.fullName from Document doc, doc.object(XWiki.XWikiUsers) objUser \nwhere objUser.password not like 'hash:%' and objUser.password &lt;&gt; '' \norder by doc.fullName\")\n$services.query.xwql($statement).execute()\n{{/velocity}}\n</code></pre>\n<p>Once impacted users are identified at least 2 options are possible:</p>\n<ol>\n<li>Set a new password (manually by going to the user profile, or automatically with a groovy script for example)</li>\n<li>rollback to a previous version of the user document: in such case the password will be automatically processed properly</li>\n</ol>\n<p>Be aware that those workarounds won't remove the clear password entry that might remain in database due to history.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>Jira ticket: <a href=\"https://jira.xwiki.org/browse/XWIKI-19869\">https://jira.xwiki.org/browse/XWIKI-19869</a></li>\n<li>Advisory of a data leak vulnerability that increases the criticality of this vulnerability: <a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-599v-w48h-rjrm</a></li>\n<li>Bug discovered \"protecting\" subwiki from this vulnerability: <a href=\"https://jira.xwiki.org/browse/XWIKI-19945\">https://jira.xwiki.org/browse/XWIKI-19945</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">Jira</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-q2hm-2h45-v5g3</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q2hm-2h45-v5g3\">https://github.com/advisories/GHSA-q2hm-2h45-v5g3</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q2hm-2h45-v5g3",
            "title": "[org.xwiki.platform:xwiki-platform-security-authentication-default] Plaintext storage of password after a reset in org.xwiki.platform:xwiki-platform-security-authentication-default",
            "date_modified": "2022-11-21T22:37:14.000Z",
            "date_published": "2022-11-21T22:37:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q2hm-2h45-v5g3"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible to make XWiki create many new schemas and fill them with tables just by using a crafted user identifier in the login form.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.8, 14.6RC1 and 14.4.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The only workarounds for this are:</p>\n<ul>\n<li>use an authenticator which does interpret the login as a reference to a document</li>\n<li>using a different database than PostgreSQL</li>\n<li>upgrade XWiki</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://jira.xwiki.org/browse/XWIKI-19886\">https://jira.xwiki.org/browse/XWIKI-19886</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v",
            "title": "[org.xwiki.platform:xwiki-platform-oldcore] Creation of new database tables through login form on PostgreSQL",
            "date_modified": "2022-11-21T22:36:51.000Z",
            "date_published": "2022-11-21T22:36:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible to make XWiki create many new schemas and fill them with tables just by using a crafted user identifier in the login form.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.8, 14.6RC1 and 14.4.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The only workarounds for this are:</p>\n<ul>\n<li>use an authenticator which does interpret the login as a reference to a document</li>\n<li>using a different database than PostgreSQL</li>\n<li>upgrade XWiki</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://jira.xwiki.org/browse/XWIKI-19886\">https://jira.xwiki.org/browse/XWIKI-19886</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v",
            "title": "[org.xwiki.platform:xwiki-platform-oldcore] Creation of new database tables through login form on PostgreSQL",
            "date_modified": "2022-11-21T22:36:51.000Z",
            "date_published": "2022-11-21T22:36:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible to make XWiki create many new schemas and fill them with tables just by using a crafted user identifier in the login form.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.8, 14.6RC1 and 14.4.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The only workarounds for this are:</p>\n<ul>\n<li>use an authenticator which does interpret the login as a reference to a document</li>\n<li>using a different database than PostgreSQL</li>\n<li>upgrade XWiki</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://jira.xwiki.org/browse/XWIKI-19886\">https://jira.xwiki.org/browse/XWIKI-19886</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-4x5r-6v26-7j4v\">https://github.com/advisories/GHSA-4x5r-6v26-7j4v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v",
            "title": "[org.xwiki.platform:xwiki-platform-oldcore] Creation of new database tables through login form on PostgreSQL",
            "date_modified": "2022-11-21T22:36:51.000Z",
            "date_published": "2022-11-21T22:36:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-4x5r-6v26-7j4v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with view rights on commonly accessible documents including the icon picker macro can execute arbitrary Groovy, Python or Velocity code in XWiki due to improper neutralization of the macro parameters of the icon picker macro.</p>\n<p>The URL <code>&lt;server&gt;/xwiki/bin/view/Main?sheet=CKEditor.HTMLConverter&amp;language=en&amp;sourceSyntax=xwiki%252F2.1&amp;stripHTMLEnvelope=true&amp;fromHTML=false&amp;toHTML=true&amp;text=%7B%7BiconPicker%20id%3D%22'%3C%2Fscript%3E%7B%7B%2Fhtml%7D%7D%7B%7Bcache%7D%7D%7B%7Bgroovy%7D%7Dprintln(%2FHellofromIconPickerId%2F)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%22%20class%3D%22'%3C%2Fscript%3E%7B%7B%2Fhtml%7D%7D%7B%7Bcache%7D%7D%7B%7Bgroovy%7D%7Dprintln(%2FHellofromIconPickerClass%2F)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%22%2F%7D%7D</code> demonstrates the issue (replace <code>&lt;server&gt;</code> by the URL to your XWiki installation). If the output <code>HellofromIconPickerId</code> or <code>HellofromIconPickerClass</code> is visible, the XWiki installation is vulnerable (normally, all output should be contained in a script-tag and thus invisible).</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.5 and 14.4.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01\">patch</a> can be manually applied by editing <code>IconThemesCode.IconPickerMacro</code> in the object editor. The whole document can also be replaced by the current version by importing the document from the XAR archive of a fixed version as the only changes to the document have been security fixes and small formatting changes.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01\">https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19805\">https://jira.xwiki.org/browse/XWIKI-19805</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5j7g-cf6r-g2h7\">https://github.com/advisories/GHSA-5j7g-cf6r-g2h7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5j7g-cf6r-g2h7",
            "title": "[org.xwiki.platform:xwiki-platform-icon-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in xwiki-platform-icon-ui",
            "date_modified": "2022-11-21T22:36:34.000Z",
            "date_published": "2022-11-21T22:36:33.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5j7g-cf6r-g2h7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with view rights on commonly accessible documents including the icon picker macro can execute arbitrary Groovy, Python or Velocity code in XWiki due to improper neutralization of the macro parameters of the icon picker macro.</p>\n<p>The URL <code>&lt;server&gt;/xwiki/bin/view/Main?sheet=CKEditor.HTMLConverter&amp;language=en&amp;sourceSyntax=xwiki%252F2.1&amp;stripHTMLEnvelope=true&amp;fromHTML=false&amp;toHTML=true&amp;text=%7B%7BiconPicker%20id%3D%22'%3C%2Fscript%3E%7B%7B%2Fhtml%7D%7D%7B%7Bcache%7D%7D%7B%7Bgroovy%7D%7Dprintln(%2FHellofromIconPickerId%2F)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%22%20class%3D%22'%3C%2Fscript%3E%7B%7B%2Fhtml%7D%7D%7B%7Bcache%7D%7D%7B%7Bgroovy%7D%7Dprintln(%2FHellofromIconPickerClass%2F)%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fcache%7D%7D%22%2F%7D%7D</code> demonstrates the issue (replace <code>&lt;server&gt;</code> by the URL to your XWiki installation). If the output <code>HellofromIconPickerId</code> or <code>HellofromIconPickerClass</code> is visible, the XWiki installation is vulnerable (normally, all output should be contained in a script-tag and thus invisible).</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.5 and 14.4.2.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The <a href=\"https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01\">patch</a> can be manually applied by editing <code>IconThemesCode.IconPickerMacro</code> in the object editor. The whole document can also be replaced by the current version by importing the document from the XAR archive of a fixed version as the only changes to the document have been security fixes and small formatting changes.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01\">https://github.com/xwiki/xwiki-platform/commit/47eb8a5fba550f477944eb6da8ca91b87eaf1d01</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19805\">https://jira.xwiki.org/browse/XWIKI-19805</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-5j7g-cf6r-g2h7</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5j7g-cf6r-g2h7\">https://github.com/advisories/GHSA-5j7g-cf6r-g2h7</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5j7g-cf6r-g2h7",
            "title": "[org.xwiki.platform:xwiki-platform-icon-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in xwiki-platform-icon-ui",
            "date_modified": "2022-11-21T22:36:34.000Z",
            "date_published": "2022-11-21T22:36:33.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5j7g-cf6r-g2h7"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user (logged in or not) with access to the page XWiki.XWikiUserProfileSheet can enable or disable any user profile. This might allow to a disabled user to re-enable themselves, or to an attacker to disable any user of the wiki. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.5RC1 and 14.4.2. </p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The problem can be patched immediately by editing the page <code>XWiki.XWikiUserProfileSheet</code> in the wiki and by performing the changes contained in <a href=\"https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa\">https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa\">https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19792\">https://jira.xwiki.org/browse/XWIKI-19792</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p5v9-g8w8-5q4v\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p5v9-g8w8-5q4v</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p5v9-g8w8-5q4v\">https://github.com/advisories/GHSA-p5v9-g8w8-5q4v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p5v9-g8w8-5q4v",
            "title": "[org.xwiki.platform:xwiki-platform-user-profile-ui] Missing Authorization to enable or disable users in org.xwiki.platform:xwiki-platform-user-profile-ui",
            "date_modified": "2022-11-21T22:35:40.000Z",
            "date_published": "2022-11-21T22:35:39.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p5v9-g8w8-5q4v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user (logged in or not) with access to the page XWiki.XWikiUserProfileSheet can enable or disable any user profile. This might allow to a disabled user to re-enable themselves, or to an attacker to disable any user of the wiki. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.5RC1 and 14.4.2. </p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The problem can be patched immediately by editing the page <code>XWiki.XWikiUserProfileSheet</code> in the wiki and by performing the changes contained in <a href=\"https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa\">https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa\">https://github.com/xwiki/xwiki-platform/commit/5be1cc0adf917bf10899c47723fa451e950271fa</a></li>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19792\">https://jira.xwiki.org/browse/XWIKI-19792</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p5v9-g8w8-5q4v\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-p5v9-g8w8-5q4v</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p5v9-g8w8-5q4v\">https://github.com/advisories/GHSA-p5v9-g8w8-5q4v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p5v9-g8w8-5q4v",
            "title": "[org.xwiki.platform:xwiki-platform-user-profile-ui] Missing Authorization to enable or disable users in org.xwiki.platform:xwiki-platform-user-profile-ui",
            "date_modified": "2022-11-21T22:35:40.000Z",
            "date_published": "2022-11-21T22:35:39.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p5v9-g8w8-5q4v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible for a user with only Script rights to enable or disable a user: this operation should be only doable for users with admin rights. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in XWiki 13.10.7, 14.4.2 and 14.5RC1.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround other than upgrading the wiki, but note that this only impacts users with Script rights: administrator should take care which users have such right. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19804\">https://jira.xwiki.org/browse/XWIKI-19804</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd\">https://github.com/xwiki/xwiki-platform/commit/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2gj2-vj98-j2qq\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2gj2-vj98-j2qq</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2gj2-vj98-j2qq\">https://github.com/advisories/GHSA-2gj2-vj98-j2qq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2gj2-vj98-j2qq",
            "title": "[org.xwiki.platform:xwiki-platform-oldcore] Missing Authorization in User#setDisabledStatus in org.xwiki.platform:xwiki-platform-oldcore",
            "date_modified": "2022-11-21T22:35:24.000Z",
            "date_published": "2022-11-21T22:35:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2gj2-vj98-j2qq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible for a user with only Script rights to enable or disable a user: this operation should be only doable for users with admin rights. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in XWiki 13.10.7, 14.4.2 and 14.5RC1.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround other than upgrading the wiki, but note that this only impacts users with Script rights: administrator should take care which users have such right. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19804\">https://jira.xwiki.org/browse/XWIKI-19804</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd\">https://github.com/xwiki/xwiki-platform/commit/0b732f2ef0224e2aaf10e2e1ef48dbd3fb6e10cd</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2gj2-vj98-j2qq\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-2gj2-vj98-j2qq</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2gj2-vj98-j2qq\">https://github.com/advisories/GHSA-2gj2-vj98-j2qq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2gj2-vj98-j2qq",
            "title": "[org.xwiki.platform:xwiki-platform-oldcore] Missing Authorization in User#setDisabledStatus in org.xwiki.platform:xwiki-platform-oldcore",
            "date_modified": "2022-11-21T22:35:24.000Z",
            "date_published": "2022-11-21T22:35:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2gj2-vj98-j2qq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with the right to edit his personal page can follow one of the scenario below:</p>\n<p><strong>Scenario 1</strong>:</p>\n<ul>\n<li>Log in as a simple user with just edit rights on the user profile</li>\n<li>Go to the user's profile</li>\n<li>Upload an attachment in the attachment tab at the bottom of the page (any image is fine)</li>\n<li>Click on \"rename\" in the attachment list and enter <code>{{async async=\"true\" cached=\"false\" context=\"doc.reference\"}}{{groovy}}println(\"Hello from groovy!\"){{/groovy}}{{/async}}.png</code> as new attachment name and submit the rename</li>\n<li>Go back to the user profile</li>\n<li>Click on the edit icon on the user avatar</li>\n<li><code>Hello from groovy!</code> is displayed as the title of the attachment</li>\n</ul>\n<p><strong>Scenario 2</strong>:</p>\n<ul>\n<li>Log in as a simple user with just edit rights on a page</li>\n<li>Create a Page <code>MyPage.WebHome</code></li>\n<li>Create an XClass field of type String named <code>avatar</code></li>\n<li>Add an XObject of type <code>MyPage.WebHome</code> on the page</li>\n<li>Insert an <code>attachmentSelector</code> macro in the document with the following values:<ul>\n<li><strong>classname</strong>: <code>MyPage.WebHome</code></li>\n<li><strong>property</strong>: <code>avatar</code></li>\n<li><strong>savemode</strong>: <code>direct</code></li>\n<li><strong>displayImage</strong>: <code>true</code></li>\n<li><strong>width</strong>: <code>]] {{async async=\"true\" cached=\"false\" context=\"doc.reference\"}}{{groovy}}println(\"Hello from groovy!\"){{/groovy}}{{/async}}</code>. You'll find below a snippet of an <code>attachmentSelector</code> macro declaration.</li>\n</ul>\n</li>\n<li>Display the page</li>\n<li>Use the attachment picker to select an image</li>\n<li><code>Hello from groovy</code> is displayed aside the image</li>\n</ul>\n<p>Example of an <code>attachmentSelector</code> macro declaration:</p>\n<pre><code>`{{attachmentSelector classname=\"MyPage.WebHome\" property=\"avatar\" savemode=\"direct\" displayImage=\"true\" width=\"]] {{async async=~\"true~\" cached=~\"false~\" context=~\"doc.reference~\"~}~}{{groovy~}~}println(~\"Hello from groovy!~\"){{/groovy~}~}{{/async~}~}\"/}}`\n</code></pre>\n<p><strong>Note</strong>: The issue can also be reproduced by inserting the dangerous payload in the <code>height</code> or <code>alt</code> macro properties.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue can be fixed on a running wiki by updating <code>XWiki.AttachmentSelector</code> with the versions below:</p>\n<ul>\n<li>14.5-rc-1+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/eb15147adf94bddb92626f862c1710d45bcd64a7#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/eb15147adf94bddb92626f862c1710d45bcd64a7#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n<li>14.4.2+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/c02f8eb1f3c953d124f2c097021536f8bc00fa8d#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/c02f8eb1f3c953d124f2c097021536f8bc00fa8d#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n<li>13.10.7+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/efd0df0468d46149ba68b66660b93f31b6318515#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/efd0df0468d46149ba68b66660b93f31b6318515#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No known workaround.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19800\">https://jira.xwiki.org/browse/XWIKI-19800</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9hqh-fmhg-vq2j\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9hqh-fmhg-vq2j</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9hqh-fmhg-vq2j\">https://github.com/advisories/GHSA-9hqh-fmhg-vq2j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9hqh-fmhg-vq2j",
            "title": "[org.xwiki.platform:xwiki-platform-attachment-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in AttachmentSelector.xml",
            "date_modified": "2022-11-21T22:34:59.000Z",
            "date_published": "2022-11-21T22:34:57.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9hqh-fmhg-vq2j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user with the right to edit his personal page can follow one of the scenario below:</p>\n<p><strong>Scenario 1</strong>:</p>\n<ul>\n<li>Log in as a simple user with just edit rights on the user profile</li>\n<li>Go to the user's profile</li>\n<li>Upload an attachment in the attachment tab at the bottom of the page (any image is fine)</li>\n<li>Click on \"rename\" in the attachment list and enter <code>{{async async=\"true\" cached=\"false\" context=\"doc.reference\"}}{{groovy}}println(\"Hello from groovy!\"){{/groovy}}{{/async}}.png</code> as new attachment name and submit the rename</li>\n<li>Go back to the user profile</li>\n<li>Click on the edit icon on the user avatar</li>\n<li><code>Hello from groovy!</code> is displayed as the title of the attachment</li>\n</ul>\n<p><strong>Scenario 2</strong>:</p>\n<ul>\n<li>Log in as a simple user with just edit rights on a page</li>\n<li>Create a Page <code>MyPage.WebHome</code></li>\n<li>Create an XClass field of type String named <code>avatar</code></li>\n<li>Add an XObject of type <code>MyPage.WebHome</code> on the page</li>\n<li>Insert an <code>attachmentSelector</code> macro in the document with the following values:<ul>\n<li><strong>classname</strong>: <code>MyPage.WebHome</code></li>\n<li><strong>property</strong>: <code>avatar</code></li>\n<li><strong>savemode</strong>: <code>direct</code></li>\n<li><strong>displayImage</strong>: <code>true</code></li>\n<li><strong>width</strong>: <code>]] {{async async=\"true\" cached=\"false\" context=\"doc.reference\"}}{{groovy}}println(\"Hello from groovy!\"){{/groovy}}{{/async}}</code>. You'll find below a snippet of an <code>attachmentSelector</code> macro declaration.</li>\n</ul>\n</li>\n<li>Display the page</li>\n<li>Use the attachment picker to select an image</li>\n<li><code>Hello from groovy</code> is displayed aside the image</li>\n</ul>\n<p>Example of an <code>attachmentSelector</code> macro declaration:</p>\n<pre><code>`{{attachmentSelector classname=\"MyPage.WebHome\" property=\"avatar\" savemode=\"direct\" displayImage=\"true\" width=\"]] {{async async=~\"true~\" cached=~\"false~\" context=~\"doc.reference~\"~}~}{{groovy~}~}println(~\"Hello from groovy!~\"){{/groovy~}~}{{/async~}~}\"/}}`\n</code></pre>\n<p><strong>Note</strong>: The issue can also be reproduced by inserting the dangerous payload in the <code>height</code> or <code>alt</code> macro properties.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue can be fixed on a running wiki by updating <code>XWiki.AttachmentSelector</code> with the versions below:</p>\n<ul>\n<li>14.5-rc-1+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/eb15147adf94bddb92626f862c1710d45bcd64a7#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/eb15147adf94bddb92626f862c1710d45bcd64a7#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n<li>14.4.2+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/c02f8eb1f3c953d124f2c097021536f8bc00fa8d#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/c02f8eb1f3c953d124f2c097021536f8bc00fa8d#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n<li>13.10.7+: <a href=\"https://github.com/xwiki/xwiki-platform/commit/efd0df0468d46149ba68b66660b93f31b6318515#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23\">https://github.com/xwiki/xwiki-platform/commit/efd0df0468d46149ba68b66660b93f31b6318515#diff-e1513599ab698991f6cbba55d38f3f464432ced8d137a668b1f7618c7e747e23</a></li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>No known workaround.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19800\">https://jira.xwiki.org/browse/XWIKI-19800</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org/\">Jira XWiki.org</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">Security Mailing List</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9hqh-fmhg-vq2j\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-9hqh-fmhg-vq2j</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9hqh-fmhg-vq2j\">https://github.com/advisories/GHSA-9hqh-fmhg-vq2j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9hqh-fmhg-vq2j",
            "title": "[org.xwiki.platform:xwiki-platform-attachment-ui] Improper Neutralization of Directives in Dynamically Evaluated Code ('Eval Injection') in AttachmentSelector.xml",
            "date_modified": "2022-11-21T22:34:59.000Z",
            "date_published": "2022-11-21T22:34:57.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9hqh-fmhg-vq2j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible with a simple request to perform deletion or renaming of tags without needing any confirmation, by using a CSRF attack. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.4.1 and 14.5RC1. </p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It's possible to patch existing instances directly by editing the page Main.Tags and add this kind of check, in the code for renaming and for deleting:</p>\n<pre><code>#if (!$services.csrf.isTokenValid($request.get('form_token')))\n    #set ($discard = $response.sendError(401, \"Wrong CSRF token\"))\n#end\n</code></pre>\n<p>See the commit with the fix for more information about patching the page: <a href=\"https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e\">https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19748\">https://jira.xwiki.org/browse/XWIKI-19748</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e\">https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mq7h-5574-hw9f\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mq7h-5574-hw9f</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mq7h-5574-hw9f\">https://github.com/advisories/GHSA-mq7h-5574-hw9f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mq7h-5574-hw9f",
            "title": "[org.xwiki.platform:xwiki-platform-tag-ui] Cross-Site Request Forgery (CSRF) allowing to delete or rename tags",
            "date_modified": "2022-11-21T22:34:35.000Z",
            "date_published": "2022-11-21T22:34:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mq7h-5574-hw9f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>It's possible with a simple request to perform deletion or renaming of tags without needing any confirmation, by using a CSRF attack. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been patched in XWiki 13.10.7, 14.4.1 and 14.5RC1. </p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It's possible to patch existing instances directly by editing the page Main.Tags and add this kind of check, in the code for renaming and for deleting:</p>\n<pre><code>#if (!$services.csrf.isTokenValid($request.get('form_token')))\n    #set ($discard = $response.sendError(401, \"Wrong CSRF token\"))\n#end\n</code></pre>\n<p>See the commit with the fix for more information about patching the page: <a href=\"https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e\">https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://jira.xwiki.org/browse/XWIKI-19748\">https://jira.xwiki.org/browse/XWIKI-19748</a></li>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e\">https://github.com/xwiki/xwiki-platform/commit/7fd4cda0590180c4d34f557597e9e10e263def9e</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://jira.xwiki.org\">JIRA</a></li>\n<li>Email us at <a href=\"mailto:security@xwiki.org\">security ML</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mq7h-5574-hw9f\">https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-mq7h-5574-hw9f</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mq7h-5574-hw9f\">https://github.com/advisories/GHSA-mq7h-5574-hw9f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mq7h-5574-hw9f",
            "title": "[org.xwiki.platform:xwiki-platform-tag-ui] Cross-Site Request Forgery (CSRF) allowing to delete or rename tags",
            "date_modified": "2022-11-21T22:34:35.000Z",
            "date_published": "2022-11-21T22:34:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mq7h-5574-hw9f"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}