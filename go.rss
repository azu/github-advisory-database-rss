<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-02-05T05:01:31.029Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost-server/v6] Improper Privilege Management in Mattermost]]></title>
        <id>https://github.com/advisories/GHSA-qggc-pj29-j27m</id>
        <link href="https://github.com/advisories/GHSA-qggc-pj29-j27m"/>
        <updated>2023-02-02T23:05:14.000Z</updated>
        <content type="html"><![CDATA[<p>One of the API in Mattermost version 6.4.1 and earlier fails to properly protect the permissions, which allows the authenticated members with restricted custom admin role to bypass the restrictions and view the server logs and server config.json file contents. Per the Mattermost security updates page, versions 6.4.2, 6.3.5, 6.2.5, and 5.37.9 contain patches for this issue</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-1332">https://nvd.nist.gov/vuln/detail/CVE-2022-1332</a></li>
<li><a href="https://mattermost.com/security-updates/">https://mattermost.com/security-updates/</a></li>
<li><a href="https://github.com/advisories/GHSA-qggc-pj29-j27m">https://github.com/advisories/GHSA-qggc-pj29-j27m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qggc-pj29-j27m</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-04-14T00:00:17.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[www.velocidex.com/golang/velociraptor] Velociraptor subject to Path Traversal]]></title>
        <id>https://github.com/advisories/GHSA-7jf5-fvgf-48c6</id>
        <link href="https://github.com/advisories/GHSA-7jf5-fvgf-48c6"/>
        <updated>2023-02-01T01:37:24.000Z</updated>
        <content type="html"><![CDATA[<p>Rapid7 Velociraptor did not properly sanitize the client ID parameter to the CreateCollection API, allowing a directory traversal in where the collection task could be written. It was possible to provide a client id of "../clients/server" to schedule the collection for the server (as a server artifact), but only require privileges to schedule collections on the client. Normally, to schedule an artifact on the server, the COLLECT_SERVER permission is required. This permission is normally only granted to "administrator" role. Due to this issue, it is sufficient to have the COLLECT_CLIENT privilege, which is normally granted to the "investigator" role. To exploit this vulnerability, the attacker must already have a Velociraptor user account at least "investigator" level, and be able to authenticate to the GUI and issue an API call to the backend. Typically, most users deploy Velociraptor with limited access to a trusted group, and most users will already be administrators within the GUI. This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released January 16, 2023, fixes the issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0290">https://nvd.nist.gov/vuln/detail/CVE-2023-0290</a></li>
<li><a href="https://github.com/Velocidex/velociraptor">https://github.com/Velocidex/velociraptor</a></li>
<li><a href="https://github.com/advisories/GHSA-7jf5-fvgf-48c6">https://github.com/advisories/GHSA-7jf5-fvgf-48c6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7jf5-fvgf-48c6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-19T00:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[www.velocidex.com/golang/velociraptor] Velociraptor vulnerable to Missing Authorization]]></title>
        <id>https://github.com/advisories/GHSA-g5vm-525q-r66c</id>
        <link href="https://github.com/advisories/GHSA-g5vm-525q-r66c"/>
        <updated>2023-02-01T01:37:20.000Z</updated>
        <content type="html"><![CDATA[<p>Rapid7 Velociraptor allows users to be created with different privileges on the server. Administrators are generally allowed to run any command on the server including writing arbitrary files. However, lower privilege users are generally forbidden from writing or modifying files on the server. The VQL copy() function applies permission checks for reading files but does not check for permission to write files. This allows a low privilege user (usually, users with the Velociraptor "investigator" role) to overwrite files on the server, including Velociraptor configuration files. To exploit this vulnerability, the attacker must already have a Velociraptor user account at a low privilege level (at least "analyst") and be able to log into the GUI and create a notebook where they can run the VQL query invoking the copy() VQL function. Typically, most users deploy Velociraptor with limited access to a trusted group (most users will be administrators within the GUI). This vulnerability is associated with program files <a href="https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go">https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go</a> <a href="https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go">https://github.Com/Velocidex/velociraptor/blob/master/vql/filesystem/copy.go</a> and program routines copy(). This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released January 16, 2023, fixes the issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0242">https://nvd.nist.gov/vuln/detail/CVE-2023-0242</a></li>
<li><a href="https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check">https://docs.velociraptor.app/announcements/2023-cves/#:~:text=to%20upgrade%20clients.-,CVE%2D2023%2D0242,-Insufficient%20Permission%20Check</a></li>
<li><a href="https://github.com/advisories/GHSA-g5vm-525q-r66c">https://github.com/advisories/GHSA-g5vm-525q-r66c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g5vm-525q-r66c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-18T21:30:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[fortio.org/proxy] Initial debug-host handler implementation could leak information and facilitate denial of service]]></title>
        <id>https://github.com/advisories/GHSA-x477-fq37-q5wr</id>
        <link href="https://github.com/advisories/GHSA-x477-fq37-q5wr"/>
        <updated>2023-01-27T00:55:28.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>version 1.5.0 and 1.6.0 when using the new <code>debug-host</code> feature could expose unnecessary information about the host</p>
<h3 id="patches">Patches</h3>
<p>Use 1.6.1 or newer</p>
<h3 id="workarounds">Workarounds</h3>
<p>Downgrade to 1.4.0 or set <code>debug-host</code> to empty</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/fortio/proxy/pull/38">https://github.com/fortio/proxy/pull/38</a></p>
<p>Q&amp;A <a href="https://github.com/fortio/proxy/discussions">https://github.com/fortio/proxy/discussions</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/fortio/proxy/security/advisories/GHSA-x477-fq37-q5wr">https://github.com/fortio/proxy/security/advisories/GHSA-x477-fq37-q5wr</a></li>
<li><a href="https://github.com/fortio/proxy/pull/38">https://github.com/fortio/proxy/pull/38</a></li>
<li><a href="https://github.com/advisories/GHSA-x477-fq37-q5wr">https://github.com/advisories/GHSA-x477-fq37-q5wr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x477-fq37-q5wr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-27T00:55:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.elastic.co/apm] Information Disclosure in go.elastic.co/apm]]></title>
        <id>https://github.com/advisories/GHSA-qqc5-rgcc-cjqh</id>
        <link href="https://github.com/advisories/GHSA-qqc5-rgcc-cjqh"/>
        <updated>2023-01-26T21:57:07.000Z</updated>
        <content type="html"><![CDATA[<p>The Elastic APM agent for Go versions before 1.11.0 can leak sensitive HTTP header information when logging the details during an application panic. Normally, the APM agent will sanitize sensitive HTTP header details before sending the information to the APM server. During an application panic it is possible the headers will not be sanitized before being sent.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-22133">https://nvd.nist.gov/vuln/detail/CVE-2021-22133</a></li>
<li><a href="https://github.com/elastic/apm-agent-go/commit/c5c7e21aa26a6def7790f74fbceed792ad47ef35">https://github.com/elastic/apm-agent-go/commit/c5c7e21aa26a6def7790f74fbceed792ad47ef35</a></li>
<li><a href="https://discuss.elastic.co/t/elastic-apm-agent-for-go-1-11-0-security-update/263252">https://discuss.elastic.co/t/elastic-apm-agent-for-go-1-11-0-security-update/263252</a></li>
<li><a href="https://github.com/elastic/apm-agent-go/compare/v1.10.0...v1.11.0">https://github.com/elastic/apm-agent-go/compare/v1.10.0...v1.11.0</a></li>
<li><a href="https://github.com/elastic/apm-agent-go/pull/888">https://github.com/elastic/apm-agent-go/pull/888</a></li>
<li><a href="https://github.com/elastic/apm-agent-go/commit/dd3e8c593580e7b80a98b57e1cc6e017e56747b4">https://github.com/elastic/apm-agent-go/commit/dd3e8c593580e7b80a98b57e1cc6e017e56747b4</a></li>
<li><a href="https://github.com/advisories/GHSA-qqc5-rgcc-cjqh">https://github.com/advisories/GHSA-qqc5-rgcc-cjqh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qqc5-rgcc-cjqh</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2021-05-18T18:34:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] JWT audience claim is not verified]]></title>
        <id>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</id>
        <link href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc"/>
        <updated>2023-01-26T21:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.</p>
<p>OIDC providers include an <code>aud</code> (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD <em>does</em> validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD <em>does not</em> validate the audience claim, so it will accept tokens that are not intended for Argo CD.</p>
<p>If Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's <code>groups</code> claim, even though those groups were not intended to be used by Argo CD.</p>
<p>This bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.6.0-rc5</li>
<li>v2.5.8</li>
<li>v2.4.20</li>
<li>v2.3.14</li>
</ul>
<p>The patch introduces a new <code>allowedAudiences</code> to the OIDC config block. By default, the client ID is the only allowed audience. Users who <em>want</em> Argo CD to accept tokens intended for a different audience may use <code>allowedAudiences</code> to specify those audiences.</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    allowedAudiences:
    - audience-1
    - audience-2
    - argocd-client-id  # If `allowedAudiences` is non-empty, Argo CD's client ID must be explicitly added if you want to allow it.
</code></pre>
<p>Even though <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">the OIDC spec requires the audience claim</a>, some tokens may not include it. To avoid a breaking change in a patch release, versions &lt; 2.6.0 of Argo CD will skip the audience claim check for tokens that have no audience. In versions &gt;= 2.6.0, Argo CD will reject all tokens which do not have an audience claim. Users can opt into the old behavior by setting an option:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    skipAudienceCheckWhenTokenHasNoAudience: true
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround besides upgrading.</p>
<h3 id="credits">Credits</h3>
<p>The Argo CD team would like to express their gratitude to Vladimir Pouzanov (@farcaller) from Indeed, who discovered the issue, reported it confidentially according to our <a href="https://github.com/argoproj/argo-cd/blob/master/SECURITY.md#reporting-a-vulnerability">guidelines</a>, and actively worked with the project to provide a remedy. Many thanks to Vladimir!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd.readthedocs.io/en/latest/operator-manual/user-management/#existing-oidc-provider">How to configure OIDC in Argo CD</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">OIDC spec section discussing the audience claim</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3">JWT spec section discussing the audience claim</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22482">https://nvd.nist.gov/vuln/detail/CVE-2023-22482</a></li>
<li><a href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T22:02:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] JWT audience claim is not verified]]></title>
        <id>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</id>
        <link href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc"/>
        <updated>2023-01-26T21:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.</p>
<p>OIDC providers include an <code>aud</code> (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD <em>does</em> validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD <em>does not</em> validate the audience claim, so it will accept tokens that are not intended for Argo CD.</p>
<p>If Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's <code>groups</code> claim, even though those groups were not intended to be used by Argo CD.</p>
<p>This bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.6.0-rc5</li>
<li>v2.5.8</li>
<li>v2.4.20</li>
<li>v2.3.14</li>
</ul>
<p>The patch introduces a new <code>allowedAudiences</code> to the OIDC config block. By default, the client ID is the only allowed audience. Users who <em>want</em> Argo CD to accept tokens intended for a different audience may use <code>allowedAudiences</code> to specify those audiences.</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    allowedAudiences:
    - audience-1
    - audience-2
    - argocd-client-id  # If `allowedAudiences` is non-empty, Argo CD's client ID must be explicitly added if you want to allow it.
</code></pre>
<p>Even though <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">the OIDC spec requires the audience claim</a>, some tokens may not include it. To avoid a breaking change in a patch release, versions &lt; 2.6.0 of Argo CD will skip the audience claim check for tokens that have no audience. In versions &gt;= 2.6.0, Argo CD will reject all tokens which do not have an audience claim. Users can opt into the old behavior by setting an option:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    skipAudienceCheckWhenTokenHasNoAudience: true
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround besides upgrading.</p>
<h3 id="credits">Credits</h3>
<p>The Argo CD team would like to express their gratitude to Vladimir Pouzanov (@farcaller) from Indeed, who discovered the issue, reported it confidentially according to our <a href="https://github.com/argoproj/argo-cd/blob/master/SECURITY.md#reporting-a-vulnerability">guidelines</a>, and actively worked with the project to provide a remedy. Many thanks to Vladimir!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd.readthedocs.io/en/latest/operator-manual/user-management/#existing-oidc-provider">How to configure OIDC in Argo CD</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">OIDC spec section discussing the audience claim</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3">JWT spec section discussing the audience claim</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22482">https://nvd.nist.gov/vuln/detail/CVE-2023-22482</a></li>
<li><a href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T22:02:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] JWT audience claim is not verified]]></title>
        <id>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</id>
        <link href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc"/>
        <updated>2023-01-26T21:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.</p>
<p>OIDC providers include an <code>aud</code> (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD <em>does</em> validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD <em>does not</em> validate the audience claim, so it will accept tokens that are not intended for Argo CD.</p>
<p>If Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's <code>groups</code> claim, even though those groups were not intended to be used by Argo CD.</p>
<p>This bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.6.0-rc5</li>
<li>v2.5.8</li>
<li>v2.4.20</li>
<li>v2.3.14</li>
</ul>
<p>The patch introduces a new <code>allowedAudiences</code> to the OIDC config block. By default, the client ID is the only allowed audience. Users who <em>want</em> Argo CD to accept tokens intended for a different audience may use <code>allowedAudiences</code> to specify those audiences.</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    allowedAudiences:
    - audience-1
    - audience-2
    - argocd-client-id  # If `allowedAudiences` is non-empty, Argo CD's client ID must be explicitly added if you want to allow it.
</code></pre>
<p>Even though <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">the OIDC spec requires the audience claim</a>, some tokens may not include it. To avoid a breaking change in a patch release, versions &lt; 2.6.0 of Argo CD will skip the audience claim check for tokens that have no audience. In versions &gt;= 2.6.0, Argo CD will reject all tokens which do not have an audience claim. Users can opt into the old behavior by setting an option:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    skipAudienceCheckWhenTokenHasNoAudience: true
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround besides upgrading.</p>
<h3 id="credits">Credits</h3>
<p>The Argo CD team would like to express their gratitude to Vladimir Pouzanov (@farcaller) from Indeed, who discovered the issue, reported it confidentially according to our <a href="https://github.com/argoproj/argo-cd/blob/master/SECURITY.md#reporting-a-vulnerability">guidelines</a>, and actively worked with the project to provide a remedy. Many thanks to Vladimir!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd.readthedocs.io/en/latest/operator-manual/user-management/#existing-oidc-provider">How to configure OIDC in Argo CD</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">OIDC spec section discussing the audience claim</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3">JWT spec section discussing the audience claim</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22482">https://nvd.nist.gov/vuln/detail/CVE-2023-22482</a></li>
<li><a href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T22:02:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] JWT audience claim is not verified]]></title>
        <id>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</id>
        <link href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc"/>
        <updated>2023-01-26T21:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All versions of Argo CD starting with v1.8.2 are vulnerable to an improper authorization bug causing the API to accept certain invalid tokens.</p>
<p>OIDC providers include an <code>aud</code> (audience) claim in signed tokens. The value of that claim specifies the intended audience(s) of the token (i.e. the service or services which are meant to accept the token). Argo CD <em>does</em> validate that the token was signed by Argo CD's configured OIDC provider. But Argo CD <em>does not</em> validate the audience claim, so it will accept tokens that are not intended for Argo CD.</p>
<p>If Argo CD's configured OIDC provider also serves other audiences (for example, a file storage service), then Argo CD will accept a token intended for one of those other audiences. Argo CD will grant the user privileges based on the token's <code>groups</code> claim, even though those groups were not intended to be used by Argo CD.</p>
<p>This bug also increases the blast radius of a stolen token. If an attacker steals a valid token for a different audience, they can use it to access Argo CD.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.6.0-rc5</li>
<li>v2.5.8</li>
<li>v2.4.20</li>
<li>v2.3.14</li>
</ul>
<p>The patch introduces a new <code>allowedAudiences</code> to the OIDC config block. By default, the client ID is the only allowed audience. Users who <em>want</em> Argo CD to accept tokens intended for a different audience may use <code>allowedAudiences</code> to specify those audiences.</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    allowedAudiences:
    - audience-1
    - audience-2
    - argocd-client-id  # If `allowedAudiences` is non-empty, Argo CD's client ID must be explicitly added if you want to allow it.
</code></pre>
<p>Even though <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">the OIDC spec requires the audience claim</a>, some tokens may not include it. To avoid a breaking change in a patch release, versions &lt; 2.6.0 of Argo CD will skip the audience claim check for tokens that have no audience. In versions &gt;= 2.6.0, Argo CD will reject all tokens which do not have an audience claim. Users can opt into the old behavior by setting an option:</p>
<pre><code class="language-yaml">apiVersion: v1
kind: ConfigMap
metadata:
  name: argocd-cm
data:
  oidc.config: |
    name: Example
    skipAudienceCheckWhenTokenHasNoAudience: true
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround besides upgrading.</p>
<h3 id="credits">Credits</h3>
<p>The Argo CD team would like to express their gratitude to Vladimir Pouzanov (@farcaller) from Indeed, who discovered the issue, reported it confidentially according to our <a href="https://github.com/argoproj/argo-cd/blob/master/SECURITY.md#reporting-a-vulnerability">guidelines</a>, and actively worked with the project to provide a remedy. Many thanks to Vladimir!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd.readthedocs.io/en/latest/operator-manual/user-management/#existing-oidc-provider">How to configure OIDC in Argo CD</a></li>
<li><a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">OIDC spec section discussing the audience claim</a></li>
<li><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3">JWT spec section discussing the audience claim</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/argoproj/argo-cd/security/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22482">https://nvd.nist.gov/vuln/detail/CVE-2023-22482</a></li>
<li><a href="https://github.com/advisories/GHSA-q9hr-j4rf-8fjc">https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q9hr-j4rf-8fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T22:02:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rancher/github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Controller reconciles apps outside configured namespaces when sharding is enabled]]></title>
        <id>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</id>
        <link href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw"/>
        <updated>2023-01-26T21:57:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All Argo CD versions starting with 2.5.0-rc1 are vulnerable to an authorization bypass bug which allows a malicious Argo CD user to deploy Applications outside the configured allowed namespaces. </p>
<h4 id="description-of-exploit">Description of exploit</h4>
<p>Reconciled Application namespaces are specified as a comma-delimited list of glob patterns. When sharding is enabled on the Application controller, it does not enforce that list of patterns when reconciling Applications. For example, if Application namespaces are configured to be <code>argocd-*</code>, the Application controller may reconcile an Application installed in a namespace called <code>other</code>, even though it does not start with <code>argocd-</code>.</p>
<p>Reconciliation of the out-of-bounds Application is only triggered when the Application is updated, so the attacker must be able to cause an update operation on the Application resource.</p>
<h4 id="limitations">Limitations</h4>
<p>This bug only applies to users who have explicitly enabled the "apps-in-any-namespace" feature by setting <code>application.namespaces</code> in the argocd-cmd-params-cm ConfigMap or otherwise setting the <code>--application-namespaces</code> flags on the Application controller and API server components. The apps-in-any-namespace feature is in beta as of this Security Advisory's publish date.</p>
<p>The bug is also limited to Argo CD instances where sharding is enabled by increasing the <code>replicas</code> count for the Application controller.</p>
<p>Finally, the AppProjects' <code>sourceNamespaces</code> field acts as a secondary check against this exploit. To cause reconciliation of an Application in an out-of-bounds namespace, an AppProject must be available which permits Applications in the out-of-bounds namespace.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.5.8</li>
<li>v2.6.0-rc5</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Running only one replica of the Application controller will prevent exploitation of this bug.</p>
<p>Making sure all AppProjects' <code>sourceNamespaces</code> are restricted within the confines of the configured Application namespaces will also prevent exploitation of this bug.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to ChangZhuo Chen (@czchen) for finding the issue and for contributing the fix!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd--10678.org.readthedocs.build/en/10678/operator-manual/app-any-namespace/">Documentation for apps-in-any-namespace</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22736">https://nvd.nist.gov/vuln/detail/CVE-2023-22736</a></li>
<li><a href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:39:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Controller reconciles apps outside configured namespaces when sharding is enabled]]></title>
        <id>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</id>
        <link href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw"/>
        <updated>2023-01-26T21:57:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All Argo CD versions starting with 2.5.0-rc1 are vulnerable to an authorization bypass bug which allows a malicious Argo CD user to deploy Applications outside the configured allowed namespaces. </p>
<h4 id="description-of-exploit">Description of exploit</h4>
<p>Reconciled Application namespaces are specified as a comma-delimited list of glob patterns. When sharding is enabled on the Application controller, it does not enforce that list of patterns when reconciling Applications. For example, if Application namespaces are configured to be <code>argocd-*</code>, the Application controller may reconcile an Application installed in a namespace called <code>other</code>, even though it does not start with <code>argocd-</code>.</p>
<p>Reconciliation of the out-of-bounds Application is only triggered when the Application is updated, so the attacker must be able to cause an update operation on the Application resource.</p>
<h4 id="limitations">Limitations</h4>
<p>This bug only applies to users who have explicitly enabled the "apps-in-any-namespace" feature by setting <code>application.namespaces</code> in the argocd-cmd-params-cm ConfigMap or otherwise setting the <code>--application-namespaces</code> flags on the Application controller and API server components. The apps-in-any-namespace feature is in beta as of this Security Advisory's publish date.</p>
<p>The bug is also limited to Argo CD instances where sharding is enabled by increasing the <code>replicas</code> count for the Application controller.</p>
<p>Finally, the AppProjects' <code>sourceNamespaces</code> field acts as a secondary check against this exploit. To cause reconciliation of an Application in an out-of-bounds namespace, an AppProject must be available which permits Applications in the out-of-bounds namespace.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.5.8</li>
<li>v2.6.0-rc5</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Running only one replica of the Application controller will prevent exploitation of this bug.</p>
<p>Making sure all AppProjects' <code>sourceNamespaces</code> are restricted within the confines of the configured Application namespaces will also prevent exploitation of this bug.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to ChangZhuo Chen (@czchen) for finding the issue and for contributing the fix!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd--10678.org.readthedocs.build/en/10678/operator-manual/app-any-namespace/">Documentation for apps-in-any-namespace</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22736">https://nvd.nist.gov/vuln/detail/CVE-2023-22736</a></li>
<li><a href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:39:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher generated tokens not revoked after modifications made to authentication provider]]></title>
        <id>https://github.com/advisories/GHSA-c45c-39f6-6gw9</id>
        <link href="https://github.com/advisories/GHSA-c45c-39f6-6gw9"/>
        <updated>2023-01-25T19:38:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It only affects Rancher setups that have an external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> configured or had one configured in the past.</p>
<p>It was discovered that when an external authentication provider is configured in Rancher and then disabled, the Rancher generated <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">tokens</a> associated with users who had access granted through the now disabled auth provider are not revoked. This allows users to retain access to Rancher and <code>kubectl</code> access to clusters managed by Rancher, according to their previous configured permissions, even after they are supposed to have lost it due to the auth provider been disabled.</p>
<p>The problem also occurs if the auth provider is configured (and is still enabled) to use the <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">access level scopes</a> <code>allow members of clusters and projects, plus authorized users &amp; groups</code> and <code>restrict access to only the authorized users &amp; groups</code>. In this case, removing users and groups from the authorized lists will not revoke the access tokens and they will remain valid.</p>
<p>An example scenario is:</p>
<ol>
<li>OpenLDAP, MS Active Directory (AD) or any other external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> is configured as an auth provider.</li>
<li>A user (<code>cluster-owner</code>) is granted <code>cluster-owner</code> permissions on a downstream cluster (<code>test-cluster</code>).</li>
<li><code>cluster-owner</code> logs in using their external auth provider username and password.</li>
<li><code>cluster-owner</code> generates a <code>kubeconfig</code> token for <code>test-cluster</code>.</li>
<li>The configured external auth provider is disabled.</li>
</ol>
<p>In this scenario, the <code>kubeconfig</code> generated in step 4 will still be valid after step 5, and <code>test-cluster</code> can still be accessed using the <code>kubeconfig</code> token.</p>
<p>By default, tokens for authenticated session have their <code>ttl</code> (time to live) set to <code>960</code> minutes, so they will expire after <code>16</code> hours. <code>kubeconfig</code> tokens are configured to never expire, and their <code>ttl</code> is set to <code>0</code>. These configurations can be changed in the Rancher's settings (<code>Configuration &gt; Global Settings &gt; Settings</code>) with the <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">parameters</a>  <code>auth-user-session-ttl-minutes</code> and <code>kubeconfig-default-token-ttl-minutes</code>, respectively.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you cannot update to a patched Rancher version, the recommended workaround is to review and remove tokens associated with auth providers manually.</p>
<p>The tokens can be reviewed by executing <code>kubectl get tokens</code> in Rancher's <code>local</code> cluster. Each found token must be manually reviewed to check if it belongs to a user from a disabled auth provider or a user who's access was previously removed from the auth provider (when the auth provider is still enabled and is or was configured to use access level scopes, as mentioned above). The identified tokens can be removed with <code>kubectl delete tokens &lt;token_name&gt;</code>.</p>
<p>It is important to mention that this workaround must be done every time an auth provider is disabled in case you cannot update to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions. After updating to a patched version, it is highly recommended to review the existing tokens and remove tokens related to disabled auth providers as described above in the workaround section.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9">https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9</a></li>
<li><a href="https://github.com/advisories/GHSA-c45c-39f6-6gw9">https://github.com/advisories/GHSA-c45c-39f6-6gw9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c45c-39f6-6gw9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:38:13.000Z</published>
    </entry>
</feed>