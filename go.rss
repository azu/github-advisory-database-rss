<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-10-18T11:01:23.059Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana privilege escalation vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-fw9c-75hh-89p6</id>
        <link href="https://github.com/advisories/GHSA-fw9c-75hh-89p6"/>
        <updated>2023-10-17T20:23:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana is an open-source platform for monitoring and observability. The vulnerability impacts instances with several organizations, and allows a user with Organization Admin permissions in one organization to change the permissions associated with Organization Viewer, Organization Editor and Organization Admin roles in all organizations.</p>
<p>It also allows an Organization Admin to assign or revoke any permissions that they have to any user globally.</p>
<p>This means that any Organization Admin can elevate their own permissions in any organization that they are already a member of, or elevate or restrict the permissions of any other user.</p>
<p>The vulnerability does not allow a user to become a member of an organization that they are not already a member of, or to add any other users to an organization that the current user is not a member of.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-4822">https://nvd.nist.gov/vuln/detail/CVE-2023-4822</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2023-4822">https://grafana.com/security/security-advisories/cve-2023-4822</a></li>
<li><a href="https://github.com/advisories/GHSA-fw9c-75hh-89p6">https://github.com/advisories/GHSA-fw9c-75hh-89p6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fw9c-75hh-89p6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-16T09:30:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/consensys/gnark] Plonk verifier KZG multi point verification]]></title>
        <id>https://github.com/advisories/GHSA-7p92-x423-vwj6</id>
        <link href="https://github.com/advisories/GHSA-7p92-x423-vwj6"/>
        <updated>2023-10-17T14:24:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The vulnerability allows a third party to derive a valid proof from a valid initial tuple {proof, public_inputs}, corresponding to the same public inputs as the initial proof. It is due to a randomness being generated using a small part of the scratch memory describing the state, allowing for degrees of freedom in the transcript.</p>
<p>Note that the impact is limited to the PlonK verifier smart contract.</p>
<h3 id="patches">Patches</h3>
<p>We still use a hash function on some data to have a pseudo rng, but instead of hashing the first 32 bytes of the state (
<code> let random := mod(keccak256(state, 0x20), r_mod)</code> )</p>
<p>we hash the whole state at this point of the verifier as if it was a Fiat Shamir transcript:</p>
<pre><code>        mstore(mPtr, mload(add(state, STATE_FOLDED_DIGESTS_X)))
        mstore(add(mPtr, 0x20), mload(add(state, STATE_FOLDED_DIGESTS_Y)))
        mstore(add(mPtr, 0x40), calldataload(add(aproof, PROOF_BATCH_OPENING_AT_ZETA_X)))
        mstore(add(mPtr, 0x60), calldataload(add(aproof, PROOF_BATCH_OPENING_AT_ZETA_Y)))
        mstore(add(mPtr, 0x80), calldataload(add(aproof, PROOF_GRAND_PRODUCT_COMMITMENT_X)))
        mstore(add(mPtr, 0xa0), calldataload(add(aproof, PROOF_GRAND_PRODUCT_COMMITMENT_Y)))
        mstore(add(mPtr, 0xc0), calldataload(add(aproof, PROOF_OPENING_AT_ZETA_OMEGA_X)))
        mstore(add(mPtr, 0xe0), calldataload(add(aproof, PROOF_OPENING_AT_ZETA_OMEGA_Y)))
        mstore(add(mPtr, 0x100), mload(add(state, STATE_ZETA)))
        mstore(add(mPtr, 0x120), mload(add(state, STATE_GAMMA_KZG)))
        let random := staticcall(gas(), 0x2, mPtr, 0x140, mPtr, 0x20)
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>In the function <code>batch_verify_multi_points</code>, the variable <code>random</code> (corresponding to <code>u</code> in the paper, step 12 of the <a href="https://eprint.iacr.org/2019/953.pdf">plonk</a> verification process) should depend on <code>state_folded_digests_x</code>, <code>state_folded_digests_y</code>, <code>proof_grand_product_commitment_x</code>, <code>proof_grand_product_commitment_y</code> and <code>state_zeta</code> (by hashing those values for instance).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Consensys/gnark/security/advisories/GHSA-7p92-x423-vwj6">https://github.com/Consensys/gnark/security/advisories/GHSA-7p92-x423-vwj6</a></li>
<li><a href="https://github.com/advisories/GHSA-7p92-x423-vwj6">https://github.com/advisories/GHSA-7p92-x423-vwj6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7p92-x423-vwj6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-10-17T14:24:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crewjam/saml] Cross-site Scripting via missing Binding syntax validation]]></title>
        <id>https://github.com/advisories/GHSA-267v-3v32-g6q5</id>
        <link href="https://github.com/advisories/GHSA-267v-3v32-g6q5"/>
        <updated>2023-10-17T14:20:59.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The package does not validate the ACS Location URI according to the SAML binding being parsed.</p>
<p>If abused, this flaw allows attackers to register malicious Service Providers at the IdP and inject Javascript in the ACS endpoint definition, achieving Cross-Site-Scripting (XSS) in the IdP context during the redirection at the end of a SAML SSO Flow.</p>
<p>Consequently, an attacker may perform any authenticated action as the victim once the victim’s browser loaded the SAML IdP initiated SSO link for the malicious service provider.</p>
<p>Note: The severity is considered “High” because the SP registration is commonly an unrestricted operation in IdPs, hence not requiring particular permissions or publicly accessible to ease the IdP interoperability.</p>
<h3 id="patches">Patches</h3>
<p>This issue is fixed in 0.4.14</p>
<h3 id="workarounds">Workarounds</h3>
<p>Users of the package can perform external validation of URLs provided in SAML metadata, or restrict the ability for end-users to upload arbitrary metadata. </p>
<h3 id="references">References</h3>
<p>This issue was reported by Francesco Lacerenza from Doyensec</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/crewjam/saml/security/advisories/GHSA-267v-3v32-g6q5">https://github.com/crewjam/saml/security/advisories/GHSA-267v-3v32-g6q5</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45683">https://nvd.nist.gov/vuln/detail/CVE-2023-45683</a></li>
<li><a href="https://github.com/crewjam/saml/commit/b07b16cf83c4171d16da4d85608cb827f183cd79">https://github.com/crewjam/saml/commit/b07b16cf83c4171d16da4d85608cb827f183cd79</a></li>
<li><a href="https://github.com/advisories/GHSA-267v-3v32-g6q5">https://github.com/advisories/GHSA-267v-3v32-g6q5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-267v-3v32-g6q5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T14:20:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kumahq/kuma] github.com/kumahq/kuma affected by CVE-2023-44487]]></title>
        <id>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</id>
        <link href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv"/>
        <updated>2023-10-17T12:41:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Envoy and Go HTTP/2 protocol stack is vulnerable to the "Rapid Reset" class of exploits, which send a sequence of HEADERS frames optionally followed by RST_STREAM frames.</p>
<p>This can be exercised if you use the builtin gateway and receive untrusted http2 traffic.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a>
<a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a>
<a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Disable http2 on the gateway listener with a MeshProxyPatch or ProxyTemplate.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">https://github.com/advisories/GHSA-qppj-fm5r-hxr3</a>
<a href="https://github.com/golang/go/issues/63417">https://github.com/golang/go/issues/63417</a>
<a href="https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76">https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76</a>
<a href="https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack">https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack</a>
<a href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1">https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1</a>
<a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge">https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></li>
<li><a href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/advisories/GHSA-9wmc-rg4h-28wv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kumahq/kuma] github.com/kumahq/kuma affected by CVE-2023-44487]]></title>
        <id>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</id>
        <link href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv"/>
        <updated>2023-10-17T12:41:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Envoy and Go HTTP/2 protocol stack is vulnerable to the "Rapid Reset" class of exploits, which send a sequence of HEADERS frames optionally followed by RST_STREAM frames.</p>
<p>This can be exercised if you use the builtin gateway and receive untrusted http2 traffic.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a>
<a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a>
<a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Disable http2 on the gateway listener with a MeshProxyPatch or ProxyTemplate.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">https://github.com/advisories/GHSA-qppj-fm5r-hxr3</a>
<a href="https://github.com/golang/go/issues/63417">https://github.com/golang/go/issues/63417</a>
<a href="https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76">https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76</a>
<a href="https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack">https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack</a>
<a href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1">https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1</a>
<a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge">https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></li>
<li><a href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/advisories/GHSA-9wmc-rg4h-28wv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kumahq/kuma] github.com/kumahq/kuma affected by CVE-2023-44487]]></title>
        <id>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</id>
        <link href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv"/>
        <updated>2023-10-17T12:41:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Envoy and Go HTTP/2 protocol stack is vulnerable to the "Rapid Reset" class of exploits, which send a sequence of HEADERS frames optionally followed by RST_STREAM frames.</p>
<p>This can be exercised if you use the builtin gateway and receive untrusted http2 traffic.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a>
<a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a>
<a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Disable http2 on the gateway listener with a MeshProxyPatch or ProxyTemplate.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">https://github.com/advisories/GHSA-qppj-fm5r-hxr3</a>
<a href="https://github.com/golang/go/issues/63417">https://github.com/golang/go/issues/63417</a>
<a href="https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76">https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76</a>
<a href="https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack">https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack</a>
<a href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1">https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1</a>
<a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge">https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></li>
<li><a href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/advisories/GHSA-9wmc-rg4h-28wv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kumahq/kuma] github.com/kumahq/kuma affected by CVE-2023-44487]]></title>
        <id>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</id>
        <link href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv"/>
        <updated>2023-10-17T12:41:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Envoy and Go HTTP/2 protocol stack is vulnerable to the "Rapid Reset" class of exploits, which send a sequence of HEADERS frames optionally followed by RST_STREAM frames.</p>
<p>This can be exercised if you use the builtin gateway and receive untrusted http2 traffic.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a>
<a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a>
<a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Disable http2 on the gateway listener with a MeshProxyPatch or ProxyTemplate.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">https://github.com/advisories/GHSA-qppj-fm5r-hxr3</a>
<a href="https://github.com/golang/go/issues/63417">https://github.com/golang/go/issues/63417</a>
<a href="https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76">https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76</a>
<a href="https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack">https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack</a>
<a href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1">https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1</a>
<a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge">https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></li>
<li><a href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/advisories/GHSA-9wmc-rg4h-28wv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kumahq/kuma] github.com/kumahq/kuma affected by CVE-2023-44487]]></title>
        <id>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</id>
        <link href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv"/>
        <updated>2023-10-17T12:41:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Envoy and Go HTTP/2 protocol stack is vulnerable to the "Rapid Reset" class of exploits, which send a sequence of HEADERS frames optionally followed by RST_STREAM frames.</p>
<p>This can be exercised if you use the builtin gateway and receive untrusted http2 traffic.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a>
<a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a>
<a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Disable http2 on the gateway listener with a MeshProxyPatch or ProxyTemplate.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/advisories/GHSA-qppj-fm5r-hxr3">https://github.com/advisories/GHSA-qppj-fm5r-hxr3</a>
<a href="https://github.com/golang/go/issues/63417">https://github.com/golang/go/issues/63417</a>
<a href="https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76">https://github.com/envoyproxy/envoy/security/advisories/GHSA-jhv4-f7mr-xx76</a>
<a href="https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack">https://cloud.google.com/blog/products/identity-security/how-it-works-the-novel-http2-rapid-reset-ddos-attack</a>
<a href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1">https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/?sf269548684=1</a>
<a href="https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge">https://www.envoyproxy.io/docs/envoy/latest/configuration/best_practices/edge</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/kumahq/kuma/security/advisories/GHSA-9wmc-rg4h-28wv</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8001">https://github.com/kumahq/kuma/pull/8001</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8023">https://github.com/kumahq/kuma/pull/8023</a></li>
<li><a href="https://github.com/kumahq/kuma/pull/8034">https://github.com/kumahq/kuma/pull/8034</a></li>
<li><a href="https://github.com/advisories/GHSA-9wmc-rg4h-28wv">https://github.com/advisories/GHSA-9wmc-rg4h-28wv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9wmc-rg4h-28wv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/gofiber/fiber/v2] Go Fiber CSRF Token Validation Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-mv73-f69x-444p</id>
        <link href="https://github.com/advisories/GHSA-mv73-f69x-444p"/>
        <updated>2023-10-17T12:41:09.000Z</updated>
        <content type="html"><![CDATA[<p>A Cross-Site Request Forgery (CSRF) vulnerability has been identified in the application, which allows an attacker to obtain tokens and forge malicious requests on behalf of a user. This can lead to unauthorized actions being taken on the user's behalf, potentially compromising the security and integrity of the application.</p>
<h2 id="vulnerability-details">Vulnerability Details</h2>
<p>The vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. The following issues were identified:</p>
<ol>
<li><strong>Lack of Token Association</strong>: The CSRF token was validated against tokens in storage but was not tied to the original requestor that generated it, allowing for token reuse.</li>
</ol>
<h3 id="specific-go-packages-affected">Specific Go Packages Affected</h3>
<p>github.com/gofiber/fiber/v2/middleware/csrf</p>
<h2 id="remediation">Remediation</h2>
<p>To remediate this vulnerability, it is recommended to take the following actions:</p>
<ol>
<li><p><strong>Update the Application</strong>: Upgrade the application to a fixed version with a patch for the vulnerability.</p>
</li>
<li><p><strong>Implement Proper CSRF Protection</strong>: Review the updated documentation and ensure your application's CSRF protection mechanisms follow best practices.</p>
</li>
<li><p><strong>Choose CSRF Protection Method</strong>: Select the appropriate CSRF protection method based on your application's requirements, either the Double Submit Cookie method or the Synchronizer Token Pattern using sessions.</p>
</li>
<li><p><strong>Security Testing</strong>: Conduct a thorough security assessment, including penetration testing, to identify and address any other security vulnerabilities.</p>
</li>
</ol>
<h2 id="defence-in-depth">Defence-in-depth</h2>
<p>Users should take additional security measures like captchas or Two-Factor Authentication (2FA) and set Session cookies with SameSite=Lax or SameSite=Secure, and the Secure and HttpOnly attributes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/gofiber/fiber/security/advisories/GHSA-mv73-f69x-444p">https://github.com/gofiber/fiber/security/advisories/GHSA-mv73-f69x-444p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45141">https://nvd.nist.gov/vuln/detail/CVE-2023-45141</a></li>
<li><a href="https://github.com/advisories/GHSA-mv73-f69x-444p">https://github.com/advisories/GHSA-mv73-f69x-444p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mv73-f69x-444p</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-17T12:41:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/gofiber/fiber/v2] CSRF Token Reuse Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-94w9-97p3-p368</id>
        <link href="https://github.com/advisories/GHSA-94w9-97p3-p368"/>
        <updated>2023-10-17T12:40:38.000Z</updated>
        <content type="html"><![CDATA[<p>A Cross-Site Request Forgery (CSRF) vulnerability has been identified in the application, which allows an attacker to inject arbitrary values and forge malicious requests on behalf of a user. This vulnerability can allow an attacker to inject arbitrary values without any authentication, or perform various malicious actions on behalf of an authenticated user, potentially compromising the security and integrity of the application.</p>
<h2 id="vulnerability-details">Vulnerability Details</h2>
<p>The vulnerability is caused by improper validation and enforcement of CSRF tokens within the application. The following issues were identified:</p>
<ol>
<li><p><strong>Token Injection</strong>: For 'safe' methods, the token was extracted from the cookie and saved to storage without further validation or sanitization.</p>
</li>
<li><p><strong>Lack of Token Association</strong>: The CSRF token was validated against tokens in storage but not associated with a session, nor by using a Double Submit Cookie Method, allowing for token reuse.</p>
</li>
</ol>
<h3 id="specific-go-packages-affected">Specific Go Packages Affected</h3>
<p>github.com/gofiber/fiber/v2/middleware/csrf</p>
<h2 id="remediation">Remediation</h2>
<p>To remediate this vulnerability, it is recommended to take the following actions:</p>
<ol>
<li><p><strong>Update the Application</strong>: Upgrade the application to a fixed version with a patch for the vulnerability.</p>
</li>
<li><p><strong>Implement Proper CSRF Protection</strong>: Review the updated documentation and ensure your application's CSRF protection mechanisms follow best practices.</p>
</li>
<li><p><strong>Choose CSRF Protection Method</strong>: Select the appropriate CSRF protection method based on your application's requirements, either the Double Submit Cookie method or the Synchronizer Token Pattern using sessions.</p>
</li>
<li><p><strong>Security Testing</strong>: Conduct a thorough security assessment, including penetration testing, to identify and address any other security vulnerabilities.</p>
</li>
</ol>
<h2 id="defence-in-depth">Defence-in-depth</h2>
<p>Users should take additional security measures like captchas or Two-Factor Authentication (2FA) and set Session cookies with SameSite=Lax or SameSite=Secure, and the Secure and HttpOnly attributes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/gofiber/fiber/security/advisories/GHSA-94w9-97p3-p368">https://github.com/gofiber/fiber/security/advisories/GHSA-94w9-97p3-p368</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45128">https://nvd.nist.gov/vuln/detail/CVE-2023-45128</a></li>
<li><a href="https://github.com/gofiber/fiber/commit/8c3916dbf4ad2ed427d02c6eb63ae8b2fa8f019a">https://github.com/gofiber/fiber/commit/8c3916dbf4ad2ed427d02c6eb63ae8b2fa8f019a</a></li>
<li><a href="https://github.com/advisories/GHSA-94w9-97p3-p368">https://github.com/advisories/GHSA-94w9-97p3-p368</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-94w9-97p3-p368</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-10-17T12:40:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik] Traefik vulnerable to HTTP/2 request causing denial of service ]]></title>
        <id>https://github.com/advisories/GHSA-7v4p-328v-8v5g</id>
        <link href="https://github.com/advisories/GHSA-7v4p-328v-8v5g"/>
        <updated>2023-10-17T02:37:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability CVE-2023-39325 exists in <a href="https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1">Go managing HTTP/2 requests</a>, which impacts Traefik. This vulnerability could be exploited to cause a denial of service.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-44487">CVE-2023-44487</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-39325">CVE-2023-39325</a></li>
</ul>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.10.5">https://github.com/traefik/traefik/releases/tag/v2.10.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.0-beta4">https://github.com/traefik/traefik/releases/tag/v3.0.0-beta4</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-7v4p-328v-8v5g">https://github.com/traefik/traefik/security/advisories/GHSA-7v4p-328v-8v5g</a></li>
<li><a href="https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1">https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1</a></li>
<li><a href="https://github.com/advisories/GHSA-7v4p-328v-8v5g">https://github.com/advisories/GHSA-7v4p-328v-8v5g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v4p-328v-8v5g</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-17T02:37:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik] Traefik vulnerable to HTTP/2 request causing denial of service ]]></title>
        <id>https://github.com/advisories/GHSA-7v4p-328v-8v5g</id>
        <link href="https://github.com/advisories/GHSA-7v4p-328v-8v5g"/>
        <updated>2023-10-17T02:37:43.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability CVE-2023-39325 exists in <a href="https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1">Go managing HTTP/2 requests</a>, which impacts Traefik. This vulnerability could be exploited to cause a denial of service.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-44487">CVE-2023-44487</a></li>
<li><a href="https://www.cve.org/CVERecord?id=CVE-2023-39325">CVE-2023-39325</a></li>
</ul>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.10.5">https://github.com/traefik/traefik/releases/tag/v2.10.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.0-beta4">https://github.com/traefik/traefik/releases/tag/v3.0.0-beta4</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-7v4p-328v-8v5g">https://github.com/traefik/traefik/security/advisories/GHSA-7v4p-328v-8v5g</a></li>
<li><a href="https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1">https://groups.google.com/g/golang-announce/c/iNNxDTCjZvo/m/UDd7VKQuAAAJ?pli=1</a></li>
<li><a href="https://github.com/advisories/GHSA-7v4p-328v-8v5g">https://github.com/advisories/GHSA-7v4p-328v-8v5g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v4p-328v-8v5g</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-17T02:37:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/net/http/httptrace/otelhttptrace] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/gopkg.in/macaron.v1/otelmacaron] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/github.com/labstack/echo/otelecho] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/github.com/gorilla/mux/otelmux] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/github.com/gin-gonic/gin/otelgin] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/github.com/emicklei/go-restful/otelrestful] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp] OpenTelemetry-Go Contrib vulnerable to denial of service in otelhttp due to unbound cardinality metrics]]></title>
        <id>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</id>
        <link href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr"/>
        <updated>2023-10-16T22:32:30.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>OpenTelemetry-Go Contrib has a <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">handler wrapper <code>otelhttp</code></a> that adds the following labels by deafult that have unbound cardinality:</p>
<ul>
<li><code>http.user_agent</code></li>
<li><code>http.method</code></li>
</ul>
<p>This leads to the server's potential memory exhaustion when many malicious requests are sent to it.</p>
<h3 id="details">Details</h3>
<p>HTTP header User-Agent or HTTP method for requests can be easily set by an attacker to be random and long. The library internally uses <a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">httpconv.ServerRequest</a> that records every value for HTTP <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L204">method</a> and <a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">User-Agent</a>.</p>
<p><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">This pull request</a> released with version 0.44.0 dixes this vulnerability The values collected for attribute <code>http.request.method</code> were changed to be restricted to a set of well-known values and other high cardinality attributes were removed.</p>
<h3 id="impact">Impact</h3>
<p>In order to be affected program has to use <a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">otelhttp.NewHandler</a> wrapper and does not filter any unknown HTTP methods or User agents on the level of CDN, LB, previous middleware, etc.</p>
<h3 id="others">Others</h3>
<p>This vulnerability is similar but different from these known vulnerabilities:</p>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a> (<a href="https://github.com/open-telemetry/opentelemetry-go-contrib">open-telemetry/opentelemetry-go-contrib</a>)</li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a> (<a href="https://github.com/prometheus/client_golang">prometheus/client_golang</a>)</li>
</ul>
<h3 id="workaround-for-affected-versions">Workaround for affected versions</h3>
<p>As a workaround, <a href="https://pkg.go.dev/go.opentelemetry.io/contrib/instrumentation/net/http/otelhttp/filters">otelhttp.WithFilter()</a> can be used instead, but it requires manual careful configuration to not log certain requests entirely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-5r5m-65gx-7vrh</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/open-telemetry/opentelemetry-go-contrib/security/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-45142">https://nvd.nist.gov/vuln/detail/CVE-2023-45142</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277">https://github.com/open-telemetry/opentelemetry-go-contrib/pull/4277</a></li>
<li><a href="https://github.com/advisories/GHSA-cg3q-j54f-5p7p">https://github.com/advisories/GHSA-cg3q-j54f-5p7p</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65">https://github.com/open-telemetry/opentelemetry-go-contrib/blob/5f7e6ad5a49b45df45f61a1deb29d7f1158032df/instrumentation/net/http/otelhttp/handler.go#L63-L65</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0">https://github.com/open-telemetry/opentelemetry-go-contrib/releases/tag/v1.19.0</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223">https://github.com/open-telemetry/opentelemetry-go/blob/38e1b499c3da3107694ad2660b3888eee9c8b896/semconv/internal/v2/http.go#L223</a></li>
<li><a href="https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159">https://github.com/open-telemetry/opentelemetry-go/blob/v1.12.0/semconv/internal/v2/http.go#L159</a></li>
<li><a href="https://github.com/advisories/GHSA-rcjv-mgp8-qvmr">https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rcjv-mgp8-qvmr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-16T14:01:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/sylabs/singularity] Sylabs Singularity Improper Input Validation]]></title>
        <id>https://github.com/advisories/GHSA-p83v-8vmr-qfv9</id>
        <link href="https://github.com/advisories/GHSA-p83v-8vmr-qfv9"/>
        <updated>2023-10-15T05:03:41.000Z</updated>
        <content type="html"><![CDATA[<p>Sylabs Singularity 2.4 to 2.6 allows local users to conduct Improper Input Validation attacks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-19295">https://nvd.nist.gov/vuln/detail/CVE-2018-19295</a></li>
<li><a href="https://github.com/sylabs/singularity/releases/tag/2.6.1">https://github.com/sylabs/singularity/releases/tag/2.6.1</a></li>
<li><a href="https://github.com/sylabs/singularity/commit/9103f0155259fdf1159277bca3c2d347571cba0d">https://github.com/sylabs/singularity/commit/9103f0155259fdf1159277bca3c2d347571cba0d</a></li>
<li><a href="https://github.com/advisories/GHSA-p83v-8vmr-qfv9">https://github.com/advisories/GHSA-p83v-8vmr-qfv9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p83v-8vmr-qfv9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-14T01:39:14.000Z</published>
    </entry>
</feed>