<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-04-06T01:29:21.156Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/studygolang/studygolang] studygolang vulnerable to cross-site scripting]]></title>
        <id>https://github.com/advisories/GHSA-gw62-c7w4-x449</id>
        <link href="https://github.com/advisories/GHSA-gw62-c7w4-x449"/>
        <updated>2023-04-05T23:17:46.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability classified as problematic has been found in studygolang. This affects an unknown part of the file static/js/topics.js. The manipulation of the argument contentHtml leads to cross site scripting. It is possible to initiate the attack remotely. The name of the patch is 0fb30f9640bd5fa0cae58922eac6c00bb1a94391. It is recommended to apply a patch to fix this issue. The identifier VDB-216477 was assigned to this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4272">https://nvd.nist.gov/vuln/detail/CVE-2021-4272</a></li>
<li><a href="https://github.com/studygolang/studygolang/commit/0fb30f9640bd5fa0cae58922eac6c00bb1a94391">https://github.com/studygolang/studygolang/commit/0fb30f9640bd5fa0cae58922eac6c00bb1a94391</a></li>
<li><a href="https://vuldb.com/?id.216477">https://vuldb.com/?id.216477</a></li>
<li><a href="https://github.com/advisories/GHSA-gw62-c7w4-x449">https://github.com/advisories/GHSA-gw62-c7w4-x449</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gw62-c7w4-x449</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-12-21T21:30:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/phachon/mm-wiki] Phachon mm-wiki vulnerable to stored cross-site scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-f7rp-xx67-4pj9</id>
        <link href="https://github.com/advisories/GHSA-f7rp-xx67-4pj9"/>
        <updated>2023-04-05T19:27:23.000Z</updated>
        <content type="html"><![CDATA[<p>Phachon mm-wiki v.0.1.2 vulnerable to stored cross-site scripting (XSS). This could allow a remote attacker to execute arbitrary code via JavaScript code in the markdown editor. Any user browsing the document containing XSS malicious code will trigger the vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-19277">https://nvd.nist.gov/vuln/detail/CVE-2020-19277</a></li>
<li><a href="https://github.com/phachon/mm-wiki/issues/68">https://github.com/phachon/mm-wiki/issues/68</a></li>
<li><a href="https://github.com/advisories/GHSA-f7rp-xx67-4pj9">https://github.com/advisories/GHSA-f7rp-xx67-4pj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f7rp-xx67-4pj9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-04T15:30:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/usememos/memos] Cross Site Scripting in usememos/memos]]></title>
        <id>https://github.com/advisories/GHSA-9w8x-5hv5-r6gw</id>
        <link href="https://github.com/advisories/GHSA-9w8x-5hv5-r6gw"/>
        <updated>2023-04-04T21:45:30.000Z</updated>
        <content type="html"><![CDATA[<p>All versions of the package github.com/usememos/memos/server prior to 0.11.0 are vulnerable to Cross-site Scripting (XSS) due to insufficient checks on external resources, which allows malicious actors to introduce links starting with a javascript: scheme.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-25978">https://nvd.nist.gov/vuln/detail/CVE-2022-25978</a></li>
<li><a href="https://github.com/usememos/memos/issues/1026">https://github.com/usememos/memos/issues/1026</a></li>
<li><a href="https://github.com/usememos/memos/commit/b11d2130a084385eb65c3761a3c841ebe9f81ae8">https://github.com/usememos/memos/commit/b11d2130a084385eb65c3761a3c841ebe9f81ae8</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMUSEMEMOSMEMOSSERVER-3319070">https://security.snyk.io/vuln/SNYK-GOLANG-GITHUBCOMUSEMEMOSMEMOSSERVER-3319070</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2023-1566">https://pkg.go.dev/vuln/GO-2023-1566</a></li>
<li><a href="https://github.com/advisories/GHSA-9w8x-5hv5-r6gw">https://github.com/advisories/GHSA-9w8x-5hv5-r6gw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9w8x-5hv5-r6gw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-02-15T06:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pion/dtls] Pion DTLS is vulnerable to panic via Hello Verify Request unmarshal]]></title>
        <id>https://github.com/advisories/GHSA-4xgv-j62q-h3rj</id>
        <link href="https://github.com/advisories/GHSA-4xgv-j62q-h3rj"/>
        <updated>2023-04-04T21:43:13.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>During the unmarshalling of a hello verify request we could try to unmarshal into too small a buffer. is could result in a panic leading the program to crash.</p>
<p>This issue could be abused to cause a denial of service.</p>
<h3 id="workaround">Workaround</h3>
<p>None, upgrade to 2.2.4</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pion/dtls/security/advisories/GHSA-4xgv-j62q-h3rj">https://github.com/pion/dtls/security/advisories/GHSA-4xgv-j62q-h3rj</a></li>
<li><a href="https://github.com/pion/dtls/commit/a50d26c5e4eed2ca87509494ffef2d2ebd22b1eb">https://github.com/pion/dtls/commit/a50d26c5e4eed2ca87509494ffef2d2ebd22b1eb</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2023-1534">https://pkg.go.dev/vuln/GO-2023-1534</a></li>
<li><a href="https://github.com/advisories/GHSA-4xgv-j62q-h3rj">https://github.com/advisories/GHSA-4xgv-j62q-h3rj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4xgv-j62q-h3rj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-02-07T18:36:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pion/dtls] Pion DTLS is vulnerable to out of bounds read via server hello]]></title>
        <id>https://github.com/advisories/GHSA-hxp2-xqf3-v83h</id>
        <link href="https://github.com/advisories/GHSA-hxp2-xqf3-v83h"/>
        <updated>2023-04-04T21:42:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When attempting to unmarshal a Server Hello request we could attempt to unmarshal into a buffer that was too small. This could result in a panic leading the program to crash.</p>
<p>This issue could be abused to cause a denial of service.</p>
<h3 id="workaround">Workaround</h3>
<p>None</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pion/dtls/security/advisories/GHSA-hxp2-xqf3-v83h">https://github.com/pion/dtls/security/advisories/GHSA-hxp2-xqf3-v83h</a></li>
<li><a href="https://github.com/pion/dtls/commit/7a14903448b70069fd9e02adf210ca23083c56d2">https://github.com/pion/dtls/commit/7a14903448b70069fd9e02adf210ca23083c56d2</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2023-1535">https://pkg.go.dev/vuln/GO-2023-1535</a></li>
<li><a href="https://github.com/advisories/GHSA-hxp2-xqf3-v83h">https://github.com/advisories/GHSA-hxp2-xqf3-v83h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hxp2-xqf3-v83h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-02-07T18:24:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/crossplane/crossplane-runtime] fieldpath's Paved.SetValue allows growing arrays up to arbitrary sizes in crossplane-runtime]]></title>
        <id>https://github.com/advisories/GHSA-vfvj-3m3g-m532</id>
        <link href="https://github.com/advisories/GHSA-vfvj-3m3g-m532"/>
        <updated>2023-04-04T21:35:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Fuzz testing on <code>crossplane/crossplane</code>, by Ada Logics and sponsored by the CNCF, identified input to a function in the <code>fieldpath</code> package that can cause an out of memory panic. Applications that use the <code>Paved</code> type's <code>SetValue</code> method with user provided input without proper validation might use excessive amounts of memory and cause an out of memory panic.</p>
<h3 id="details">Details</h3>
<p>In the <code>fieldpath</code> package, the <code>SetValue</code> method of the <code>Paved</code> type sets a value on the inner object according to the provided path, without validating it first. This allows setting values in slices at any specific index and the code will grow the target array up to the required size. The index is currently capped at max uint32 (4294967295) given how indexes are parsed,  but that is still an unnecessarily large value.</p>
<h3 id="workaround">Workaround</h3>
<p>Users can parse and validate the path before passing it to the <code>SetValue</code> method of the <code>Paved</code> type, constraining the index size as deemed appropriate.</p>
<h3 id="credits">Credits</h3>
<p>Disclosed by Ada Logics in a fuzzing audit sponsored by CNCF.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/crossplane/crossplane-runtime/security/advisories/GHSA-vfvj-3m3g-m532">https://github.com/crossplane/crossplane-runtime/security/advisories/GHSA-vfvj-3m3g-m532</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-27483">https://nvd.nist.gov/vuln/detail/CVE-2023-27483</a></li>
<li><a href="https://github.com/crossplane/crossplane-runtime/commit/53508a9f4374604db140dd8ab2fa52276441e738">https://github.com/crossplane/crossplane-runtime/commit/53508a9f4374604db140dd8ab2fa52276441e738</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2023-1623">https://pkg.go.dev/vuln/GO-2023-1623</a></li>
<li><a href="https://github.com/crossplane/crossplane-runtime/commit/f67177024d906aaf5e13ee7cd470b4e87a9fef40">https://github.com/crossplane/crossplane-runtime/commit/f67177024d906aaf5e13ee7cd470b4e87a9fef40</a></li>
<li><a href="https://github.com/advisories/GHSA-vfvj-3m3g-m532">https://github.com/advisories/GHSA-vfvj-3m3g-m532</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vfvj-3m3g-m532</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-03-13T20:53:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network may be unauthenticated]]></title>
        <id>https://github.com/advisories/GHSA-232p-vwff-86mp</id>
        <link href="https://github.com/advisories/GHSA-232p-vwff-86mp"/>
        <updated>2023-04-05T23:16:24.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p><a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L230-L234">Two iptables rules</a> serve to filter incoming VXLAN datagrams with a VNI that corresponds to an encrypted network and discards unencrypted datagrams. The rules are appended to the end of the <code>INPUT</code> filter chain, following any rules that have been previously set by the system administrator. Administrator-set rules take precedence over the rules Moby sets to discard unencrypted VXLAN datagrams, which can potentially admit unencrypted datagrams that should have been discarded.</p>
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:</p>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></li>
</ul>
<p>These rules are not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks on affected configurations silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams.</p>
<p>The injection of arbitrary Ethernet frames can enable a Denial of Service attack. A sophisticated attacker may be able to establish a UDP or TCP connection by way of the container’s outbound gateway that would otherwise be blocked by a stateful firewall, or carry out other escalations beyond simple injection by smuggling packets into the overlay network.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>Close the VXLAN port (by default, UDP port 4789) to incoming traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) to prevent all VXLAN packet injection.</li>
<li>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li><a href="https://github.com/moby/moby/issues/43382">#43382</a> partially discussed this concern, but did not consider the security implications.</li>
<li>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</li>
<li><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://github.com/moby/moby/issues/43382">https://github.com/moby/moby/issues/43382</a></li>
<li><a href="https://github.com/moby/moby/pull/45118">https://github.com/moby/moby/pull/45118</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28840">https://nvd.nist.gov/vuln/detail/CVE-2023-28840</a></li>
<li><a href="https://github.com/advisories/GHSA-232p-vwff-86mp">https://github.com/advisories/GHSA-232p-vwff-86mp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-232p-vwff-86mp</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-04-04T21:13:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network may be unauthenticated]]></title>
        <id>https://github.com/advisories/GHSA-232p-vwff-86mp</id>
        <link href="https://github.com/advisories/GHSA-232p-vwff-86mp"/>
        <updated>2023-04-05T23:16:24.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p><a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L230-L234">Two iptables rules</a> serve to filter incoming VXLAN datagrams with a VNI that corresponds to an encrypted network and discards unencrypted datagrams. The rules are appended to the end of the <code>INPUT</code> filter chain, following any rules that have been previously set by the system administrator. Administrator-set rules take precedence over the rules Moby sets to discard unencrypted VXLAN datagrams, which can potentially admit unencrypted datagrams that should have been discarded.</p>
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:</p>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></li>
</ul>
<p>These rules are not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks on affected configurations silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams.</p>
<p>The injection of arbitrary Ethernet frames can enable a Denial of Service attack. A sophisticated attacker may be able to establish a UDP or TCP connection by way of the container’s outbound gateway that would otherwise be blocked by a stateful firewall, or carry out other escalations beyond simple injection by smuggling packets into the overlay network.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>Close the VXLAN port (by default, UDP port 4789) to incoming traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) to prevent all VXLAN packet injection.</li>
<li>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li><a href="https://github.com/moby/moby/issues/43382">#43382</a> partially discussed this concern, but did not consider the security implications.</li>
<li>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</li>
<li><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://github.com/moby/moby/issues/43382">https://github.com/moby/moby/issues/43382</a></li>
<li><a href="https://github.com/moby/moby/pull/45118">https://github.com/moby/moby/pull/45118</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28840">https://nvd.nist.gov/vuln/detail/CVE-2023-28840</a></li>
<li><a href="https://github.com/advisories/GHSA-232p-vwff-86mp">https://github.com/advisories/GHSA-232p-vwff-86mp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-232p-vwff-86mp</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-04-04T21:13:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network traffic may be unencrypted]]></title>
        <id>https://github.com/advisories/GHSA-33pg-m6jh-5237</id>
        <link href="https://github.com/advisories/GHSA-33pg-m6jh-5237"/>
        <updated>2023-04-05T23:16:54.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p>An <a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207">iptables rule</a> designates outgoing VXLAN datagrams with a VNI that corresponds to an encrypted overlay network for IPsec encapsulation.</p>
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:</p>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></li>
</ul>
<p>This rule is not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks on affected platforms silently transmit unencrypted data. As a result, <code>overlay</code> networks may appear to be functional, passing traffic as expected, but without any of the expected confidentiality or data integrity guarantees.</p>
<p>It is possible for an attacker sitting in a trusted position on the network to read all of the application traffic that is moving across the overlay network, resulting in unexpected secrets or user data disclosure. Thus, because many database protocols, internal APIs, etc. are not protected by a second layer of encryption, a user may rely on Swarm encrypted overlay networks to provide confidentiality, which due to this vulnerability is no longer guaranteed.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>Close the VXLAN port (by default, UDP port 4789) to outgoing traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) in order to prevent unintentionally leaking unencrypted traffic over the Internet.</li>
<li>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li><a href="https://github.com/moby/moby/issues/43382">#43382 </a>partially discussed this concern, but did not consider the security implications.</li>
<li>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</li>
<li><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://github.com/moby/moby/issues/43382">https://github.com/moby/moby/issues/43382</a></li>
<li><a href="https://github.com/moby/moby/pull/45118">https://github.com/moby/moby/pull/45118</a></li>
<li><a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207">https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28841">https://nvd.nist.gov/vuln/detail/CVE-2023-28841</a></li>
<li><a href="https://github.com/advisories/GHSA-33pg-m6jh-5237">https://github.com/advisories/GHSA-33pg-m6jh-5237</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-33pg-m6jh-5237</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-04T21:12:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network traffic may be unencrypted]]></title>
        <id>https://github.com/advisories/GHSA-33pg-m6jh-5237</id>
        <link href="https://github.com/advisories/GHSA-33pg-m6jh-5237"/>
        <updated>2023-04-05T23:16:54.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p>An <a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207">iptables rule</a> designates outgoing VXLAN datagrams with a VNI that corresponds to an encrypted overlay network for IPsec encapsulation.</p>
<p>On Red Hat Enterprise Linux and derivatives such as CentOS and Rocky, the <code>xt_u32</code> module has been:</p>
<ul>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.3_release_notes/rhel-8-3-0-release#technology-preview_networking">moved to the kernel-modules-extra package and no longer installed by default in RHEL 8.3</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/8.6_release_notes/deprecated_functionality#deprecated-functionality_networking">officially deprecated in RHEL 8.6</a></li>
<li><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/9/html/considerations_in_adopting_rhel_9/assembly_networking_considerations-in-adopting-rhel-9#ref_firewall-networking_assembly_networking">removed completely in RHEL 9</a></li>
</ul>
<p>This rule is not created when <code>xt_u32</code> is unavailable, even though the container is still attached to the network.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks on affected platforms silently transmit unencrypted data. As a result, <code>overlay</code> networks may appear to be functional, passing traffic as expected, but without any of the expected confidentiality or data integrity guarantees.</p>
<p>It is possible for an attacker sitting in a trusted position on the network to read all of the application traffic that is moving across the overlay network, resulting in unexpected secrets or user data disclosure. Thus, because many database protocols, internal APIs, etc. are not protected by a second layer of encryption, a user may rely on Swarm encrypted overlay networks to provide confidentiality, which due to this vulnerability is no longer guaranteed.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>Close the VXLAN port (by default, UDP port 4789) to outgoing traffic at the Internet boundary (see <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a>) in order to prevent unintentionally leaking unencrypted traffic over the Internet.</li>
<li>Ensure that the <code>xt_u32</code> kernel module is available on all nodes of the Swarm cluster.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li><a href="https://github.com/moby/moby/issues/43382">#43382 </a>partially discussed this concern, but did not consider the security implications.</li>
<li>Mirantis FIELD-5788 essentially duplicates <a href="https://github.com/moby/moby/issues/43382">#43382</a>, and was created six months earlier; it similarly overlooked the security implications.</li>
<li><a href="https://github.com/moby/moby/pull/45118">#45118</a> is the ancestor of the final patches, and was where the security implications were discovered.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">CVE-2023-28842: Encrypted overlay network with a single endpoint is unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://github.com/moby/moby/issues/43382">https://github.com/moby/moby/issues/43382</a></li>
<li><a href="https://github.com/moby/moby/pull/45118">https://github.com/moby/moby/pull/45118</a></li>
<li><a href="https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207">https://github.com/moby/libnetwork/blob/d9fae4c73daf76c3b0f77e14b45b8bf612ba764d/drivers/overlay/encryption.go#L205-L207</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28841">https://nvd.nist.gov/vuln/detail/CVE-2023-28841</a></li>
<li><a href="https://github.com/advisories/GHSA-33pg-m6jh-5237">https://github.com/advisories/GHSA-33pg-m6jh-5237</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-33pg-m6jh-5237</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-04T21:12:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network with a single endpoint is unauthenticated]]></title>
        <id>https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</id>
        <link href="https://github.com/advisories/GHSA-6wrf-mxfj-pf5p"/>
        <updated>2023-04-05T23:15:38.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p>The <code>overlay</code> driver dynamically and lazily defines the kernel configuration for the VXLAN network on each node as containers are attached and detached. Routes and encryption parameters are only defined for destination nodes that participate in the network. The iptables rules that prevent encrypted overlay networks from accepting unencrypted packets are not created until a peer is available with which to communicate.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams. The implications of this can be quite dire, and <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a> should be referenced for a deeper exploration.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>In multi-node clusters, deploy a global ‘pause’ container for each encrypted overlay network, on every node. For example, use the <code>registry.k8s.io/pause</code> image and a <code>--mode global</code> service.</li>
<li>For a single-node cluster, do not use overlay networks of any sort. Bridge networks provide the same connectivity on a single node and have no multi-node features.
The Swarm ingress feature is implemented using an overlay network, but can be disabled by publishing ports in <code>host</code> mode instead of <code>ingress</code> mode (allowing the use of an external load balancer), and removing the <code>ingress</code> network.</li>
<li>If encrypted overlay networks are in exclusive use, block UDP port 4789 from traffic that has not been validated by IPSec. For example, <code>iptables -A INPUT -m udp —-dport 4789 -m policy --dir in --pol none -j DROP</code>.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li>This issue was discovered while characterizing and mitigating <a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840</a> and <a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841</a>.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28842">https://nvd.nist.gov/vuln/detail/CVE-2023-28842</a></li>
<li><a href="https://github.com/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-04T21:11:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/docker/docker] Docker Swarm encrypted overlay network with a single endpoint is unauthenticated]]></title>
        <id>https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</id>
        <link href="https://github.com/advisories/GHSA-6wrf-mxfj-pf5p"/>
        <updated>2023-04-05T23:15:38.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://mobyproject.org/">Moby</a> is an open source container framework developed by Docker Inc. that is distributed as Docker, Mirantis Container Runtime, and various other downstream projects/products. The Moby daemon component (<code>dockerd</code>), which is developed as <a href="https://github.com/moby/moby">moby/moby</a> is commonly referred to as <em>Docker</em>.</p>
<p>Swarm Mode, which is compiled in and delivered by default in <code>dockerd</code> and is thus present in most major Moby downstreams, is a simple, built-in container orchestrator that is implemented through a combination of <a href="https://github.com/moby/swarmkit">SwarmKit</a> and supporting network code.</p>
<p>The <code>overlay</code> network driver is a core feature of Swarm Mode, providing isolated virtual LANs that allow communication between containers and services across the cluster. This driver is an implementation/user of <a href="https://en.wikipedia.org/wiki/Virtual_Extensible_LAN">VXLAN</a>, which encapsulates link-layer (Ethernet) frames in UDP datagrams that tag the frame with a VXLAN Network ID (VNI) that identifies the originating overlay network. In addition, the overlay network driver supports an optional, off-by-default encrypted mode, which is especially useful when VXLAN packets traverses an untrusted network between nodes.</p>
<p>Encrypted overlay networks function by encapsulating the VXLAN datagrams through the use of the <a href="https://en.wikipedia.org/wiki/IPsec#Encapsulating_Security_Payload">IPsec Encapsulating Security Payload</a> protocol in <a href="https://en.wikipedia.org/wiki/IPsec#Transport_mode">Transport mode</a>. By deploying IPSec encapsulation, encrypted overlay networks gain the additional properties of source authentication through cryptographic proof, data integrity through check-summing, and confidentiality through encryption.</p>
<p>When setting an endpoint up on an encrypted overlay network, Moby installs three <a href="https://www.netfilter.org/projects/iptables/index.html">iptables</a> (Linux kernel firewall) rules that enforce both incoming and outgoing IPSec. These rules rely on the <code>u32</code> iptables extension provided by the <code>xt_u32</code> kernel module to directly filter on a VXLAN packet's VNI field, so that IPSec guarantees can be enforced on encrypted overlay networks without interfering with other overlay networks or other users of VXLAN.</p>
<p>The <code>overlay</code> driver dynamically and lazily defines the kernel configuration for the VXLAN network on each node as containers are attached and detached. Routes and encryption parameters are only defined for destination nodes that participate in the network. The iptables rules that prevent encrypted overlay networks from accepting unencrypted packets are not created until a peer is available with which to communicate.</p>
<h2 id="impact">Impact</h2>
<p>Encrypted overlay networks silently accept cleartext VXLAN datagrams that are tagged with the VNI of an encrypted overlay network. As a result, it is possible to inject arbitrary Ethernet frames into the encrypted overlay network by encapsulating them in VXLAN datagrams. The implications of this can be quite dire, and <a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw</a> should be referenced for a deeper exploration.</p>
<h2 id="patches">Patches</h2>
<p>Patches are available in Moby releases 23.0.3, and 20.10.24. As Mirantis Container Runtime's 20.10 releases are numbered differently, users of that platform should update to 20.10.16.</p>
<h2 id="workarounds">Workarounds</h2>
<ul>
<li>In multi-node clusters, deploy a global ‘pause’ container for each encrypted overlay network, on every node. For example, use the <code>registry.k8s.io/pause</code> image and a <code>--mode global</code> service.</li>
<li>For a single-node cluster, do not use overlay networks of any sort. Bridge networks provide the same connectivity on a single node and have no multi-node features.
The Swarm ingress feature is implemented using an overlay network, but can be disabled by publishing ports in <code>host</code> mode instead of <code>ingress</code> mode (allowing the use of an external load balancer), and removing the <code>ingress</code> network.</li>
<li>If encrypted overlay networks are in exclusive use, block UDP port 4789 from traffic that has not been validated by IPSec. For example, <code>iptables -A INPUT -m udp —-dport 4789 -m policy --dir in --pol none -j DROP</code>.</li>
</ul>
<h2 id="background">Background</h2>
<ul>
<li>This issue was discovered while characterizing and mitigating <a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840</a> and <a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841</a>.</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">CVE-2023-28841: Encrypted overlay network traffic may be unencrypted</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">CVE-2023-28840: Encrypted overlay network may be unauthenticated</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">GHSA-vwm3-crmr-xfxw: The Swarm VXLAN port may be exposed to attack due to ambiguous documentation</a></li>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">GHSA-gvm4-2qqg-m333: Security issues in encrypted overlay networks</a> (libnetwork)</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333">https://github.com/moby/libnetwork/security/advisories/GHSA-gvm4-2qqg-m333</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp">https://github.com/moby/moby/security/advisories/GHSA-232p-vwff-86mp</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237">https://github.com/moby/moby/security/advisories/GHSA-33pg-m6jh-5237</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/moby/moby/security/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
<li><a href="https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw">https://github.com/moby/moby/security/advisories/GHSA-vwm3-crmr-xfxw</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28842">https://nvd.nist.gov/vuln/detail/CVE-2023-28842</a></li>
<li><a href="https://github.com/advisories/GHSA-6wrf-mxfj-pf5p">https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6wrf-mxfj-pf5p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-04T21:11:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/russellhaering/goxmldsig] gosaml2 is vulnerable to NULL Pointer Dereference]]></title>
        <id>https://github.com/advisories/GHSA-gq5r-cc4w-g8xf</id>
        <link href="https://github.com/advisories/GHSA-gq5r-cc4w-g8xf"/>
        <updated>2023-04-04T17:28:33.000Z</updated>
        <content type="html"><![CDATA[<p>This affects all versions less than 0.7.0 of package github.com/russellhaering/gosaml2. There is a crash on null pointer dereference caused by sending malformed XML signatures.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-7731">https://nvd.nist.gov/vuln/detail/CVE-2020-7731</a></li>
<li><a href="https://github.com/russellhaering/gosaml2/issues/59">https://github.com/russellhaering/gosaml2/issues/59</a></li>
<li><a href="https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMRUSSELLHAERINGGOSAML2-608302">https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMRUSSELLHAERINGGOSAML2-608302</a></li>
<li><a href="https://github.com/russellhaering/goxmldsig/issues/48">https://github.com/russellhaering/goxmldsig/issues/48</a></li>
<li><a href="https://github.com/russellhaering/gosaml2/pull/90">https://github.com/russellhaering/gosaml2/pull/90</a></li>
<li><a href="https://github.com/russellhaering/gosaml2/commit/66e3b7affd622b8b24ea1e18845f045e46b23424">https://github.com/russellhaering/gosaml2/commit/66e3b7affd622b8b24ea1e18845f045e46b23424</a></li>
<li><a href="https://github.com/russellhaering/gosaml2/releases/tag/v0.7.0">https://github.com/russellhaering/gosaml2/releases/tag/v0.7.0</a></li>
<li><a href="https://github.com/advisories/GHSA-gq5r-cc4w-g8xf">https://github.com/advisories/GHSA-gq5r-cc4w-g8xf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gq5r-cc4w-g8xf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-06-23T17:25:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cloudflare/cfrpki/cmd/octorpki] Infinite certificate chain depth results in OctoRPKI running forever]]></title>
        <id>https://github.com/advisories/GHSA-g5gj-9ggf-9vmq</id>
        <link href="https://github.com/advisories/GHSA-g5gj-9ggf-9vmq"/>
        <updated>2023-04-03T19:46:48.000Z</updated>
        <content type="html"><![CDATA[<p>OctoRPKI does not limit the depth of a certificate chain, allowing for a CA to create children in an ad-hoc fashion, thereby making tree traversal never end.</p>
<h2 id="patches">Patches</h2>
<h2 id="for-more-information">For more information</h2>
<p>If you have any questions or comments about this advisory email us at <a href="mailto:security@cloudflare.com">security@cloudflare.com</a> </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cloudflare/cfrpki/security/advisories/GHSA-g5gj-9ggf-9vmq">https://github.com/cloudflare/cfrpki/security/advisories/GHSA-g5gj-9ggf-9vmq</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-3908">https://nvd.nist.gov/vuln/detail/CVE-2021-3908</a></li>
<li><a href="https://github.com/cloudflare/cfrpki/releases/tag/v1.4.0">https://github.com/cloudflare/cfrpki/releases/tag/v1.4.0</a></li>
<li><a href="https://www.debian.org/security/2022/dsa-5041">https://www.debian.org/security/2022/dsa-5041</a></li>
<li><a href="https://github.com/advisories/GHSA-g5gj-9ggf-9vmq">https://github.com/advisories/GHSA-g5gj-9ggf-9vmq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g5gj-9ggf-9vmq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-11-10T20:38:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/couchbase/sync_gateway/db] SQL Injection in Couchbase Sync Gateway]]></title>
        <id>https://github.com/advisories/GHSA-g622-r636-qfqh</id>
        <link href="https://github.com/advisories/GHSA-g622-r636-qfqh"/>
        <updated>2023-04-03T19:42:35.000Z</updated>
        <content type="html"><![CDATA[<p>The Couchbase Sync Gateway 2.1.2 in combination with a Couchbase Server is affected by a previously undisclosed N1QL-injection vulnerability in the REST API. An attacker with access to the public REST API can insert additional N1QL statements through the parameters ?startkey? and ?endkey? of the ?_all_docs? endpoint.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-9039">https://nvd.nist.gov/vuln/detail/CVE-2019-9039</a></li>
<li><a href="https://github.com/couchbase/sync_gateway/commit/97adb5b496aa96aa70398018ea96da913ffd8d8c">https://github.com/couchbase/sync_gateway/commit/97adb5b496aa96aa70398018ea96da913ffd8d8c</a></li>
<li><a href="https://docs.couchbase.com/sync-gateway/2.5/release-notes.html">https://docs.couchbase.com/sync-gateway/2.5/release-notes.html</a></li>
<li><a href="https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/">https://research.hisolutions.com/2019/06/n1ql-injection-in-couchbase-sync-gateway-cve-2019-9039/</a></li>
<li><a href="https://www.couchbase.com/resources/security#SecurityAlerts">https://www.couchbase.com/resources/security#SecurityAlerts</a></li>
<li><a href="https://github.com/advisories/GHSA-g622-r636-qfqh">https://github.com/advisories/GHSA-g622-r636-qfqh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g622-r636-qfqh</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-02-15T01:57:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/nats-io/nats-server/v2] Incorrect Authorization in NATS nats-server]]></title>
        <id>https://github.com/advisories/GHSA-g6w6-r76c-28j7</id>
        <link href="https://github.com/advisories/GHSA-g6w6-r76c-28j7"/>
        <updated>2023-04-03T19:38:18.000Z</updated>
        <content type="html"><![CDATA[<p>(This advisory is canonically <a href="https://advisories.nats.io/CVE/CVE-2022-24450.txt">https://advisories.nats.io/CVE/CVE-2022-24450.txt</a>)</p>
<h2 id="problem-description">Problem Description</h2>
<p>NATS nats-server through 2022-02-04 has Incorrect Access Control, with unchecked ability for clients to authorize into any account, because of a coding error in a long-extant experimental feature.</p>
<p>A client crafting the initial protocol-level handshake could, with valid credentials for any account, specify a target account and switch into it immediately.  This includes any other tenant, and includes the System account which controls nats-server core operations.</p>
<p>For deployments not using multi-tenancy through NATS Accounts, there is still a vulnerability: normal users are able to choose to be in the System account.</p>
<p>An experimental feature to provide dynamically provisioned sandbox accounts was designed to allow a server administrator to turn on an option to allow clients to dynamically request a brand new account inline at connection time.  This feature went nowhere, but lived on in the code and was used by a number of tests; support was never added to any client libraries or to the documentation.</p>
<p>A bug in handling the feature meant that if someone did in fact have valid account credentials, then they could specify any other existing account and they would be assigned into that account.</p>
<p>Release 2.7.2 of nats-server removes the feature.
Because of the lack of client support and absence from protocol documentation, we feel this is safe operationally as well as the safest fix for the code.</p>
<h2 id="affected-versions">Affected versions</h2>
<h4 id="nats-server">NATS Server</h4>
<ul>
<li>All 2.x versions up to and including 2.7.1.</li>
<li>Fixed with nats-io/nats-server: 2.7.2</li>
<li>NATS Server 1.x did not have accounts.</li>
<li>Docker image:  nats <a href="https://hub.docker.com/_/nats">https://hub.docker.com/_/nats</a></li>
</ul>
<h4 id="nats-streaming-server">NATS Streaming Server</h4>
<ul>
<li>All versions embedding affected NATS Server:<ul>
<li>Affected: v0.15.0 up to and including v0.24.0</li>
<li>Fixed with nats-io/nats-streaming-server: 0.24.1</li>
</ul>
</li>
<li>Docker image:  nats-streaming <a href="https://hub.docker.com/_/nats-streaming">https://hub.docker.com/_/nats-streaming</a></li>
</ul>
<h2 id="impact">Impact</h2>
<p>Existing users could act in any account, including the System account.</p>
<h2 id="workaround">Workaround</h2>
<p>None.</p>
<h2 id="solution">Solution</h2>
<p>Upgrade the NATS server.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nats-io/nats-server/security/advisories/GHSA-g6w6-r76c-28j7">https://github.com/nats-io/nats-server/security/advisories/GHSA-g6w6-r76c-28j7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-24450">https://nvd.nist.gov/vuln/detail/CVE-2022-24450</a></li>
<li><a href="https://advisories.nats.io/CVE/CVE-2022-24450.txt">https://advisories.nats.io/CVE/CVE-2022-24450.txt</a></li>
<li><a href="https://github.com/nats-io/nats-server/releases/tag/v2.7.2">https://github.com/nats-io/nats-server/releases/tag/v2.7.2</a></li>
<li><a href="https://github.com/advisories/GHSA-g6w6-r76c-28j7">https://github.com/advisories/GHSA-g6w6-r76c-28j7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g6w6-r76c-28j7</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-02-08T17:23:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost-server/v5] Cross-site Scripting in Mattermost]]></title>
        <id>https://github.com/advisories/GHSA-hv5f-73mr-7vvj</id>
        <link href="https://github.com/advisories/GHSA-hv5f-73mr-7vvj"/>
        <updated>2023-04-03T19:24:43.000Z</updated>
        <content type="html"><![CDATA[<p>Mattermost 5.38 and earlier fails to sufficiently sanitize clipboard contents, which allows a user-assisted attacker to inject arbitrary web script in product deployments that explicitly disable the default CSP.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37860">https://nvd.nist.gov/vuln/detail/CVE-2021-37860</a></li>
<li><a href="https://mattermost.com/security-updates/">https://mattermost.com/security-updates/</a></li>
<li><a href="https://docs.mattermost.com/install/self-managed-changelog.html#release-v5-39-quality-release">https://docs.mattermost.com/install/self-managed-changelog.html#release-v5-39-quality-release</a></li>
<li><a href="https://github.com/advisories/GHSA-hv5f-73mr-7vvj">https://github.com/advisories/GHSA-hv5f-73mr-7vvj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hv5f-73mr-7vvj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-09-23T23:11:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/aws/amazon-cloudwatch-agent] Amazon CloudWatch Agent for Windows has Privilege Escalation Vector]]></title>
        <id>https://github.com/advisories/GHSA-j8x2-2m5w-j939</id>
        <link href="https://github.com/advisories/GHSA-j8x2-2m5w-j939"/>
        <updated>2023-04-03T19:24:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A privilege escalation issue exists within the Amazon CloudWatch Agent for Windows in versions up to and including v1.247354. When users trigger a repair of the Agent, a pop-up window opens with SYSTEM permissions. Users with administrative access to affected hosts may use this to create a new command prompt as NT AUTHORITY\SYSTEM. </p>
<p>To trigger this issue, the third party must be able to access the affected host and elevate their privileges such that they’re able to trigger the agent repair process. They must also be able to install the tools required to trigger the issue. </p>
<p>This issue does not affect the CloudWatch Agent for macOS or Linux. </p>
<h3 id="patches">Patches</h3>
<p>Maintainers recommend that Agent users upgrade to the latest available version of the CloudWatch Agent to address this issue. </p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no recommended work around. Affected users must update the installed version of the CloudWatch Agent to address this issue.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837">https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, contact AWS/Amazon Security via their <a href="http://aws.amazon.com/security/vulnerability-reporting/">vulnerability reporting page</a> or directly via email to <a href="mailto:aws-security@amazon.com">aws-security@amazon.com</a>. Please do not create a public GitHub issue.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aws/amazon-cloudwatch-agent/security/advisories/GHSA-j8x2-2m5w-j939">https://github.com/aws/amazon-cloudwatch-agent/security/advisories/GHSA-j8x2-2m5w-j939</a></li>
<li><a href="https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837">https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23511">https://nvd.nist.gov/vuln/detail/CVE-2022-23511</a></li>
<li><a href="https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52">https://github.com/aws/amazon-cloudwatch-agent/commit/6119858864c317ff26f41f576c169148d1250837#diff-76ed074a9305c04054cdebb9e9aad2d818052b07091de1f20cad0bbac34ffb52</a></li>
<li><a href="https://github.com/advisories/GHSA-j8x2-2m5w-j939">https://github.com/advisories/GHSA-j8x2-2m5w-j939</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j8x2-2m5w-j939</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-12-12T14:38:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/goharbor/harbor] Harbor fails to validate the user permissions when viewing Webhook policies]]></title>
        <id>https://github.com/advisories/GHSA-jf8p-3vjh-pq94</id>
        <link href="https://github.com/advisories/GHSA-jf8p-3vjh-pq94"/>
        <updated>2023-04-03T19:21:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Harbor fails to validate the user permissions to view Webhook policies including relevant credentials configured in different projects the user doesn’t have access to, resulting in malicious users being able to read Webhook policies of other users/projects. API call is</p>
<p>&nbsp; GET /projects/{project_name_or_id}/webhook/policies/{webhook_policy_id}</p>
<p>By sending the below request and specifying different Webhook policy ids in the last part of the URL, the malicious user may disclose Webhook policies related to other repositories/projects.: none;"&gt;</p>
<h3 id="patches">Patches</h3>
<p>This and similar issues are fixed in Harbor v2.5.2 and later. Please upgrade as soon as possible.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds available.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/goharbor/harbor">the Harbor GitHub repository</a></li>
</ul>
<h3 id="credits">Credits</h3>
<p>Thanks to <a href="https://www.linkedin.com/in/gal-goldshtein/">Gal Goldstein</a> and <a href="https://www.linkedin.com/in/daniel-abeles/">Daniel Abeles</a> from <a href="https://www.oxeye.io/">Oxeye Security</a> for reporting this issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goharbor/harbor/security/advisories/GHSA-jf8p-3vjh-pq94">https://github.com/goharbor/harbor/security/advisories/GHSA-jf8p-3vjh-pq94</a></li>
<li><a href="https://github.com/advisories/GHSA-jf8p-3vjh-pq94">https://github.com/advisories/GHSA-jf8p-3vjh-pq94</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jf8p-3vjh-pq94</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-09-16T19:35:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/goharbor/harbor] Harbor fails to validate the user permissions when viewing Webhook policies]]></title>
        <id>https://github.com/advisories/GHSA-jf8p-3vjh-pq94</id>
        <link href="https://github.com/advisories/GHSA-jf8p-3vjh-pq94"/>
        <updated>2023-04-03T19:21:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Harbor fails to validate the user permissions to view Webhook policies including relevant credentials configured in different projects the user doesn’t have access to, resulting in malicious users being able to read Webhook policies of other users/projects. API call is</p>
<p>&nbsp; GET /projects/{project_name_or_id}/webhook/policies/{webhook_policy_id}</p>
<p>By sending the below request and specifying different Webhook policy ids in the last part of the URL, the malicious user may disclose Webhook policies related to other repositories/projects.: none;"&gt;</p>
<h3 id="patches">Patches</h3>
<p>This and similar issues are fixed in Harbor v2.5.2 and later. Please upgrade as soon as possible.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds available.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/goharbor/harbor">the Harbor GitHub repository</a></li>
</ul>
<h3 id="credits">Credits</h3>
<p>Thanks to <a href="https://www.linkedin.com/in/gal-goldshtein/">Gal Goldstein</a> and <a href="https://www.linkedin.com/in/daniel-abeles/">Daniel Abeles</a> from <a href="https://www.oxeye.io/">Oxeye Security</a> for reporting this issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goharbor/harbor/security/advisories/GHSA-jf8p-3vjh-pq94">https://github.com/goharbor/harbor/security/advisories/GHSA-jf8p-3vjh-pq94</a></li>
<li><a href="https://github.com/advisories/GHSA-jf8p-3vjh-pq94">https://github.com/advisories/GHSA-jf8p-3vjh-pq94</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jf8p-3vjh-pq94</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-09-16T19:35:47.000Z</published>
    </entry>
</feed>