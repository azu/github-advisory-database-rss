<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-05-26T23:01:29.704Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pomerium/pomerium] Pomerium vulnerable to Incorrect Authorization with specially crafted requests]]></title>
        <id>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</id>
        <link href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p"/>
        <updated>2023-05-26T22:00:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>With specially crafted requests, incorrect authorization decisions may be made by Pomerium.</p>
<h3 id="patches">Patches</h3>
<p>We are releasing patch fixes to address this vulnerability going back to <code>v0.17.X</code>. Please upgrade to:</p>
<ul>
<li>v0.22.2</li>
<li>v0.21.4</li>
<li>v0.20.1</li>
<li>v0.19.2</li>
<li>v0.18.1</li>
<li>v0.17.4</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/pomerium/pomerium/issues">pomerium/pomerium</a></li>
<li>Email us at <a href="mailto:security@pomerium.com">security@pomerium.com</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/pomerium/pomerium/security/advisories/GHSA-pvrc-wvj2-f59p</a></li>
<li><a href="https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb">https://github.com/pomerium/pomerium/commit/d315e683357a9b587ba9ef399a8813bcc52fdebb</a></li>
<li><a href="https://github.com/advisories/GHSA-pvrc-wvj2-f59p">https://github.com/advisories/GHSA-pvrc-wvj2-f59p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pvrc-wvj2-f59p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-26T22:00:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/sigstore/rekor] malformed proposed intoto entries can cause a panic]]></title>
        <id>https://github.com/advisories/GHSA-frqx-jfcm-6jjr</id>
        <link href="https://github.com/advisories/GHSA-frqx-jfcm-6jjr"/>
        <updated>2023-05-26T19:39:03.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A malformed proposed entry of the <code>intoto/v0.0.2</code> type can cause a panic on a thread within the Rekor process. The thread is recovered so the client receives a 500 error message and service still continues, so the availability impact of this is minimal.</p>
<h3 id="patches">Patches</h3>
<p>This is fixed in v1.2.0 of Rekor.</p>
<h3 id="workarounds">Workarounds</h3>
<p>No</p>
<h3 id="references">References</h3>
<p>Discovered by OSS-Fuzz</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/sigstore/rekor/security/advisories/GHSA-frqx-jfcm-6jjr">https://github.com/sigstore/rekor/security/advisories/GHSA-frqx-jfcm-6jjr</a></li>
<li><a href="https://github.com/sigstore/rekor/commit/140c5add105179e5ffd9e3e114fd1b6b93aebbd4">https://github.com/sigstore/rekor/commit/140c5add105179e5ffd9e3e114fd1b6b93aebbd4</a></li>
<li><a href="https://github.com/advisories/GHSA-frqx-jfcm-6jjr">https://github.com/advisories/GHSA-frqx-jfcm-6jjr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-frqx-jfcm-6jjr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-26T19:39:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sigs.k8s.io/secrets-store-csi-driver] secrets-store-csi-driver discloses service account tokens in logs]]></title>
        <id>https://github.com/advisories/GHSA-g82w-58jf-gcxx</id>
        <link href="https://github.com/advisories/GHSA-g82w-58jf-gcxx"/>
        <updated>2023-05-26T13:59:22.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in secrets-store-csi-driver where an actor with access to the driver logs could observe service account tokens.  These tokens could then potentially be exchanged with external cloud providers to access secrets stored in cloud vault solutions.  Tokens are only logged when <a href="https://kubernetes-csi.github.io/docs/token-requests.html">TokenRequests is configured in the CSIDriver object</a> and the driver is set to run at log level 2 or greater via the -v flag.</p>
<p>This issue has been rated MEDIUM <a href="https://www.first.org/cvss/calculator/3.1#CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N">CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N</a> (6.5), and assigned CVE-2023-2878</p>
<h3 id="am-i-vulnerable">Am I vulnerable?</h3>
<p>You may be vulnerable if <a href="https://kubernetes-csi.github.io/docs/token-requests.html">TokenRequests is configured in the CSIDriver object</a> and the driver is set to run at log level 2 or greater via the -v flag.</p>
<p>To check if token requests are configured, run the following command:</p>
<pre><code class="language-bash">kubectl get csidriver secrets-store.csi.k8s.io -o jsonpath="{.spec.tokenRequests}"
</code></pre>
<p>To check if tokens are being logged, examine the secrets-store container log:</p>
<pre><code class="language-bash">kubectl logs -l app=secrets-store-csi-driver -c secrets-store -f | grep --line-buffered "csi.storage.k8s.io/serviceAccount.tokens"
</code></pre>
<h3 id="affected-versions">Affected Versions</h3>
<ul>
<li>secrets-store-csi-driver &lt; 1.3.3</li>
</ul>
<h3 id="how-do-i-mitigate-this-vulnerability">How do I mitigate this vulnerability?</h3>
<p>Prior to upgrading, this vulnerability can be mitigated by running secrets-store-csi-driver at log level 0 or 1 via the -v flag.</p>
<h3 id="fixed-versions">Fixed Versions</h3>
<ul>
<li>secrets-store-csi-driver &gt;= 1.3.3</li>
</ul>
<p>To upgrade, refer to the documentation: <a href="https://secrets-store-csi-driver.sigs.k8s.io/getting-started/upgrades.html#upgrades">https://secrets-store-csi-driver.sigs.k8s.io/getting-started/upgrades.html#upgrades</a></p>
<h3 id="detection">Detection</h3>
<p>Examine cloud provider logs for unexpected token exchanges, as well as unexpected access to cloud vault secrets.</p>
<p>If you find evidence that this vulnerability has been exploited, please contact <a href="https://groups.google.com/">security@kubernetes.io</a></p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>This vulnerability was reported by Tomer Shaiman @tshaiman from Microsoft.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/kubernetes-sigs/secrets-store-csi-driver/security/advisories/GHSA-g82w-58jf-gcxx">https://github.com/kubernetes-sigs/secrets-store-csi-driver/security/advisories/GHSA-g82w-58jf-gcxx</a></li>
<li><a href="https://github.com/kubernetes-sigs/secrets-store-csi-driver/releases/tag/v1.3.3">https://github.com/kubernetes-sigs/secrets-store-csi-driver/releases/tag/v1.3.3</a></li>
<li><a href="https://github.com/advisories/GHSA-g82w-58jf-gcxx">https://github.com/advisories/GHSA-g82w-58jf-gcxx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g82w-58jf-gcxx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-26T13:59:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/minio/console] Minio console object names with RIGHT-TO-LEFT OVERRIDE unicode character can be exploited]]></title>
        <id>https://github.com/advisories/GHSA-jv3f-7m33-qp65</id>
        <link href="https://github.com/advisories/GHSA-jv3f-7m33-qp65"/>
        <updated>2023-05-26T13:57:28.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Unicode RIGHT-TO-LEFT OVERRIDE characters can be used to mask the original filename.</p>
<h3 id="reported-by">Reported-By</h3>
<p>Thanks to the report from Mio Li <a href="mailto:wulilixi1@gmail.com">wulilixi1@gmail.com</a></p>
<h3 id="patches">Patches</h3>
<pre><code>commit 17e791afb90c9ad27c65f63c6be14f2f6a3a9d60
Author: Daniel Valdivia &lt;18384552+dvaldivia@users.noreply.github.com&gt;
Date:   Tue May 23 08:47:12 2023 -0700

    Replace RIGHT-TO-LEFT OVERRIDE unicode (#2828)
    
    Signed-off-by: Daniel Valdivia &lt;18384552+dvaldivia@users.noreply.github.com&gt;
</code></pre>
<h3 id="workarounds">Workarounds</h3>
<p>Workarounds are to remove the concerned file and rewrite it properly with the right file and extensions.  Avoid using RTLO characters in your filenames.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/minio/console/security/advisories/GHSA-jv3f-7m33-qp65">https://github.com/minio/console/security/advisories/GHSA-jv3f-7m33-qp65</a></li>
<li><a href="https://github.com/minio/console/commit/17e791afb90c9ad27c65f63c6be14f2f6a3a9d60">https://github.com/minio/console/commit/17e791afb90c9ad27c65f63c6be14f2f6a3a9d60</a></li>
<li><a href="https://github.com/advisories/GHSA-jv3f-7m33-qp65">https://github.com/advisories/GHSA-jv3f-7m33-qp65</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jv3f-7m33-qp65</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-26T13:57:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/kyverno/kyverno] kyverno seccomp control can be circumvented]]></title>
        <id>https://github.com/advisories/GHSA-33hq-f2mf-jm3c</id>
        <link href="https://github.com/advisories/GHSA-33hq-f2mf-jm3c"/>
        <updated>2023-05-26T21:00:44.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Users of the podSecurity (<code>validate.podSecurity</code>) subrule in Kyverno versions v1.9.2 and v1.9.3 may be unable to enforce the check for the Seccomp control at the baseline level when using a <code>version</code> value of <code>latest</code>. There is no effect if a version number is referenced instead. See the <a href="https://kyverno.io/docs/writing-policies/validate/#pod-security">documentation</a> for information on this subrule type. Users of Kyverno v1.9.2 and v1.9.3 are affected.</p>
<h3 id="patches">Patches</h3>
<p>v1.9.4
v1.10.0</p>
<h3 id="workarounds">Workarounds</h3>
<p>To work around this issue without upgrading to v1.9.4, temporarily install individual policies for the respective Seccomp checks in baseline <a href="https://kyverno.io/policies/pod-security/baseline/restrict-seccomp/restrict-seccomp/">here</a> and restricted <a href="https://kyverno.io/policies/pod-security/restricted/restrict-seccomp-strict/restrict-seccomp-strict/">here</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://kyverno.io/docs/writing-policies/validate/#pod-security">https://kyverno.io/docs/writing-policies/validate/#pod-security</a></li>
<li><a href="https://github.com/kyverno/kyverno/pull/7263">https://github.com/kyverno/kyverno/pull/7263</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kyverno/kyverno/security/advisories/GHSA-33hq-f2mf-jm3c">https://github.com/kyverno/kyverno/security/advisories/GHSA-33hq-f2mf-jm3c</a></li>
<li><a href="https://github.com/kyverno/kyverno/pull/7263">https://github.com/kyverno/kyverno/pull/7263</a></li>
<li><a href="https://github.com/kyverno/kyverno/releases/tag/v1.9.4">https://github.com/kyverno/kyverno/releases/tag/v1.9.4</a></li>
<li><a href="https://github.com/advisories/GHSA-33hq-f2mf-jm3c">https://github.com/advisories/GHSA-33hq-f2mf-jm3c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-33hq-f2mf-jm3c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-25T16:58:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[k8s.io/ingress-nginx] Ingress-nginx `path` sanitization can be bypassed with newline character]]></title>
        <id>https://github.com/advisories/GHSA-863x-868h-968x</id>
        <link href="https://github.com/advisories/GHSA-863x-868h-968x"/>
        <updated>2023-05-24T21:55:35.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in ingress-nginx where a user that can create or update ingress objects can use a newline character to bypass the sanitization of the <code>spec.rules[].http.paths[].path</code> field of an Ingress object (in the <code>networking.k8s.io</code> or <code>extensions</code> API group) to obtain the credentials of the ingress-nginx controller. In the default configuration, that credential has access to all secrets in the cluster.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-25748">https://nvd.nist.gov/vuln/detail/CVE-2021-25748</a></li>
<li><a href="https://github.com/kubernetes/ingress-nginx/issues/8686">https://github.com/kubernetes/ingress-nginx/issues/8686</a></li>
<li><a href="https://groups.google.com/g/kubernetes-security-announce/c/avaRYa9c7I8">https://groups.google.com/g/kubernetes-security-announce/c/avaRYa9c7I8</a></li>
<li><a href="https://github.com/kubernetes/ingress-nginx/pull/8623">https://github.com/kubernetes/ingress-nginx/pull/8623</a></li>
<li><a href="https://github.com/kubernetes/ingress-nginx/releases/tag/controller-v1.2.1">https://github.com/kubernetes/ingress-nginx/releases/tag/controller-v1.2.1</a></li>
<li><a href="https://github.com/advisories/GHSA-863x-868h-968x">https://github.com/advisories/GHSA-863x-868h-968x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-863x-868h-968x</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-24T18:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/gin-gonic/gin] Gin Web Framework does not properly sanitize filename parameter of Context.FileAttachment function]]></title>
        <id>https://github.com/advisories/GHSA-2c4m-59x9-fr2g</id>
        <link href="https://github.com/advisories/GHSA-2c4m-59x9-fr2g"/>
        <updated>2023-05-24T18:33:08.000Z</updated>
        <content type="html"><![CDATA[<p>The filename parameter of the Context.FileAttachment function is not properly sanitized. A maliciously crafted filename can cause the Content-Disposition header to be sent with an unexpected filename value or otherwise modify the Content-Disposition header. For example, a filename of "setup.bat";x=.txt" will be sent as a file named "setup.bat".</p>
<p>If the FileAttachment function is called with names provided by an untrusted source, this may permit an attacker to cause a file to be served with a name different than provided. Maliciously crafted attachment file name can modify the Content-Disposition header.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/gin-gonic/gin/issues/3555">https://github.com/gin-gonic/gin/issues/3555</a></li>
<li><a href="https://github.com/gin-gonic/gin/pull/3556">https://github.com/gin-gonic/gin/pull/3556</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2023-1737">https://pkg.go.dev/vuln/GO-2023-1737</a></li>
<li><a href="https://github.com/advisories/GHSA-2c4m-59x9-fr2g">https://github.com/advisories/GHSA-2c4m-59x9-fr2g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2c4m-59x9-fr2g</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-12T20:19:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/goreleaser/nfpm] nfpm has incorrect default permissions]]></title>
        <id>https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</id>
        <link href="https://github.com/advisories/GHSA-w7jw-q4fg-qc4c"/>
        <updated>2023-05-24T17:30:18.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When building packages directly from source control, file permissions on the checked-in files are not maintained. </p>
<h3 id="details">Details</h3>
<p>When building packages directly from source control, file permissions on the checked-in files are not maintained. When nfpm packaged the files (without extra config for enforcing its own permissions) files could go out with bad permissions (chmod 666 or 777).</p>
<h3 id="poc">PoC</h3>
<p>Create a default nfpm structure. </p>
<p>Within the test folder, create 3 files named <code>chmod-XXX.sh</code>. Each script has file 
permissions set corresponding with their file names (<code>chmod-777.sh</code> = <code>chmod 777</code>). Below each 
file and permissions can be seen.</p>
<pre><code class="language-console">$ ls -lart test 
total 24
-rwxrwxrwx   1 user  group   11 May 19 13:15 chmod-777.sh
-rw-rw-rw-   1 user  group   11 May 19 13:16 chmod-666.sh
drwxr-xr-x   5 user  group  160 May 19 13:19 .
-rw-rw-r--   1 user  group   11 May 19 13:19 chmod-664.sh
drwxr-xr-x  10 user  group  320 May 19 13:29 ..
</code></pre>
<p>Below is the snippet nfpm configuration file of the contents of the package. The test folder 
and files has no extra config for enforcing permissions. </p>
<pre><code class="language-yaml">contents:
- src: foo-binary
  dst: /usr/bin/bar
- src: bar-config.conf
  dst: /etc/foo-binary/bar-config.conf
  type: config
- src: test
  dst: /etc/test/scripts
</code></pre>
<p>The next step is to create a deb package.</p>
<pre><code class="language-console">$ nfpm package -p deb # Create dep package
using deb packager...
created package: foo_1.0.0_arm64.deb
</code></pre>
<p>When on a Ubuntu VM, install the foo package which was created</p>
<pre><code class="language-console">$ sudo dpkg -i foo_1.0.0_arm64.deb # Installing deb package within Ubuntu
Selecting previously unselected package foo.
(Reading database ... 67540 files and directories currently installed.)
Preparing to unpack foo_1.0.0_arm64.deb ...
Unpacking foo (1.0.0) ...
Setting up foo (1.0.0) ...
</code></pre>
<p>Looking at <code>/etc/test/scripts</code> and viewing the permissions. Permissions are passed exactly the same as the source.</p>
<pre><code class="language-console">$ ls -lart /etc/test/scripts
total 20
-rwxrwxrwx 1 root root   11 May 22 12:15 chmod-777.sh
-rw-rw-rw- 1 root root   11 May 22 12:16 chmod-666.sh
-rw-rw-r-- 1 root root   11 May 22 12:19 chmod-664.sh
drwxr-xr-x 3 root root 4096 May 22 13:00 ..
drwxr-xr-x 2 root root 4096 May 22 13:00 .
</code></pre>
<h2 id="solution">Solution</h2>
<p>To prevent world-writable files from making it into the packages, add the ability to override the default permissions of packaged files using a umask config option in the packaging spec file. This feature in nfpm would allow applying a global umask across any files being packaged, therefore, with the correct configuration, preventing world-writable files without needing to list permissions on each and every file in the package</p>
<h3 id="impact">Impact</h3>
<p>Vulnerability is <a href="https://cwe.mitre.org/data/definitions/276.html">https://cwe.mitre.org/data/definitions/276.html</a>
<a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N">https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N</a></p>
<p>Anyone using nfpm for creating packages and not checking/setting file permissions before packaging could result in bad permissions for files/folders.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goreleaser/nfpm/security/advisories/GHSA-w7jw-q4fg-qc4c">https://github.com/goreleaser/nfpm/security/advisories/GHSA-w7jw-q4fg-qc4c</a></li>
<li><a href="https://github.com/goreleaser/nfpm/commit/ed9abdf63d5012cc884f2a83b4ab2b42b3680d30">https://github.com/goreleaser/nfpm/commit/ed9abdf63d5012cc884f2a83b4ab2b42b3680d30</a></li>
<li><a href="https://github.com/goreleaser/nfpm/releases/tag/v2.29.0">https://github.com/goreleaser/nfpm/releases/tag/v2.29.0</a></li>
<li><a href="https://github.com/advisories/GHSA-w7jw-q4fg-qc4c">https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-24T17:30:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/goreleaser/nfpm/v2] nfpm has incorrect default permissions]]></title>
        <id>https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</id>
        <link href="https://github.com/advisories/GHSA-w7jw-q4fg-qc4c"/>
        <updated>2023-05-24T17:30:18.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When building packages directly from source control, file permissions on the checked-in files are not maintained. </p>
<h3 id="details">Details</h3>
<p>When building packages directly from source control, file permissions on the checked-in files are not maintained. When nfpm packaged the files (without extra config for enforcing its own permissions) files could go out with bad permissions (chmod 666 or 777).</p>
<h3 id="poc">PoC</h3>
<p>Create a default nfpm structure. </p>
<p>Within the test folder, create 3 files named <code>chmod-XXX.sh</code>. Each script has file 
permissions set corresponding with their file names (<code>chmod-777.sh</code> = <code>chmod 777</code>). Below each 
file and permissions can be seen.</p>
<pre><code class="language-console">$ ls -lart test 
total 24
-rwxrwxrwx   1 user  group   11 May 19 13:15 chmod-777.sh
-rw-rw-rw-   1 user  group   11 May 19 13:16 chmod-666.sh
drwxr-xr-x   5 user  group  160 May 19 13:19 .
-rw-rw-r--   1 user  group   11 May 19 13:19 chmod-664.sh
drwxr-xr-x  10 user  group  320 May 19 13:29 ..
</code></pre>
<p>Below is the snippet nfpm configuration file of the contents of the package. The test folder 
and files has no extra config for enforcing permissions. </p>
<pre><code class="language-yaml">contents:
- src: foo-binary
  dst: /usr/bin/bar
- src: bar-config.conf
  dst: /etc/foo-binary/bar-config.conf
  type: config
- src: test
  dst: /etc/test/scripts
</code></pre>
<p>The next step is to create a deb package.</p>
<pre><code class="language-console">$ nfpm package -p deb # Create dep package
using deb packager...
created package: foo_1.0.0_arm64.deb
</code></pre>
<p>When on a Ubuntu VM, install the foo package which was created</p>
<pre><code class="language-console">$ sudo dpkg -i foo_1.0.0_arm64.deb # Installing deb package within Ubuntu
Selecting previously unselected package foo.
(Reading database ... 67540 files and directories currently installed.)
Preparing to unpack foo_1.0.0_arm64.deb ...
Unpacking foo (1.0.0) ...
Setting up foo (1.0.0) ...
</code></pre>
<p>Looking at <code>/etc/test/scripts</code> and viewing the permissions. Permissions are passed exactly the same as the source.</p>
<pre><code class="language-console">$ ls -lart /etc/test/scripts
total 20
-rwxrwxrwx 1 root root   11 May 22 12:15 chmod-777.sh
-rw-rw-rw- 1 root root   11 May 22 12:16 chmod-666.sh
-rw-rw-r-- 1 root root   11 May 22 12:19 chmod-664.sh
drwxr-xr-x 3 root root 4096 May 22 13:00 ..
drwxr-xr-x 2 root root 4096 May 22 13:00 .
</code></pre>
<h2 id="solution">Solution</h2>
<p>To prevent world-writable files from making it into the packages, add the ability to override the default permissions of packaged files using a umask config option in the packaging spec file. This feature in nfpm would allow applying a global umask across any files being packaged, therefore, with the correct configuration, preventing world-writable files without needing to list permissions on each and every file in the package</p>
<h3 id="impact">Impact</h3>
<p>Vulnerability is <a href="https://cwe.mitre.org/data/definitions/276.html">https://cwe.mitre.org/data/definitions/276.html</a>
<a href="https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N">https://www.first.org/cvss/calculator/3.0#CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N</a></p>
<p>Anyone using nfpm for creating packages and not checking/setting file permissions before packaging could result in bad permissions for files/folders.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goreleaser/nfpm/security/advisories/GHSA-w7jw-q4fg-qc4c">https://github.com/goreleaser/nfpm/security/advisories/GHSA-w7jw-q4fg-qc4c</a></li>
<li><a href="https://github.com/goreleaser/nfpm/commit/ed9abdf63d5012cc884f2a83b4ab2b42b3680d30">https://github.com/goreleaser/nfpm/commit/ed9abdf63d5012cc884f2a83b4ab2b42b3680d30</a></li>
<li><a href="https://github.com/goreleaser/nfpm/releases/tag/v2.29.0">https://github.com/goreleaser/nfpm/releases/tag/v2.29.0</a></li>
<li><a href="https://github.com/advisories/GHSA-w7jw-q4fg-qc4c">https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w7jw-q4fg-qc4c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-24T17:30:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Potential HTTP policy bypass when using header rules in Cilium]]></title>
        <id>https://github.com/advisories/GHSA-2h44-x2wx-49f4</id>
        <link href="https://github.com/advisories/GHSA-2h44-x2wx-49f4"/>
        <updated>2023-05-25T19:07:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue only impacts users who:</p>
<ul>
<li>Have a HTTP policy that applies to multiple <code>toEndpoints</code> AND</li>
<li>Have an allow-all rule in place that affects only one of those endpoints</li>
</ul>
<p>In such cases, a wildcard rule will be appended to the set of HTTP rules, which could cause bypass of HTTP policies.</p>
<h3 id="patches">Patches</h3>
<p>This issue has been patched in Cilium 1.11.16, 1.12.9, and 1.13.2.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Rewrite HTTP rules for each endpoint separately. For example, if the initial rule looks like:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<p>It should be rewritten to:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
    - toEndpoints:
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jrajahalme for investigating and fixing the issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>As usual, if you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list: <a href="mailto:security@cilium.io">security@cilium.io</a> - first, before disclosing them in any public forums. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and is treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4">https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.11.16">https://github.com/cilium/cilium/releases/tag/v1.11.16</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.12.9">https://github.com/cilium/cilium/releases/tag/v1.12.9</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.2">https://github.com/cilium/cilium/releases/tag/v1.13.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30851">https://nvd.nist.gov/vuln/detail/CVE-2023-30851</a></li>
<li><a href="https://github.com/advisories/GHSA-2h44-x2wx-49f4">https://github.com/advisories/GHSA-2h44-x2wx-49f4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2h44-x2wx-49f4</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-22T20:33:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Potential HTTP policy bypass when using header rules in Cilium]]></title>
        <id>https://github.com/advisories/GHSA-2h44-x2wx-49f4</id>
        <link href="https://github.com/advisories/GHSA-2h44-x2wx-49f4"/>
        <updated>2023-05-25T19:07:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue only impacts users who:</p>
<ul>
<li>Have a HTTP policy that applies to multiple <code>toEndpoints</code> AND</li>
<li>Have an allow-all rule in place that affects only one of those endpoints</li>
</ul>
<p>In such cases, a wildcard rule will be appended to the set of HTTP rules, which could cause bypass of HTTP policies.</p>
<h3 id="patches">Patches</h3>
<p>This issue has been patched in Cilium 1.11.16, 1.12.9, and 1.13.2.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Rewrite HTTP rules for each endpoint separately. For example, if the initial rule looks like:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<p>It should be rewritten to:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
    - toEndpoints:
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jrajahalme for investigating and fixing the issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>As usual, if you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list: <a href="mailto:security@cilium.io">security@cilium.io</a> - first, before disclosing them in any public forums. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and is treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4">https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.11.16">https://github.com/cilium/cilium/releases/tag/v1.11.16</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.12.9">https://github.com/cilium/cilium/releases/tag/v1.12.9</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.2">https://github.com/cilium/cilium/releases/tag/v1.13.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30851">https://nvd.nist.gov/vuln/detail/CVE-2023-30851</a></li>
<li><a href="https://github.com/advisories/GHSA-2h44-x2wx-49f4">https://github.com/advisories/GHSA-2h44-x2wx-49f4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2h44-x2wx-49f4</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-22T20:33:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Potential HTTP policy bypass when using header rules in Cilium]]></title>
        <id>https://github.com/advisories/GHSA-2h44-x2wx-49f4</id>
        <link href="https://github.com/advisories/GHSA-2h44-x2wx-49f4"/>
        <updated>2023-05-25T19:07:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue only impacts users who:</p>
<ul>
<li>Have a HTTP policy that applies to multiple <code>toEndpoints</code> AND</li>
<li>Have an allow-all rule in place that affects only one of those endpoints</li>
</ul>
<p>In such cases, a wildcard rule will be appended to the set of HTTP rules, which could cause bypass of HTTP policies.</p>
<h3 id="patches">Patches</h3>
<p>This issue has been patched in Cilium 1.11.16, 1.12.9, and 1.13.2.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Rewrite HTTP rules for each endpoint separately. For example, if the initial rule looks like:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<p>It should be rewritten to:</p>
<pre><code>  egress:
    - toEndpoints:
        - matchLabels:
            k8s:kind: echo
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
    - toEndpoints:
        - matchLabels:
            k8s:kind: example
      toPorts:
        - ports:
            - port: "8080"
              protocol: TCP
          rules:
            http:
              - method: "GET"
</code></pre>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jrajahalme for investigating and fixing the issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>As usual, if you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list: <a href="mailto:security@cilium.io">security@cilium.io</a> - first, before disclosing them in any public forums. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and is treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4">https://github.com/cilium/cilium/security/advisories/GHSA-2h44-x2wx-49f4</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.11.16">https://github.com/cilium/cilium/releases/tag/v1.11.16</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.12.9">https://github.com/cilium/cilium/releases/tag/v1.12.9</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.2">https://github.com/cilium/cilium/releases/tag/v1.13.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30851">https://nvd.nist.gov/vuln/detail/CVE-2023-30851</a></li>
<li><a href="https://github.com/advisories/GHSA-2h44-x2wx-49f4">https://github.com/advisories/GHSA-2h44-x2wx-49f4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2h44-x2wx-49f4</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-22T20:33:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/ginuerzh/gost] ginuerzh/gost vulnerable to Timing Attack]]></title>
        <id>https://github.com/advisories/GHSA-qjrq-hm79-49ww</id>
        <link href="https://github.com/advisories/GHSA-qjrq-hm79-49ww"/>
        <updated>2023-05-23T16:23:06.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://en.wikipedia.org/wiki/Timing_attack">Timing attacks</a> occur when an attacker can guess a secret by observing a difference in processing time for valid and invalid inputs. Sensitive secrets such as passwords, token and API keys should be compared only using a constant-time comparision function.
More information on this attack type can be found in <a href="https://verboselogging.com/2012/08/20/a-timing-attack-in-action">this blog post</a>. </p>
<h1 id="root-cause-analysis">Root Cause Analysis</h1>
<p>In this case, the vulnerability occurs due to the following code.</p>
<p><a href="https://github.com/ginuerzh/gost/blob/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go#L46-L46">https://github.com/ginuerzh/gost/blob/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go#L46-L46</a></p>
<p>Here, a untrusted input, sourced from a HTTP header, is compared directly with a secret. 
Since, this comparision is not secure, an attacker can mount a side-channel timing attack to guess the password.</p>
<h1 id="remediation">Remediation</h1>
<p>This can be easily fixed using a constant time comparing function such as <code>crypto/subtle</code>'s <code>ConstantTimeCompare</code>. 
An example fix can be found in <a href="https://github.com/runatlantis/atlantis/commit/48870911974adddaa4c99c8089e79b7d787fa820">https://github.com/runatlantis/atlantis/commit/48870911974adddaa4c99c8089e79b7d787fa820</a> Alternatively, one can apply the patch below</p>
<pre><code>From d18cff85e1a565f688f717fd8f2cacea62ff9dbf Mon Sep 17 00:00:00 2001
From: Porcupiney Hairs &lt;porcupiney.hairs@protonmail.com&gt;
Date: Sun, 7 May 2023 01:03:33 +0530
Subject: [PATCH] Fix : Timing attack

---
 auth.go | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/auth.go b/auth.go
index 1be96e9..be13f23 100644
--- a/auth.go
+++ b/auth.go
@@ -2,6 +2,7 @@ package gost
 
 import (
     "bufio"
+	"crypto/subtle"
     "io"
     "strings"
     "sync"
@@ -43,7 +44,8 @@ func (au *LocalAuthenticator) Authenticate(user, password string) bool {
     }
 
     v, ok := au.kvs[user]
-	return ok &amp;&amp; (v == "" || password == v)
+	passOk := subtle.ConstantTimeCompare([]byte(password), []byte(v)) == 0
+	return ok &amp;&amp; (v == "" || passOk)
 }
 
 // Add adds a key-value pair to the Authenticator.
-- 
2.25.1
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ginuerzh/gost/security/advisories/GHSA-qjrq-hm79-49ww">https://github.com/ginuerzh/gost/security/advisories/GHSA-qjrq-hm79-49ww</a></li>
<li><a href="https://github.com/ginuerzh/gost/blob/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go#L46">https://github.com/ginuerzh/gost/blob/1c62376e0880e4094bd3731e06bd4f7842638f6a/auth.go#L46</a></li>
<li><a href="https://github.com/advisories/GHSA-qjrq-hm79-49ww">https://github.com/advisories/GHSA-qjrq-hm79-49ww</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qjrq-hm79-49ww</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-22T19:47:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/gen2brain/go-unarr] Tarslip in go-unarr]]></title>
        <id>https://github.com/advisories/GHSA-v9j4-cp63-qv62</id>
        <link href="https://github.com/advisories/GHSA-v9j4-cp63-qv62"/>
        <updated>2023-05-22T15:19:59.000Z</updated>
        <content type="html"><![CDATA[<p>unarr.go in go-unarr (aka Go bindings for unarr) 0.1.1 allows Directory Traversal via ../ in a pathname within a TAR archive.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-38197">https://nvd.nist.gov/vuln/detail/CVE-2021-38197</a></li>
<li><a href="https://github.com/gen2brain/go-unarr/issues/21">https://github.com/gen2brain/go-unarr/issues/21</a></li>
<li><a href="https://github.com/gen2brain/go-unarr/commit/239ec404d348280b50bbf671327709e8857fc5f4">https://github.com/gen2brain/go-unarr/commit/239ec404d348280b50bbf671327709e8857fc5f4</a></li>
<li><a href="https://github.com/gen2brain/go-unarr/releases/tag/v0.1.4">https://github.com/gen2brain/go-unarr/releases/tag/v0.1.4</a></li>
<li><a href="https://github.com/advisories/GHSA-v9j4-cp63-qv62">https://github.com/advisories/GHSA-v9j4-cp63-qv62</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v9j4-cp63-qv62</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2021-09-01T18:32:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/dgraph-io/dgraph] Dgraph Audit Log Encryption Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-92wq-q9pq-gw47</id>
        <link href="https://github.com/advisories/GHSA-92wq-q9pq-gw47"/>
        <updated>2023-05-17T18:48:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Existing Dgraph audit logs are vulnerable to brute force attacks due to nonce collisions.  All audit logs generated by versions of Dgraph &lt;v23.0.0 are affected.</p>
<h3 id="patches">Patches</h3>
<p>This issue was patched in <a href="https://github.com/dgraph-io/dgraph/pull/8323">https://github.com/dgraph-io/dgraph/pull/8323</a>.  Dgraph users should upgrade to v23.0.0.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Store existing audit logs in a secure location.  For extra security, encrypt using a tool like <code>gpg</code>.</p>
<h3 id="references">References</h3>
<p>See <a href="https://github.com/dgraph-io/dgraph/pull/8323">https://github.com/dgraph-io/dgraph/pull/8323</a> for more context on the vulnerability.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47">https://github.com/dgraph-io/dgraph/security/advisories/GHSA-92wq-q9pq-gw47</a></li>
<li><a href="https://github.com/dgraph-io/dgraph/pull/8323">https://github.com/dgraph-io/dgraph/pull/8323</a></li>
<li><a href="https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0">https://github.com/dgraph-io/dgraph/releases/tag/v23.0.0</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-31135">https://nvd.nist.gov/vuln/detail/CVE-2023-31135</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cryptographic_nonce">https://en.wikipedia.org/wiki/Cryptographic_nonce</a></li>
<li><a href="https://github.com/advisories/GHSA-92wq-q9pq-gw47">https://github.com/advisories/GHSA-92wq-q9pq-gw47</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-92wq-q9pq-gw47</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-17T17:07:40.000Z</published>
    </entry>
</feed>