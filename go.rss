<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-06-28T07:01:32.064Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/corazawaf/coraza/v2] Coraza has potential denial of service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-c2pj-v37r-2p6h</id>
        <link href="https://github.com/advisories/GHSA-c2pj-v37r-2p6h"/>
        <updated>2023-06-27T23:07:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Due to the misuse of <code>log.Fatalf</code>, the application using coraza crashed after receiving crafted requests from attackers.</p>
<h3 id="details">Details</h3>
<p><a href="https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a>
The bodyprocessors of multipart uses <code>log.Fatalf</code> to handle errors from the <code>mime.ParseMediaType</code>, but <code>log.Fatalf</code> calls <code>os.Exit</code> directly after logging the error.
<a href="https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a>
This means that the application will immediately crash after receiving a malicious request that triggers an error in <code>mime.ParseMediaType</code>.</p>
<h3 id="poc">PoC</h3>
<p>The server can be demonstrated by <a href="https://github.com/corazawaf/coraza/tree/main/examples/http-server">https://github.com/corazawaf/coraza/tree/main/examples/http-server</a></p>
<p>After sending this request</p>
<pre><code>POST / HTTP/1.1
Host: 127.0.0.1:8090
User-Agent: curl/8.1.2
Accept: */*
Content-Length: 199
Content-Type: multipart/form-data; boundary=------------------------5fa6351b877326a1; a=1; a=2
Connection: close

--------------------------5fa6351b877326a1
Content-Disposition: form-data; name="file"; filename="123"
Content-Type: application/octet-stream

123

--------------------------5fa6351b877326a1--
</code></pre>
<p>The server will crash immediately. The <code>a=1; a=2</code> in <code>Content-Type</code> makes <code>mime: duplicate parameter name</code> error.</p>
<h3 id="impact">Impact</h3>
<p>I believe the vulnerability was introduced by the following commit: <a href="https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a>.</p>
<h3 id="mitigation">Mitigation</h3>
<p>The error from <code>mime.ParseMediaType</code> should return directly.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h">https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h</a></li>
<li><a href="https://github.com/corazawaf/coraza-caddy/issues/48">https://github.com/corazawaf/coraza-caddy/issues/48</a></li>
<li><a href="https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a></li>
<li><a href="https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8">https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8</a></li>
<li><a href="https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a></li>
<li><a href="https://github.com/corazawaf/coraza/releases/tag/v3.0.1">https://github.com/corazawaf/coraza/releases/tag/v3.0.1</a></li>
<li><a href="https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a></li>
<li><a href="https://github.com/advisories/GHSA-c2pj-v37r-2p6h">https://github.com/advisories/GHSA-c2pj-v37r-2p6h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c2pj-v37r-2p6h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-06-26T15:48:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/corazawaf/coraza/v3] Coraza has potential denial of service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-c2pj-v37r-2p6h</id>
        <link href="https://github.com/advisories/GHSA-c2pj-v37r-2p6h"/>
        <updated>2023-06-27T23:07:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Due to the misuse of <code>log.Fatalf</code>, the application using coraza crashed after receiving crafted requests from attackers.</p>
<h3 id="details">Details</h3>
<p><a href="https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a>
The bodyprocessors of multipart uses <code>log.Fatalf</code> to handle errors from the <code>mime.ParseMediaType</code>, but <code>log.Fatalf</code> calls <code>os.Exit</code> directly after logging the error.
<a href="https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a>
This means that the application will immediately crash after receiving a malicious request that triggers an error in <code>mime.ParseMediaType</code>.</p>
<h3 id="poc">PoC</h3>
<p>The server can be demonstrated by <a href="https://github.com/corazawaf/coraza/tree/main/examples/http-server">https://github.com/corazawaf/coraza/tree/main/examples/http-server</a></p>
<p>After sending this request</p>
<pre><code>POST / HTTP/1.1
Host: 127.0.0.1:8090
User-Agent: curl/8.1.2
Accept: */*
Content-Length: 199
Content-Type: multipart/form-data; boundary=------------------------5fa6351b877326a1; a=1; a=2
Connection: close

--------------------------5fa6351b877326a1
Content-Disposition: form-data; name="file"; filename="123"
Content-Type: application/octet-stream

123

--------------------------5fa6351b877326a1--
</code></pre>
<p>The server will crash immediately. The <code>a=1; a=2</code> in <code>Content-Type</code> makes <code>mime: duplicate parameter name</code> error.</p>
<h3 id="impact">Impact</h3>
<p>I believe the vulnerability was introduced by the following commit: <a href="https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a>.</p>
<h3 id="mitigation">Mitigation</h3>
<p>The error from <code>mime.ParseMediaType</code> should return directly.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h">https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h</a></li>
<li><a href="https://github.com/corazawaf/coraza-caddy/issues/48">https://github.com/corazawaf/coraza-caddy/issues/48</a></li>
<li><a href="https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a></li>
<li><a href="https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8">https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8</a></li>
<li><a href="https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a></li>
<li><a href="https://github.com/corazawaf/coraza/releases/tag/v3.0.1">https://github.com/corazawaf/coraza/releases/tag/v3.0.1</a></li>
<li><a href="https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a></li>
<li><a href="https://github.com/advisories/GHSA-c2pj-v37r-2p6h">https://github.com/advisories/GHSA-c2pj-v37r-2p6h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c2pj-v37r-2p6h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-06-26T15:48:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing]]></title>
        <id>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</id>
        <link href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"/>
        <updated>2023-06-27T23:07:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana is validating Azure AD accounts based on the email claim. </p>
<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>
<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-3128">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2023-3128/">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>
<li><a href="https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>
<li><a href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-06-22T21:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing]]></title>
        <id>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</id>
        <link href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"/>
        <updated>2023-06-27T23:07:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana is validating Azure AD accounts based on the email claim. </p>
<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>
<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-3128">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2023-3128/">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>
<li><a href="https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>
<li><a href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-06-22T21:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing]]></title>
        <id>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</id>
        <link href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"/>
        <updated>2023-06-27T23:07:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana is validating Azure AD accounts based on the email claim. </p>
<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>
<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-3128">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2023-3128/">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>
<li><a href="https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>
<li><a href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-06-22T21:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing]]></title>
        <id>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</id>
        <link href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"/>
        <updated>2023-06-27T23:07:51.000Z</updated>
        <content type="html"><![CDATA[<p>Grafana is validating Azure AD accounts based on the email claim. </p>
<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>
<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-3128">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>
<li><a href="https://grafana.com/security/security-advisories/cve-2023-3128/">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>
<li><a href="https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>
<li><a href="https://github.com/advisories/GHSA-mpv3-g8m3-3fjc">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-06-22T21:30:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost-server/v6] Mattermost Server Missing Authorization vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-455c-vqrf-mghr</id>
        <link href="https://github.com/advisories/GHSA-455c-vqrf-mghr"/>
        <updated>2023-06-27T23:07:46.000Z</updated>
        <content type="html"><![CDATA[<p>Mattermost Apps Framework fails to verify that a secret provided in the incoming webhook request allowing an attacker to&nbsp;modify the contents of the post sent by the Apps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2783">https://nvd.nist.gov/vuln/detail/CVE-2023-2783</a></li>
<li><a href="https://mattermost.com/security-updates">https://mattermost.com/security-updates</a></li>
<li><a href="https://github.com/advisories/GHSA-455c-vqrf-mghr">https://github.com/advisories/GHSA-455c-vqrf-mghr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-455c-vqrf-mghr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost-server/v6] Mattermost Server Missing Authorization vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-455c-vqrf-mghr</id>
        <link href="https://github.com/advisories/GHSA-455c-vqrf-mghr"/>
        <updated>2023-06-27T23:07:46.000Z</updated>
        <content type="html"><![CDATA[<p>Mattermost Apps Framework fails to verify that a secret provided in the incoming webhook request allowing an attacker to&nbsp;modify the contents of the post sent by the Apps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2783">https://nvd.nist.gov/vuln/detail/CVE-2023-2783</a></li>
<li><a href="https://mattermost.com/security-updates">https://mattermost.com/security-updates</a></li>
<li><a href="https://github.com/advisories/GHSA-455c-vqrf-mghr">https://github.com/advisories/GHSA-455c-vqrf-mghr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-455c-vqrf-mghr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/mattermost/mattermost-server/v6] Mattermost Server Missing Authorization vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-455c-vqrf-mghr</id>
        <link href="https://github.com/advisories/GHSA-455c-vqrf-mghr"/>
        <updated>2023-06-27T23:07:46.000Z</updated>
        <content type="html"><![CDATA[<p>Mattermost Apps Framework fails to verify that a secret provided in the incoming webhook request allowing an attacker to&nbsp;modify the contents of the post sent by the Apps.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2783">https://nvd.nist.gov/vuln/detail/CVE-2023-2783</a></li>
<li><a href="https://mattermost.com/security-updates">https://mattermost.com/security-updates</a></li>
<li><a href="https://github.com/advisories/GHSA-455c-vqrf-mghr">https://github.com/advisories/GHSA-455c-vqrf-mghr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-455c-vqrf-mghr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/cosmos-sdk] Cosmos "Barberry" vulnerability in github.com/cosmos/cosmos-sdk]]></title>
        <id>https://github.com/advisories/GHSA-w44m-8mv2-v78h</id>
        <link href="https://github.com/advisories/GHSA-w44m-8mv2-v78h"/>
        <updated>2023-06-22T20:01:55.000Z</updated>
        <content type="html"><![CDATA[<p>The cosmos-sdk module is affected by the vulnerability codenamed "Barberry".</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/cosmos-sdk/pull/16466">https://github.com/cosmos/cosmos-sdk/pull/16466</a></li>
<li><a href="https://forum.cosmos.network/t/cosmos-sdk-security-advisory-barberry/10825">https://forum.cosmos.network/t/cosmos-sdk-security-advisory-barberry/10825</a></li>
<li><a href="https://github.com/advisories/GHSA-w44m-8mv2-v78h">https://github.com/advisories/GHSA-w44m-8mv2-v78h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w44m-8mv2-v78h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-22T20:01:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cosmos/cosmos-sdk] Cosmos "Barberry" vulnerability in github.com/cosmos/cosmos-sdk]]></title>
        <id>https://github.com/advisories/GHSA-w44m-8mv2-v78h</id>
        <link href="https://github.com/advisories/GHSA-w44m-8mv2-v78h"/>
        <updated>2023-06-22T20:01:55.000Z</updated>
        <content type="html"><![CDATA[<p>The cosmos-sdk module is affected by the vulnerability codenamed "Barberry".</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cosmos/cosmos-sdk/pull/16466">https://github.com/cosmos/cosmos-sdk/pull/16466</a></li>
<li><a href="https://forum.cosmos.network/t/cosmos-sdk-security-advisory-barberry/10825">https://forum.cosmos.network/t/cosmos-sdk-security-advisory-barberry/10825</a></li>
<li><a href="https://github.com/advisories/GHSA-w44m-8mv2-v78h">https://github.com/advisories/GHSA-w44m-8mv2-v78h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w44m-8mv2-v78h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-22T20:01:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/casdoor/casdoor] Casdoor Cross-Site Request Forgery vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-rwcp-qrwg-56cg</id>
        <link href="https://github.com/advisories/GHSA-rwcp-qrwg-56cg"/>
        <updated>2023-06-22T20:01:22.000Z</updated>
        <content type="html"><![CDATA[<p>Casdoor v1.331.0 and below was discovered to contain a Cross-Site Request Forgery (CSRF) in the endpoint <code>/api/set-password</code>. This vulnerability allows attackers to arbitrarily change the victim user's password via supplying a crafted URL.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-34927">https://nvd.nist.gov/vuln/detail/CVE-2023-34927</a></li>
<li><a href="https://github.com/casdoor/casdoor/issues/1531">https://github.com/casdoor/casdoor/issues/1531</a></li>
<li><a href="https://casdoor.org/">https://casdoor.org/</a></li>
<li><a href="https://gist.github.com/omriman067/4e90a3a4ffa40984f011d8777a995469">https://gist.github.com/omriman067/4e90a3a4ffa40984f011d8777a995469</a></li>
<li><a href="https://github.com/advisories/GHSA-rwcp-qrwg-56cg">https://github.com/advisories/GHSA-rwcp-qrwg-56cg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rwcp-qrwg-56cg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-22T15:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/bishopfox/sliver] Silver vulnerable to MitM attack against implants due to a cryptography vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-8jxm-xp43-qh3q</id>
        <link href="https://github.com/advisories/GHSA-8jxm-xp43-qh3q"/>
        <updated>2023-06-21T22:08:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The current cryptography implementation in Sliver up to version 1.5.39 allows a MitM with access to the corresponding implant binary to execute arbitrary codes on implanted devices via intercepted and crafted responses. (Reserved CVE ID: CVE-2023-34758)</p>
<h3 id="details">Details</h3>
<p>Please see <a href="https://github.com/tangent65536/Slivjacker">the PoC repo</a>.</p>
<h3 id="poc">PoC</h3>
<p>Please also see <a href="https://github.com/tangent65536/Slivjacker">the PoC repo</a>.
To setup a simple PoC environment,  </p>
<ol>
<li>Generate an implant with its C2 set to the PoC server's address and copy the embedded private implant key and public server key into the config json.  </li>
<li>Run the implant on a separate VM and a <code>notepad.exe</code> window should pop up on the implanted VM.</li>
</ol>
<h3 id="impact">Impact</h3>
<p>A successful attack grants the attacker permission to execute arbitrary code on the implanted device.  </p>
<h3 id="references">References</h3>
<p><a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/implant.go">https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/implant.go</a><br><a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/crypto.go">https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/crypto.go</a><br><a href="https://github.com/tangent65536/Slivjacker">https://github.com/tangent65536/Slivjacker</a>  </p>
<h3 id="credits">Credits</h3>
<p><a href="https://github.com/tangent65536">Ting-Wei Hsieh</a> from <a href="https://www.chtsecurity.com/?lang=en">CHT Security Co. Ltd.</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/BishopFox/sliver/security/advisories/GHSA-8jxm-xp43-qh3q">https://github.com/BishopFox/sliver/security/advisories/GHSA-8jxm-xp43-qh3q</a></li>
<li><a href="https://github.com/BishopFox/sliver/commit/2d1ea6192cac2ff9d6450b2d96043fdbf8561516">https://github.com/BishopFox/sliver/commit/2d1ea6192cac2ff9d6450b2d96043fdbf8561516</a></li>
<li><a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/crypto.go">https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/crypto.go</a></li>
<li><a href="https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/implant.go">https://github.com/BishopFox/sliver/blob/master/implant/sliver/cryptography/implant.go</a></li>
<li><a href="https://github.com/BishopFox/sliver/releases/tag/v1.5.40">https://github.com/BishopFox/sliver/releases/tag/v1.5.40</a></li>
<li><a href="https://github.com/tangent65536/Slivjacker">https://github.com/tangent65536/Slivjacker</a></li>
<li><a href="https://github.com/advisories/GHSA-8jxm-xp43-qh3q">https://github.com/advisories/GHSA-8jxm-xp43-qh3q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8jxm-xp43-qh3q</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-06-21T22:08:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[code.vegaprotocol.io/vega] Vega's validators able to submit duplicate transactions ]]></title>
        <id>https://github.com/advisories/GHSA-8rc9-vxjh-qjf2</id>
        <link href="https://github.com/advisories/GHSA-8rc9-vxjh-qjf2"/>
        <updated>2023-06-27T23:07:49.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability exists that allows a malicious validator to trick the Vega network into re-processing past Ethereum events from Vega’s Ethereum bridge. For example, a deposit to the collateral bridge for 100USDT that credits a party’s general account on Vega, can be re-processed 50 times resulting in 5000USDT in that party’s general account. This is without depositing any more than the original 100USDT on the bridge.</p>
<p>Despite this exploit requiring access to a validator's Vega key, a validator key can be obtained at the small cost of 3000VEGA, the amount needed to announce a new node onto the network.</p>
<p>The steps to carry out this exploit are as follows:</p>
<ol>
<li>Cause an Ethereum event on one of the bridge contracts e.g a deposit to the collateral bridge, or the staking bridge</li>
<li>This will result in the Ethereum-event-forwarder of each node to submit a ChainEvent transaction to the Vega network corresponding to that event</li>
<li>Scrape the valid chain event transaction from the Tendermint block data using a node’s Tendermint API</li>
<li>Change the value of the <code>txId</code> field of the ChainEvent to any valid, but different, value</li>
<li>Bundle the tweaked ChainEvent into a new transaction, sign it with a validator key and resubmit to the Vega network</li>
<li>The fraudulent ChainEvent will be processed by Vega as if it were a new ChainEvent even though it did not occur on Ethereum</li>
</ol>
<p>The key to this exploit is in step 4. The <code>txId</code> field of the ChainEvent is used when checking for ChainEvent resubmission, but NOT during the subsequent on-chain verification of the event. Therefore changing the <code>txId</code> of an existing ChainEvent is enough to by-pass the duplication check and for it to still be verified as a real event.</p>
<h3 id="impact">Impact</h3>
<p>The impact of this exploit is dependent on the ChainEvent being manipulated. The below table describes each one:</p>
<table>
<thead>
<tr>
<th>Chain Event</th>
<th>Allows</th>
<th>Consequence</th>
</tr>
</thead>
<tbody><tr>
<td>Deposit</td>
<td>Generation of unlimited funds of any asset</td>
<td>Withdrawal of all assets</td>
</tr>
<tr>
<td>Stake Deposit</td>
<td>Delegate unlimited Vega to a single node</td>
<td>A single node has controlling amount of voting power</td>
</tr>
<tr>
<td>Stake Removed</td>
<td>Force a Validator node to drop below self-stake requirements</td>
<td>Prevents reward payouts</td>
</tr>
<tr>
<td>Bridge Stop</td>
<td>The Vega network to think the bridge is stopped</td>
<td>Prevent anyone from withdrawing funds</td>
</tr>
<tr>
<td>Signer Removed</td>
<td>The Vega network to think a validator nodes is not on the multisig contract</td>
<td>Prevent reward payouts</td>
</tr>
</tbody></table>
<h3 id="patches">Patches</h3>
<p>v0.71.6</p>
<h3 id="workarounds">Workarounds</h3>
<p>No work around known, however there are mitigations in place should this vulnerability be exploited:</p>
<ul>
<li>there are monitoring alerts, for <code>mainnet1</code>, in place to identify any issues of this nature including this vulnerability being exploited</li>
<li>the validators have the ability to stop the bridge thus stopping any withdrawals should this vulnerability be exploited</li>
</ul>
<h3 id="references">References</h3>
<p>N/A</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/vegaprotocol/vega/security/advisories/GHSA-8rc9-vxjh-qjf2">https://github.com/vegaprotocol/vega/security/advisories/GHSA-8rc9-vxjh-qjf2</a></li>
<li><a href="https://github.com/vegaprotocol/vega/commit/56b09bf57af8cd9eca5996252d86f469a3e34c68">https://github.com/vegaprotocol/vega/commit/56b09bf57af8cd9eca5996252d86f469a3e34c68</a></li>
<li><a href="https://github.com/vegaprotocol/vega/releases/tag/v0.71.6">https://github.com/vegaprotocol/vega/releases/tag/v0.71.6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-35163">https://nvd.nist.gov/vuln/detail/CVE-2023-35163</a></li>
<li><a href="https://github.com/advisories/GHSA-8rc9-vxjh-qjf2">https://github.com/advisories/GHSA-8rc9-vxjh-qjf2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8rc9-vxjh-qjf2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-06-20T16:36:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Cilium vulnerable to information leakage via incorrect ReferenceGrant handling]]></title>
        <id>https://github.com/advisories/GHSA-r7wr-4w5q-55m6</id>
        <link href="https://github.com/advisories/GHSA-r7wr-4w5q-55m6"/>
        <updated>2023-06-19T19:46:04.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When the <a href="https://docs.cilium.io/en/v1.13/network/servicemesh/gateway-api/gateway-api/">Gateway API</a> is enabled in Cilium, the absence of a check on the namespace in which a <a href="https://gateway-api.sigs.k8s.io/api-types/referencegrant/">ReferenceGrant</a> is created could result in Cilium gaining visibility of secrets (including certificates) and services across namespaces.</p>
<p>An attacker on an affected cluster can configure Cilium to use cluster secrets or communicate with services that it should not have access to.</p>
<p>Gateway API functionality is disabled by default.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability is fixed in Cilium release 1.13.4.</p>
<p>Cilium versions &lt;1.13 are not affected.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @meyskens for investigating and fixing the issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>As usual, if you think you found a related vulnerability, we strongly encourage you to report security vulnerabilities to our private security mailing list: <a href="mailto:security@cilium.io">security@cilium.io</a> - first, before disclosing them in any public forums. This is a private mailing list where only members of the Cilium internal security team are subscribed to, and is treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-r7wr-4w5q-55m6">https://github.com/cilium/cilium/security/advisories/GHSA-r7wr-4w5q-55m6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-34242">https://nvd.nist.gov/vuln/detail/CVE-2023-34242</a></li>
<li><a href="https://github.com/cilium/cilium/releases/tag/v1.13.4">https://github.com/cilium/cilium/releases/tag/v1.13.4</a></li>
<li><a href="https://github.com/advisories/GHSA-r7wr-4w5q-55m6">https://github.com/advisories/GHSA-r7wr-4w5q-55m6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r7wr-4w5q-55m6</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-06-16T17:47:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[k8s.io/kubernetes] Kubelet vulnerable to bypass of seccomp profile enforcement]]></title>
        <id>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</id>
        <link href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc"/>
        <updated>2023-06-27T20:21:08.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in Kubelet that allows pods to bypass the seccomp profile enforcement. Pods that use localhost type for seccomp profile but specify an empty profile field, are affected by this issue. In this scenario, this vulnerability allows the pod to run in unconfined (seccomp disabled) mode. This bug affects Kubelet.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2431">https://nvd.nist.gov/vuln/detail/CVE-2023-2431</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/118690">https://github.com/kubernetes/kubernetes/issues/118690</a></li>
<li><a href="https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10">https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117020">https://github.com/kubernetes/kubernetes/pull/117020</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117116">https://github.com/kubernetes/kubernetes/pull/117116</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117117">https://github.com/kubernetes/kubernetes/pull/117117</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117118">https://github.com/kubernetes/kubernetes/pull/117118</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117147">https://github.com/kubernetes/kubernetes/pull/117147</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/</a></li>
<li><a href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc">https://github.com/advisories/GHSA-xc8m-28vv-4pjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[k8s.io/kubernetes] Kubelet vulnerable to bypass of seccomp profile enforcement]]></title>
        <id>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</id>
        <link href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc"/>
        <updated>2023-06-27T20:21:08.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in Kubelet that allows pods to bypass the seccomp profile enforcement. Pods that use localhost type for seccomp profile but specify an empty profile field, are affected by this issue. In this scenario, this vulnerability allows the pod to run in unconfined (seccomp disabled) mode. This bug affects Kubelet.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2431">https://nvd.nist.gov/vuln/detail/CVE-2023-2431</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/118690">https://github.com/kubernetes/kubernetes/issues/118690</a></li>
<li><a href="https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10">https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117020">https://github.com/kubernetes/kubernetes/pull/117020</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117116">https://github.com/kubernetes/kubernetes/pull/117116</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117117">https://github.com/kubernetes/kubernetes/pull/117117</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117118">https://github.com/kubernetes/kubernetes/pull/117118</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117147">https://github.com/kubernetes/kubernetes/pull/117147</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/</a></li>
<li><a href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc">https://github.com/advisories/GHSA-xc8m-28vv-4pjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[k8s.io/kubernetes] Kubelet vulnerable to bypass of seccomp profile enforcement]]></title>
        <id>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</id>
        <link href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc"/>
        <updated>2023-06-27T20:21:08.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in Kubelet that allows pods to bypass the seccomp profile enforcement. Pods that use localhost type for seccomp profile but specify an empty profile field, are affected by this issue. In this scenario, this vulnerability allows the pod to run in unconfined (seccomp disabled) mode. This bug affects Kubelet.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2431">https://nvd.nist.gov/vuln/detail/CVE-2023-2431</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/118690">https://github.com/kubernetes/kubernetes/issues/118690</a></li>
<li><a href="https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10">https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117020">https://github.com/kubernetes/kubernetes/pull/117020</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117116">https://github.com/kubernetes/kubernetes/pull/117116</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117117">https://github.com/kubernetes/kubernetes/pull/117117</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117118">https://github.com/kubernetes/kubernetes/pull/117118</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117147">https://github.com/kubernetes/kubernetes/pull/117147</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/</a></li>
<li><a href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc">https://github.com/advisories/GHSA-xc8m-28vv-4pjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[k8s.io/kubernetes] Kubelet vulnerable to bypass of seccomp profile enforcement]]></title>
        <id>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</id>
        <link href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc"/>
        <updated>2023-06-27T20:21:08.000Z</updated>
        <content type="html"><![CDATA[<p>A security issue was discovered in Kubelet that allows pods to bypass the seccomp profile enforcement. Pods that use localhost type for seccomp profile but specify an empty profile field, are affected by this issue. In this scenario, this vulnerability allows the pod to run in unconfined (seccomp disabled) mode. This bug affects Kubelet.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2431">https://nvd.nist.gov/vuln/detail/CVE-2023-2431</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/issues/118690">https://github.com/kubernetes/kubernetes/issues/118690</a></li>
<li><a href="https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10">https://groups.google.com/g/kubernetes-security-announce/c/QHmx0HOQa10</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117020">https://github.com/kubernetes/kubernetes/pull/117020</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117116">https://github.com/kubernetes/kubernetes/pull/117116</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117117">https://github.com/kubernetes/kubernetes/pull/117117</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117118">https://github.com/kubernetes/kubernetes/pull/117118</a></li>
<li><a href="https://github.com/kubernetes/kubernetes/pull/117147">https://github.com/kubernetes/kubernetes/pull/117147</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XBX4RL4UOC7JHWWYB2AJCKSUM7EG5Y5G/</a></li>
<li><a href="https://github.com/advisories/GHSA-xc8m-28vv-4pjc">https://github.com/advisories/GHSA-xc8m-28vv-4pjc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc8m-28vv-4pjc</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-06-16T09:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/ipfs/go-libipfs] Boxo bitswap/server: DOS unbounded persistent memory leak]]></title>
        <id>https://github.com/advisories/GHSA-m974-xj4j-7qv5</id>
        <link href="https://github.com/advisories/GHSA-m974-xj4j-7qv5"/>
        <updated>2023-06-16T17:42:48.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker is able allocate arbitrarily many bytes in the Bitswap server by sending many <code>WANT_BLOCK</code> and or <code>WANT_HAVE</code> requests which are queued in an unbounded queue, with allocations that persist even if the connection is closed.
This affects users accepting untrusted connections with the Bitswap server, this also affects users using the old API stubs at <code>github.com/ipfs/boxo/bitswap</code> because it transitively uses <code>github.com/ipfs/boxo/bitswap/server</code>.</p>
<p>We have <a href="https://github.com/ipfs/boxo/issues/215">renamed go-libipfs to boxo</a>; this document uses both terms interchangeably. The version numbers for both are applicable, as they share the same historical timeline.</p>
<h3 id="remediation">Remediation</h3>
<p>Apply one of:</p>
<ul>
<li>Update <code>boxo</code> to <a href="https://github.com/ipfs/boxo/releases/tag/v0.6.0"><code>v0.6.0</code></a> or later</li>
<li>Update <code>boxo</code> to <a href="https://github.com/ipfs/boxo/releases/tag/v0.4.1"><code>v0.4.1</code></a>
 Note that <em><strong><code>v0.5.0</code> is NOT safe</strong></em>, <code>v0.4.1</code> is a backport of the <code>v0.6.0</code> security fixes on top of <code>v0.4.0</code>.</li>
</ul>
<h3 id="mitigations">Mitigations</h3>
<ol>
<li>The server now limits how many wantlist entries per peer it knows.
 The <code>MaxQueuedWantlistEntriesPerPeer</code> option allows configuring how many wantlist entries the server remembers; if a peer sends a wantlist bigger than this (including a sum of multiple delta updates) the server will truncate the wantlist to the match the limit.
 This defaults to <code>1024</code> entries per peer.</li>
<li>The server now properly clears state about peers when they disconnect.
 Peer state is more lazily allocated (only when a wantlist is received in the first place) and is properly cleared when the <code>PeerDisconnected</code> callback is received.</li>
<li>The server now ignores CIDs above some size.
 Clients were able to send any CID as long as the total protobuf message were bellow the 4MiB limit. This is allowed to allocate lots of memory with very little entries.
 This can be configured using the <code>MaxCidSize</code> option and defaults to <code>168 bytes</code>.</li>
<li>The server now closes the connection if an inline CID is requested (either as <code>WANT_*</code> or <code>CANCEL</code>).
 The attack were more effective if done with CIDs that are present in target's blockstore, this is because this will push longer-lasting jobs on some priority queue.
 Since inline CID are literal data (instead of hashes of data), everyone always "has" any inline CID (since instead of loading the data from disk, it can be extracted from the CID). It makes no sense for anyone to ever ask you about an inline CID since they could also just parse it themselves. Thus, as a defensive measure, we kill the connection with peers that ask about an inline CID.</li>
</ol>
<h3 id="vulnerable-symbols">Vulnerable symbols</h3>
<ul>
<li><code>github.com/ipfs/go-libipfs/bitswap/server/internal/decision.(*Engine).MessageReceived</code></li>
<li><code>github.com/ipfs/go-libipfs/bitswap/server/internal/decision.(*Engine).NotifyNewBlocks</code></li>
<li><code>github.com/ipfs/go-libipfs/bitswap/server/internal/decision.(*Engine).findOrCreate</code></li>
<li><code>github.com/ipfs/go-libipfs/bitswap/server/internal/decision.(*Engine).PeerConnected</code></li>
</ul>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/ipfs/boxo/commit/9cb5cb54d40b57084d1221ba83b9e6bb3fcc3197">https://github.com/ipfs/boxo/commit/9cb5cb54d40b57084d1221ba83b9e6bb3fcc3197</a> (mitigations 1 and 2)</li>
<li><a href="https://github.com/ipfs/boxo/commit/62cbac40b96f49e39cd7fedc77ee6b56adce4916">https://github.com/ipfs/boxo/commit/62cbac40b96f49e39cd7fedc77ee6b56adce4916</a> (mitigations 3 and 4)</li>
<li><a href="https://github.com/ipfs/boxo/commit/baa748b682fabb21a4c1f7628a8af348d4645974">https://github.com/ipfs/boxo/commit/baa748b682fabb21a4c1f7628a8af348d4645974</a> (tests)</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>If you are using the stubs at <code>github.com/ipfs/go-libipfs/bitswap</code> and not taking advantage of the features provided by the server, refactoring your code to use the new split API will allow you to run in a client-only mode using: <a href="https://pkg.go.dev/github.com/ipfs/boxo/bitswap/client"><code>github.com/ipfs/boxo/bitswap/client</code></a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ipfs/boxo/security/advisories/GHSA-m974-xj4j-7qv5">https://github.com/ipfs/boxo/security/advisories/GHSA-m974-xj4j-7qv5</a></li>
<li><a href="https://github.com/ipfs/go-libipfs/security/advisories/GHSA-m974-xj4j-7qv5">https://github.com/ipfs/go-libipfs/security/advisories/GHSA-m974-xj4j-7qv5</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25568">https://nvd.nist.gov/vuln/detail/CVE-2023-25568</a></li>
<li><a href="https://github.com/ipfs/boxo/commit/62cbac40b96f49e39cd7fedc77ee6b56adce4916">https://github.com/ipfs/boxo/commit/62cbac40b96f49e39cd7fedc77ee6b56adce4916</a></li>
<li><a href="https://github.com/ipfs/boxo/commit/9cb5cb54d40b57084d1221ba83b9e6bb3fcc3197">https://github.com/ipfs/boxo/commit/9cb5cb54d40b57084d1221ba83b9e6bb3fcc3197</a></li>
<li><a href="https://github.com/ipfs/boxo/commit/baa748b682fabb21a4c1f7628a8af348d4645974">https://github.com/ipfs/boxo/commit/baa748b682fabb21a4c1f7628a8af348d4645974</a></li>
<li><a href="https://github.com/advisories/GHSA-m974-xj4j-7qv5">https://github.com/advisories/GHSA-m974-xj4j-7qv5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m974-xj4j-7qv5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-11T20:32:18.000Z</published>
    </entry>
</feed>