<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2023-01-25T21:01:37.740Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[rancher/github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Command injection in Git package in Wrangler]]></title>
        <id>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</id>
        <link href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5"/>
        <updated>2023-01-25T19:40:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A command injection vulnerability was discovered in Wrangler's Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Wrangler's Git package uses the underlying Git binary present in the host OS or container image to execute Git operations. Specially crafted commands can be passed to Wrangler that will change their behavior and cause confusion when executed through Git, resulting in command injection in the underlying host.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/rancher/wrangler/security/advisories/GHSA-qrg7-hfx7-95c5</a></li>
<li><a href="https://github.com/advisories/GHSA-qrg7-hfx7-95c5">https://github.com/advisories/GHSA-qrg7-hfx7-95c5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qrg7-hfx7-95c5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:40:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/wrangler] Denial of service (DoS) when processing Git credentials]]></title>
        <id>https://github.com/advisories/GHSA-8fcj-gf77-47mg</id>
        <link href="https://github.com/advisories/GHSA-8fcj-gf77-47mg"/>
        <updated>2023-01-25T19:40:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A denial of services (DoS) vulnerability was discovered in Wrangler Git package affecting versions up to and including <code>v1.0.0</code>.</p>
<p>Specially crafted Git credentials can result in a denial of service (DoS) attack on an application that uses Wrangler due to the exhaustion of the available memory and CPU resources. This is caused by a lack of input validation of Git credentials before they are used, which may lead to a denial of service in some cases. This issue can be triggered when accessing both private and public Git repositories. </p>
<h3 id="workarounds">Workarounds</h3>
<p>A workaround is to sanitize input passed to the Git package to remove potential unsafe and ambiguous characters. Otherwise, the best course of action is to update to a patched Wrangler version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include <code>v1.0.1</code> and later and the backported tags - <code>v0.7.4-security1</code>, <code>v0.8.5-security1</code> and <code>v0.8.11</code>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> or <a href="https://github.com/rancher/wrangler/issues/new">Wrangler</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg">https://github.com/rancher/wrangler/security/advisories/GHSA-8fcj-gf77-47mg</a></li>
<li><a href="https://github.com/advisories/GHSA-8fcj-gf77-47mg">https://github.com/advisories/GHSA-8fcj-gf77-47mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fcj-gf77-47mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-25T19:40:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Controller reconciles apps outside configured namespaces when sharding is enabled]]></title>
        <id>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</id>
        <link href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw"/>
        <updated>2023-01-25T19:39:05.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All Argo CD versions starting with 2.5.0-rc1 are vulnerable to an authorization bypass bug which allows a malicious Argo CD user to deploy Applications outside the configured allowed namespaces. </p>
<h4 id="description-of-exploit">Description of exploit</h4>
<p>Reconciled Application namespaces are specified as a comma-delimited list of glob patterns. When sharding is enabled on the Application controller, it does not enforce that list of patterns when reconciling Applications. For example, if Application namespaces are configured to be <code>argocd-*</code>, the Application controller may reconcile an Application installed in a namespace called <code>other</code>, even though it does not start with <code>argocd-</code>.</p>
<p>Reconciliation of the out-of-bounds Application is only triggered when the Application is updated, so the attacker must be able to cause an update operation on the Application resource.</p>
<h4 id="limitations">Limitations</h4>
<p>This bug only applies to users who have explicitly enabled the "apps-in-any-namespace" feature by setting <code>application.namespaces</code> in the argocd-cmd-params-cm ConfigMap or otherwise setting the <code>--application-namespaces</code> flags on the Application controller and API server components. The apps-in-any-namespace feature is in beta as of this Security Advisory's publish date.</p>
<p>The bug is also limited to Argo CD instances where sharding is enabled by increasing the <code>replicas</code> count for the Application controller.</p>
<p>Finally, the AppProjects' <code>sourceNamespaces</code> field acts as a secondary check against this exploit. To cause reconciliation of an Application in an out-of-bounds namespace, an AppProject must be available which permits Applications in the out-of-bounds namespace.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.5.8</li>
<li>v2.6.0-rc5</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Running only one replica of the Application controller will prevent exploitation of this bug.</p>
<p>Making sure all AppProjects' <code>sourceNamespaces</code> are restricted within the confines of the configured Application namespaces will also prevent exploitation of this bug.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to ChangZhuo Chen (@czchen) for finding the issue and for contributing the fix!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd--10678.org.readthedocs.build/en/10678/operator-manual/app-any-namespace/">Documentation for apps-in-any-namespace</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
<li><a href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:39:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/argoproj/argo-cd] Controller reconciles apps outside configured namespaces when sharding is enabled]]></title>
        <id>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</id>
        <link href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw"/>
        <updated>2023-01-25T19:39:05.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>All Argo CD versions starting with 2.5.0-rc1 are vulnerable to an authorization bypass bug which allows a malicious Argo CD user to deploy Applications outside the configured allowed namespaces. </p>
<h4 id="description-of-exploit">Description of exploit</h4>
<p>Reconciled Application namespaces are specified as a comma-delimited list of glob patterns. When sharding is enabled on the Application controller, it does not enforce that list of patterns when reconciling Applications. For example, if Application namespaces are configured to be <code>argocd-*</code>, the Application controller may reconcile an Application installed in a namespace called <code>other</code>, even though it does not start with <code>argocd-</code>.</p>
<p>Reconciliation of the out-of-bounds Application is only triggered when the Application is updated, so the attacker must be able to cause an update operation on the Application resource.</p>
<h4 id="limitations">Limitations</h4>
<p>This bug only applies to users who have explicitly enabled the "apps-in-any-namespace" feature by setting <code>application.namespaces</code> in the argocd-cmd-params-cm ConfigMap or otherwise setting the <code>--application-namespaces</code> flags on the Application controller and API server components. The apps-in-any-namespace feature is in beta as of this Security Advisory's publish date.</p>
<p>The bug is also limited to Argo CD instances where sharding is enabled by increasing the <code>replicas</code> count for the Application controller.</p>
<p>Finally, the AppProjects' <code>sourceNamespaces</code> field acts as a secondary check against this exploit. To cause reconciliation of an Application in an out-of-bounds namespace, an AppProject must be available which permits Applications in the out-of-bounds namespace.</p>
<h3 id="patches">Patches</h3>
<p>A patch for this vulnerability has been released in the following Argo CD versions:</p>
<ul>
<li>v2.5.8</li>
<li>v2.6.0-rc5</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Running only one replica of the Application controller will prevent exploitation of this bug.</p>
<p>Making sure all AppProjects' <code>sourceNamespaces</code> are restricted within the confines of the configured Application namespaces will also prevent exploitation of this bug.</p>
<h3 id="credits">Credits</h3>
<p>Thanks to ChangZhuo Chen (@czchen) for finding the issue and for contributing the fix!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://argo-cd--10678.org.readthedocs.build/en/10678/operator-manual/app-any-namespace/">Documentation for apps-in-any-namespace</a></li>
</ul>
<h3 id="for-more-information">For more information</h3>
<ul>
<li>Open an issue in <a href="https://github.com/argoproj/argo-cd/issues">the Argo CD issue tracker</a> or <a href="https://github.com/argoproj/argo-cd/discussions">discussions</a></li>
<li>Join us on <a href="https://argoproj.github.io/community/join-slack">Slack</a> in channel #argo-cd</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/argoproj/argo-cd/security/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
<li><a href="https://github.com/advisories/GHSA-6p4m-hw2h-6gmw">https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6p4m-hw2h-6gmw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:39:03.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher generated tokens not revoked after modifications made to authentication provider]]></title>
        <id>https://github.com/advisories/GHSA-c45c-39f6-6gw9</id>
        <link href="https://github.com/advisories/GHSA-c45c-39f6-6gw9"/>
        <updated>2023-01-25T19:38:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It only affects Rancher setups that have an external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> configured or had one configured in the past.</p>
<p>It was discovered that when an external authentication provider is configured in Rancher and then disabled, the Rancher generated <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">tokens</a> associated with users who had access granted through the now disabled auth provider are not revoked. This allows users to retain access to Rancher and <code>kubectl</code> access to clusters managed by Rancher, according to their previous configured permissions, even after they are supposed to have lost it due to the auth provider been disabled.</p>
<p>The problem also occurs if the auth provider is configured (and is still enabled) to use the <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">access level scopes</a> <code>allow members of clusters and projects, plus authorized users &amp; groups</code> and <code>restrict access to only the authorized users &amp; groups</code>. In this case, removing users and groups from the authorized lists will not revoke the access tokens and they will remain valid.</p>
<p>An example scenario is:</p>
<ol>
<li>OpenLDAP, MS Active Directory (AD) or any other external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> is configured as an auth provider.</li>
<li>A user (<code>cluster-owner</code>) is granted <code>cluster-owner</code> permissions on a downstream cluster (<code>test-cluster</code>).</li>
<li><code>cluster-owner</code> logs in using their external auth provider username and password.</li>
<li><code>cluster-owner</code> generates a <code>kubeconfig</code> token for <code>test-cluster</code>.</li>
<li>The configured external auth provider is disabled.</li>
</ol>
<p>In this scenario, the <code>kubeconfig</code> generated in step 4 will still be valid after step 5, and <code>test-cluster</code> can still be accessed using the <code>kubeconfig</code> token.</p>
<p>By default, tokens for authenticated session have their <code>ttl</code> (time to live) set to <code>960</code> minutes, so they will expire after <code>16</code> hours. <code>kubeconfig</code> tokens are configured to never expire, and their <code>ttl</code> is set to <code>0</code>. These configurations can be changed in the Rancher's settings (<code>Configuration &gt; Global Settings &gt; Settings</code>) with the <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">parameters</a>  <code>auth-user-session-ttl-minutes</code> and <code>kubeconfig-default-token-ttl-minutes</code>, respectively.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you cannot update to a patched Rancher version, the recommended workaround is to review and remove tokens associated with auth providers manually.</p>
<p>The tokens can be reviewed by executing <code>kubectl get tokens</code> in Rancher's <code>local</code> cluster. Each found token must be manually reviewed to check if it belongs to a user from a disabled auth provider or a user who's access was previously removed from the auth provider (when the auth provider is still enabled and is or was configured to use access level scopes, as mentioned above). The identified tokens can be removed with <code>kubectl delete tokens &lt;token_name&gt;</code>.</p>
<p>It is important to mention that this workaround must be done every time an auth provider is disabled in case you cannot update to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions. After updating to a patched version, it is highly recommended to review the existing tokens and remove tokens related to disabled auth providers as described above in the workaround section.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9">https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9</a></li>
<li><a href="https://github.com/advisories/GHSA-c45c-39f6-6gw9">https://github.com/advisories/GHSA-c45c-39f6-6gw9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c45c-39f6-6gw9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:38:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher generated tokens not revoked after modifications made to authentication provider]]></title>
        <id>https://github.com/advisories/GHSA-c45c-39f6-6gw9</id>
        <link href="https://github.com/advisories/GHSA-c45c-39f6-6gw9"/>
        <updated>2023-01-25T19:38:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It only affects Rancher setups that have an external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> configured or had one configured in the past.</p>
<p>It was discovered that when an external authentication provider is configured in Rancher and then disabled, the Rancher generated <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">tokens</a> associated with users who had access granted through the now disabled auth provider are not revoked. This allows users to retain access to Rancher and <code>kubectl</code> access to clusters managed by Rancher, according to their previous configured permissions, even after they are supposed to have lost it due to the auth provider been disabled.</p>
<p>The problem also occurs if the auth provider is configured (and is still enabled) to use the <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">access level scopes</a> <code>allow members of clusters and projects, plus authorized users &amp; groups</code> and <code>restrict access to only the authorized users &amp; groups</code>. In this case, removing users and groups from the authorized lists will not revoke the access tokens and they will remain valid.</p>
<p>An example scenario is:</p>
<ol>
<li>OpenLDAP, MS Active Directory (AD) or any other external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> is configured as an auth provider.</li>
<li>A user (<code>cluster-owner</code>) is granted <code>cluster-owner</code> permissions on a downstream cluster (<code>test-cluster</code>).</li>
<li><code>cluster-owner</code> logs in using their external auth provider username and password.</li>
<li><code>cluster-owner</code> generates a <code>kubeconfig</code> token for <code>test-cluster</code>.</li>
<li>The configured external auth provider is disabled.</li>
</ol>
<p>In this scenario, the <code>kubeconfig</code> generated in step 4 will still be valid after step 5, and <code>test-cluster</code> can still be accessed using the <code>kubeconfig</code> token.</p>
<p>By default, tokens for authenticated session have their <code>ttl</code> (time to live) set to <code>960</code> minutes, so they will expire after <code>16</code> hours. <code>kubeconfig</code> tokens are configured to never expire, and their <code>ttl</code> is set to <code>0</code>. These configurations can be changed in the Rancher's settings (<code>Configuration &gt; Global Settings &gt; Settings</code>) with the <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">parameters</a>  <code>auth-user-session-ttl-minutes</code> and <code>kubeconfig-default-token-ttl-minutes</code>, respectively.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you cannot update to a patched Rancher version, the recommended workaround is to review and remove tokens associated with auth providers manually.</p>
<p>The tokens can be reviewed by executing <code>kubectl get tokens</code> in Rancher's <code>local</code> cluster. Each found token must be manually reviewed to check if it belongs to a user from a disabled auth provider or a user who's access was previously removed from the auth provider (when the auth provider is still enabled and is or was configured to use access level scopes, as mentioned above). The identified tokens can be removed with <code>kubectl delete tokens &lt;token_name&gt;</code>.</p>
<p>It is important to mention that this workaround must be done every time an auth provider is disabled in case you cannot update to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions. After updating to a patched version, it is highly recommended to review the existing tokens and remove tokens related to disabled auth providers as described above in the workaround section.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9">https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9</a></li>
<li><a href="https://github.com/advisories/GHSA-c45c-39f6-6gw9">https://github.com/advisories/GHSA-c45c-39f6-6gw9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c45c-39f6-6gw9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:38:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher generated tokens not revoked after modifications made to authentication provider]]></title>
        <id>https://github.com/advisories/GHSA-c45c-39f6-6gw9</id>
        <link href="https://github.com/advisories/GHSA-c45c-39f6-6gw9"/>
        <updated>2023-01-25T19:38:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It only affects Rancher setups that have an external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> configured or had one configured in the past.</p>
<p>It was discovered that when an external authentication provider is configured in Rancher and then disabled, the Rancher generated <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">tokens</a> associated with users who had access granted through the now disabled auth provider are not revoked. This allows users to retain access to Rancher and <code>kubectl</code> access to clusters managed by Rancher, according to their previous configured permissions, even after they are supposed to have lost it due to the auth provider been disabled.</p>
<p>The problem also occurs if the auth provider is configured (and is still enabled) to use the <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">access level scopes</a> <code>allow members of clusters and projects, plus authorized users &amp; groups</code> and <code>restrict access to only the authorized users &amp; groups</code>. In this case, removing users and groups from the authorized lists will not revoke the access tokens and they will remain valid.</p>
<p>An example scenario is:</p>
<ol>
<li>OpenLDAP, MS Active Directory (AD) or any other external <a href="https://ranchermanager.docs.rancher.com/pages-for-subheaders/authentication-config">authentication provider</a> is configured as an auth provider.</li>
<li>A user (<code>cluster-owner</code>) is granted <code>cluster-owner</code> permissions on a downstream cluster (<code>test-cluster</code>).</li>
<li><code>cluster-owner</code> logs in using their external auth provider username and password.</li>
<li><code>cluster-owner</code> generates a <code>kubeconfig</code> token for <code>test-cluster</code>.</li>
<li>The configured external auth provider is disabled.</li>
</ol>
<p>In this scenario, the <code>kubeconfig</code> generated in step 4 will still be valid after step 5, and <code>test-cluster</code> can still be accessed using the <code>kubeconfig</code> token.</p>
<p>By default, tokens for authenticated session have their <code>ttl</code> (time to live) set to <code>960</code> minutes, so they will expire after <code>16</code> hours. <code>kubeconfig</code> tokens are configured to never expire, and their <code>ttl</code> is set to <code>0</code>. These configurations can be changed in the Rancher's settings (<code>Configuration &gt; Global Settings &gt; Settings</code>) with the <a href="https://ranchermanager.docs.rancher.com/reference-guides/about-the-api/api-tokens">parameters</a>  <code>auth-user-session-ttl-minutes</code> and <code>kubeconfig-default-token-ttl-minutes</code>, respectively.</p>
<h3 id="workarounds">Workarounds</h3>
<p>If you cannot update to a patched Rancher version, the recommended workaround is to review and remove tokens associated with auth providers manually.</p>
<p>The tokens can be reviewed by executing <code>kubectl get tokens</code> in Rancher's <code>local</code> cluster. Each found token must be manually reviewed to check if it belongs to a user from a disabled auth provider or a user who's access was previously removed from the auth provider (when the auth provider is still enabled and is or was configured to use access level scopes, as mentioned above). The identified tokens can be removed with <code>kubectl delete tokens &lt;token_name&gt;</code>.</p>
<p>It is important to mention that this workaround must be done every time an auth provider is disabled in case you cannot update to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions. After updating to a patched version, it is highly recommended to review the existing tokens and remove tokens related to disabled auth providers as described above in the workaround section.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9">https://github.com/rancher/rancher/security/advisories/GHSA-c45c-39f6-6gw9</a></li>
<li><a href="https://github.com/advisories/GHSA-c45c-39f6-6gw9">https://github.com/advisories/GHSA-c45c-39f6-6gw9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c45c-39f6-6gw9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:38:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Plaintext storage of sensitive data in Rancher API and cluster.management.cattle.io objects]]></title>
        <id>https://github.com/advisories/GHSA-cq4p-vp5q-4522</id>
        <link href="https://github.com/advisories/GHSA-cq4p-vp5q-4522"/>
        <updated>2023-01-25T19:36:59.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It was discovered that the security advisory CVE-2021-36782 (GHSA-g7j7-h4q8-8w2f), previously released by Rancher, missed addressing some sensitive fields, secret tokens, encryption keys, and SSH keys that were still being stored in plaintext directly on Kubernetes objects like <code>Clusters</code>.</p>
<p>The exposed credentials are visible in Rancher to authenticated <code>Cluster Owners</code>, <code>Cluster Members</code>, <code>Project Owners</code> and <code>Project Members</code> of that cluster on the endpoints:</p>
<ul>
<li><code>/v1/management.cattle.io.cluster</code></li>
<li><code>/v1/management.cattle.io.clustertemplaterevisions</code></li>
</ul>
<p>The remaining sensitive fields are now stripped from <code>Clusters</code> and other objects and moved to a <code>Secret</code> before the object is stored. The <code>Secret</code> is retrieved when the credential is needed. For objects that existed before this security fix, a one-time migration happens on startup.</p>
<p>The fields that have been addressed by this security fix are:</p>
<ul>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESGCM.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESCBC.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].SecretboxConfiguration.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.Kubelet.ExtraEnv</code> when containing the <code>AWS_SECRET_ACCESS_KEY</code> environment variable</li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.BastionHost.SSHKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSecretAccessKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSessionToken</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.ApicUserKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.KafkaClientKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.Token</code></li>
</ul>
<p><strong>Important:</strong></p>
<ul>
<li><p>For the exposure of credentials not related to Rancher, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>
</li>
<li><p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>
</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no direct mitigation besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>After upgrading to a patched version, it is important to check for the <code>ACISecretsMigrated</code> and <code>RKESecretsMigrated</code> conditions on <code>Clusters</code> and <code>ClusterTemplateRevisions</code> to confirm when secrets have been fully migrated off of those objects, and the objects scoped within them.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522">https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522</a></li>
<li><a href="https://github.com/advisories/GHSA-cq4p-vp5q-4522">https://github.com/advisories/GHSA-cq4p-vp5q-4522</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cq4p-vp5q-4522</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T19:36:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Plaintext storage of sensitive data in Rancher API and cluster.management.cattle.io objects]]></title>
        <id>https://github.com/advisories/GHSA-cq4p-vp5q-4522</id>
        <link href="https://github.com/advisories/GHSA-cq4p-vp5q-4522"/>
        <updated>2023-01-25T19:36:59.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It was discovered that the security advisory CVE-2021-36782 (GHSA-g7j7-h4q8-8w2f), previously released by Rancher, missed addressing some sensitive fields, secret tokens, encryption keys, and SSH keys that were still being stored in plaintext directly on Kubernetes objects like <code>Clusters</code>.</p>
<p>The exposed credentials are visible in Rancher to authenticated <code>Cluster Owners</code>, <code>Cluster Members</code>, <code>Project Owners</code> and <code>Project Members</code> of that cluster on the endpoints:</p>
<ul>
<li><code>/v1/management.cattle.io.cluster</code></li>
<li><code>/v1/management.cattle.io.clustertemplaterevisions</code></li>
</ul>
<p>The remaining sensitive fields are now stripped from <code>Clusters</code> and other objects and moved to a <code>Secret</code> before the object is stored. The <code>Secret</code> is retrieved when the credential is needed. For objects that existed before this security fix, a one-time migration happens on startup.</p>
<p>The fields that have been addressed by this security fix are:</p>
<ul>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESGCM.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESCBC.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].SecretboxConfiguration.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.Kubelet.ExtraEnv</code> when containing the <code>AWS_SECRET_ACCESS_KEY</code> environment variable</li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.BastionHost.SSHKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSecretAccessKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSessionToken</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.ApicUserKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.KafkaClientKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.Token</code></li>
</ul>
<p><strong>Important:</strong></p>
<ul>
<li><p>For the exposure of credentials not related to Rancher, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>
</li>
<li><p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>
</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no direct mitigation besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>After upgrading to a patched version, it is important to check for the <code>ACISecretsMigrated</code> and <code>RKESecretsMigrated</code> conditions on <code>Clusters</code> and <code>ClusterTemplateRevisions</code> to confirm when secrets have been fully migrated off of those objects, and the objects scoped within them.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522">https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522</a></li>
<li><a href="https://github.com/advisories/GHSA-cq4p-vp5q-4522">https://github.com/advisories/GHSA-cq4p-vp5q-4522</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cq4p-vp5q-4522</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T19:36:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Plaintext storage of sensitive data in Rancher API and cluster.management.cattle.io objects]]></title>
        <id>https://github.com/advisories/GHSA-cq4p-vp5q-4522</id>
        <link href="https://github.com/advisories/GHSA-cq4p-vp5q-4522"/>
        <updated>2023-01-25T19:36:59.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue affects Rancher versions from 2.5.0 up to and including 2.5.16, from 2.6.0 up to and including 2.6.9 and 2.7.0. It was discovered that the security advisory CVE-2021-36782 (GHSA-g7j7-h4q8-8w2f), previously released by Rancher, missed addressing some sensitive fields, secret tokens, encryption keys, and SSH keys that were still being stored in plaintext directly on Kubernetes objects like <code>Clusters</code>.</p>
<p>The exposed credentials are visible in Rancher to authenticated <code>Cluster Owners</code>, <code>Cluster Members</code>, <code>Project Owners</code> and <code>Project Members</code> of that cluster on the endpoints:</p>
<ul>
<li><code>/v1/management.cattle.io.cluster</code></li>
<li><code>/v1/management.cattle.io.clustertemplaterevisions</code></li>
</ul>
<p>The remaining sensitive fields are now stripped from <code>Clusters</code> and other objects and moved to a <code>Secret</code> before the object is stored. The <code>Secret</code> is retrieved when the credential is needed. For objects that existed before this security fix, a one-time migration happens on startup.</p>
<p>The fields that have been addressed by this security fix are:</p>
<ul>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESGCM.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].AESCBC.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.KubeAPI.SecretsEncryptionConfig.CustomConfig.Providers[].SecretboxConfiguration.Keys[].Secret</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Services.Kubelet.ExtraEnv</code> when containing the <code>AWS_SECRET_ACCESS_KEY</code> environment variable</li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.BastionHost.SSHKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSecretAccessKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.PrivateRegistries[].ECRCredentialPlugin.AwsSessionToken</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.ApicUserKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.KafkaClientKey</code></li>
<li><code>Cluster.Spec.RancherKubernetesEngineConfig.Network.AciNetworkProvider.Token</code></li>
</ul>
<p><strong>Important:</strong></p>
<ul>
<li><p>For the exposure of credentials not related to Rancher, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>
</li>
<li><p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>
</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no direct mitigation besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>After upgrading to a patched version, it is important to check for the <code>ACISecretsMigrated</code> and <code>RKESecretsMigrated</code> conditions on <code>Clusters</code> and <code>ClusterTemplateRevisions</code> to confirm when secrets have been fully migrated off of those objects, and the objects scoped within them.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522">https://github.com/rancher/rancher/security/advisories/GHSA-cq4p-vp5q-4522</a></li>
<li><a href="https://github.com/advisories/GHSA-cq4p-vp5q-4522">https://github.com/advisories/GHSA-cq4p-vp5q-4522</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cq4p-vp5q-4522</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-25T19:36:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Command injection in Rancher Git package]]></title>
        <id>https://github.com/advisories/GHSA-34p5-jp77-fcrc</id>
        <link href="https://github.com/advisories/GHSA-34p5-jp77-fcrc"/>
        <updated>2023-01-25T19:36:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An issue was discovered in Rancher from versions 2.5.0 up to and including 2.5.16, 2.6.0 up to and including 2.6.9 and 2.7.0, where a command injection vulnerability is present in the Rancher Git package. This package uses the underlying Git binary available in the Rancher container image to execute Git operations.</p>
<p>Specially crafted commands, when not properly disambiguated, can cause confusion when executed through Git, resulting in command injection in the underlying Rancher host.</p>
<p>This issue can potentially be exploited in Rancher in two ways:</p>
<ol>
<li>Adding an untrusted Helm catalog, in the Catalogs menu, that contains maliciously designed repo URL configuration in Helm charts.</li>
<li>Modifying the URL configuration used to download KDM (Kontainer Driver Metadata) releases.</li>
</ol>
<p>By default, only the Rancher admin has permission to manage both configurations for the local cluster (the cluster where Rancher is provisioned).</p>
<p>Note: More information about this category of issue in version control system (VCS) tools are available in Snyk's <a href="https://snyk.io/blog/argument-injection-when-using-git-and-mercurial/">blog post</a>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Except for only adding trusted catalogs and the KDM URL to Rancher, there is no other workaround besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>It is also important to update to a patched version in case Rancher or its standalone Git package implementation is used as a Go library instead of the application itself. Otherwise, this vulnerability might affect your dependent code.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc">https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc</a></li>
<li><a href="https://github.com/advisories/GHSA-34p5-jp77-fcrc">https://github.com/advisories/GHSA-34p5-jp77-fcrc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-34p5-jp77-fcrc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:36:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Command injection in Rancher Git package]]></title>
        <id>https://github.com/advisories/GHSA-34p5-jp77-fcrc</id>
        <link href="https://github.com/advisories/GHSA-34p5-jp77-fcrc"/>
        <updated>2023-01-25T19:36:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An issue was discovered in Rancher from versions 2.5.0 up to and including 2.5.16, 2.6.0 up to and including 2.6.9 and 2.7.0, where a command injection vulnerability is present in the Rancher Git package. This package uses the underlying Git binary available in the Rancher container image to execute Git operations.</p>
<p>Specially crafted commands, when not properly disambiguated, can cause confusion when executed through Git, resulting in command injection in the underlying Rancher host.</p>
<p>This issue can potentially be exploited in Rancher in two ways:</p>
<ol>
<li>Adding an untrusted Helm catalog, in the Catalogs menu, that contains maliciously designed repo URL configuration in Helm charts.</li>
<li>Modifying the URL configuration used to download KDM (Kontainer Driver Metadata) releases.</li>
</ol>
<p>By default, only the Rancher admin has permission to manage both configurations for the local cluster (the cluster where Rancher is provisioned).</p>
<p>Note: More information about this category of issue in version control system (VCS) tools are available in Snyk's <a href="https://snyk.io/blog/argument-injection-when-using-git-and-mercurial/">blog post</a>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Except for only adding trusted catalogs and the KDM URL to Rancher, there is no other workaround besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>It is also important to update to a patched version in case Rancher or its standalone Git package implementation is used as a Go library instead of the application itself. Otherwise, this vulnerability might affect your dependent code.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc">https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc</a></li>
<li><a href="https://github.com/advisories/GHSA-34p5-jp77-fcrc">https://github.com/advisories/GHSA-34p5-jp77-fcrc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-34p5-jp77-fcrc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:36:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Command injection in Rancher Git package]]></title>
        <id>https://github.com/advisories/GHSA-34p5-jp77-fcrc</id>
        <link href="https://github.com/advisories/GHSA-34p5-jp77-fcrc"/>
        <updated>2023-01-25T19:36:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An issue was discovered in Rancher from versions 2.5.0 up to and including 2.5.16, 2.6.0 up to and including 2.6.9 and 2.7.0, where a command injection vulnerability is present in the Rancher Git package. This package uses the underlying Git binary available in the Rancher container image to execute Git operations.</p>
<p>Specially crafted commands, when not properly disambiguated, can cause confusion when executed through Git, resulting in command injection in the underlying Rancher host.</p>
<p>This issue can potentially be exploited in Rancher in two ways:</p>
<ol>
<li>Adding an untrusted Helm catalog, in the Catalogs menu, that contains maliciously designed repo URL configuration in Helm charts.</li>
<li>Modifying the URL configuration used to download KDM (Kontainer Driver Metadata) releases.</li>
</ol>
<p>By default, only the Rancher admin has permission to manage both configurations for the local cluster (the cluster where Rancher is provisioned).</p>
<p>Note: More information about this category of issue in version control system (VCS) tools are available in Snyk's <a href="https://snyk.io/blog/argument-injection-when-using-git-and-mercurial/">blog post</a>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Except for only adding trusted catalogs and the KDM URL to Rancher, there is no other workaround besides updating Rancher to a patched version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<p>It is also important to update to a patched version in case Rancher or its standalone Git package implementation is used as a Go library instead of the application itself. Otherwise, this vulnerability might affect your dependent code.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc">https://github.com/rancher/rancher/security/advisories/GHSA-34p5-jp77-fcrc</a></li>
<li><a href="https://github.com/advisories/GHSA-34p5-jp77-fcrc">https://github.com/advisories/GHSA-34p5-jp77-fcrc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-34p5-jp77-fcrc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:36:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Authenticated user can gain unauthorized shell pod and kubectl access in the local cluster]]></title>
        <id>https://github.com/advisories/GHSA-g25r-gvq3-wrq7</id>
        <link href="https://github.com/advisories/GHSA-g25r-gvq3-wrq7"/>
        <updated>2023-01-25T19:36:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An issue was discovered in Rancher where an authorization logic flaw allows an authenticated user on any downstream cluster to (1) open a shell pod in the Rancher <code>local</code> cluster and (2) have limited <code>kubectl</code> access to it. The expected behavior is that a user does not have such access in the Rancher <code>local</code> cluster unless explicitly granted.</p>
<p>This issue does not allow the user to escalate privileges in the <code>local</code> cluster directly (this would require another vulnerability to be exploited).</p>
<p>The security issue happens in two different ways:</p>
<ol>
<li><p>Shell pod access - This is when a user opens a shell pod in the Rancher UI to a downstream cluster that the user has permission to access. The web request can be intercepted using the browser's web inspector/network console or a proxy tool to change the shell's destination to the Rancher <code>local</code> cluster instead of the desired downstream cluster.</p>
<ul>
<li><p>This flaw cannot be exploited to access a downstream cluster that the user has no permissions to.</p>
</li>
<li><p>The shell pod runs with a limited non-root user, reducing the severity of this issue. However, even as a non-root user, it is still possible download and run binaries inside the shell pod.</p>
</li>
<li><p>The blast radius of this issue can increase based on the configuration of the <code>local</code> cluster. For example:</p>
<ul>
<li><p>If the <code>local</code> cluster has unlimited network access, e.g. to the Internet, the user can open a reverse network connection to the shell pod.</p>
</li>
<li><p>Or access the cloud metadata API of the underlying cloud infrastructure, where the user can extract the credentials associated with the <code>local</code> cluster and use them to interact with the cloud environment (this will be limited by the permissions granted to the cloud credentials in question). </p>
</li>
<li><p>Check further recommendations about liming access to the cloud metadata API in Rancher's <a href="https://ranchermanager.docs.rancher.com/reference-guides/rancher-security/kubernetes-security-best-practices">security best practices</a>.</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Kubectl access - When downloading the kubeconfig file of a downstream cluster that the user has access to, the <code>server</code> cluster address in the kubeconfig file can be changed to point to the Rancher <code>local</code> cluster instead of the intended downstream cluster.</p>
<ul>
<li><p>This can also be achieved by crafting a kubeconfig using a Rancher token instead of using the kubeconfig from an active cluster. </p>
</li>
<li><p>This flaw cannot be exploited to access a downstream cluster that the user has no permissions to.</p>
</li>
</ul>
</li>
</ol>
<p>Notes:</p>
<ul>
<li>Rancher <code>local</code> cluster means the cluster where Rancher is installed. It is named as <code>local</code> inside the list of clusters in the Rancher UI.</li>
<li>Audit logs in Rancher can be used to identify possible abuses of this issue, by tracking API requests to the user ID of the user that performed the action. API audit logs can be enabled as described in the <a href="https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-api-audit-log">documentation</a> when set to level <code>1</code> or above.</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround or direct mitigation besides updating to a patched Rancher version.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases 2.5.17, 2.6.10, 2.7.1 and later versions.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-g25r-gvq3-wrq7">https://github.com/rancher/rancher/security/advisories/GHSA-g25r-gvq3-wrq7</a></li>
<li><a href="https://github.com/advisories/GHSA-g25r-gvq3-wrq7">https://github.com/advisories/GHSA-g25r-gvq3-wrq7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g25r-gvq3-wrq7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-25T19:36:09.000Z</published>
    </entry>
</feed>