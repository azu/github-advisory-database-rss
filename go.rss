<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/go.rss</id>
    <title>Security Advisory for Go modules</title>
    <updated>2024-06-22T07:02:14.375Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago"/>
    <subtitle>Security Advisory for Go modules on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[github.com/lightningnetwork/lnd] Lightning Network Daemon (LND)'s onion processing logic leads to a denial of service]]></title>
        <id>https://github.com/advisories/GHSA-9gxx-58q6-42p7</id>
        <link href="https://github.com/advisories/GHSA-9gxx-58q6-42p7"/>
        <updated>2024-06-21T14:02:37.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A parsing vulnerability in lnd's onion processing logic led to a DoS vector due to excessive memory allocation. </p>
<h3 id="patches">Patches</h3>
<p>The issue was patched in lnd <a href="https://github.com/lightningnetwork/lnd/releases/tag/v0.17.0-beta">v0.17.0</a>. Users should update to a version &gt;= v0.17.0 to be protected. </p>
<h3 id="references">References</h3>
<p>Detailed blog post: <a href="https://morehouse.github.io/lightning/lnd-onion-bomb/">https://morehouse.github.io/lightning/lnd-onion-bomb/</a></p>
<p>Developer discussion: <a href="https://delvingbitcoin.org/t/dos-disclosure-lnd-onion-bomb/979">https://delvingbitcoin.org/t/dos-disclosure-lnd-onion-bomb/979</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/lightningnetwork/lnd/security/advisories/GHSA-9gxx-58q6-42p7">https://github.com/lightningnetwork/lnd/security/advisories/GHSA-9gxx-58q6-42p7</a></li>
<li><a href="https://delvingbitcoin.org/t/dos-disclosure-lnd-onion-bomb/979">https://delvingbitcoin.org/t/dos-disclosure-lnd-onion-bomb/979</a></li>
<li><a href="https://github.com/lightningnetwork/lnd/releases/tag/v0.17.0-beta">https://github.com/lightningnetwork/lnd/releases/tag/v0.17.0-beta</a></li>
<li><a href="https://morehouse.github.io/lightning/lnd-onion-bomb">https://morehouse.github.io/lightning/lnd-onion-bomb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-38359">https://nvd.nist.gov/vuln/detail/CVE-2024-38359</a></li>
<li><a href="https://lightning.network">https://lightning.network</a></li>
<li><a href="https://github.com/advisories/GHSA-9gxx-58q6-42p7">https://github.com/advisories/GHSA-9gxx-58q6-42p7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9gxx-58q6-42p7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-20T19:18:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/authzed/spicedb] SpiceDB exclusions can result in no permission returned when permission expected]]></title>
        <id>https://github.com/advisories/GHSA-grjv-gjgr-66g2</id>
        <link href="https://github.com/advisories/GHSA-grjv-gjgr-66g2"/>
        <updated>2024-06-21T14:02:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="background">Background</h3>
<p>Use of an exclusion under an arrow that has multiple resources may resolve to <code>NO_PERMISSION</code> when permission is expected.</p>
<p>For example, given this schema:</p>
<pre><code class="language-zed">definition user {}

definition folder {
  relation member: user
  relation banned: user
  permission view = member - banned
}

definition resource {
  relation folder: folder
  permission view = folder-&gt;view
}
</code></pre>
<p>If the resource exists under <em>multiple</em> folders and the user has access to view more than a single folder, SpiceDB may report the user does not have access due to a failure in the exclusion dispatcher to request that <em>all</em> the folders in which the user is a member be returned</p>
<h3 id="impact">Impact</h3>
<p>Permission is returned as <code>NO_PERMISSION</code> when <code>PERMISSION</code> is expected on the <code>CheckPermission</code> API.</p>
<h3 id="workarounds">Workarounds</h3>
<p>None</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/authzed/spicedb/security/advisories/GHSA-grjv-gjgr-66g2">https://github.com/authzed/spicedb/security/advisories/GHSA-grjv-gjgr-66g2</a></li>
<li><a href="https://github.com/authzed/spicedb/commit/ecef31d2b266fde17eb2c3415e2ec4ceff96fbeb">https://github.com/authzed/spicedb/commit/ecef31d2b266fde17eb2c3415e2ec4ceff96fbeb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-38361">https://nvd.nist.gov/vuln/detail/CVE-2024-38361</a></li>
<li><a href="https://github.com/advisories/GHSA-grjv-gjgr-66g2">https://github.com/advisories/GHSA-grjv-gjgr-66g2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-grjv-gjgr-66g2</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-06-20T16:24:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik/v2] ACME DNS: Azure Identity Libraries Elevation of Privilege Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-rvj4-q8q5-8grf</id>
        <link href="https://github.com/advisories/GHSA-rvj4-q8q5-8grf"/>
        <updated>2024-06-20T16:20:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There is a vulnerability in <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">CVE-2024-35255</a></li>
</ul>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.5">https://github.com/traefik/traefik/releases/tag/v2.11.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.3">https://github.com/traefik/traefik/releases/tag/v3.0.3</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>No workaround.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please <a href="https://github.com/traefik/traefik/issues">open an issue</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-rvj4-q8q5-8grf">https://github.com/traefik/traefik/security/advisories/GHSA-rvj4-q8q5-8grf</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">https://nvd.nist.gov/vuln/detail/CVE-2024-35255</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.5">https://github.com/traefik/traefik/releases/tag/v2.11.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.3">https://github.com/traefik/traefik/releases/tag/v3.0.3</a></li>
<li><a href="https://github.com/advisories/GHSA-rvj4-q8q5-8grf">https://github.com/advisories/GHSA-rvj4-q8q5-8grf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rvj4-q8q5-8grf</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-20T16:20:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/traefik/traefik/v3] ACME DNS: Azure Identity Libraries Elevation of Privilege Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-rvj4-q8q5-8grf</id>
        <link href="https://github.com/advisories/GHSA-rvj4-q8q5-8grf"/>
        <updated>2024-06-20T16:20:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There is a vulnerability in <a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">CVE-2024-35255</a></li>
</ul>
<h3 id="patches">Patches</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.5">https://github.com/traefik/traefik/releases/tag/v2.11.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.3">https://github.com/traefik/traefik/releases/tag/v3.0.3</a></li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>No workaround.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please <a href="https://github.com/traefik/traefik/issues">open an issue</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/traefik/traefik/security/advisories/GHSA-rvj4-q8q5-8grf">https://github.com/traefik/traefik/security/advisories/GHSA-rvj4-q8q5-8grf</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">https://nvd.nist.gov/vuln/detail/CVE-2024-35255</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v2.11.5">https://github.com/traefik/traefik/releases/tag/v2.11.5</a></li>
<li><a href="https://github.com/traefik/traefik/releases/tag/v3.0.3">https://github.com/traefik/traefik/releases/tag/v3.0.3</a></li>
<li><a href="https://github.com/advisories/GHSA-rvj4-q8q5-8grf">https://github.com/advisories/GHSA-rvj4-q8q5-8grf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rvj4-q8q5-8grf</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-20T16:20:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/go-skynet/LocalAI] LocalAI path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-cpcx-r2gq-x893</id>
        <link href="https://github.com/advisories/GHSA-cpcx-r2gq-x893"/>
        <updated>2024-06-20T16:12:33.000Z</updated>
        <content type="html"><![CDATA[<p>A path traversal vulnerability exists in mudler/localai version 2.14.0, where an attacker can exploit the <code>model</code> parameter during the model deletion process to delete arbitrary files. Specifically, by crafting a request with a manipulated <code>model</code> parameter, an attacker can traverse the directory structure and target files outside of the intended directory, leading to the deletion of sensitive data. This vulnerability is due to insufficient input validation and sanitization of the <code>model</code> parameter.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-5182">https://nvd.nist.gov/vuln/detail/CVE-2024-5182</a></li>
<li><a href="https://github.com/mudler/localai/commit/1a3dedece06cab1acc3332055d285ac540a47f0e">https://github.com/mudler/localai/commit/1a3dedece06cab1acc3332055d285ac540a47f0e</a></li>
<li><a href="https://huntr.com/bounties/f7a87f29-c22a-48e8-9fce-b6d5a273e545">https://huntr.com/bounties/f7a87f29-c22a-48e8-9fce-b6d5a273e545</a></li>
<li><a href="https://github.com/advisories/GHSA-cpcx-r2gq-x893">https://github.com/advisories/GHSA-cpcx-r2gq-x893</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cpcx-r2gq-x893</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-20T00:30:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/drakkan/sftpgo/v2] SFTPGo has insufficient access control for password reset]]></title>
        <id>https://github.com/advisories/GHSA-hw5f-6wvv-xcrh</id>
        <link href="https://github.com/advisories/GHSA-hw5f-6wvv-xcrh"/>
        <updated>2024-06-20T19:16:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>SFTPGo WebAdmin and WebClient support password reset. This feature is disabled in the default configuration.
In SFTPGo versions prior to v2.6.1, if the feature is enabled, even users with access restrictions (e.g. expired) can reset their password and log in.</p>
<h3 id="patches">Patches</h3>
<p>Fixed in v2.6.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>The following workarounds are available:</p>
<ul>
<li>keep the password reset feature disabled.</li>
<li>Set a blank email address for users and admins with access restrictions so they cannot receive the email with the reset code and exploit the vulnerability.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/drakkan/sftpgo/security/advisories/GHSA-hw5f-6wvv-xcrh">https://github.com/drakkan/sftpgo/security/advisories/GHSA-hw5f-6wvv-xcrh</a></li>
<li><a href="https://github.com/drakkan/sftpgo/releases/tag/v2.6.1">https://github.com/drakkan/sftpgo/releases/tag/v2.6.1</a></li>
<li><a href="https://github.com/drakkan/sftpgo/commit/3462bba3f41cbc75486474991b9e3ac1b5f1e583">https://github.com/drakkan/sftpgo/commit/3462bba3f41cbc75486474991b9e3ac1b5f1e583</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37897">https://nvd.nist.gov/vuln/detail/CVE-2024-37897</a></li>
<li><a href="https://github.com/drakkan/sftpgo/commit/1f8ac8bfe16100b0484d6c91e1e8361687324423">https://github.com/drakkan/sftpgo/commit/1f8ac8bfe16100b0484d6c91e1e8361687324423</a></li>
<li><a href="https://github.com/advisories/GHSA-hw5f-6wvv-xcrh">https://github.com/advisories/GHSA-hw5f-6wvv-xcrh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hw5f-6wvv-xcrh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-20T16:11:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/pocketbase/pocketbase] PocketBase performs password auth and OAuth2 unverified email linking]]></title>
        <id>https://github.com/advisories/GHSA-m93w-4fxv-r35v</id>
        <link href="https://github.com/advisories/GHSA-m93w-4fxv-r35v"/>
        <updated>2024-06-18T20:29:34.000Z</updated>
        <content type="html"><![CDATA[<p><strong>In order to be exploited you must have both OAuth2 and Password auth methods enabled.</strong></p>
<p>A possible attack scenario could be:</p>
<ul>
<li>a malicious actor register with the targeted user's email (it is unverified)</li>
<li>at some later point in time the targeted user stumble on your app and decides to sign-up with OAuth2 (<em>this step could be also initiated by the attacker by sending an invite email to the targeted user</em>)</li>
<li>on successful OAuth2 auth we search for an existing PocketBase user matching with the OAuth2 user's email and associate them</li>
<li>because we haven't changed the password of the existing PocketBase user during the linking, the malicious actor has access to the targeted user account and will be able to login with the initially created email/password</li>
</ul>
<p>To prevent this for happening we now reset the password for this specific case if the previously created user wasn't verified (an exception to this is if the linking is explicit/manual, aka. when you send <code>Authorization:TOKEN</code> with the OAuth2 auth call).</p>
<p>Additionally to warn existing users we now send an email alert in case the user has logged in with password but has at least one OAuth2 account linked. It looks something like:</p>
<p><em>Hello,
Just to let you know that someone has logged in to your Acme account using a password while you already have OAuth2 GitLab auth linked.
If you have recently signed in with a password, you may disregard this email.
<strong>If you don't recognize the above action, you should immediately change your Acme account password.</strong>
Thanks,
Acme team</em></p>
<p>The flow will be further improved with the <a href="https://github.com/pocketbase/pocketbase/discussions/4355">ongoing refactoring</a> and we will start sending emails for "unrecognized device" logins (OTP and MFA is already implemented and will be available with the next v0.23.0 release in the near future).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pocketbase/pocketbase/security/advisories/GHSA-m93w-4fxv-r35v">https://github.com/pocketbase/pocketbase/security/advisories/GHSA-m93w-4fxv-r35v</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-38351">https://nvd.nist.gov/vuln/detail/CVE-2024-38351</a></li>
<li><a href="https://github.com/pocketbase/pocketbase/commit/58ace5d5e7b9b979490019cf8d1b88491e5daec5">https://github.com/pocketbase/pocketbase/commit/58ace5d5e7b9b979490019cf8d1b88491e5daec5</a></li>
<li><a href="https://github.com/pocketbase/pocketbase/discussions/4355">https://github.com/pocketbase/pocketbase/discussions/4355</a></li>
<li><a href="https://github.com/advisories/GHSA-m93w-4fxv-r35v">https://github.com/advisories/GHSA-m93w-4fxv-r35v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m93w-4fxv-r35v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-18T20:29:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/stacklok/minder] Minder affected by denial of service from maliciously configured Git repository]]></title>
        <id>https://github.com/advisories/GHSA-hpcg-xjq5-g666</id>
        <link href="https://github.com/advisories/GHSA-hpcg-xjq5-g666"/>
        <updated>2024-06-18T19:27:36.000Z</updated>
        <content type="html"><![CDATA[<p>Minder's Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository. The Git provider clones users repositories using the <code>github.com/go-git/go-git/v5</code> library on these lines:</p>
<p><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89</a></p>
<p>The Git provider does the following on these lines:</p>
<p>First, it sets the <code>CloneOptions</code>, specifying the url, the depth etc:</p>
<p><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62</a></p>
<p>It then validates the options: </p>
<p><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L66-L68">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L66-L68</a></p>
<p>It then sets up an in-memory filesystem, to which it clones:</p>
<p><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L70-L71">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L70-L71</a></p>
<p>Finally, it clones the repository:</p>
<p><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L77">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L77</a></p>
<p>This <code>(g *Git) Clone()</code> method is vulnerable to a DoS attack: A Minder user can instruct Minder to clone a large repository which will exhaust memory and crash the Minder server. The root cause of this vulnerability is a combination of the following conditions:</p>
<ol>
<li>Users can control the Git URL which Minder clones.</li>
<li>Minder does not enforce a size limit to the repository.</li>
<li>Minder clones the entire repository into memory.</li>
</ol>
<h2 id="poc">PoC</h2>
<p>Here, we share a PoC of how the logic of <code>(g *Git) Clone()</code> behaves isolated from Minder. To get a true assessment of whether this is 100% identical to its behavior in the context of Minder instead of an isolated PoC, this should be tested out by creating a large repository and instructing Minder to clone it. However, even in that case, it might not be possible to deterministically trigger a DoS because of noise from network calls.</p>
<p>We believe the below PoC is a correct representation because:</p>
<ol>
<li>We have replicated the important and impactful parts of <code>(g *Git) Clone()</code></li>
<li>We run this in multiple goroutines which Minder does here: <a href="https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L128">https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L128</a></li>
<li>Minders timeout is set to 5 minutes: <a href="https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L114">https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L114</a>. With a reasonable connection, Minder can download many GBs in that period.</li>
</ol>
<p>In our PoC, we demonstrate that under these two conditions, a large repository can perform a SigKill of the Go process which in Minders case is the Minder server.</p>
<p>First, create a local Git repository:</p>
<pre><code>cd /tmp
mkdir upstream-repo
cd upstream-repo
git init --bare
cd /tmp
git clone /tmp/upstream-repo ./upstream-repo-clone
cd ./upstream-repo-clone
# Add large file:
fallocate -l 8G large-file
git add .
git commit -m "add large file"
git push
cd /tmp
</code></pre>
<p>Create and run the following script in <code>/tmp/dos-poc/main.go</code>:</p>
<pre><code class="language-go">package main

import (
        "context"
        "fmt"
        "github.com/go-git/go-billy/v5/memfs"
        "github.com/go-git/go-git/v5"
        "github.com/go-git/go-git/v5/storage/memory"
        "runtime"
        "sync"
)

func main() {
        var (
                wg  sync.WaitGroup
        )

        for i := 0; i &lt; 2; i++ {
                fmt.Println("Starting one...")
                wg.Add(1)
                go func() {
                        defer wg.Done()
                        opts := &amp;git.CloneOptions{
                                URL:          "/tmp/upstream-repo",
                                SingleBranch: true,
                                Depth:        1,
                                Tags:         git.NoTags,
                        }

                        storer := memory.NewStorage()
                        fs := memfs.New()
                        git.CloneContext(context.Background(), storer, fs, opts)
                }()
        }
        fmt.Println("Finished")
        PrintMemUsage()
        wg.Wait()

}

func PrintMemUsage() {
        var m runtime.MemStats
        runtime.ReadMemStats(&amp;m)
        // For info on each, see: https://golang.org/pkg/runtime/#MemStats
        fmt.Printf("Alloc = %v MiB", bToMb(m.Alloc))
        fmt.Printf("\tTotalAlloc = %v MiB", bToMb(m.TotalAlloc))
        fmt.Printf("\tSys = %v MiB", bToMb(m.Sys))
        fmt.Printf("\tNumGC = %v\n", m.NumGC)
}

func bToMb(b uint64) uint64 {
        return b / 1024 / 1024
}
</code></pre>
<p>On my local machine, this Go program is killed before it prints "Finished" in the terminal. Observing the memory by way of <code>top</code>, we can see that the memory climbs steadily until the program crashes around 93% memory consumption.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/stacklok/minder/security/advisories/GHSA-hpcg-xjq5-g666">https://github.com/stacklok/minder/security/advisories/GHSA-hpcg-xjq5-g666</a></li>
<li><a href="https://github.com/stacklok/minder/commit/35bab8f9a6025eea9e6e3cef6bd80707ac03d2a9">https://github.com/stacklok/minder/commit/35bab8f9a6025eea9e6e3cef6bd80707ac03d2a9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37904">https://nvd.nist.gov/vuln/detail/CVE-2024-37904</a></li>
<li><a href="https://github.com/stacklok/minder/commit/7979b43">https://github.com/stacklok/minder/commit/7979b43</a></li>
<li><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89</a></li>
<li><a href="https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62</a></li>
<li><a href="https://github.com/advisories/GHSA-hpcg-xjq5-g666">https://github.com/advisories/GHSA-hpcg-xjq5-g666</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hpcg-xjq5-g666</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-18T16:34:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher's External RoleTemplates can lead to privilege escalation]]></title>
        <id>https://github.com/advisories/GHSA-64jq-m7rq-768h</id>
        <link href="https://github.com/advisories/GHSA-64jq-m7rq-768h"/>
        <updated>2024-06-17T22:30:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby privilege escalation checks are not properly enforced for <code>RoleTemplate</code>objects when external=true, which in specific scenarios can lead to privilege escalation.</p>
<p>The bug in the webhook rule resolver ignores rules from a <code>ClusterRole</code> for external <code>RoleTemplates</code> when its context is set to either <code>project</code> or is left empty. The fix introduces a new field to the <code>RoleTemplate</code> CRD named <code>ExternalRules</code>. The new field will be used to resolve rules directly from the <code>RoleTemplate</code>. Additionally, rules from the backing <code>ClusterRole</code> will be used if <code>ExternalRules</code> is not provided. The new field will always take precedence when it is set, and serve as the source of truth for rules used when creating Rancher resources on the local cluster.</p>
<p>Please note that this is a breaking change for external <code>RoleTemplates</code>, when context is set to <code>project</code> or empty and the backing <code>ClusterRole</code> does not exist, as this was not previously required.</p>
<p><strong>Important:</strong> The fix is automatically applied when upgrading to the release lines <code>2.8</code>and above. For users still on the <code>2.7</code> release line, after the upgrade to a patched version, users are required to opt-in to the fix by enabling the <code>external-rules</code> <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a>.</p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>The following script was developed for Rancher Manager administrators to identify <code>RoleTemplates</code> impacted by this vulnerability. The script requires <code>jq</code> installed and a <code>kubeconfig</code> with access to Rancher local cluster; it can also be executed in Rancher's kubectl shell.</p>
<pre><code class="language-bash">#!/bin/bash
set -euo pipefail

# get all RoleTemplates with .context == "project" or .context == "" that don't have externalRules.
rts=$(kubectl get roletemplates -o json | jq -r  '.items[] | select((.context == "project" or .context == "") and .external == true and .externalRules == null) | .metadata.name')
found_invalid_rt=false

for rt in $rts; do
  if ! kubectl get clusterrole "$rt" &gt; /dev/null 2&gt;&amp;1; then
     echo "$rt" # prints RoleTemplate names that don't have a backing ClusterRole
     found_invalid_rt=true
  fi
done

if ! $found_invalid_rt ; then
    echo 'This cluster is not affected by CVE-2023-32197: no RoleTemplate objects found'
fi
</code></pre>
<p>It will return all objects affected by this vulnerability. The administrator can fix those objects by creating the backing <code>ClusterRole</code> that they refer to.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32196">CVE-2023-32196</a></li>
</ul>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security-related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h">https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h</a></li>
<li><a href="https://github.com/advisories/GHSA-64jq-m7rq-768h">https://github.com/advisories/GHSA-64jq-m7rq-768h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-64jq-m7rq-768h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-17T22:30:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher's External RoleTemplates can lead to privilege escalation]]></title>
        <id>https://github.com/advisories/GHSA-64jq-m7rq-768h</id>
        <link href="https://github.com/advisories/GHSA-64jq-m7rq-768h"/>
        <updated>2024-06-17T22:30:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified whereby privilege escalation checks are not properly enforced for <code>RoleTemplate</code>objects when external=true, which in specific scenarios can lead to privilege escalation.</p>
<p>The bug in the webhook rule resolver ignores rules from a <code>ClusterRole</code> for external <code>RoleTemplates</code> when its context is set to either <code>project</code> or is left empty. The fix introduces a new field to the <code>RoleTemplate</code> CRD named <code>ExternalRules</code>. The new field will be used to resolve rules directly from the <code>RoleTemplate</code>. Additionally, rules from the backing <code>ClusterRole</code> will be used if <code>ExternalRules</code> is not provided. The new field will always take precedence when it is set, and serve as the source of truth for rules used when creating Rancher resources on the local cluster.</p>
<p>Please note that this is a breaking change for external <code>RoleTemplates</code>, when context is set to <code>project</code> or empty and the backing <code>ClusterRole</code> does not exist, as this was not previously required.</p>
<p><strong>Important:</strong> The fix is automatically applied when upgrading to the release lines <code>2.8</code>and above. For users still on the <code>2.7</code> release line, after the upgrade to a patched version, users are required to opt-in to the fix by enabling the <code>external-rules</code> <a href="https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags">feature flag</a>.</p>
<p>Please consult the associated <a href="https://attack.mitre.org/techniques/T1068/">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>The following script was developed for Rancher Manager administrators to identify <code>RoleTemplates</code> impacted by this vulnerability. The script requires <code>jq</code> installed and a <code>kubeconfig</code> with access to Rancher local cluster; it can also be executed in Rancher's kubectl shell.</p>
<pre><code class="language-bash">#!/bin/bash
set -euo pipefail

# get all RoleTemplates with .context == "project" or .context == "" that don't have externalRules.
rts=$(kubectl get roletemplates -o json | jq -r  '.items[] | select((.context == "project" or .context == "") and .external == true and .externalRules == null) | .metadata.name')
found_invalid_rt=false

for rt in $rts; do
  if ! kubectl get clusterrole "$rt" &gt; /dev/null 2&gt;&amp;1; then
     echo "$rt" # prints RoleTemplate names that don't have a backing ClusterRole
     found_invalid_rt=true
  fi
done

if ! $found_invalid_rt ; then
    echo 'This cluster is not affected by CVE-2023-32197: no RoleTemplate objects found'
fi
</code></pre>
<p>It will return all objects affected by this vulnerability. The administrator can fix those objects by creating the backing <code>ClusterRole</code> that they refer to.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32196">CVE-2023-32196</a></li>
</ul>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security-related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h">https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h</a></li>
<li><a href="https://github.com/advisories/GHSA-64jq-m7rq-768h">https://github.com/advisories/GHSA-64jq-m7rq-768h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-64jq-m7rq-768h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-17T22:30:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec]]></title>
        <id>https://github.com/advisories/GHSA-q6c7-56cq-g2wm</id>
        <link href="https://github.com/advisories/GHSA-q6c7-56cq-g2wm"/>
        <updated>2024-06-17T22:30:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue is only relevant to clusters provisioned using RKE1 with secrets encryption configuration enabled.</p>
<p>A vulnerability has been identified in which an RKE1 cluster keeps constantly reconciling when secrets encryption configuration is enabled (please see the <a href="https://rke.docs.rancher.com/config-options/secrets-encryption">RKE documentation</a>). When reconciling, the Kube API secret values are written in plaintext on the AppliedSpec. Cluster owners, Cluster members, and Project members (for projects within the cluster), all have RBAC permissions to view the cluster object from the apiserver.</p>
<p>This could lead to an unauthorized user gaining access to the entire secrets encryption config specific for the cluster, only on the applied spec.</p>
<p>Since this affects only custom encryption configurations, users need to manually rotate the keys by editing the cluster. For more information, please refer to the <a href="https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation">RKE secrets encryption documentation</a>.</p>
<p>The full custom configuration example:</p>
<pre><code class="language-yaml">services:
  kube-api:
    secrets_encryption_config:
      enabled: true
      custom_config:
        apiVersion: apiserver.config.k8s.io/v1
        kind: EncryptionConfiguration
        resources:
        - resources:
          - secrets
          providers:
          - aescbc:
              keys:
              - name: k-fw5hn
                secret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I= #&lt;--- needs to be changed
          - identity: {}
</code></pre>
<p>Please consult the associated  <a href="https://attack.mitre.org/techniques/T1552/">MITRE ATT&amp;CK - Technique - Unsecured Credentials</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>To address this issue, the fix introduces a new change that copies the AppliedSpec before mutating. As such, the next time the cluster is reconciled and the AppliedSpec is set, all references to sensitive data will be removed. </p>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22032">CVE-2024-22032</a></li>
</ul>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security-related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm">https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm</a></li>
<li><a href="https://github.com/advisories/GHSA-q6c7-56cq-g2wm">https://github.com/advisories/GHSA-q6c7-56cq-g2wm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q6c7-56cq-g2wm</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-17T22:30:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec]]></title>
        <id>https://github.com/advisories/GHSA-q6c7-56cq-g2wm</id>
        <link href="https://github.com/advisories/GHSA-q6c7-56cq-g2wm"/>
        <updated>2024-06-17T22:30:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This issue is only relevant to clusters provisioned using RKE1 with secrets encryption configuration enabled.</p>
<p>A vulnerability has been identified in which an RKE1 cluster keeps constantly reconciling when secrets encryption configuration is enabled (please see the <a href="https://rke.docs.rancher.com/config-options/secrets-encryption">RKE documentation</a>). When reconciling, the Kube API secret values are written in plaintext on the AppliedSpec. Cluster owners, Cluster members, and Project members (for projects within the cluster), all have RBAC permissions to view the cluster object from the apiserver.</p>
<p>This could lead to an unauthorized user gaining access to the entire secrets encryption config specific for the cluster, only on the applied spec.</p>
<p>Since this affects only custom encryption configurations, users need to manually rotate the keys by editing the cluster. For more information, please refer to the <a href="https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation">RKE secrets encryption documentation</a>.</p>
<p>The full custom configuration example:</p>
<pre><code class="language-yaml">services:
  kube-api:
    secrets_encryption_config:
      enabled: true
      custom_config:
        apiVersion: apiserver.config.k8s.io/v1
        kind: EncryptionConfiguration
        resources:
        - resources:
          - secrets
          providers:
          - aescbc:
              keys:
              - name: k-fw5hn
                secret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I= #&lt;--- needs to be changed
          - identity: {}
</code></pre>
<p>Please consult the associated  <a href="https://attack.mitre.org/techniques/T1552/">MITRE ATT&amp;CK - Technique - Unsecured Credentials</a> for further information about this category of attack.</p>
<h3 id="patches">Patches</h3>
<p>To address this issue, the fix introduces a new change that copies the AppliedSpec before mutating. As such, the next time the cluster is reconciled and the AppliedSpec is set, all references to sensitive data will be removed. </p>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22032">CVE-2024-22032</a></li>
</ul>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security-related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm">https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm</a></li>
<li><a href="https://github.com/advisories/GHSA-q6c7-56cq-g2wm">https://github.com/advisories/GHSA-q6c7-56cq-g2wm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q6c7-56cq-g2wm</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-17T22:30:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke] rke's credentials are stored in the RKE1 Cluster state ConfigMap]]></title>
        <id>https://github.com/advisories/GHSA-6gr4-52w6-vmqx</id>
        <link href="https://github.com/advisories/GHSA-6gr4-52w6-vmqx"/>
        <updated>2024-06-17T22:30:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When RKE provisions a cluster, it stores the cluster state in a configmap called <code>full-cluster-state</code> inside the <code>kube-system</code> namespace of the cluster itself. This cluster state object contains information used to set up the K8s cluster, which may include the following sensitive data:</p>
<ul>
<li>RancherKubernetesEngineConfig<ul>
<li>RKENodeConfig<ul>
<li>SSH username</li>
<li>SSH private key</li>
<li>SSH private key path</li>
</ul>
</li>
<li>RKEConfigServices<ul>
<li>ETCDService<ul>
<li>External client key</li>
<li>BackupConfig<ul>
<li>S3BackupConfig<ul>
<li>AWS access key</li>
<li>AWS secret key</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>KubeAPIService<ul>
<li>SecretsEncryptionConfig<ul>
<li>K8s encryption configuration (contains encryption keys)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>PrivateRegistries<ul>
<li>User</li>
<li>Password</li>
<li>ECRCredentialPlugin<ul>
<li>AWS access key</li>
<li>AWS secret key</li>
<li>AWS session token</li>
</ul>
</li>
</ul>
</li>
<li>CloudProvider<ul>
<li>AzureCloudProvider<ul>
<li>AAD client ID</li>
<li>AAD client secret</li>
<li>AAD client cert password</li>
</ul>
</li>
<li>OpenstackCloudProvider<ul>
<li>Username</li>
<li>User ID</li>
<li>Password</li>
</ul>
</li>
<li>VsphereCloudProvider<ul>
<li>GlobalVsphereOpts<ul>
<li>User</li>
<li>Password</li>
</ul>
</li>
<li>VirtualCenterConfig<ul>
<li>User</li>
<li>Password</li>
</ul>
</li>
</ul>
</li>
<li>HarvesterCloudProvider<ul>
<li>CloudConfig</li>
</ul>
</li>
<li>CustomCloudProvider</li>
</ul>
</li>
<li>BastionHost<ul>
<li>User</li>
<li>SSH key</li>
</ul>
</li>
</ul>
</li>
<li>CertificatesBundle<ul>
<li>Private key</li>
</ul>
</li>
<li>EncryptionConfig<ul>
<li>Private key</li>
</ul>
</li>
</ul>
<p>The <code>State</code> type that contains the above info and more can viewed <a href="https://github.com/rancher/rke/blob/8714c3c06e0bad55c61684fd5d94f1481128c58d/cluster/state.go#L37">here</a>.</p>
<p>While the <code>full-cluster-state</code> configmap is not publicly available (reading it requires access to the RKE cluster), it being a configmap makes it available to non-administrators of the cluster. Because this configmap contains essentially all the information and credentials required to administer the cluster, anyone with permission to read it thereby achieves admin-level access to the cluster (please consult the <a href="https://attack.mitre.org/techniques/T1552/001/">MITRE ATT&amp;CK - Technique - Unsecured Credentials : Credentials In Files</a> for further information about the associated technique of attack).</p>
<p><strong>Important:</strong>
For the exposure of credentials not related to Rancher and RKE, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>
<p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability is being fixed in RKE versions <code>1.4.19</code> and <code>1.5.10</code> which are included in Rancher versions <code>2.7.14</code> and <code>2.8.5</code>.</p>
<p>The patches include changes that will cause RKE to automatically migrate the cluster state configmap to a <code>full-cluster-state</code> secret in the <code>kube-system</code> namespace. The migrated secret will only be accessible to those who have read access to the <code>kube-system</code> namespace in the downstream RKE cluster. In Rancher, only admin and cluster-owner roles can access the secret. The old configmap will be removed after successful migration.</p>
<p>All downstream clusters provisioned using RKE via Rancher will be migrated automatically on Rancher upgrade. Note that any downstream clusters that are unavailable or otherwise non migratable on Rancher upgrade will still be migrated automatically as soon as they become available.</p>
<p>Clusters provisioned using RKE outside of Rancher will be migrated automatically upon the next invocation of <code>rke up</code> (i.e. the next cluster reconciliation) after upgrading RKE.</p>
<p>If a rollback needs to be performed after an upgrade to a patched Rancher or RKE version, downstream RKE clusters that were migrated need to have their migrations manually reversed using this script: <a href="https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations">https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations</a>. 
<strong>Please be sure to back up downstream clusters before performing the reverse migration</strong>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes.</p>
<p>Users should not attempt to perform this migration manually without upgrading their RKE/Rancher versions as only post-patch versions of RKE are capable of reading the cluster state from a secret instead of a configmap. In other words, migrating the cluster state to a secret without upgrading RKE/Rancher would cause RKE to be unable to read the cluster state, making it incapable of managing the cluster until an RKE/Rancher upgrade is performed.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support life cycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx">https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx</a></li>
<li><a href="https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd">https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd</a></li>
<li><a href="https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf">https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf</a></li>
<li><a href="https://github.com/advisories/GHSA-6gr4-52w6-vmqx">https://github.com/advisories/GHSA-6gr4-52w6-vmqx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6gr4-52w6-vmqx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-06-17T22:30:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rke] rke's credentials are stored in the RKE1 Cluster state ConfigMap]]></title>
        <id>https://github.com/advisories/GHSA-6gr4-52w6-vmqx</id>
        <link href="https://github.com/advisories/GHSA-6gr4-52w6-vmqx"/>
        <updated>2024-06-17T22:30:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When RKE provisions a cluster, it stores the cluster state in a configmap called <code>full-cluster-state</code> inside the <code>kube-system</code> namespace of the cluster itself. This cluster state object contains information used to set up the K8s cluster, which may include the following sensitive data:</p>
<ul>
<li>RancherKubernetesEngineConfig<ul>
<li>RKENodeConfig<ul>
<li>SSH username</li>
<li>SSH private key</li>
<li>SSH private key path</li>
</ul>
</li>
<li>RKEConfigServices<ul>
<li>ETCDService<ul>
<li>External client key</li>
<li>BackupConfig<ul>
<li>S3BackupConfig<ul>
<li>AWS access key</li>
<li>AWS secret key</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>KubeAPIService<ul>
<li>SecretsEncryptionConfig<ul>
<li>K8s encryption configuration (contains encryption keys)</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>PrivateRegistries<ul>
<li>User</li>
<li>Password</li>
<li>ECRCredentialPlugin<ul>
<li>AWS access key</li>
<li>AWS secret key</li>
<li>AWS session token</li>
</ul>
</li>
</ul>
</li>
<li>CloudProvider<ul>
<li>AzureCloudProvider<ul>
<li>AAD client ID</li>
<li>AAD client secret</li>
<li>AAD client cert password</li>
</ul>
</li>
<li>OpenstackCloudProvider<ul>
<li>Username</li>
<li>User ID</li>
<li>Password</li>
</ul>
</li>
<li>VsphereCloudProvider<ul>
<li>GlobalVsphereOpts<ul>
<li>User</li>
<li>Password</li>
</ul>
</li>
<li>VirtualCenterConfig<ul>
<li>User</li>
<li>Password</li>
</ul>
</li>
</ul>
</li>
<li>HarvesterCloudProvider<ul>
<li>CloudConfig</li>
</ul>
</li>
<li>CustomCloudProvider</li>
</ul>
</li>
<li>BastionHost<ul>
<li>User</li>
<li>SSH key</li>
</ul>
</li>
</ul>
</li>
<li>CertificatesBundle<ul>
<li>Private key</li>
</ul>
</li>
<li>EncryptionConfig<ul>
<li>Private key</li>
</ul>
</li>
</ul>
<p>The <code>State</code> type that contains the above info and more can viewed <a href="https://github.com/rancher/rke/blob/8714c3c06e0bad55c61684fd5d94f1481128c58d/cluster/state.go#L37">here</a>.</p>
<p>While the <code>full-cluster-state</code> configmap is not publicly available (reading it requires access to the RKE cluster), it being a configmap makes it available to non-administrators of the cluster. Because this configmap contains essentially all the information and credentials required to administer the cluster, anyone with permission to read it thereby achieves admin-level access to the cluster (please consult the <a href="https://attack.mitre.org/techniques/T1552/001/">MITRE ATT&amp;CK - Technique - Unsecured Credentials : Credentials In Files</a> for further information about the associated technique of attack).</p>
<p><strong>Important:</strong>
For the exposure of credentials not related to Rancher and RKE, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>
<p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability is being fixed in RKE versions <code>1.4.19</code> and <code>1.5.10</code> which are included in Rancher versions <code>2.7.14</code> and <code>2.8.5</code>.</p>
<p>The patches include changes that will cause RKE to automatically migrate the cluster state configmap to a <code>full-cluster-state</code> secret in the <code>kube-system</code> namespace. The migrated secret will only be accessible to those who have read access to the <code>kube-system</code> namespace in the downstream RKE cluster. In Rancher, only admin and cluster-owner roles can access the secret. The old configmap will be removed after successful migration.</p>
<p>All downstream clusters provisioned using RKE via Rancher will be migrated automatically on Rancher upgrade. Note that any downstream clusters that are unavailable or otherwise non migratable on Rancher upgrade will still be migrated automatically as soon as they become available.</p>
<p>Clusters provisioned using RKE outside of Rancher will be migrated automatically upon the next invocation of <code>rke up</code> (i.e. the next cluster reconciliation) after upgrading RKE.</p>
<p>If a rollback needs to be performed after an upgrade to a patched Rancher or RKE version, downstream RKE clusters that were migrated need to have their migrations manually reversed using this script: <a href="https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations">https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations</a>. 
<strong>Please be sure to back up downstream clusters before performing the reverse migration</strong>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes.</p>
<p>Users should not attempt to perform this migration manually without upgrading their RKE/Rancher versions as only post-patch versions of RKE are capable of reading the cluster state from a secret instead of a configmap. In other words, migrating the cluster state to a secret without upgrading RKE/Rancher would cause RKE to be unable to read the cluster state, making it incapable of managing the cluster until an RKE/Rancher upgrade is performed.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support life cycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx">https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx</a></li>
<li><a href="https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd">https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd</a></li>
<li><a href="https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf">https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf</a></li>
<li><a href="https://github.com/advisories/GHSA-6gr4-52w6-vmqx">https://github.com/advisories/GHSA-6gr4-52w6-vmqx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6gr4-52w6-vmqx</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-06-17T22:30:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher does not automatically clean up a user deleted or disabled from the configured Authentication Provider]]></title>
        <id>https://github.com/advisories/GHSA-9ghh-mmcq-8phc</id>
        <link href="https://github.com/advisories/GHSA-9ghh-mmcq-8phc"/>
        <updated>2024-06-17T22:30:48.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in which Rancher does not automatically clean up a user which has been deleted from the configured authentication provider (AP). This characteristic also applies to disabled or revoked users, Rancher will not reflect these modifications which may leave the user’s tokens still usable.</p>
<p>An AP must be enabled to be affected by this, as the built-in User Management feature is not affected by this vulnerability.
This issue may lead to an adversary gaining unauthorized access, as the user’s access privileges may still be active within Rancher even though they are no longer valid on the configured AP (please consult the <a href="https://attack.mitre.org/techniques/T1078/">MITRE ATT&amp;CK - Technique - Valid Accounts</a> for further information about the associated technique of attack).</p>
<p>It’s important to note that all configurable APs are impacted, see <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config#external-vs-local-authentication">Rancher Docs - Configuring Authentication - External vs. Local Authentication</a> to get the full authentication providers list.</p>
<p>To address this issue, the fix introduces a new user retention process that can be configured to run periodically and disable and/or delete inactive users. If enabled a user becomes subject to retention if they don't login for a configurable period of time. It's possible to set overrides for users that are used mainly for programmatic access (e.g. CI, scripts etc.) so that they don't become subject to retention for a longer period of time or at all. The user retention process is disabled by default, to avoid deleting wrong accounts. It is up to each user to enable it and configure the retention period as it best suits its environment.</p>
<p>Be aware that once the process is enabled, it might take a few days for previous users that have been revoked or deleted from the AP to be automatically removed from Rancher. To attenuate the risk of this condition, we recommend to regularly audit the AP’s user accounts for activity and manually deactivate or remove them from Rancher, if they are no longer needed.</p>
<p>For further information about the user retention process configuration, please refer to the dedicated documentation <a href="https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-user-retention">Rancher Docs - Advanced User Guides - Enable User Retention</a>.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Administrators that are unable to update to a patched Rancher Manager version, are advised to delete Rancher users, via kubectl or through the UI, as soon as those users are deleted from the Authentication Provider. If a user needs to be temporarily disabled on the Authentication Provider, similar intervention will need to take place to reflect that change on Rancher Manager.</p>
<p>Below is a procedure to list and remove a deleted/disabled user in Rancher using <code>kubectl</code> (with a privileged kubeconfig).</p>
<ol>
<li>List all users bound to a supported external auth provider, then returns <code>username</code>, <code>uid</code>, <code>displayName</code> and <code>PrincipalIds</code> which contains the related <code>authprovider_user://ID</code></li>
</ol>
<pre><code class="language-shell">#!/bin/bash

for authprovider in {activedirectory,azure,common,genericoidc,github googleauth, keycloakoidc,ldap,oidc,publicapi,saml}
do 
    kubectl get users -o json | jq --arg authprovider "$authprovider" '.items[] | select(.principalIds[] | test("^" + $authprovider + "_user://")) | {username: .metadata.name, uid: .metadata.uid, displayName: .displayName, principalIds: .principalIds}'
done
</code></pre>
<ol start="2">
<li>Once the <code>authprovider_user://ID</code> (and/or <code>DisplayName</code>) is confirmed, remove the user from the Rancher UI or using <code>kubectl delete users &lt;USERNAME&gt;</code>.</li>
</ol>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc">https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc</a></li>
<li><a href="https://github.com/advisories/GHSA-9ghh-mmcq-8phc">https://github.com/advisories/GHSA-9ghh-mmcq-8phc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9ghh-mmcq-8phc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-17T22:30:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/rancher/rancher] Rancher does not automatically clean up a user deleted or disabled from the configured Authentication Provider]]></title>
        <id>https://github.com/advisories/GHSA-9ghh-mmcq-8phc</id>
        <link href="https://github.com/advisories/GHSA-9ghh-mmcq-8phc"/>
        <updated>2024-06-17T22:30:48.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A vulnerability has been identified in which Rancher does not automatically clean up a user which has been deleted from the configured authentication provider (AP). This characteristic also applies to disabled or revoked users, Rancher will not reflect these modifications which may leave the user’s tokens still usable.</p>
<p>An AP must be enabled to be affected by this, as the built-in User Management feature is not affected by this vulnerability.
This issue may lead to an adversary gaining unauthorized access, as the user’s access privileges may still be active within Rancher even though they are no longer valid on the configured AP (please consult the <a href="https://attack.mitre.org/techniques/T1078/">MITRE ATT&amp;CK - Technique - Valid Accounts</a> for further information about the associated technique of attack).</p>
<p>It’s important to note that all configurable APs are impacted, see <a href="https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config#external-vs-local-authentication">Rancher Docs - Configuring Authentication - External vs. Local Authentication</a> to get the full authentication providers list.</p>
<p>To address this issue, the fix introduces a new user retention process that can be configured to run periodically and disable and/or delete inactive users. If enabled a user becomes subject to retention if they don't login for a configurable period of time. It's possible to set overrides for users that are used mainly for programmatic access (e.g. CI, scripts etc.) so that they don't become subject to retention for a longer period of time or at all. The user retention process is disabled by default, to avoid deleting wrong accounts. It is up to each user to enable it and configure the retention period as it best suits its environment.</p>
<p>Be aware that once the process is enabled, it might take a few days for previous users that have been revoked or deleted from the AP to be automatically removed from Rancher. To attenuate the risk of this condition, we recommend to regularly audit the AP’s user accounts for activity and manually deactivate or remove them from Rancher, if they are no longer needed.</p>
<p>For further information about the user retention process configuration, please refer to the dedicated documentation <a href="https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-user-retention">Rancher Docs - Advanced User Guides - Enable User Retention</a>.</p>
<h3 id="patches">Patches</h3>
<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Administrators that are unable to update to a patched Rancher Manager version, are advised to delete Rancher users, via kubectl or through the UI, as soon as those users are deleted from the Authentication Provider. If a user needs to be temporarily disabled on the Authentication Provider, similar intervention will need to take place to reflect that change on Rancher Manager.</p>
<p>Below is a procedure to list and remove a deleted/disabled user in Rancher using <code>kubectl</code> (with a privileged kubeconfig).</p>
<ol>
<li>List all users bound to a supported external auth provider, then returns <code>username</code>, <code>uid</code>, <code>displayName</code> and <code>PrincipalIds</code> which contains the related <code>authprovider_user://ID</code></li>
</ol>
<pre><code class="language-shell">#!/bin/bash

for authprovider in {activedirectory,azure,common,genericoidc,github googleauth, keycloakoidc,ldap,oidc,publicapi,saml}
do 
    kubectl get users -o json | jq --arg authprovider "$authprovider" '.items[] | select(.principalIds[] | test("^" + $authprovider + "_user://")) | {username: .metadata.name, uid: .metadata.uid, displayName: .displayName, principalIds: .principalIds}'
done
</code></pre>
<ol start="2">
<li>Once the <code>authprovider_user://ID</code> (and/or <code>DisplayName</code>) is confirmed, remove the user from the Rancher UI or using <code>kubectl delete users &lt;USERNAME&gt;</code>.</li>
</ol>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Reach out to the <a href="https://github.com/rancher/rancher/security/policy">SUSE Rancher Security team</a> for security related inquiries.</li>
<li>Open an issue in the <a href="https://github.com/rancher/rancher/issues/new/choose">Rancher</a> repository.</li>
<li>Verify with our <a href="https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/">support matrix</a> and <a href="https://www.suse.com/lifecycle/">product support lifecycle</a>.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc">https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc</a></li>
<li><a href="https://github.com/advisories/GHSA-9ghh-mmcq-8phc">https://github.com/advisories/GHSA-9ghh-mmcq-8phc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9ghh-mmcq-8phc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-17T22:30:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/AdguardTeam/AdGuardHome] AdGuardHome privilege escalation vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-7jp9-vgmq-c8r5</id>
        <link href="https://github.com/advisories/GHSA-7jp9-vgmq-c8r5"/>
        <updated>2024-06-13T23:18:27.000Z</updated>
        <content type="html"><![CDATA[<p>An issue in AdGuardHome v0.93 to latest allows unprivileged attackers to escalate privileges via overwriting the AdGuardHome binary.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36586">https://nvd.nist.gov/vuln/detail/CVE-2024-36586</a></li>
<li><a href="https://github.com/go-compile/security-advisories/blob/master/vulns/CVE-2024-36586.md">https://github.com/go-compile/security-advisories/blob/master/vulns/CVE-2024-36586.md</a></li>
<li><a href="https://github.com/advisories/GHSA-7jp9-vgmq-c8r5">https://github.com/advisories/GHSA-7jp9-vgmq-c8r5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7jp9-vgmq-c8r5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-13T21:30:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/k8sgpt-ai/k8sgpt] Vulnerabilities with the k8sGPT]]></title>
        <id>https://github.com/advisories/GHSA-85rg-8m6h-825p</id>
        <link href="https://github.com/advisories/GHSA-85rg-8m6h-825p"/>
        <updated>2024-06-13T19:39:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Bunch of vulnerabilities found in k8sGPT.  Fixed in release <a href="https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33">https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/k8sgpt-ai/k8sgpt/security/advisories/GHSA-85rg-8m6h-825p">https://github.com/k8sgpt-ai/k8sgpt/security/advisories/GHSA-85rg-8m6h-825p</a></li>
<li><a href="https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33">https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33</a></li>
<li><a href="https://github.com/advisories/GHSA-85rg-8m6h-825p">https://github.com/advisories/GHSA-85rg-8m6h-825p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-85rg-8m6h-825p</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-13T19:39:11.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Cilium leaks sensitive information in cilium-bugtool]]></title>
        <id>https://github.com/advisories/GHSA-wh78-7948-358j</id>
        <link href="https://github.com/advisories/GHSA-wh78-7948-358j"/>
        <updated>2024-06-20T18:53:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The output of <code>cilium-bugtool</code> can contain sensitive data when the tool is run (with the <code>--envoy-dump</code> flag set) against Cilium deployments with the Envoy proxy enabled.</p>
<p>Users of the following features are affected:</p>
<ul>
<li><a href="https://docs.cilium.io/en/stable/security/tls-visibility/#gs-tls-inspection">TLS inspection</a></li>
<li><a href="https://docs.cilium.io/en/stable/network/servicemesh/tls-termination/#gs-ingress-tls">Ingress with TLS termination</a></li>
<li><a href="https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/https/">Gateway API with TLS termination</a></li>
<li><a href="https://docs.cilium.io/en/stable/security/policy/language/#kafka-beta">Kafka network policies with API key filtering</a></li>
</ul>
<p>The sensitive data includes:</p>
<ul>
<li>The CA certificate, certificate chain, and private key used by Cilium HTTP Network Policies, and when using Ingress/Gateway API</li>
<li>The API keys used in Kafka-related network policy</li>
</ul>
<p><code>cilium-bugtool</code> is a debugging tool that is typically invoked manually and does not run during the normal operation of a Cilium cluster.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>Cilium v1.13 between v1.13.0 and v1.13.16 inclusive</li>
<li>Cilium v1.14 between v1.14.0 and v1.14.11 inclusive</li>
<li>Cilium v1.15 between v1.15.0 and v1.15.5 inclusive</li>
</ul>
<p>This issue has been patched in:</p>
<ul>
<li>Cilium v1.15.6</li>
<li>Cilium v1.14.12</li>
<li>Cilium v1.13.17</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @sayboras for their work on triaging and remediating this issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j">https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37307">https://nvd.nist.gov/vuln/detail/CVE-2024-37307</a></li>
<li><a href="https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407">https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407</a></li>
<li><a href="https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a">https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a</a></li>
<li><a href="https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741">https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741</a></li>
<li><a href="https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653">https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653</a></li>
<li><a href="https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b">https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b</a></li>
<li><a href="https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61">https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2024-2922">https://pkg.go.dev/vuln/GO-2024-2922</a></li>
<li><a href="https://github.com/advisories/GHSA-wh78-7948-358j">https://github.com/advisories/GHSA-wh78-7948-358j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wh78-7948-358j</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-13T19:29:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[github.com/cilium/cilium] Cilium leaks sensitive information in cilium-bugtool]]></title>
        <id>https://github.com/advisories/GHSA-wh78-7948-358j</id>
        <link href="https://github.com/advisories/GHSA-wh78-7948-358j"/>
        <updated>2024-06-20T18:53:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The output of <code>cilium-bugtool</code> can contain sensitive data when the tool is run (with the <code>--envoy-dump</code> flag set) against Cilium deployments with the Envoy proxy enabled.</p>
<p>Users of the following features are affected:</p>
<ul>
<li><a href="https://docs.cilium.io/en/stable/security/tls-visibility/#gs-tls-inspection">TLS inspection</a></li>
<li><a href="https://docs.cilium.io/en/stable/network/servicemesh/tls-termination/#gs-ingress-tls">Ingress with TLS termination</a></li>
<li><a href="https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/https/">Gateway API with TLS termination</a></li>
<li><a href="https://docs.cilium.io/en/stable/security/policy/language/#kafka-beta">Kafka network policies with API key filtering</a></li>
</ul>
<p>The sensitive data includes:</p>
<ul>
<li>The CA certificate, certificate chain, and private key used by Cilium HTTP Network Policies, and when using Ingress/Gateway API</li>
<li>The API keys used in Kafka-related network policy</li>
</ul>
<p><code>cilium-bugtool</code> is a debugging tool that is typically invoked manually and does not run during the normal operation of a Cilium cluster.</p>
<h3 id="patches">Patches</h3>
<p>This issue affects:</p>
<ul>
<li>Cilium v1.13 between v1.13.0 and v1.13.16 inclusive</li>
<li>Cilium v1.14 between v1.14.0 and v1.14.11 inclusive</li>
<li>Cilium v1.15 between v1.15.0 and v1.15.5 inclusive</li>
</ul>
<p>This issue has been patched in:</p>
<ul>
<li>Cilium v1.15.6</li>
<li>Cilium v1.14.12</li>
<li>Cilium v1.13.17</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>There is no workaround to this issue.</p>
<h3 id="acknowledgements">Acknowledgements</h3>
<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @sayboras for their work on triaging and remediating this issue.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, please reach out on <a href="https://docs.cilium.io/en/latest/community/community/#slack">Slack</a>.</p>
<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href="mailto:security@cilium.io">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j">https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37307">https://nvd.nist.gov/vuln/detail/CVE-2024-37307</a></li>
<li><a href="https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407">https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407</a></li>
<li><a href="https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a">https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a</a></li>
<li><a href="https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741">https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741</a></li>
<li><a href="https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653">https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653</a></li>
<li><a href="https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b">https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b</a></li>
<li><a href="https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61">https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61</a></li>
<li><a href="https://pkg.go.dev/vuln/GO-2024-2922">https://pkg.go.dev/vuln/GO-2024-2922</a></li>
<li><a href="https://github.com/advisories/GHSA-wh78-7948-358j">https://github.com/advisories/GHSA-wh78-7948-358j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wh78-7948-358j</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-13T19:29:36.000Z</published>
    </entry>
</feed>