<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/maven.rss</id>
    <title>Security Advisory for Java artifacts hosted at the Maven central repository</title>
    <updated>2023-10-06T21:01:29.779Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Amaven"/>
    <subtitle>Security Advisory for Java artifacts hosted at the Maven central repository on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[org.xwiki.platform:xwiki-platform] XWiki XSS Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-6mvr-cq72-f66v</id>
        <link href="https://github.com/advisories/GHSA-6mvr-cq72-f66v"/>
        <updated>2023-10-06T18:04:37.000Z</updated>
        <content type="html"><![CDATA[<p>The Image Import function in XWiki through 10.7 has XSS.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-16277">https://nvd.nist.gov/vuln/detail/CVE-2018-16277</a></li>
<li><a href="https://mksec.tk/index.php/2018/09/27/cve-2018-16277-xss-in-xwiki/">https://mksec.tk/index.php/2018/09/27/cve-2018-16277-xss-in-xwiki/</a></li>
<li><a href="https://github.com/advisories/GHSA-6mvr-cq72-f66v">https://github.com/advisories/GHSA-6mvr-cq72-f66v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6mvr-cq72-f66v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-14T01:59:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[org.keycloak:keycloak-parent] Keycloak Improper Bruteforce Detection]]></title>
        <id>https://github.com/advisories/GHSA-85v8-vx4w-q684</id>
        <link href="https://github.com/advisories/GHSA-85v8-vx4w-q684"/>
        <updated>2023-10-06T17:29:16.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was found in Keycloak 4.2.1.Final, 4.3.0.Final. When TOPT enabled, an improper implementation of the Brute Force detection algorithm will not enforce its protection measures.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-14657">https://nvd.nist.gov/vuln/detail/CVE-2018-14657</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3592">https://access.redhat.com/errata/RHSA-2018:3592</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3593">https://access.redhat.com/errata/RHSA-2018:3593</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3595">https://access.redhat.com/errata/RHSA-2018:3595</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14657">https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-14657</a></li>
<li><a href="https://github.com/advisories/GHSA-85v8-vx4w-q684">https://github.com/advisories/GHSA-85v8-vx4w-q684</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-85v8-vx4w-q684</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-13T01:12:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[org.keycloak:keycloak-services] Keycloak Authentication Error]]></title>
        <id>https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</id>
        <link href="https://github.com/advisories/GHSA-xvv8-8wh9-9fh2"/>
        <updated>2023-10-06T17:25:02.000Z</updated>
        <content type="html"><![CDATA[<p>It was found that SAML authentication in Keycloak 3.4.3.Final incorrectly authenticated expired certificates. A malicious user could use this to access unauthorized data or possibly conduct further attacks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-10894">https://nvd.nist.gov/vuln/detail/CVE-2018-10894</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3592">https://access.redhat.com/errata/RHSA-2018:3592</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3593">https://access.redhat.com/errata/RHSA-2018:3593</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3595">https://access.redhat.com/errata/RHSA-2018:3595</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2019:0877">https://access.redhat.com/errata/RHSA-2019:0877</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10894">https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10894</a></li>
<li><a href="https://github.com/keycloak/keycloak/commit/812e76c39b1e693e8f11e5549cca2c90631f372e">https://github.com/keycloak/keycloak/commit/812e76c39b1e693e8f11e5549cca2c90631f372e</a></li>
<li><a href="https://github.com/advisories/GHSA-xvv8-8wh9-9fh2">https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-13T01:34:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[org.keycloak:keycloak-saml-adapter-core] Keycloak Authentication Error]]></title>
        <id>https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</id>
        <link href="https://github.com/advisories/GHSA-xvv8-8wh9-9fh2"/>
        <updated>2023-10-06T17:25:02.000Z</updated>
        <content type="html"><![CDATA[<p>It was found that SAML authentication in Keycloak 3.4.3.Final incorrectly authenticated expired certificates. A malicious user could use this to access unauthorized data or possibly conduct further attacks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-10894">https://nvd.nist.gov/vuln/detail/CVE-2018-10894</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3592">https://access.redhat.com/errata/RHSA-2018:3592</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3593">https://access.redhat.com/errata/RHSA-2018:3593</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2018:3595">https://access.redhat.com/errata/RHSA-2018:3595</a></li>
<li><a href="https://access.redhat.com/errata/RHSA-2019:0877">https://access.redhat.com/errata/RHSA-2019:0877</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10894">https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2018-10894</a></li>
<li><a href="https://github.com/keycloak/keycloak/commit/812e76c39b1e693e8f11e5549cca2c90631f372e">https://github.com/keycloak/keycloak/commit/812e76c39b1e693e8f11e5549cca2c90631f372e</a></li>
<li><a href="https://github.com/advisories/GHSA-xvv8-8wh9-9fh2">https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xvv8-8wh9-9fh2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-13T01:34:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[net.mingsoft:ms-mcms] Mingsoft MCMS CSRF vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-m246-pv28-4r6f</id>
        <link href="https://github.com/advisories/GHSA-m246-pv28-4r6f"/>
        <updated>2023-10-06T16:19:53.000Z</updated>
        <content type="html"><![CDATA[<p>An issue was discovered in MCMS 4.6.5. There is a CSRF vulnerability that can add an administrator account via ms/basic/manager/save.do.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-17366">https://nvd.nist.gov/vuln/detail/CVE-2018-17366</a></li>
<li><a href="https://gitee.com/mingSoft/MCMS/issues/IM1DA">https://gitee.com/mingSoft/MCMS/issues/IM1DA</a></li>
<li><a href="https://github.com/advisories/GHSA-m246-pv28-4r6f">https://github.com/advisories/GHSA-m246-pv28-4r6f</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m246-pv28-4r6f</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-14T02:00:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[org.openrefine:main] OpenRefine Directory Traversal]]></title>
        <id>https://github.com/advisories/GHSA-f6fv-fjg8-4m6w</id>
        <link href="https://github.com/advisories/GHSA-f6fv-fjg8-4m6w"/>
        <updated>2023-10-06T15:30:56.000Z</updated>
        <content type="html"><![CDATA[<p>OpenRefine before 3.2 beta allows directory traversal via a relative pathname in a ZIP archive.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-19859">https://nvd.nist.gov/vuln/detail/CVE-2018-19859</a></li>
<li><a href="https://github.com/OpenRefine/OpenRefine/issues/1840">https://github.com/OpenRefine/OpenRefine/issues/1840</a></li>
<li><a href="https://github.com/OpenRefine/OpenRefine/pull/1901">https://github.com/OpenRefine/OpenRefine/pull/1901</a></li>
<li><a href="https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656">https://github.com/OpenRefine/OpenRefine/commit/e243e73e4064de87a913946bd320fbbe246da656</a></li>
<li><a href="https://github.com/advisories/GHSA-f6fv-fjg8-4m6w">https://github.com/advisories/GHSA-f6fv-fjg8-4m6w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f6fv-fjg8-4m6w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-14T01:14:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ro.pippo:pippo-session] Pippo RCE Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-h892-x453-86wc</id>
        <link href="https://github.com/advisories/GHSA-h892-x453-86wc"/>
        <updated>2023-10-06T01:08:09.000Z</updated>
        <content type="html"><![CDATA[<p>Pippo through 1.11.0 allows remote code execution via a command to java.lang.ProcessBuilder because the XstreamEngine component does not use XStream's available protection mechanisms to restrict unmarshalling.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-18240">https://nvd.nist.gov/vuln/detail/CVE-2018-18240</a></li>
<li><a href="https://github.com/pippo-java/pippo/issues/454">https://github.com/pippo-java/pippo/issues/454</a></li>
<li><a href="https://github.com/pippo-java/pippo/commit/c6b26551a82d2dd32097fcb17c13c3b830916296">https://github.com/pippo-java/pippo/commit/c6b26551a82d2dd32097fcb17c13c3b830916296</a></li>
<li><a href="https://github.com/advisories/GHSA-h892-x453-86wc">https://github.com/advisories/GHSA-h892-x453-86wc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h892-x453-86wc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-05-13T01:19:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ro.pippo:pippo-core] Pippo RCE Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-h892-x453-86wc</id>
        <link href="https://github.com/advisories/GHSA-h892-x453-86wc"/>
        <updated>2023-10-06T01:08:09.000Z</updated>
        <content type="html"><![CDATA[<p>Pippo through 1.11.0 allows remote code execution via a command to java.lang.ProcessBuilder because the XstreamEngine component does not use XStream's available protection mechanisms to restrict unmarshalling.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-18240">https://nvd.nist.gov/vuln/detail/CVE-2018-18240</a></li>
<li><a href="https://github.com/pippo-java/pippo/issues/454">https://github.com/pippo-java/pippo/issues/454</a></li>
<li><a href="https://github.com/pippo-java/pippo/commit/c6b26551a82d2dd32097fcb17c13c3b830916296">https://github.com/pippo-java/pippo/commit/c6b26551a82d2dd32097fcb17c13c3b830916296</a></li>
<li><a href="https://github.com/advisories/GHSA-h892-x453-86wc">https://github.com/advisories/GHSA-h892-x453-86wc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h892-x453-86wc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-05-13T01:19:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[io.micronaut.security:micronaut-security-oauth2] io.micronaut.security:micronaut-security-oauth2 has invalid IdTokenClaimsValidator logic on aud]]></title>
        <id>https://github.com/advisories/GHSA-qw22-8w9r-864h</id>
        <link href="https://github.com/advisories/GHSA-qw22-8w9r-864h"/>
        <updated>2023-10-05T20:55:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>IdTokenClaimsValidator skips <code>aud</code> claim validation if token is issued by same identity issuer/provider.</p>
<h3 id="details">Details</h3>
<p>See <a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></p>
<p>This logic violates point 3 of <a href="https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation">https://openid.net/specs/openid-connect-core-1_0.html#IDTokenValidation</a>. </p>
<p>Workaround exists by setting <code>micronaut.security.token.jwt.claims-validators.audience</code> with valid values. 
 <code>micronaut.security.token.jwt.claims-validators.openid-idtoken</code> can be kept as default on.</p>
<h3 id="poc">PoC</h3>
<p>Should probably be:</p>
<pre><code class="language-java">                return issuer.equalsIgnoreCase(iss) &amp;&amp;
                        audiences.contains(clientId) &amp;&amp;
                                validateAzp(claims, clientId, audiences);
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any OIDC setup using Micronaut where multiple OIDC applications exists for the same issuer but token auth are not meant to be shared.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h">https://github.com/micronaut-projects/micronaut-security/security/advisories/GHSA-qw22-8w9r-864h</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980">https://github.com/micronaut-projects/micronaut-security/commit/9728b925221a0d87798ccf250657a3c214b7e980</a></li>
<li><a href="https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202">https://github.com/micronaut-projects/micronaut-security/blob/master/security-oauth2/src/main/java/io/micronaut/security/oauth2/client/IdTokenClaimsValidator.java#L202</a></li>
<li><a href="https://github.com/advisories/GHSA-qw22-8w9r-864h">https://github.com/advisories/GHSA-qw22-8w9r-864h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qw22-8w9r-864h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-10-05T20:55:14.000Z</published>
    </entry>
</feed>