<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2023-08-02T07:01:27.360Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[@ensdomains/ens-contracts] .eth registrar controller can shorten the duration of registered names]]></title>
        <id>https://github.com/advisories/GHSA-rrxv-q8m4-wch3</id>
        <link href="https://github.com/advisories/GHSA-rrxv-q8m4-wch3"/>
        <updated>2023-08-01T19:48:32.000Z</updated>
        <content type="html"><![CDATA[<h3 id="description">Description</h3>
<p>According to the documentation, controllers are allowed to register new domains and extend the expiry of existing domains, but they cannot change the ownership or reduce the expiration time of existing domains. However, a preliminary analysis suggests that an attacker-controlled controller may be able to reduce the expiration time of existing domains due to an integer overflow in the renew function.</p>
<p>The vulnerability resides in the following GitHub repository: <a href="https://github.com/ensdomains/ens-contracts/blob/master/contracts/ethregistrar/BaseRegistrarImplementation.sol#L171">https://github.com/ensdomains/ens-contracts/blob/master/contracts/ethregistrar/BaseRegistrarImplementation.sol#L171</a> </p>
<p>The vulnerable line of code is:</p>
<pre><code>require(
            expiries[id] + duration + GRACE_PERIOD &gt; duration + GRACE_PERIOD
        ); // Prevent future overflow
</code></pre>
<p>In this code snippet, the <code>duration</code> variable is user-supplied, making it possible to provide a value that would cause an overflow on both sides of the '&gt;' expression, ultimately rendering the condition true. Specifically, when the duration is set to <code>2^256 - GRACE_PERIOD</code>, the subsequent line <code>expiries[id] += duration;</code> also experiences an overflow, as <code>expiries[id]</code> is greater than <code>GRACE_PERIOD</code>. This results in the reduction of <code>expiries[id]</code> by <code>GRACE_PERIOD</code>. By repeatedly calling the renew function, an attacker could potentially force the expiration of an ENS record.</p>
<p>You can find the PoC included in the attached document. To execute the test, please use the following command:</p>
<pre><code>forge test -vvv --match-contract RegistrarExploit --fork-url &lt;alchemy_url&gt;
</code></pre>
<p>Replace <code>&lt;alchemy_url&gt;</code> with your Alchemy API URL. This command will run the Foundry test file and demonstrate the potential vulnerability.</p>
<h3 id="impact">Impact</h3>
<p>If successfully exploited, this vulnerability would enable attackers to force the expiration of any ENS record, ultimately allowing them to claim the affected domains for themselves.</p>
<p>Currently, it would require a malicious DAO to exploit it. Nevertheless, any vulnerability present in the controllers could potentially render this issue exploitable in the future.</p>
<p>An additional concern is the possibility of renewal discounts. Should ENS decide to implement a system that offers unlimited .eth domains for a fixed fee in the future, the vulnerability could become exploitable by any user due to the reduced attack cost.</p>
<h3 id="patches">Patches</h3>
<p>A mitigation is being developed.</p>
<h3 id="workarounds">Workarounds</h3>
<p>As long as registration cost remains linear or superlinear based on registration duration, or limited to a reasonable maximum (eg, 1 million years), this vulnerability could only be exploited by a malicious DAO. The interim workaround is thus to take no action.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ensdomains/ens-contracts/security/advisories/GHSA-rrxv-q8m4-wch3">https://github.com/ensdomains/ens-contracts/security/advisories/GHSA-rrxv-q8m4-wch3</a></li>
<li><a href="https://github.com/ensdomains/ens-contracts/commit/e6b136e979084de3761c125142620304173990ca">https://github.com/ensdomains/ens-contracts/commit/e6b136e979084de3761c125142620304173990ca</a></li>
<li><a href="https://github.com/ensdomains/ens-contracts/blob/master/contracts/ethregistrar/BaseRegistrarImplementation.sol#L171">https://github.com/ensdomains/ens-contracts/blob/master/contracts/ethregistrar/BaseRegistrarImplementation.sol#L171</a></li>
<li><a href="https://github.com/advisories/GHSA-rrxv-q8m4-wch3">https://github.com/advisories/GHSA-rrxv-q8m4-wch3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rrxv-q8m4-wch3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-08-01T19:48:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[underscore-keypath] underscore-keypath vulnerable to Prototype Pollution]]></title>
        <id>https://github.com/advisories/GHSA-gpvc-mx6g-cchv</id>
        <link href="https://github.com/advisories/GHSA-gpvc-mx6g-cchv"/>
        <updated>2023-08-01T19:47:11.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package underscore-keypath from 0.0.11 are vulnerable to Prototype Pollution via the name argument of the <code>setProperty()</code> function. Exploiting this vulnerability is possible due to improper input sanitization which allows the usage of arguments like <code>__proto__</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26139">https://nvd.nist.gov/vuln/detail/CVE-2023-26139</a></li>
<li><a href="https://gist.github.com/lelecolacola123/cc0d1e73780127aea9482c05f2ff3252">https://gist.github.com/lelecolacola123/cc0d1e73780127aea9482c05f2ff3252</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-JS-UNDERSCOREKEYPATH-5416714">https://security.snyk.io/vuln/SNYK-JS-UNDERSCOREKEYPATH-5416714</a></li>
<li><a href="https://github.com/advisories/GHSA-gpvc-mx6g-cchv">https://github.com/advisories/GHSA-gpvc-mx6g-cchv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gpvc-mx6g-cchv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T06:30:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[is-svg] Regular Expression Denial of Service (ReDoS)]]></title>
        <id>https://github.com/advisories/GHSA-7r28-3m3f-r2pr</id>
        <link href="https://github.com/advisories/GHSA-7r28-3m3f-r2pr"/>
        <updated>2023-08-01T19:25:13.000Z</updated>
        <content type="html"><![CDATA[<p>The is-svg package 2.1.0 through 4.2.1 for Node.js uses a regular expression that is vulnerable to Regular Expression Denial of Service (ReDoS). If an attacker provides a malicious string, is-svg will get stuck processing the input for a very long time.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-28092">https://nvd.nist.gov/vuln/detail/CVE-2021-28092</a></li>
<li><a href="https://github.com/sindresorhus/is-svg/commit/01f8a087fab8a69c3ac9085fbb16035907ab6a5b">https://github.com/sindresorhus/is-svg/commit/01f8a087fab8a69c3ac9085fbb16035907ab6a5b</a></li>
<li><a href="https://github.com/sindresorhus/is-svg/releases">https://github.com/sindresorhus/is-svg/releases</a></li>
<li><a href="https://github.com/sindresorhus/is-svg/releases/tag/v4.2.2">https://github.com/sindresorhus/is-svg/releases/tag/v4.2.2</a></li>
<li><a href="https://www.npmjs.com/package/is-svg">https://www.npmjs.com/package/is-svg</a></li>
<li><a href="https://security.netapp.com/advisory/ntap-20210513-0008/">https://security.netapp.com/advisory/ntap-20210513-0008/</a></li>
<li><a href="https://github.com/advisories/GHSA-7r28-3m3f-r2pr">https://github.com/advisories/GHSA-7r28-3m3f-r2pr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7r28-3m3f-r2pr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-03-19T21:25:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/win-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/macos-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/macos-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linuxstatic-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linux-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linux-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/exe] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pnpm] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/cafs] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/win-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/macos-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/macos-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linuxstatic-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linux-x64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/linux-arm64] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@pnpm/exe] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pnpm] pnpm incorrectly parses tar archives relative to specification]]></title>
        <id>https://github.com/advisories/GHSA-5r98-f33j-g8h7</id>
        <link href="https://github.com/advisories/GHSA-5r98-f33j-g8h7"/>
        <updated>2023-08-01T17:00:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>It is possible to construct a tarball that, when installed via npm or parsed by the registry is safe, but when installed via pnpm is malicious, due to how pnpm parses tar archives.</p>
<h3 id="details">Details</h3>
<p>The TAR format is an append-only archive format, and as such, the specification for how to update a file is to add a new record to the end with the updated version of the file. This means that it is completely valid for an archive to contain multiple copies of, say, <code>package.json</code>, and the expected behavior when extracting is that all versions other than the last get ignored.</p>
<p>This is further complicated by that during tarball extraction, all package managers are configured to drop the first path component, so collisions can be created simply by using multiple root folders in the archive, even without performing updates.</p>
<p>When pnpm extracts a tar archive via tar-stream, it appears to extract only the <em>first</em> file of a given name and discards all subsequent files with the same name.</p>
<h3 id="poc">PoC</h3>
<p>Create a root folder with the following layout:</p>
<ul>
<li><code>a/package.json</code></li>
<li><code>package/package.json</code></li>
<li><code>z/package.json</code></li>
</ul>
<p>File contents:</p>
<h4 id="apackagejson">a/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^15"
    }
}
</code></pre>
<h4 id="packagepackagejson">package/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is a bad version of a test package",
    "dependencies": {
        "react": "^16"
    }
}
</code></pre>
<h4 id="zpackagejson">z/package.json</h4>
<pre><code class="language-json">{
    "name": "test-package",
    "version": "0.1.0",
    "description": "This is the good version of a test package",
    "dependencies": {
        "react": "^17"
    }
}
</code></pre>
<p>Then use the tar binary to produce a tarball (working directory is the root folder):
<code>tar -c -z --format ustar -f package.tgz a package z</code>
The order of the folders at the end matters; whichever one is last will end up being the package.json that wins when extracted by npm; the one that is first will be the one that wins when extracted by pnpm.</p>
<p>Install the tarball via the <code>file:</code> protocol.</p>
<p>Observe that with npm, the lockfile has <code>react@17</code>, while with pnpm it has <code>react@15</code>.</p>
<h3 id="impact">Impact</h3>
<p>This can result in a package that appears safe on the npm registry or when installed via npm being replaced with a compromised or malicious version when installed via pnpm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7">https://github.com/pnpm/pnpm/security/advisories/GHSA-5r98-f33j-g8h7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37478">https://nvd.nist.gov/vuln/detail/CVE-2023-37478</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v7.33.4">https://github.com/pnpm/pnpm/releases/tag/v7.33.4</a></li>
<li><a href="https://github.com/pnpm/pnpm/releases/tag/v8.6.8">https://github.com/pnpm/pnpm/releases/tag/v8.6.8</a></li>
<li><a href="https://github.com/advisories/GHSA-5r98-f33j-g8h7">https://github.com/advisories/GHSA-5r98-f33j-g8h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5r98-f33j-g8h7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-08-01T17:00:55.000Z</published>
    </entry>
</feed>