<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/npm.rss</id>
    <title>Security Advisory for JavaScript packages hosted at npmjs.com</title>
    <updated>2023-12-14T05:01:16.450Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm"/>
    <subtitle>Security Advisory for JavaScript packages hosted at npmjs.com on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[buttercup] Buttercup allows attackers to obtain the hash of the master password]]></title>
        <id>https://github.com/advisories/GHSA-7cwq-p8cr-h9qg</id>
        <link href="https://github.com/advisories/GHSA-7cwq-p8cr-h9qg"/>
        <updated>2023-12-13T23:22:07.000Z</updated>
        <content type="html"><![CDATA[<p>Buttercup allows attackers to obtain the hash of the master password for the password manager via accessing the file /vaults.json/.</p>
<p>This affects the Buttercup app up to version 2.20.3.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-41646">https://nvd.nist.gov/vuln/detail/CVE-2023-41646</a></li>
<li><a href="https://buttercup.pw/">https://buttercup.pw/</a></li>
<li><a href="https://github.com/tristao-marinho/CVE-2023-41646/">https://github.com/tristao-marinho/CVE-2023-41646/</a></li>
<li><a href="https://github.com/buttercup/buttercup-core/issues/336">https://github.com/buttercup/buttercup-core/issues/336</a></li>
<li><a href="https://github.com/buttercup/buttercup-core/commit/77fbcdfe4caf57486a3c83c07fc6d36bb0e1d3e1">https://github.com/buttercup/buttercup-core/commit/77fbcdfe4caf57486a3c83c07fc6d36bb0e1d3e1</a></li>
<li><a href="https://github.com/advisories/GHSA-7cwq-p8cr-h9qg">https://github.com/advisories/GHSA-7cwq-p8cr-h9qg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cwq-p8cr-h9qg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-09-08T00:31:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@cubejs-backend/api-gateway] Denial of service attack on the cube-api endpoint]]></title>
        <id>https://github.com/advisories/GHSA-9759-3276-g2pm</id>
        <link href="https://github.com/advisories/GHSA-9759-3276-g2pm"/>
        <updated>2023-12-13T23:15:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>It is possible to make the entire Cube API unavailable by submitting a specially crafted request to a Cube API endpoint.</p>
<h3 id="patches">Patches</h3>
<p>The issue has been patched in the <code>v0.34.34</code> and it's recommended that all users exposing Cube APIs to the public internet upgrade to the latest version to prevent service disruption.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are currently no workaround for older versions, and the recommendation is to upgrade.</p>
<h3 id="references">References</h3>
<p>The issue was reported by an independent researcher in our Community Slack and has been promptly patched in the recent update.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/cube-js/cube/security/advisories/GHSA-9759-3276-g2pm">https://github.com/cube-js/cube/security/advisories/GHSA-9759-3276-g2pm</a></li>
<li><a href="https://github.com/advisories/GHSA-9759-3276-g2pm">https://github.com/advisories/GHSA-9759-3276-g2pm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9759-3276-g2pm</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-13T23:15:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Code execution in evershop]]></title>
        <id>https://github.com/advisories/GHSA-5mmr-9qx3-3pf9</id>
        <link href="https://github.com/advisories/GHSA-5mmr-9qx3-3pf9"/>
        <updated>2023-12-13T13:37:58.000Z</updated>
        <content type="html"><![CDATA[<p>An issue in EverShop NPM versions before v.1.0.0-rc.8 allows a remote attacker to obtain sensitive information and execute arbitrary code via the /deleteCustomer/route.json file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46498">https://nvd.nist.gov/vuln/detail/CVE-2023-46498</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cx8b24ace3-0c9a/">https://devhub.checkmarx.com/cve-details/Cx8b24ace3-0c9a/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/cve-2023-46498/">https://devhub.checkmarx.com/cve-details/cve-2023-46498/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/342">https://github.com/evershopcommerce/evershop/pull/342</a></li>
<li><a href="https://github.com/advisories/GHSA-5mmr-9qx3-3pf9">https://github.com/advisories/GHSA-5mmr-9qx3-3pf9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5mmr-9qx3-3pf9</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Cross-site Scripting in evershop]]></title>
        <id>https://github.com/advisories/GHSA-gjj8-m83c-qv9h</id>
        <link href="https://github.com/advisories/GHSA-gjj8-m83c-qv9h"/>
        <updated>2023-12-13T13:37:46.000Z</updated>
        <content type="html"><![CDATA[<p>Cross Site Scripting vulnerability in EverShop NPM versions before v.1.0.0-rc.5 allows a remote attacker to obtain sensitive information via a crafted scripts to the Admin Panel.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46499">https://nvd.nist.gov/vuln/detail/CVE-2023-46499</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cx0f8b38be-d5de/">https://devhub.checkmarx.com/cve-details/Cx0f8b38be-d5de/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/cve-2023-46499/">https://devhub.checkmarx.com/cve-details/cve-2023-46499/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/244">https://github.com/evershopcommerce/evershop/pull/244</a></li>
<li><a href="https://github.com/advisories/GHSA-gjj8-m83c-qv9h">https://github.com/advisories/GHSA-gjj8-m83c-qv9h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gjj8-m83c-qv9h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Directory Traversal in evershop]]></title>
        <id>https://github.com/advisories/GHSA-7443-5962-wp4r</id>
        <link href="https://github.com/advisories/GHSA-7443-5962-wp4r"/>
        <updated>2023-12-13T13:37:36.000Z</updated>
        <content type="html"><![CDATA[<p>Directory Traversal vulnerability in EverShop NPM versions before v.1.0.0-rc.8 allows a remote attacker to obtain sensitive information via a crafted request to the mkdirSync function in the folderCreate/createFolder.js endpoint.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46497">https://nvd.nist.gov/vuln/detail/CVE-2023-46497</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-46497/">https://devhub.checkmarx.com/cve-details/CVE-2023-46497/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cx16846793-56b6/">https://devhub.checkmarx.com/cve-details/Cx16846793-56b6/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/338">https://github.com/evershopcommerce/evershop/pull/338</a></li>
<li><a href="https://github.com/advisories/GHSA-7443-5962-wp4r">https://github.com/advisories/GHSA-7443-5962-wp4r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7443-5962-wp4r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Directory Traversal in evershop]]></title>
        <id>https://github.com/advisories/GHSA-rwf3-w4jq-f4cm</id>
        <link href="https://github.com/advisories/GHSA-rwf3-w4jq-f4cm"/>
        <updated>2023-12-13T13:37:17.000Z</updated>
        <content type="html"><![CDATA[<p>Directory Traversal vulnerability in EverShop NPM versions before v.1.0.0-rc.8 allows a remote attacker to obtain sensitive information via a crafted request to the DELETE function in api/files endpoint.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46496">https://nvd.nist.gov/vuln/detail/CVE-2023-46496</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-46496/">https://devhub.checkmarx.com/cve-details/CVE-2023-46496/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cx943be66a-54cc/">https://devhub.checkmarx.com/cve-details/Cx943be66a-54cc/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/338">https://github.com/evershopcommerce/evershop/pull/338</a></li>
<li><a href="https://github.com/advisories/GHSA-rwf3-w4jq-f4cm">https://github.com/advisories/GHSA-rwf3-w4jq-f4cm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rwf3-w4jq-f4cm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Cross Site Scripting in evershop]]></title>
        <id>https://github.com/advisories/GHSA-m6vm-ff9v-jp3r</id>
        <link href="https://github.com/advisories/GHSA-m6vm-ff9v-jp3r"/>
        <updated>2023-12-13T13:37:00.000Z</updated>
        <content type="html"><![CDATA[<p>Cross Site Scripting vulnerability in EverShop NPM versions before v.1.0.0-rc.5 allows a remote attacker to obtain sensitive information via a crafted request to the ProductGrid function in admin/productGrid/Grid.jsx.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46494">https://nvd.nist.gov/vuln/detail/CVE-2023-46494</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-46494/">https://devhub.checkmarx.com/cve-details/CVE-2023-46494/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cx8ecec391-2014/">https://devhub.checkmarx.com/cve-details/Cx8ecec391-2014/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/244">https://github.com/evershopcommerce/evershop/pull/244</a></li>
<li><a href="https://github.com/advisories/GHSA-m6vm-ff9v-jp3r">https://github.com/advisories/GHSA-m6vm-ff9v-jp3r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-m6vm-ff9v-jp3r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Cross-site Scripting in evershop]]></title>
        <id>https://github.com/advisories/GHSA-2xcj-557c-hf8r</id>
        <link href="https://github.com/advisories/GHSA-2xcj-557c-hf8r"/>
        <updated>2023-12-13T13:36:34.000Z</updated>
        <content type="html"><![CDATA[<p>Cross Site Scripting vulnerability in EverShop NPM versions before v.1.0.0-rc.8 allows a remote attacker to obtain sensitive information via a crafted request to the sortBy parameter.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46495">https://nvd.nist.gov/vuln/detail/CVE-2023-46495</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-46495/">https://devhub.checkmarx.com/cve-details/CVE-2023-46495/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cxbc6d4599-c1bd/">https://devhub.checkmarx.com/cve-details/Cxbc6d4599-c1bd/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/338">https://github.com/evershopcommerce/evershop/pull/338</a></li>
<li><a href="https://github.com/advisories/GHSA-2xcj-557c-hf8r">https://github.com/advisories/GHSA-2xcj-557c-hf8r</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2xcj-557c-hf8r</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@evershop/evershop] Directory Traversal in evershop]]></title>
        <id>https://github.com/advisories/GHSA-4wrm-qmq2-5fjx</id>
        <link href="https://github.com/advisories/GHSA-4wrm-qmq2-5fjx"/>
        <updated>2023-12-13T13:36:13.000Z</updated>
        <content type="html"><![CDATA[<p>Directory Traversal vulnerability in EverShop NPM versions before v.1.0.0-rc.8 allows a remote attacker to obtain sensitive information via a crafted request to the readDirSync function in fileBrowser/browser.js.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46493">https://nvd.nist.gov/vuln/detail/CVE-2023-46493</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-46493/">https://devhub.checkmarx.com/cve-details/CVE-2023-46493/</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/Cxa4d94170-be41/">https://devhub.checkmarx.com/cve-details/Cxa4d94170-be41/</a></li>
<li><a href="https://github.com/evershopcommerce/evershop/pull/338">https://github.com/evershopcommerce/evershop/pull/338</a></li>
<li><a href="https://github.com/advisories/GHSA-4wrm-qmq2-5fjx">https://github.com/advisories/GHSA-4wrm-qmq2-5fjx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4wrm-qmq2-5fjx</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-08T21:30:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[gladys] Directory Traversal in Gladys Assistant]]></title>
        <id>https://github.com/advisories/GHSA-c79f-pqgf-fhp3</id>
        <link href="https://github.com/advisories/GHSA-c79f-pqgf-fhp3"/>
        <updated>2023-12-12T20:55:08.000Z</updated>
        <content type="html"><![CDATA[<p>Gladys Assistant v4.27.0 and prior is vulnerable to Directory Traversal. The patch of CVE-2023-43256 was found to be incomplete, allowing authenticated attackers to extract sensitive files in the host machine.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-47440">https://nvd.nist.gov/vuln/detail/CVE-2023-47440</a></li>
<li><a href="https://github.com/GladysAssistant/Gladys/pull/1918/commits/4f56ba250ff9f46578f1afa6a97e62e74bad83b7">https://github.com/GladysAssistant/Gladys/pull/1918/commits/4f56ba250ff9f46578f1afa6a97e62e74bad83b7</a></li>
<li><a href="https://blog.moku.fr/cve/">https://blog.moku.fr/cve/</a></li>
<li><a href="https://blog.moku.fr/cves/CVE-2023-47440/">https://blog.moku.fr/cves/CVE-2023-47440/</a></li>
<li><a href="https://github.com/advisories/GHSA-c79f-pqgf-fhp3">https://github.com/advisories/GHSA-c79f-pqgf-fhp3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c79f-pqgf-fhp3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-07T18:30:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[uptime-kuma] Password Change Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-88j4-pcx8-q4q3</id>
        <link href="https://github.com/advisories/GHSA-88j4-pcx8-q4q3"/>
        <updated>2023-12-12T00:59:30.000Z</updated>
        <content type="html"><![CDATA[<h2 id="overview">Overview:</h2>
<p>A moderate security vulnerability has been identified in Uptime Kuma platform that poses a significant threat to the confidentiality and integrity of user accounts.<br>When a user changes their login password in Uptime Kuma, a previously logged-in user retains access without being logged out.
This behaviour persists consistently, even after system restarts or browser restarts.
This vulnerability allows unauthorized access to user accounts, compromising the security of sensitive information.</p>
<p>The same vulnerability was partially fixed in <a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g</a> but logging existing users out of their accounts was forgotten.</p>
<h2 id="impact">Impact:</h2>
<p>The impact of this vulnerability is moderate, as it enables attackers or unauthorized individuals to maintain access to user accounts even after the account password has been changed. This can lead to unauthorized data access, manipulation, or compromise of user accounts, posing a threat to the integrity and confidentiality of Uptime Kuma.
A better impact-analysis is included in <a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g</a></p>
<h2 id="poc">PoC</h2>
<ul>
<li>Change the password for a user account</li>
<li>Access the platform using the previously logged-in account without logging out</li>
<li>Note that access (read-write) remains despite the password change </li>
<li>Expected behaviour:<br> After changing the password for a user account, all previously logged-in sessions should be invalidated, requiring users to log in again with the updated credentials.</li>
<li>Actual behaviour:<br>The system retains sessions and never logs out users unless explicitly done by clicking logout.</li>
</ul>
<h2 id="remediation">Remediation:</h2>
<p>To mitigate the risks associated with this vulnerability, we made the server emit a <code>refresh</code> event (clients handle this by reloading) and then disconnecting all clients except the one initiating the password change.</p>
<p>It is recommended to Update Uptime Kuma to <code>&gt;= 1.23.9</code>. </p>
<h2 id="timeline">Timeline:</h2>
<table>
<thead>
<tr>
<th>Date</th>
<th>Event</th>
</tr>
</thead>
<tbody><tr>
<td>2023-12-07 14:35 UTC</td>
<td>@manoonabbasi discovered and posts this information as a <code>bug</code>-report in issue #4188 [^1] into our <strong>public issue tracker</strong>, which is <a href="https://github.com/louislam/uptime-kuma/security/policy"><strong>against our security policy</strong></a></td>
</tr>
<tr>
<td>2023-12-07 16:50 UTC</td>
<td>The Uptime Kuma team deleted the post in our issue tracker</td>
</tr>
<tr>
<td>2023-12-10 18:10 UTC</td>
<td>Uptime Kuma team released patch and this Advisory</td>
</tr>
</tbody></table>
<p>[^1]: deleted to prevent the spread of this vulnerability without there being a fix available</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-88j4-pcx8-q4q3">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-88j4-pcx8-q4q3</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g">https://github.com/louislam/uptime-kuma/security/advisories/GHSA-g9v2-wqcj-j99g</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49804">https://nvd.nist.gov/vuln/detail/CVE-2023-49804</a></li>
<li><a href="https://github.com/louislam/uptime-kuma/commit/482049c72b3a650c7bc5c26c2f4d57a21c0e0aa0">https://github.com/louislam/uptime-kuma/commit/482049c72b3a650c7bc5c26c2f4d57a21c0e0aa0</a></li>
<li><a href="https://github.com/advisories/GHSA-88j4-pcx8-q4q3">https://github.com/advisories/GHSA-88j4-pcx8-q4q3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-88j4-pcx8-q4q3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-12T00:59:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nuxt-api-party] SSRF & Credentials Leak ]]></title>
        <id>https://github.com/advisories/GHSA-3wfp-253j-5jxv</id>
        <link href="https://github.com/advisories/GHSA-3wfp-253j-5jxv"/>
        <updated>2023-12-12T00:49:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>nuxt-api-party</code> allows developers to proxy requests to an API without exposing credentials to the client. <a href="https://huntr.dev/bounties/4c57a3f6-0d0e-4431-9494-4a1e7b062fbf/">A previous vulnerability</a> allowed an attacker to change the baseURL of the request, potentially leading to credentials being leaked or SSRF. </p>
<p>This vulnerability is similar, and was caused by a recent change to the detection of absolute URLs, which is no longer sufficient to prevent SSRF. </p>
<h3 id="details">Details</h3>
<p><code>nuxt-api-party</code> attempts to check if the user has passed an absolute URL to prevent the aforementioned attack. This has been recently changed to <a href="https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31">use a regular expression</a> <code>^https?://</code>.</p>
<p>This regular expression can be bypassed by an absolute URL with leading whitespace. For example <code>\nhttps://whatever.com</code> has a leading newline. </p>
<p>According to the fetch specification, before a fetch is made the URL is normalized. "To normalize a <a href="https://infra.spec.whatwg.org/#byte-sequence">byte sequence</a> potentialValue, remove any leading and trailing <a href="https://fetch.spec.whatwg.org/#http-whitespace-byte">HTTP whitespace bytes</a> from potentialValue." (<a href="https://fetch.spec.whatwg.org/">source</a>)</p>
<p>This means the final request will be normalized to <code>https://whatever.com</code>. We have bypassed the check and <code>nuxt-api-party</code> will send a request outside of the whitelist. </p>
<p>This could allow us to leak credentials or perform SSRF.</p>
<h3 id="poc">PoC</h3>
<p>POC using Node.</p>
<pre><code class="language-js">await fetch("/api/__api_party/MyEndpoint", {
    method: "POST",
    body: JSON.stringify({ path: "\nhttps://google.com" }),
    headers: { "Content-Type": "application/json" }
})
</code></pre>
<p>We can use <code>__proto__</code> as a substitute for the endpoint if it is not known. This will not leak any credentials as all attributes on <code>endpoint</code> will be undefined.</p>
<pre><code class="language-js">await fetch("/api/__api_party/__proto__", {
    method: "POST",
    body: JSON.stringify({ path: "\nhttps://google.com" }),
    headers: { "Content-Type": "application/json" }
})
</code></pre>
<h3 id="impact">Impact</h3>
<p>Leak of sensitive API credentials. SSRF.</p>
<h3 id="fix">Fix</h3>
<p>Revert to the previous method of detecting absolute URLs.</p>
<pre><code class="language-js">  if (new URL(path, 'http://localhost').origin !== 'http://localhost') {
      // ...
  }
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv">https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-3wfp-253j-5jxv</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49799">https://nvd.nist.gov/vuln/detail/CVE-2023-49799</a></li>
<li><a href="https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270">https://github.com/johannschopplich/nuxt-api-party/commit/72762a200fc19d997a0f84bce578c28698dc5270</a></li>
<li><a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a></li>
<li><a href="https://fetch.spec.whatwg.org/#http-whitespace-byte">https://fetch.spec.whatwg.org/#http-whitespace-byte</a></li>
<li><a href="https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31">https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L31</a></li>
<li><a href="https://infra.spec.whatwg.org/#byte-sequence">https://infra.spec.whatwg.org/#byte-sequence</a></li>
<li><a href="https://github.com/advisories/GHSA-3wfp-253j-5jxv">https://github.com/advisories/GHSA-3wfp-253j-5jxv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3wfp-253j-5jxv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-12-12T00:49:44.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@openzeppelin/contracts-upgradeable] OpenZeppelin Contracts and Contracts Upgradeable duplicated execution of subcalls in v4.9.4]]></title>
        <id>https://github.com/advisories/GHSA-699g-q6qh-q4v8</id>
        <link href="https://github.com/advisories/GHSA-699g-q6qh-q4v8"/>
        <updated>2023-12-12T00:49:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="context">Context</h3>
<p>Merge conflict resolution issue when porting the v5.0.1 <code>Multicall</code> update to the v4.9 branch caused a duplicated line.</p>
<h3 id="impact">Impact</h3>
<p>Versions using <code>Multicall</code> from <code>@openzeppelin/contracts@4.9.4</code> and <code>@openzeppelin/contracts-upgradeable@4.9.4</code> will execute each subcall twice. Concretely, this exposes a user to unintentionally duplicate operations like asset transfers.</p>
<h3 id="patches">Patches</h3>
<p>The duplicated <code>delegatecall</code> was removed in 4.9.5. The 4.9.4 version is marked as deprecated.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8">https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49798">https://nvd.nist.gov/vuln/detail/CVE-2023-49798</a></li>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489">https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489</a></li>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205">https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205</a></li>
<li><a href="https://github.com/advisories/GHSA-699g-q6qh-q4v8">https://github.com/advisories/GHSA-699g-q6qh-q4v8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-699g-q6qh-q4v8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-12T00:49:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@openzeppelin/contracts] OpenZeppelin Contracts and Contracts Upgradeable duplicated execution of subcalls in v4.9.4]]></title>
        <id>https://github.com/advisories/GHSA-699g-q6qh-q4v8</id>
        <link href="https://github.com/advisories/GHSA-699g-q6qh-q4v8"/>
        <updated>2023-12-12T00:49:26.000Z</updated>
        <content type="html"><![CDATA[<h3 id="context">Context</h3>
<p>Merge conflict resolution issue when porting the v5.0.1 <code>Multicall</code> update to the v4.9 branch caused a duplicated line.</p>
<h3 id="impact">Impact</h3>
<p>Versions using <code>Multicall</code> from <code>@openzeppelin/contracts@4.9.4</code> and <code>@openzeppelin/contracts-upgradeable@4.9.4</code> will execute each subcall twice. Concretely, this exposes a user to unintentionally duplicate operations like asset transfers.</p>
<h3 id="patches">Patches</h3>
<p>The duplicated <code>delegatecall</code> was removed in 4.9.5. The 4.9.4 version is marked as deprecated.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8">https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-699g-q6qh-q4v8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49798">https://nvd.nist.gov/vuln/detail/CVE-2023-49798</a></li>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489">https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/commit/31f9fb9d171f60b2271b2b9c6f62d43302bf9489</a></li>
<li><a href="https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205">https://github.com/OpenZeppelin/openzeppelin-contracts/commit/88ac712e06832bce73b41e8166cded2729e25205</a></li>
<li><a href="https://github.com/advisories/GHSA-699g-q6qh-q4v8">https://github.com/advisories/GHSA-699g-q6qh-q4v8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-699g-q6qh-q4v8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-12-12T00:49:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[@koa/cors] Overly permissive origin policy]]></title>
        <id>https://github.com/advisories/GHSA-qxrj-hx23-xp82</id>
        <link href="https://github.com/advisories/GHSA-qxrj-hx23-xp82"/>
        <updated>2023-12-12T00:46:36.000Z</updated>
        <content type="html"><![CDATA[<p>Currently, the middleware operates in a way that if an allowed origin is not provided, it will return an <code>Access-Control-Allow-Origin</code> header with the value of the origin from the request. This behavior completely disables one of the most crucial elements of browsers - the Same Origin Policy (SOP), this could cause a very serious security threat to the users of this middleware.</p>
<p>If such behavior is expected, for instance, when middleware is used exclusively for prototypes and not for production applications, it should be heavily emphasized in the documentation along with an indication of the risks associated with such behavior, as many users may not be aware of it.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/koajs/cors/security/advisories/GHSA-qxrj-hx23-xp82">https://github.com/koajs/cors/security/advisories/GHSA-qxrj-hx23-xp82</a></li>
<li><a href="https://github.com/koajs/cors/commit/f31dac99f5355c41e7d4dd3c4a80c5f154941a11">https://github.com/koajs/cors/commit/f31dac99f5355c41e7d4dd3c4a80c5f154941a11</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49803">https://nvd.nist.gov/vuln/detail/CVE-2023-49803</a></li>
<li><a href="https://github.com/advisories/GHSA-qxrj-hx23-xp82">https://github.com/advisories/GHSA-qxrj-hx23-xp82</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qxrj-hx23-xp82</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-12-11T21:46:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nuxt-api-party] DOS by abusing `fetchOptions.retry`. ]]></title>
        <id>https://github.com/advisories/GHSA-q6hx-3m4p-749h</id>
        <link href="https://github.com/advisories/GHSA-q6hx-3m4p-749h"/>
        <updated>2023-12-13T18:58:35.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p><code>nuxt-api-party</code> allows developers to proxy requests to an API without exposing credentials to the client. <a href="https://github.com/unjs/ofetch"><code>ofetch</code></a> is used to send the requests. </p>
<p>The library allows the user to send many options directly to <code>ofetch</code>. There is no filter on which options are available. We can abuse the retry logic to cause the server to crash from a stack overflow.</p>
<h3 id="details">Details</h3>
<p><code>fetchOptions</code> <a href="https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L27">are obtained directly from the request body</a>. These are then <a href="https://github.com/johannschopplich/nuxt-api-party/blob/777462e1e3af1d9f8938aa33f230cd8cb6e0cc9a/src/runtime/server/handler.ts#L57C15-L57C15">passed directly into <code>ofetch</code>
</a>.</p>
<p>We can construct a URL we know will not fetch successfully, then set the retry attempts to a high value, this will cause a stack overflow as ofetch error handling works recursively. </p>
<h3 id="poc">PoC</h3>
<p>POC using Node.</p>
<pre><code class="language-js">await fetch("http://localhost:3000/api/__api_party/MyEndpoint", {
    method: "POST",
    body: JSON.stringify({ path: "x:x", retry: 9999999 }),
    headers: { "Content-Type": "application/json" }
})
</code></pre>
<p>We can use <code>__proto__</code> as a substitute for the endpoint if it is not known.</p>
<pre><code class="language-js">await fetch("http://localhost:3000/api/__api_party/__proto__", {
    method: "POST",
    body: JSON.stringify({ path: "x:x", retry: 9999999 }),
    headers: { "Content-Type": "application/json" }
})
</code></pre>
<p>We can build the size of the stack faster by using more complicated URIs</p>
<pre><code class="language-js">await fetch("http://localhost:3000/api/__api_party/__proto__", {
    method: "POST",
    body: JSON.stringify({ path: "data:x;base64,----", retry: 9999999 }),
    headers: { "Content-Type": "application/json" }
})
</code></pre>
<h3 id="impact">Impact</h3>
<p>Full DOS, server is unusable during attack. Requires a single request. </p>
<h3 id="fix">Fix</h3>
<p>Limit which options can be passed to <code>ofetch</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-q6hx-3m4p-749h">https://github.com/johannschopplich/nuxt-api-party/security/advisories/GHSA-q6hx-3m4p-749h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-49800">https://nvd.nist.gov/vuln/detail/CVE-2023-49800</a></li>
<li><a href="https://github.com/advisories/GHSA-q6hx-3m4p-749h">https://github.com/advisories/GHSA-q6hx-3m4p-749h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q6hx-3m4p-749h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-12-11T20:29:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[cli] Duplicate Advisory: Node CLI Allows Arbitrary File Overwrite]]></title>
        <id>https://github.com/advisories/GHSA-3mrp-qhcj-mwv5</id>
        <link href="https://github.com/advisories/GHSA-3mrp-qhcj-mwv5"/>
        <updated>2023-12-08T21:57:40.000Z</updated>
        <content type="html"><![CDATA[<h2 id="duplicate-advisory">Duplicate Advisory</h2>
<p>This advisory has been withdrawn because it is a duplicate of GHSA-6cpc-mj5c-m9rq. This link is maintained to preserve external references.</p>
<h2 id="original-description">Original Description</h2>
<p>An issue exists in node-cli 0.1.0 through 0.11.3 due to predictable temporary file names in lock_file and log_file, which allows an attacker to overwrite files.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2016-1000021">https://nvd.nist.gov/vuln/detail/CVE-2016-1000021</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-1000021">https://bugzilla.redhat.com/show_bug.cgi?id=CVE-2016-1000021</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2016-10538">https://nvd.nist.gov/vuln/detail/CVE-2016-10538</a></li>
<li><a href="https://github.com/node-js-libs/cli/issues/81">https://github.com/node-js-libs/cli/issues/81</a></li>
<li><a href="https://web.archive.org/web/20190430172230/https://www.npmjs.com/advisories/95">https://web.archive.org/web/20190430172230/https://www.npmjs.com/advisories/95</a></li>
<li><a href="https://github.com/advisories/GHSA-3mrp-qhcj-mwv5">https://github.com/advisories/GHSA-3mrp-qhcj-mwv5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3mrp-qhcj-mwv5</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-05-24T17:02:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[urijs] URIjs Hostname spoofing via backslashes in URL]]></title>
        <id>https://github.com/advisories/GHSA-p6j9-7xhc-rhwp</id>
        <link href="https://github.com/advisories/GHSA-p6j9-7xhc-rhwp"/>
        <updated>2023-12-08T05:05:18.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>If using affected versions to determine a URL's hostname, the hostname can be spoofed by using a backslash (<code>\</code>) character as part of the scheme delimiter, e.g. <code>scheme:/\hostname</code>. If the hostname is used in security decisions, the decision may be incorrect.</p>
<p>Depending on library usage and attacker intent, impacts may include allow/block list bypasses, SSRF attacks, open redirects, or other undesired behavior.</p>
<p>Example URL: <code>https:/\expected-example.com/path</code>
Escaped string: <code>https:/\\expected-example.com/path</code> (JavaScript strings must escape backslash)</p>
<p>Affected versions incorrectly return no hostname. Patched versions correctly return <code>expected-example.com</code>. Patched versions match the behavior of other parsers which implement the <a href="https://url.spec.whatwg.org/">WHATWG URL specification</a>, including web browsers and <a href="https://nodejs.org/api/url.html">Node's built-in URL class</a>.</p>
<h3 id="patches">Patches</h3>
<p>Version 1.19.6 is patched against all known payload variants.</p>
<h3 id="references">References</h3>
<p><a href="https://github.com/medialize/URI.js/releases/tag/v1.19.6">https://github.com/medialize/URI.js/releases/tag/v1.19.6</a> (fix for this particular bypass)
<a href="https://github.com/medialize/URI.js/releases/tag/v1.19.4">https://github.com/medialize/URI.js/releases/tag/v1.19.4</a> (fix for related bypass)
<a href="https://github.com/medialize/URI.js/releases/tag/v1.19.3">https://github.com/medialize/URI.js/releases/tag/v1.19.3</a> (fix for related bypass)
<a href="https://github.com/medialize/URI.js/pull/233">PR #233</a> (initial fix for backslash handling)</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, open an issue in <a href="https://github.com/medialize/URI.js">https://github.com/medialize/URI.js</a></p>
<h3 id="reporter-credit">Reporter credit</h3>
<p><a href="https://twitter.com/ynizry">Yaniv Nizry</a> from the CxSCA AppSec team at Checkmarx</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/medialize/URI.js/security/advisories/GHSA-p6j9-7xhc-rhwp">https://github.com/medialize/URI.js/security/advisories/GHSA-p6j9-7xhc-rhwp</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-27516">https://nvd.nist.gov/vuln/detail/CVE-2021-27516</a></li>
<li><a href="https://github.com/medialize/URI.js/commit/a1ad8bcbc39a4d136d7e252e76e957f3ece70839">https://github.com/medialize/URI.js/commit/a1ad8bcbc39a4d136d7e252e76e957f3ece70839</a></li>
<li><a href="https://github.com/medialize/URI.js/releases/tag/v1.19.6">https://github.com/medialize/URI.js/releases/tag/v1.19.6</a></li>
<li><a href="https://advisory.checkmarx.net/advisory/CX-2021-4305">https://advisory.checkmarx.net/advisory/CX-2021-4305</a></li>
<li><a href="https://github.com/advisories/GHSA-p6j9-7xhc-rhwp">https://github.com/advisories/GHSA-p6j9-7xhc-rhwp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p6j9-7xhc-rhwp</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-03-01T20:03:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ipfs-bitswap] Denial of Service in ipfs-bitswap]]></title>
        <id>https://github.com/advisories/GHSA-6fcr-9h9g-23fq</id>
        <link href="https://github.com/advisories/GHSA-6fcr-9h9g-23fq"/>
        <updated>2023-12-07T22:08:14.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of <code>ipfs-bitswap</code> prior to 0.24.1 are vulnerable to Denial of Service (DoS). The package put unwanted blocks in the blockstore, which could be used to exhaust system resources in specific conditions.</p>
<h2 id="recommendation">Recommendation</h2>
<p>Upgrade to version 0.24.1 or later.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ipfs/js-ipfs-bitswap/pull/194">https://github.com/ipfs/js-ipfs-bitswap/pull/194</a></li>
<li><a href="https://snyk.io/vuln/SNYK-JS-IPFSBITSWAP-174847">https://snyk.io/vuln/SNYK-JS-IPFSBITSWAP-174847</a></li>
<li><a href="https://www.npmjs.com/advisories/916">https://www.npmjs.com/advisories/916</a></li>
<li><a href="https://github.com/advisories/GHSA-6fcr-9h9g-23fq">https://github.com/advisories/GHSA-6fcr-9h9g-23fq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6fcr-9h9g-23fq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-02T21:50:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[beffer-xor] Malicious Package in beffer-xor]]></title>
        <id>https://github.com/advisories/GHSA-7cvf-p83w-48q6</id>
        <link href="https://github.com/advisories/GHSA-7cvf-p83w-48q6"/>
        <updated>2023-12-07T22:07:52.000Z</updated>
        <content type="html"><![CDATA[<p>Version 2.0.2 contained malicious code. The package targeted the Ethereum cryptocurrency and performed transactions to wallets not controlled by the user.</p>
<h2 id="recommendation">Recommendation</h2>
<p>Remove the package from your environment. Ensure no Ethereum funds were compromised.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://www.npmjs.com/advisories/1229">https://www.npmjs.com/advisories/1229</a></li>
<li><a href="https://github.com/advisories/GHSA-7cvf-p83w-48q6">https://github.com/advisories/GHSA-7cvf-p83w-48q6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7cvf-p83w-48q6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2020-09-03T21:37:29.000Z</published>
    </entry>
</feed>