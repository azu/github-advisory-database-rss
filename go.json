{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<p>A vulnerability was found in Windmill 1.380.0. It has been classified as problematic. Affected is an unknown function of the file backend/windmill-api/src/users.rs of the component HTTP Request Handler. The manipulation leads to improper restriction of excessive authentication attempts. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. Upgrading to version 1.390.1 is able to address this issue. The patch is identified as acfe7786152f036f2476f93ab5536571514fa9e3. It is recommended to upgrade the affected component.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-8462\">https://nvd.nist.gov/vuln/detail/CVE-2024-8462</a></li>\n<li><a href=\"https://github.com/windmill-labs/windmill/commit/acfe7786152f036f2476f93ab5536571514fa9e3\">https://github.com/windmill-labs/windmill/commit/acfe7786152f036f2476f93ab5536571514fa9e3</a></li>\n<li><a href=\"https://github.com/windmill-labs/windmill/releases/tag/v1.390.1\">https://github.com/windmill-labs/windmill/releases/tag/v1.390.1</a></li>\n<li><a href=\"https://vuldb.com/?ctiid.276630\">https://vuldb.com/?ctiid.276630</a></li>\n<li><a href=\"https://vuldb.com/?id.276630\">https://vuldb.com/?id.276630</a></li>\n<li><a href=\"https://vuldb.com/?submit.401826\">https://vuldb.com/?submit.401826</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2024-3118\">https://pkg.go.dev/vuln/GO-2024-3118</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g6q4-w3j3-jfc4\">https://github.com/advisories/GHSA-g6q4-w3j3-jfc4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g6q4-w3j3-jfc4",
            "title": "[github.com/windmill-labs/windmill] Windmill HTTP Request users.rs excessive authentication in github.com/windmill-labs/windmill",
            "date_modified": "2024-09-06T21:57:29.000Z",
            "date_published": "2024-09-05T15:33:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g6q4-w3j3-jfc4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cure53 has discovered that the Harbor web interface does not implement protection mechanisms against Cross-Site Request Forgery (CSRF). By luring an authenticated user onto a prepared third-party website, an attacker can execute any action on the platform in the context of the currently authenticated victim.</p>\n<p>The vulnerability was immediately fixed by the Harbor team and all supported versions were patched.</p>\n<p>Successful exploitation of this issue will lead to 3rd parties executing actions on the platform of behalf of authenticated users and administrators.</p>\n<p>If your product uses the affected releases of Harbor, update to version 1.8.6 and 1.9.3 to patch this issue immediately.</p>\n<p><a href=\"https://github.com/goharbor/harbor/releases/tag/v1.8.6\">https://github.com/goharbor/harbor/releases/tag/v1.8.6</a>\n<a href=\"https://github.com/goharbor/harbor/releases/tag/v1.9.3\">https://github.com/goharbor/harbor/releases/tag/v1.9.3</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories/GHSA-gcqm-v682-ccw6\">https://github.com/goharbor/harbor/security/advisories/GHSA-gcqm-v682-ccw6</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-19025\">https://nvd.nist.gov/vuln/detail/CVE-2019-19025</a></li>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories\">https://github.com/goharbor/harbor/security/advisories</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2019-19025\">https://tanzu.vmware.com/security/cve-2019-19025</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rffr-c932-cpxv\">https://github.com/advisories/GHSA-rffr-c932-cpxv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rffr-c932-cpxv",
            "title": "[github.com/goharbor/harbor] Cross-site Request Forgery (CSRF) in Cloud Native Computing Foundation Harbor",
            "date_modified": "2024-09-06T21:54:44.000Z",
            "date_published": "2021-05-18T18:27:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rffr-c932-cpxv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cure53 has discovered that the Harbor web interface does not implement protection mechanisms against Cross-Site Request Forgery (CSRF). By luring an authenticated user onto a prepared third-party website, an attacker can execute any action on the platform in the context of the currently authenticated victim.</p>\n<p>The vulnerability was immediately fixed by the Harbor team and all supported versions were patched.</p>\n<p>Successful exploitation of this issue will lead to 3rd parties executing actions on the platform of behalf of authenticated users and administrators.</p>\n<p>If your product uses the affected releases of Harbor, update to version 1.8.6 and 1.9.3 to patch this issue immediately.</p>\n<p><a href=\"https://github.com/goharbor/harbor/releases/tag/v1.8.6\">https://github.com/goharbor/harbor/releases/tag/v1.8.6</a>\n<a href=\"https://github.com/goharbor/harbor/releases/tag/v1.9.3\">https://github.com/goharbor/harbor/releases/tag/v1.9.3</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories/GHSA-gcqm-v682-ccw6\">https://github.com/goharbor/harbor/security/advisories/GHSA-gcqm-v682-ccw6</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-19025\">https://nvd.nist.gov/vuln/detail/CVE-2019-19025</a></li>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories\">https://github.com/goharbor/harbor/security/advisories</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2019-19025\">https://tanzu.vmware.com/security/cve-2019-19025</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rffr-c932-cpxv\">https://github.com/advisories/GHSA-rffr-c932-cpxv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rffr-c932-cpxv",
            "title": "[github.com/goharbor/harbor] Cross-site Request Forgery (CSRF) in Cloud Native Computing Foundation Harbor",
            "date_modified": "2024-09-06T21:54:44.000Z",
            "date_published": "2021-05-18T18:27:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rffr-c932-cpxv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cloud Native Computing Foundation Harbor prior to 1.8.6 and 1.9.3 allows SQL Injection via user-groups in the VMware Harbor Container Registry for the Pivotal Platform.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories/GHSA-qcfv-8v29-469w\">https://github.com/goharbor/harbor/security/advisories/GHSA-qcfv-8v29-469w</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-19029\">https://nvd.nist.gov/vuln/detail/CVE-2019-19029</a></li>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories\">https://github.com/goharbor/harbor/security/advisories</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2019-19029\">https://tanzu.vmware.com/security/cve-2019-19029</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-0853\">https://pkg.go.dev/vuln/GO-2022-0853</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jr34-mff8-pc6f\">https://github.com/advisories/GHSA-jr34-mff8-pc6f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jr34-mff8-pc6f",
            "title": "[github.com/goharbor/harbor] SQL Injection in Cloud Native Computing Foundation Harbor",
            "date_modified": "2024-09-06T21:52:11.000Z",
            "date_published": "2021-05-18T18:27:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jr34-mff8-pc6f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Cloud Native Computing Foundation Harbor prior to 1.8.6 and 1.9.3 allows SQL Injection via user-groups in the VMware Harbor Container Registry for the Pivotal Platform.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories/GHSA-qcfv-8v29-469w\">https://github.com/goharbor/harbor/security/advisories/GHSA-qcfv-8v29-469w</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-19029\">https://nvd.nist.gov/vuln/detail/CVE-2019-19029</a></li>\n<li><a href=\"https://github.com/goharbor/harbor/security/advisories\">https://github.com/goharbor/harbor/security/advisories</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2019-19029\">https://tanzu.vmware.com/security/cve-2019-19029</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-0853\">https://pkg.go.dev/vuln/GO-2022-0853</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jr34-mff8-pc6f\">https://github.com/advisories/GHSA-jr34-mff8-pc6f</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jr34-mff8-pc6f",
            "title": "[github.com/goharbor/harbor] SQL Injection in Cloud Native Computing Foundation Harbor",
            "date_modified": "2024-09-06T21:52:11.000Z",
            "date_published": "2021-05-18T18:27:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jr34-mff8-pc6f"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"context\">Context</h3>\n<p>ICS has the following four messages that enable validators on the provider chain to perform different actions:</p>\n<ul>\n<li><code>MsgOptIn</code> -- adds a validator to the consumer chain’s active set</li>\n<li><code>MsgOptOut</code> -- removes a validator from the consumer chain’s active set </li>\n<li><code>MsgAssignConsumerKey</code> -- changes the consensus key used for a validator’s operations on a consumer chain</li>\n<li><code>MsgSetConsumerCommissionRate</code> -- sets a validator’s consumer-specific commission rate</li>\n</ul>\n<p>Normally, only the respective validators are allowed to perform these actions. </p>\n<h3 id=\"issue\">Issue</h3>\n<p>The upgrade to SDK 0.50, introduced a <a href=\"https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations#signer\">signer</a> field to these messages. This field is used to authenticate the user sending the message to the system. However, there was no validation on the ICS side to check if the signer matches the provider address.  </p>\n<p>As a result, any user could opt-in, opt-out, change the commission rate, or change what public key a validator uses on a consumer chain. </p>\n<p>For more context, check out the code:</p>\n<ul>\n<li>proto files <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52</a></li>\n<li>message validation <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106</a></li>\n<li>message handling <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52</a></li>\n</ul>\n<h3 id=\"severity-assessment\">Severity assessment</h3>\n<p>The severity assessment is based on <a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">this framework</a>. </p>\n<p><strong>Potential impact:</strong> Catastrophic </p>\n<ul>\n<li>By changing consumer keys for 1/3+ of a consumer chain's validator set, any user could cause a consumer chain to halt. Given that the consumer is down, the provider will jail provider validators for consumer downtime, so this exploit would not have impacted the provider directly. Consumer chain halts would need to be addressed by a provider-side patch.</li>\n<li>By changing consumer keys on a consumer node, double signing, and submitting evidence back to the provider, any user could tombstone any provider validator. This would cause the provider's active set to change. At scale, this exploit could be applied to all active provider validators and a well-funded attacker could then run their own nodes and take over consensus on the provider and on consumer chains.</li>\n</ul>\n<p><strong>Likelihood:</strong> Rare</p>\n<ul>\n<li>The bug was discovered internally. There is no evidence that any external party has identified this vulnerability. </li>\n<li>The bug has been live for two weeks with no issues. </li>\n<li>All four message types are ones that only validators use, and rarely use in daily operations.</li>\n<li>In the Cosmos Hub’s recent history (May - Aug), there has been only one instance of any of these message types, which was performed in accordance with chain rules.</li>\n<li>The catastrophic exploits (such as tombstoning the entire validator set of the provider) are also extremely complex. They involve several operations that are not well-understood by many people, and the entire exploit must occur quickly and at-scale to avoid other node operators responding defensively.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g\">https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7q74-g774-7x3g\">https://github.com/advisories/GHSA-7q74-g774-7x3g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g",
            "title": "[github.com/cosmos/interchain-security/v4] Interchain Security: The signers of ICS messages do not need to match the provider address ",
            "date_modified": "2024-09-06T21:41:49.000Z",
            "date_published": "2024-09-05T21:19:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"context\">Context</h3>\n<p>ICS has the following four messages that enable validators on the provider chain to perform different actions:</p>\n<ul>\n<li><code>MsgOptIn</code> -- adds a validator to the consumer chain’s active set</li>\n<li><code>MsgOptOut</code> -- removes a validator from the consumer chain’s active set </li>\n<li><code>MsgAssignConsumerKey</code> -- changes the consensus key used for a validator’s operations on a consumer chain</li>\n<li><code>MsgSetConsumerCommissionRate</code> -- sets a validator’s consumer-specific commission rate</li>\n</ul>\n<p>Normally, only the respective validators are allowed to perform these actions. </p>\n<h3 id=\"issue\">Issue</h3>\n<p>The upgrade to SDK 0.50, introduced a <a href=\"https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations#signer\">signer</a> field to these messages. This field is used to authenticate the user sending the message to the system. However, there was no validation on the ICS side to check if the signer matches the provider address.  </p>\n<p>As a result, any user could opt-in, opt-out, change the commission rate, or change what public key a validator uses on a consumer chain. </p>\n<p>For more context, check out the code:</p>\n<ul>\n<li>proto files <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52</a></li>\n<li>message validation <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106</a></li>\n<li>message handling <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52</a></li>\n</ul>\n<h3 id=\"severity-assessment\">Severity assessment</h3>\n<p>The severity assessment is based on <a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">this framework</a>. </p>\n<p><strong>Potential impact:</strong> Catastrophic </p>\n<ul>\n<li>By changing consumer keys for 1/3+ of a consumer chain's validator set, any user could cause a consumer chain to halt. Given that the consumer is down, the provider will jail provider validators for consumer downtime, so this exploit would not have impacted the provider directly. Consumer chain halts would need to be addressed by a provider-side patch.</li>\n<li>By changing consumer keys on a consumer node, double signing, and submitting evidence back to the provider, any user could tombstone any provider validator. This would cause the provider's active set to change. At scale, this exploit could be applied to all active provider validators and a well-funded attacker could then run their own nodes and take over consensus on the provider and on consumer chains.</li>\n</ul>\n<p><strong>Likelihood:</strong> Rare</p>\n<ul>\n<li>The bug was discovered internally. There is no evidence that any external party has identified this vulnerability. </li>\n<li>The bug has been live for two weeks with no issues. </li>\n<li>All four message types are ones that only validators use, and rarely use in daily operations.</li>\n<li>In the Cosmos Hub’s recent history (May - Aug), there has been only one instance of any of these message types, which was performed in accordance with chain rules.</li>\n<li>The catastrophic exploits (such as tombstoning the entire validator set of the provider) are also extremely complex. They involve several operations that are not well-understood by many people, and the entire exploit must occur quickly and at-scale to avoid other node operators responding defensively.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g\">https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7q74-g774-7x3g\">https://github.com/advisories/GHSA-7q74-g774-7x3g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g",
            "title": "[github.com/cosmos/interchain-security/v3] Interchain Security: The signers of ICS messages do not need to match the provider address ",
            "date_modified": "2024-09-06T21:41:49.000Z",
            "date_published": "2024-09-05T21:19:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"context\">Context</h3>\n<p>ICS has the following four messages that enable validators on the provider chain to perform different actions:</p>\n<ul>\n<li><code>MsgOptIn</code> -- adds a validator to the consumer chain’s active set</li>\n<li><code>MsgOptOut</code> -- removes a validator from the consumer chain’s active set </li>\n<li><code>MsgAssignConsumerKey</code> -- changes the consensus key used for a validator’s operations on a consumer chain</li>\n<li><code>MsgSetConsumerCommissionRate</code> -- sets a validator’s consumer-specific commission rate</li>\n</ul>\n<p>Normally, only the respective validators are allowed to perform these actions. </p>\n<h3 id=\"issue\">Issue</h3>\n<p>The upgrade to SDK 0.50, introduced a <a href=\"https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations#signer\">signer</a> field to these messages. This field is used to authenticate the user sending the message to the system. However, there was no validation on the ICS side to check if the signer matches the provider address.  </p>\n<p>As a result, any user could opt-in, opt-out, change the commission rate, or change what public key a validator uses on a consumer chain. </p>\n<p>For more context, check out the code:</p>\n<ul>\n<li>proto files <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52</a></li>\n<li>message validation <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106</a></li>\n<li>message handling <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52</a></li>\n</ul>\n<h3 id=\"severity-assessment\">Severity assessment</h3>\n<p>The severity assessment is based on <a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">this framework</a>. </p>\n<p><strong>Potential impact:</strong> Catastrophic </p>\n<ul>\n<li>By changing consumer keys for 1/3+ of a consumer chain's validator set, any user could cause a consumer chain to halt. Given that the consumer is down, the provider will jail provider validators for consumer downtime, so this exploit would not have impacted the provider directly. Consumer chain halts would need to be addressed by a provider-side patch.</li>\n<li>By changing consumer keys on a consumer node, double signing, and submitting evidence back to the provider, any user could tombstone any provider validator. This would cause the provider's active set to change. At scale, this exploit could be applied to all active provider validators and a well-funded attacker could then run their own nodes and take over consensus on the provider and on consumer chains.</li>\n</ul>\n<p><strong>Likelihood:</strong> Rare</p>\n<ul>\n<li>The bug was discovered internally. There is no evidence that any external party has identified this vulnerability. </li>\n<li>The bug has been live for two weeks with no issues. </li>\n<li>All four message types are ones that only validators use, and rarely use in daily operations.</li>\n<li>In the Cosmos Hub’s recent history (May - Aug), there has been only one instance of any of these message types, which was performed in accordance with chain rules.</li>\n<li>The catastrophic exploits (such as tombstoning the entire validator set of the provider) are also extremely complex. They involve several operations that are not well-understood by many people, and the entire exploit must occur quickly and at-scale to avoid other node operators responding defensively.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g\">https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7q74-g774-7x3g\">https://github.com/advisories/GHSA-7q74-g774-7x3g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g",
            "title": "[github.com/cosmos/interchain-security/v2] Interchain Security: The signers of ICS messages do not need to match the provider address ",
            "date_modified": "2024-09-06T21:41:49.000Z",
            "date_published": "2024-09-05T21:19:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"context\">Context</h3>\n<p>ICS has the following four messages that enable validators on the provider chain to perform different actions:</p>\n<ul>\n<li><code>MsgOptIn</code> -- adds a validator to the consumer chain’s active set</li>\n<li><code>MsgOptOut</code> -- removes a validator from the consumer chain’s active set </li>\n<li><code>MsgAssignConsumerKey</code> -- changes the consensus key used for a validator’s operations on a consumer chain</li>\n<li><code>MsgSetConsumerCommissionRate</code> -- sets a validator’s consumer-specific commission rate</li>\n</ul>\n<p>Normally, only the respective validators are allowed to perform these actions. </p>\n<h3 id=\"issue\">Issue</h3>\n<p>The upgrade to SDK 0.50, introduced a <a href=\"https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations#signer\">signer</a> field to these messages. This field is used to authenticate the user sending the message to the system. However, there was no validation on the ICS side to check if the signer matches the provider address.  </p>\n<p>As a result, any user could opt-in, opt-out, change the commission rate, or change what public key a validator uses on a consumer chain. </p>\n<p>For more context, check out the code:</p>\n<ul>\n<li>proto files <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52</a></li>\n<li>message validation <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106</a></li>\n<li>message handling <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52</a></li>\n</ul>\n<h3 id=\"severity-assessment\">Severity assessment</h3>\n<p>The severity assessment is based on <a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">this framework</a>. </p>\n<p><strong>Potential impact:</strong> Catastrophic </p>\n<ul>\n<li>By changing consumer keys for 1/3+ of a consumer chain's validator set, any user could cause a consumer chain to halt. Given that the consumer is down, the provider will jail provider validators for consumer downtime, so this exploit would not have impacted the provider directly. Consumer chain halts would need to be addressed by a provider-side patch.</li>\n<li>By changing consumer keys on a consumer node, double signing, and submitting evidence back to the provider, any user could tombstone any provider validator. This would cause the provider's active set to change. At scale, this exploit could be applied to all active provider validators and a well-funded attacker could then run their own nodes and take over consensus on the provider and on consumer chains.</li>\n</ul>\n<p><strong>Likelihood:</strong> Rare</p>\n<ul>\n<li>The bug was discovered internally. There is no evidence that any external party has identified this vulnerability. </li>\n<li>The bug has been live for two weeks with no issues. </li>\n<li>All four message types are ones that only validators use, and rarely use in daily operations.</li>\n<li>In the Cosmos Hub’s recent history (May - Aug), there has been only one instance of any of these message types, which was performed in accordance with chain rules.</li>\n<li>The catastrophic exploits (such as tombstoning the entire validator set of the provider) are also extremely complex. They involve several operations that are not well-understood by many people, and the entire exploit must occur quickly and at-scale to avoid other node operators responding defensively.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g\">https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7q74-g774-7x3g\">https://github.com/advisories/GHSA-7q74-g774-7x3g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g",
            "title": "[github.com/cosmos/interchain-security] Interchain Security: The signers of ICS messages do not need to match the provider address ",
            "date_modified": "2024-09-06T21:41:49.000Z",
            "date_published": "2024-09-05T21:19:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A malicious container can affect the host by taking advantage of code cri-o added to show the container mounts on the host.</p>\n<p>A workload built from this Dockerfile:</p>\n<pre><code>FROM docker.io/library/busybox as source\nRUN mkdir /extra &amp;&amp; cd /extra &amp;&amp; ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n</code></pre>\n<p>and this container config:</p>\n<pre><code>{\n  \"metadata\": {\n      \"name\": \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"localhost/test\"\n  },\n  \"command\": [\n      \"/bin/true\"\n  ],\n  \"linux\": {\n  }\n}\n\n</code></pre>\n<p>and this sandbox config  </p>\n<pre><code>{\n  \"metadata\": {\n    \"name\": \"test-sandbox\",\n    \"namespace\": \"default\",\n    \"attempt\": 1,\n    \"uid\": \"edishd83djaideaduwk28bcsb\"\n  },\n  \"linux\": {\n    \"security_context\": {\n      \"namespace_options\": {\n        \"network\": 2\n      }\n    }\n  }\n}\n</code></pre>\n<p>will create a file on host <code>/host/mtab</code></p>\n<h3 id=\"patches\">Patches</h3>\n<p>1.30.1, 1.29.5, 1.28.7</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Unfortunately not</p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5154\">https://nvd.nist.gov/vuln/detail/CVE-2024-5154</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3676\">https://access.redhat.com/errata/RHSA-2024:3676</a></li>\n<li><a href=\"https://access.redhat.com/security/cve/CVE-2024-5154\">https://access.redhat.com/security/cve/CVE-2024-5154</a></li>\n<li><a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2280190\">https://bugzilla.redhat.com/show_bug.cgi?id=2280190</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2024-2919\">https://pkg.go.dev/vuln/GO-2024-2919</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3700\">https://access.redhat.com/errata/RHSA-2024:3700</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4008\">https://access.redhat.com/errata/RHSA-2024:4008</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4486\">https://access.redhat.com/errata/RHSA-2024:4486</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8",
            "title": "[github.com/cri-o/cri-o] malicious container creates symlink \"mtab\" on the host External",
            "date_modified": "2024-09-06T21:39:26.000Z",
            "date_published": "2024-06-04T18:12:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A malicious container can affect the host by taking advantage of code cri-o added to show the container mounts on the host.</p>\n<p>A workload built from this Dockerfile:</p>\n<pre><code>FROM docker.io/library/busybox as source\nRUN mkdir /extra &amp;&amp; cd /extra &amp;&amp; ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n</code></pre>\n<p>and this container config:</p>\n<pre><code>{\n  \"metadata\": {\n      \"name\": \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"localhost/test\"\n  },\n  \"command\": [\n      \"/bin/true\"\n  ],\n  \"linux\": {\n  }\n}\n\n</code></pre>\n<p>and this sandbox config  </p>\n<pre><code>{\n  \"metadata\": {\n    \"name\": \"test-sandbox\",\n    \"namespace\": \"default\",\n    \"attempt\": 1,\n    \"uid\": \"edishd83djaideaduwk28bcsb\"\n  },\n  \"linux\": {\n    \"security_context\": {\n      \"namespace_options\": {\n        \"network\": 2\n      }\n    }\n  }\n}\n</code></pre>\n<p>will create a file on host <code>/host/mtab</code></p>\n<h3 id=\"patches\">Patches</h3>\n<p>1.30.1, 1.29.5, 1.28.7</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Unfortunately not</p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5154\">https://nvd.nist.gov/vuln/detail/CVE-2024-5154</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3676\">https://access.redhat.com/errata/RHSA-2024:3676</a></li>\n<li><a href=\"https://access.redhat.com/security/cve/CVE-2024-5154\">https://access.redhat.com/security/cve/CVE-2024-5154</a></li>\n<li><a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2280190\">https://bugzilla.redhat.com/show_bug.cgi?id=2280190</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2024-2919\">https://pkg.go.dev/vuln/GO-2024-2919</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3700\">https://access.redhat.com/errata/RHSA-2024:3700</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4008\">https://access.redhat.com/errata/RHSA-2024:4008</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4486\">https://access.redhat.com/errata/RHSA-2024:4486</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8",
            "title": "[github.com/cri-o/cri-o] malicious container creates symlink \"mtab\" on the host External",
            "date_modified": "2024-09-06T21:39:26.000Z",
            "date_published": "2024-06-04T18:12:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A malicious container can affect the host by taking advantage of code cri-o added to show the container mounts on the host.</p>\n<p>A workload built from this Dockerfile:</p>\n<pre><code>FROM docker.io/library/busybox as source\nRUN mkdir /extra &amp;&amp; cd /extra &amp;&amp; ln -s ../../../../../../../../root etc\n\nFROM scratch\n\nCOPY --from=source /bin /bin\nCOPY --from=source /lib /lib\nCOPY --from=source /extra .\n</code></pre>\n<p>and this container config:</p>\n<pre><code>{\n  \"metadata\": {\n      \"name\": \"busybox\"\n  },\n  \"image\":{\n      \"image\": \"localhost/test\"\n  },\n  \"command\": [\n      \"/bin/true\"\n  ],\n  \"linux\": {\n  }\n}\n\n</code></pre>\n<p>and this sandbox config  </p>\n<pre><code>{\n  \"metadata\": {\n    \"name\": \"test-sandbox\",\n    \"namespace\": \"default\",\n    \"attempt\": 1,\n    \"uid\": \"edishd83djaideaduwk28bcsb\"\n  },\n  \"linux\": {\n    \"security_context\": {\n      \"namespace_options\": {\n        \"network\": 2\n      }\n    }\n  }\n}\n</code></pre>\n<p>will create a file on host <code>/host/mtab</code></p>\n<h3 id=\"patches\">Patches</h3>\n<p>1.30.1, 1.29.5, 1.28.7</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Unfortunately not</p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/cri-o/cri-o/security/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5154\">https://nvd.nist.gov/vuln/detail/CVE-2024-5154</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3676\">https://access.redhat.com/errata/RHSA-2024:3676</a></li>\n<li><a href=\"https://access.redhat.com/security/cve/CVE-2024-5154\">https://access.redhat.com/security/cve/CVE-2024-5154</a></li>\n<li><a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2280190\">https://bugzilla.redhat.com/show_bug.cgi?id=2280190</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2024-2919\">https://pkg.go.dev/vuln/GO-2024-2919</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:3700\">https://access.redhat.com/errata/RHSA-2024:3700</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4008\">https://access.redhat.com/errata/RHSA-2024:4008</a></li>\n<li><a href=\"https://access.redhat.com/errata/RHSA-2024:4486\">https://access.redhat.com/errata/RHSA-2024:4486</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j9hf-98c3-wrm8\">https://github.com/advisories/GHSA-j9hf-98c3-wrm8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8",
            "title": "[github.com/cri-o/cri-o] malicious container creates symlink \"mtab\" on the host External",
            "date_modified": "2024-09-06T21:39:26.000Z",
            "date_published": "2024-06-04T18:12:31.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j9hf-98c3-wrm8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When importing an OCI image, there was no limit on the number of bytes read for certain files. A maliciously crafted image with a large file where a limit was not applied could cause a denial of service.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This bug has been fixed in containerd 1.6.18 and 1.5.18.  Users should update to these versions to resolve the issue.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Ensure that only trusted images are used and that only trusted users have permissions to import images. </p>\n<h3 id=\"credits\">Credits</h3>\n<p>The containerd project would like to thank <a href=\"https://github.com/DavidKorczynski\">David Korczynski</a> and <a href=\"https://github.com/AdamKorcz\">Adam Korczynski</a> of ADA Logics for responsibly disclosing this issue in accordance with the <a href=\"https://github.com/containerd/project/blob/main/SECURITY.md\">containerd security policy</a> during a security fuzzing audit sponsored by CNCF.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/containerd/containerd/issues/new/choose\">containerd</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a></li>\n</ul>\n<p>To report a security issue in containerd:</p>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/new\">Report a new vulnerability</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/GHSA-259w-8hf6-59c2\">https://github.com/containerd/containerd/security/advisories/GHSA-259w-8hf6-59c2</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-25153\">https://nvd.nist.gov/vuln/detail/CVE-2023-25153</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/0c314901076a74a7b797a545d2f462285fdbb8c4\">https://github.com/containerd/containerd/commit/0c314901076a74a7b797a545d2f462285fdbb8c4</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.5.18\">https://github.com/containerd/containerd/releases/tag/v1.5.18</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.6.18\">https://github.com/containerd/containerd/releases/tag/v1.6.18</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2023-1573\">https://pkg.go.dev/vuln/GO-2023-1573</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-259w-8hf6-59c2\">https://github.com/advisories/GHSA-259w-8hf6-59c2</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-259w-8hf6-59c2",
            "title": "[github.com/containerd/containerd] OCI image importer memory exhaustion in github.com/containerd/containerd",
            "date_modified": "2024-09-06T21:37:25.000Z",
            "date_published": "2023-02-16T14:12:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-259w-8hf6-59c2"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When importing an OCI image, there was no limit on the number of bytes read for certain files. A maliciously crafted image with a large file where a limit was not applied could cause a denial of service.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This bug has been fixed in containerd 1.6.18 and 1.5.18.  Users should update to these versions to resolve the issue.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Ensure that only trusted images are used and that only trusted users have permissions to import images. </p>\n<h3 id=\"credits\">Credits</h3>\n<p>The containerd project would like to thank <a href=\"https://github.com/DavidKorczynski\">David Korczynski</a> and <a href=\"https://github.com/AdamKorcz\">Adam Korczynski</a> of ADA Logics for responsibly disclosing this issue in accordance with the <a href=\"https://github.com/containerd/project/blob/main/SECURITY.md\">containerd security policy</a> during a security fuzzing audit sponsored by CNCF.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/containerd/containerd/issues/new/choose\">containerd</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a></li>\n</ul>\n<p>To report a security issue in containerd:</p>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/new\">Report a new vulnerability</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/GHSA-259w-8hf6-59c2\">https://github.com/containerd/containerd/security/advisories/GHSA-259w-8hf6-59c2</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-25153\">https://nvd.nist.gov/vuln/detail/CVE-2023-25153</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/0c314901076a74a7b797a545d2f462285fdbb8c4\">https://github.com/containerd/containerd/commit/0c314901076a74a7b797a545d2f462285fdbb8c4</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.5.18\">https://github.com/containerd/containerd/releases/tag/v1.5.18</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.6.18\">https://github.com/containerd/containerd/releases/tag/v1.6.18</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2023-1573\">https://pkg.go.dev/vuln/GO-2023-1573</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-259w-8hf6-59c2\">https://github.com/advisories/GHSA-259w-8hf6-59c2</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-259w-8hf6-59c2",
            "title": "[github.com/containerd/containerd] OCI image importer memory exhaustion in github.com/containerd/containerd",
            "date_modified": "2024-09-06T21:37:25.000Z",
            "date_published": "2023-02-16T14:12:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-259w-8hf6-59c2"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Users running the Synthetic Monitoring agent in their local network are impacted. The authentication token used to communicate with the Synthetic Monitoring API is exposed thru a debugging endpoint. This token can be used to retrieve the Synthetic Monitoring checks created by the user and assigned to the agent identified with that token. The Synthetic Monitoring API will reject connections from already-connected agents, so access to the token does not guarantee access to the checks.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed version is v0.12.0</p>\n<p>Users are advised to rotate the agent tokens.</p>\n<p>After upgrading to version v0.12.0 or later, it's recommended that user's of distribution packages (e.g. Debian or RedHat and their derivatives) review the configuration stored in <code>/etc/synthetic-monitoring/synthetic-monitoring-agent.conf</code>, specifically the <code>API_TOKEN</code> variable which has been renamed to <code>SM_AGENT_API_TOKEN</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>With all previous versions, it's recommended that users review the agent settings and set the HTTP listening address in a manner that limits the exposure, for example, localhost or a non-routed network, by using the command line parameter <code>-listen-address</code>, e.g. <code>-listen-address localhost:4050</code>.</p>\n<h3 id=\"references\">References</h3>\n<p>The following changes have been made to address this issue:</p>\n<ul>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/373\">Disable debug endpoint by default</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/374\">Allow retrieving the token from the environment</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/375\">Default to listening on localhost</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>You can use the <a href=\"https://github.com/grafana/synthetic-monitoring-agent/discussions\">Synthetic Monitoring Agent discussions</a>.</li>\n<li>Issues should be reported in the <a href=\"https://github.com/grafana/synthetic-monitoring-agent/issues\">Synthetic Monitoring Agent issues</a>.</li>\n<li>Email us at <a href=\"mailto:security@grafana.com\">security@grafana.com</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/security/advisories/GHSA-9j4f-f249-q5w8\">https://github.com/grafana/synthetic-monitoring-agent/security/advisories/GHSA-9j4f-f249-q5w8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-46156\">https://nvd.nist.gov/vuln/detail/CVE-2022-46156</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/373\">https://github.com/grafana/synthetic-monitoring-agent/pull/373</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/374\">https://github.com/grafana/synthetic-monitoring-agent/pull/374</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/375\">https://github.com/grafana/synthetic-monitoring-agent/pull/375</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/commit/d8dc7f9c1c641881cbcf0a09e178b90ebf0f0228\">https://github.com/grafana/synthetic-monitoring-agent/commit/d8dc7f9c1c641881cbcf0a09e178b90ebf0f0228</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/releases/tag/v0.12.0\">https://github.com/grafana/synthetic-monitoring-agent/releases/tag/v0.12.0</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-1132\">https://pkg.go.dev/vuln/GO-2022-1132</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9j4f-f249-q5w8\">https://github.com/advisories/GHSA-9j4f-f249-q5w8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9j4f-f249-q5w8",
            "title": "[github.com/grafana/synthetic-monitoring-agent] Default installation of `synthetic-monitoring-agent` exposes sensitive information",
            "date_modified": "2024-09-06T21:37:05.000Z",
            "date_published": "2024-09-06T21:37:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9j4f-f249-q5w8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Users running the Synthetic Monitoring agent in their local network are impacted. The authentication token used to communicate with the Synthetic Monitoring API is exposed thru a debugging endpoint. This token can be used to retrieve the Synthetic Monitoring checks created by the user and assigned to the agent identified with that token. The Synthetic Monitoring API will reject connections from already-connected agents, so access to the token does not guarantee access to the checks.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed version is v0.12.0</p>\n<p>Users are advised to rotate the agent tokens.</p>\n<p>After upgrading to version v0.12.0 or later, it's recommended that user's of distribution packages (e.g. Debian or RedHat and their derivatives) review the configuration stored in <code>/etc/synthetic-monitoring/synthetic-monitoring-agent.conf</code>, specifically the <code>API_TOKEN</code> variable which has been renamed to <code>SM_AGENT_API_TOKEN</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>With all previous versions, it's recommended that users review the agent settings and set the HTTP listening address in a manner that limits the exposure, for example, localhost or a non-routed network, by using the command line parameter <code>-listen-address</code>, e.g. <code>-listen-address localhost:4050</code>.</p>\n<h3 id=\"references\">References</h3>\n<p>The following changes have been made to address this issue:</p>\n<ul>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/373\">Disable debug endpoint by default</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/374\">Allow retrieving the token from the environment</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/375\">Default to listening on localhost</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>You can use the <a href=\"https://github.com/grafana/synthetic-monitoring-agent/discussions\">Synthetic Monitoring Agent discussions</a>.</li>\n<li>Issues should be reported in the <a href=\"https://github.com/grafana/synthetic-monitoring-agent/issues\">Synthetic Monitoring Agent issues</a>.</li>\n<li>Email us at <a href=\"mailto:security@grafana.com\">security@grafana.com</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/security/advisories/GHSA-9j4f-f249-q5w8\">https://github.com/grafana/synthetic-monitoring-agent/security/advisories/GHSA-9j4f-f249-q5w8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-46156\">https://nvd.nist.gov/vuln/detail/CVE-2022-46156</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/373\">https://github.com/grafana/synthetic-monitoring-agent/pull/373</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/374\">https://github.com/grafana/synthetic-monitoring-agent/pull/374</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/pull/375\">https://github.com/grafana/synthetic-monitoring-agent/pull/375</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/commit/d8dc7f9c1c641881cbcf0a09e178b90ebf0f0228\">https://github.com/grafana/synthetic-monitoring-agent/commit/d8dc7f9c1c641881cbcf0a09e178b90ebf0f0228</a></li>\n<li><a href=\"https://github.com/grafana/synthetic-monitoring-agent/releases/tag/v0.12.0\">https://github.com/grafana/synthetic-monitoring-agent/releases/tag/v0.12.0</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-1132\">https://pkg.go.dev/vuln/GO-2022-1132</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9j4f-f249-q5w8\">https://github.com/advisories/GHSA-9j4f-f249-q5w8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9j4f-f249-q5w8",
            "title": "[github.com/grafana/synthetic-monitoring-agent/cmd/synthetic-monitoring-agent] Default installation of `synthetic-monitoring-agent` exposes sensitive information",
            "date_modified": "2024-09-06T21:37:05.000Z",
            "date_published": "2024-09-06T21:37:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9j4f-f249-q5w8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Some current default configurations for Vela allow exploitation and container breakouts.</p>\n<h4 id=\"default-privileged-images\">Default Privileged Images</h4>\n<p>Running Vela plugins as privileged Docker containers allows a malicious user to easily break out of the container and gain access to the worker host operating system. On a fresh install of Vela without any additional configuration, the <code>target/vela-docker</code> plugin will run as a privileged container, even if the Vela administrators did not intend to allow for any privileged plugins, and even if the <code>vela.yml</code> configuration file does not use the <code>privileged = True</code> flag.</p>\n<p>Privileged containers permit trivial breakouts, which can pose significant risk to the environment in which Vela is running.</p>\n<h4 id=\"default-allowed-repositories\">Default Allowed Repositories</h4>\n<p>On a fresh install of Vela, anyone with a GitHub account (or other enabled source control management solution) is allowed to enable a repository within Vela and run builds. This means that, if a Vela instance is accessible to the public, a third party could add their own malicious repos to the Vela instance and run arbitrary code.</p>\n<p>An example of a publicly accessible Vela instance would be one not protected behind a VPN. Whether Vela is publicly accessible depends on how Vela is set up, NOT how it is connected to GitHub.</p>\n<h4 id=\"default-enabled-events-allows-pull-requests\">Default Enabled Events allows Pull Requests</h4>\n<p>By default, Vela currently enables pull request events when a repository is Vela-enabled. Unless this default was changed when enabling each repository, anyone who can issue a pull request against a repository can trigger a Vela job.</p>\n<p>This not only permits a third party to run arbitrary code in a Vela environment, but also poses an additional risk when secrets within Vela are configured to be available in pull requests, permitting anyone with access to create pull requests to access these secrets.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrade to 0.16.0 or later. After upgrading, Vela administrators will need to explicitly change the default settings to configure Vela as desired.</p>\n<p>Some of the fixes will interrupt existing workflows and will require Vela administrators to modify default settings (see release notes for more information). However, not applying the patch (or workarounds) will continue existing risk exposure.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<h4 id=\"default-privileged-images-1\">Default Privileged Images</h4>\n<p>Instead of upgrading, the Vela administrators can adjust the worker's <code>VELA_RUNTIME_PRIVILEGED_IMAGES</code> setting to be explicitly empty:</p>\n<p><code>VELA_RUNTIME_PRIVILEGED_IMAGES=\"\"</code></p>\n<p>By assigning <code>VELA_RUNTIME_PRIVILEGED_IMAGES</code> to an empty value it disallows any images from running as privileged containers in Vela.</p>\n<h4 id=\"default-allowed-repositories-1\">Default Allowed Repositories</h4>\n<p>Instead of upgrading, the Vela administrators can leverage the <code>VELA_REPO_ALLOWLIST</code> setting on the server component to restrict access to a list of repositories that are allowed to be enabled.</p>\n<p>By changing it from the default empty list (currently interpreted by Vela as \"all repositories\") to a list explicitly allowing specific repositories, Vela administrators can control what repositories are allowed to be enabled in Vela.</p>\n<p>Vela's current default list of approved repositories that can be added to a Vela instance is an empty list. However this is currently interpreted as allowing all repositories.</p>\n<p>In the updated version, a null value (the empty list) will be interpreted as permitting no repositories to be added to a Vela instance.</p>\n<h4 id=\"default-enabled-events-allows-pull-requests-1\">Default Enabled Events allows Pull Requests</h4>\n<p>Audit enabled repositories and disable <code>pull_requests</code> if they are not needed.</p>\n<p>Instead of upgrading, the pull request trigger can be disabled on a per-repository basis.</p>\n<p>Additional protection can be provided by preventing unauthorized users from submitting pull requests in GitHub (or other source control management solution).</p>\n<h3 id=\"residual-risk\">Residual Risk</h3>\n<h4 id=\"default-privileged-images-2\">Default Privileged Images</h4>\n<p>After applying the update, any repos that Vela administrators manually define as \"trusted repos\" will be able to run the manually-specified images that are allowed to run as privileged. Those repos will continue to be vulnerable to breakout, but applying the update will help protect against the risk of trivial breakout arising from an image running as a privileged container.</p>\n<p>The recommendation is to utilize plugins that do not require privileged capabilities.</p>\n<p>For example, utilize <code>target/vela-kaniko</code> instead of <code>target/vela-docker</code> as the Kaniko plugin does not require privileged access.</p>\n<h4 id=\"default-allowed-repositories-2\">Default Allowed Repositories</h4>\n<p>Applying this update (or workaround) will protect against the risk of Vela interpreting the default empty list of approved repositories as \"all repositories\" rather than \"no repositories\" (the current default).</p>\n<h4 id=\"default-enabled-events-allows-pull-requests-2\">Default Enabled Events allows Pull Requests</h4>\n<p>Since this change only impacts newly enabled repositories, the update will not address the risk to existing enabled repositories resulting from Vela enabling pull request events when a repository is Vela-enabled.</p>\n<p>Additionally, this change only impacts defaults; users can still configure their repositories to allow pull requests as triggering events.</p>\n<p>In order to monitor risk going forward, refer to the <code>Workaround</code> section with the heading <code>Default Enabled Events allows Pull Requests</code>.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Email us at <a href=\"mailto:vela@target.com\">vela@target.com</a></li>\n</ul>\n<p>Affected products: <code>go-vela/worker</code>, <code>go-vela/server</code>, <code>go-vela/ui</code>, <code>go-vela/documentation</code></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593\">https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593</a></li>\n<li><a href=\"https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w\">https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w</a></li>\n<li><a href=\"https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4\">https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4</a></li>\n<li><a href=\"https://docs.docker.com/engine/security/#docker-daemon-attack-surface\">https://docs.docker.com/engine/security/#docker-daemon-attack-surface</a></li>\n<li><a href=\"https://github.com/go-vela/server/releases/tag/v0.16.0\">https://github.com/go-vela/server/releases/tag/v0.16.0</a></li>\n<li><a href=\"https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v\">https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-39395\">https://nvd.nist.gov/vuln/detail/CVE-2022-39395</a></li>\n<li><a href=\"https://github.com/go-vela/ui/releases/tag/v0.17.0\">https://github.com/go-vela/ui/releases/tag/v0.17.0</a></li>\n<li><a href=\"https://github.com/go-vela/worker/releases/tag/v0.16.0\">https://github.com/go-vela/worker/releases/tag/v0.16.0</a></li>\n<li><a href=\"https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist\">https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist</a></li>\n<li><a href=\"https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images\">https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-1100\">https://pkg.go.dev/vuln/GO-2022-1100</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5m7g-pj8w-7593\">https://github.com/advisories/GHSA-5m7g-pj8w-7593</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5m7g-pj8w-7593",
            "title": "[github.com/go-vela/worker] Vela Insecure Defaults",
            "date_modified": "2024-09-06T21:33:44.000Z",
            "date_published": "2022-11-09T19:17:21.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5m7g-pj8w-7593"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Some current default configurations for Vela allow exploitation and container breakouts.</p>\n<h4 id=\"default-privileged-images\">Default Privileged Images</h4>\n<p>Running Vela plugins as privileged Docker containers allows a malicious user to easily break out of the container and gain access to the worker host operating system. On a fresh install of Vela without any additional configuration, the <code>target/vela-docker</code> plugin will run as a privileged container, even if the Vela administrators did not intend to allow for any privileged plugins, and even if the <code>vela.yml</code> configuration file does not use the <code>privileged = True</code> flag.</p>\n<p>Privileged containers permit trivial breakouts, which can pose significant risk to the environment in which Vela is running.</p>\n<h4 id=\"default-allowed-repositories\">Default Allowed Repositories</h4>\n<p>On a fresh install of Vela, anyone with a GitHub account (or other enabled source control management solution) is allowed to enable a repository within Vela and run builds. This means that, if a Vela instance is accessible to the public, a third party could add their own malicious repos to the Vela instance and run arbitrary code.</p>\n<p>An example of a publicly accessible Vela instance would be one not protected behind a VPN. Whether Vela is publicly accessible depends on how Vela is set up, NOT how it is connected to GitHub.</p>\n<h4 id=\"default-enabled-events-allows-pull-requests\">Default Enabled Events allows Pull Requests</h4>\n<p>By default, Vela currently enables pull request events when a repository is Vela-enabled. Unless this default was changed when enabling each repository, anyone who can issue a pull request against a repository can trigger a Vela job.</p>\n<p>This not only permits a third party to run arbitrary code in a Vela environment, but also poses an additional risk when secrets within Vela are configured to be available in pull requests, permitting anyone with access to create pull requests to access these secrets.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Upgrade to 0.16.0 or later. After upgrading, Vela administrators will need to explicitly change the default settings to configure Vela as desired.</p>\n<p>Some of the fixes will interrupt existing workflows and will require Vela administrators to modify default settings (see release notes for more information). However, not applying the patch (or workarounds) will continue existing risk exposure.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<h4 id=\"default-privileged-images-1\">Default Privileged Images</h4>\n<p>Instead of upgrading, the Vela administrators can adjust the worker's <code>VELA_RUNTIME_PRIVILEGED_IMAGES</code> setting to be explicitly empty:</p>\n<p><code>VELA_RUNTIME_PRIVILEGED_IMAGES=\"\"</code></p>\n<p>By assigning <code>VELA_RUNTIME_PRIVILEGED_IMAGES</code> to an empty value it disallows any images from running as privileged containers in Vela.</p>\n<h4 id=\"default-allowed-repositories-1\">Default Allowed Repositories</h4>\n<p>Instead of upgrading, the Vela administrators can leverage the <code>VELA_REPO_ALLOWLIST</code> setting on the server component to restrict access to a list of repositories that are allowed to be enabled.</p>\n<p>By changing it from the default empty list (currently interpreted by Vela as \"all repositories\") to a list explicitly allowing specific repositories, Vela administrators can control what repositories are allowed to be enabled in Vela.</p>\n<p>Vela's current default list of approved repositories that can be added to a Vela instance is an empty list. However this is currently interpreted as allowing all repositories.</p>\n<p>In the updated version, a null value (the empty list) will be interpreted as permitting no repositories to be added to a Vela instance.</p>\n<h4 id=\"default-enabled-events-allows-pull-requests-1\">Default Enabled Events allows Pull Requests</h4>\n<p>Audit enabled repositories and disable <code>pull_requests</code> if they are not needed.</p>\n<p>Instead of upgrading, the pull request trigger can be disabled on a per-repository basis.</p>\n<p>Additional protection can be provided by preventing unauthorized users from submitting pull requests in GitHub (or other source control management solution).</p>\n<h3 id=\"residual-risk\">Residual Risk</h3>\n<h4 id=\"default-privileged-images-2\">Default Privileged Images</h4>\n<p>After applying the update, any repos that Vela administrators manually define as \"trusted repos\" will be able to run the manually-specified images that are allowed to run as privileged. Those repos will continue to be vulnerable to breakout, but applying the update will help protect against the risk of trivial breakout arising from an image running as a privileged container.</p>\n<p>The recommendation is to utilize plugins that do not require privileged capabilities.</p>\n<p>For example, utilize <code>target/vela-kaniko</code> instead of <code>target/vela-docker</code> as the Kaniko plugin does not require privileged access.</p>\n<h4 id=\"default-allowed-repositories-2\">Default Allowed Repositories</h4>\n<p>Applying this update (or workaround) will protect against the risk of Vela interpreting the default empty list of approved repositories as \"all repositories\" rather than \"no repositories\" (the current default).</p>\n<h4 id=\"default-enabled-events-allows-pull-requests-2\">Default Enabled Events allows Pull Requests</h4>\n<p>Since this change only impacts newly enabled repositories, the update will not address the risk to existing enabled repositories resulting from Vela enabling pull request events when a repository is Vela-enabled.</p>\n<p>Additionally, this change only impacts defaults; users can still configure their repositories to allow pull requests as triggering events.</p>\n<p>In order to monitor risk going forward, refer to the <code>Workaround</code> section with the heading <code>Default Enabled Events allows Pull Requests</code>.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Email us at <a href=\"mailto:vela@target.com\">vela@target.com</a></li>\n</ul>\n<p>Affected products: <code>go-vela/worker</code>, <code>go-vela/server</code>, <code>go-vela/ui</code>, <code>go-vela/documentation</code></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593\">https://github.com/go-vela/server/security/advisories/GHSA-5m7g-pj8w-7593</a></li>\n<li><a href=\"https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w\">https://github.com/go-vela/worker/security/advisories/GHSA-2w78-ffv6-p46w</a></li>\n<li><a href=\"https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4\">https://github.com/go-vela/server/commit/05558ee99d70f7d6f83bed7c8f78ac0b35fa26f4</a></li>\n<li><a href=\"https://docs.docker.com/engine/security/#docker-daemon-attack-surface\">https://docs.docker.com/engine/security/#docker-daemon-attack-surface</a></li>\n<li><a href=\"https://github.com/go-vela/server/releases/tag/v0.16.0\">https://github.com/go-vela/server/releases/tag/v0.16.0</a></li>\n<li><a href=\"https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v\">https://github.com/go-vela/ui/security/advisories/GHSA-xf39-98m2-889v</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-39395\">https://nvd.nist.gov/vuln/detail/CVE-2022-39395</a></li>\n<li><a href=\"https://github.com/go-vela/ui/releases/tag/v0.17.0\">https://github.com/go-vela/ui/releases/tag/v0.17.0</a></li>\n<li><a href=\"https://github.com/go-vela/worker/releases/tag/v0.16.0\">https://github.com/go-vela/worker/releases/tag/v0.16.0</a></li>\n<li><a href=\"https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist\">https://go-vela.github.io/docs/installation/server/reference/#vela_repo_allowlist</a></li>\n<li><a href=\"https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images\">https://go-vela.github.io/docs/installation/worker/reference/#vela_runtime_privileged_images</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-1100\">https://pkg.go.dev/vuln/GO-2022-1100</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5m7g-pj8w-7593\">https://github.com/advisories/GHSA-5m7g-pj8w-7593</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5m7g-pj8w-7593",
            "title": "[github.com/go-vela/server] Vela Insecure Defaults",
            "date_modified": "2024-09-06T21:33:44.000Z",
            "date_published": "2022-11-09T19:17:21.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5m7g-pj8w-7593"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In distributed service mode, Pomerium's Authenticate service exposes pprof debug and prometheus metrics handlers to untrusted traffic.  This can leak potentially sensitive environmental information or lead to limited denial of service conditions.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>v0.17.1</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Block access to <code>/debug</code> and <code>/metrics</code> paths on the authenticate service.  This can be done with any L7 proxy, including Pomerium's own proxy service.</p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/pomerium/pomerium/pull/3212\">https://github.com/pomerium/pomerium/pull/3212</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/pomerium/pomerium\">Pomerium</a></li>\n<li>Email us at <a href=\"mailto:security@pomerium.com\">security@pomerium.com</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/pomerium/pomerium/security/advisories/GHSA-q98f-2x4p-prjr\">https://github.com/pomerium/pomerium/security/advisories/GHSA-q98f-2x4p-prjr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-24797\">https://nvd.nist.gov/vuln/detail/CVE-2022-24797</a></li>\n<li><a href=\"https://github.com/pomerium/pomerium/pull/3212\">https://github.com/pomerium/pomerium/pull/3212</a></li>\n<li><a href=\"https://github.com/pomerium/pomerium/commit/b435f73e2b54088da2aca5e8c3aa1808293d6903\">https://github.com/pomerium/pomerium/commit/b435f73e2b54088da2aca5e8c3aa1808293d6903</a></li>\n<li><a href=\"https://pkg.go.dev/vuln/GO-2022-0413\">https://pkg.go.dev/vuln/GO-2022-0413</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q98f-2x4p-prjr\">https://github.com/advisories/GHSA-q98f-2x4p-prjr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q98f-2x4p-prjr",
            "title": "[github.com/pomerium/pomerium] Exposure of debug and metrics endpoints in Pomerium",
            "date_modified": "2024-09-06T21:01:26.000Z",
            "date_published": "2024-09-06T21:01:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q98f-2x4p-prjr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"description\">Description</h3>\n<p>The summary is that the proof of knowledge associated to a commitment is crucial to bind the commitment to the actual circuit variables that were supposed to be committed. However, the same σ is used for all proofs of knowledge for the commitments, which allows mixing between them, making it possible to fix the value of all but one commitment before choosing the circuit variable assignments.</p>\n<p>In more detail:\nTo simplify notation, let us consider the case of two commitments, each to only a single variable. Let's say the basis elements for those commitments are <code>K_0</code> and <code>K_1</code>. Then the proving key will contain <code>K_0</code> and <code>K_1</code>, and also <code>σ*K_0</code> and <code>σ*K_1</code> for the proof of knowledge. The honest prover assigning a to the first circuit variable and b to the second will then produce commitments\n<code>D_0 = a*K_0</code>\n<code>D_1 = b*K_1</code>\nOut of the two D's, a challenge r for the commitment folding will be generated. The folded commitment will then be\n<code>D_folded = D_0 + r*D_1 = a*K_0 + r*b*K_1</code>\nThe honest prover will supply a fitting proof of knowledge\n<code>P = a*(σ*K_0) + r*b*(σ*K_1)</code></p>\n<p>Now the verifier will only use all of this in two ways:</p>\n<ol>\n<li>In the check of the Groth16 proof itself, where only the sum <code>D_0 + D_1</code> is used.</li>\n<li>In the proof of knowledge check, where it will be verified that P is indeed <code>σ*(D_0 + r*D_1)</code>, with r calculated from <code>D_0</code> and <code>D_1</code> as before.</li>\n</ol>\n<p>This has the following implications. In the following, a malicious prover's points will have an apostrophe appended, and we keep <code>D_0</code> etc. for the legitimate values:</p>\n<ol>\n<li>A malicious prover is only forced to provide <code>D'_0</code> and <code>D'_1</code> such that the sum is correct. So they can use arbitrary <code>D'_0</code> as long as they set <code>D'_1 = D_0 + D_1 - D'_0</code>.</li>\n<li>After choosing <code>D'_0</code> and <code>D'_1</code>, the prover can always calculate r. Evaluating <code>σ*(D'_0 + r*D'_1)</code> is then possible as long as both <code>D'_0</code> and <code>D'_1</code> are linear combinations of basis elements for which σ times that basis element is known. In particular, this works as long as <code>D'_0</code> and <code>D'_1</code> are linear combinations of <code>K_0</code> and <code>K_1</code>.</li>\n</ol>\n<p>The upshot is that a malicious prover can choose arbitrary a' and b', and then set\n<code>D'_0 = a'*K_0 + b'*K_1</code>\n<code>D'_1 = (a - a')*K_0 + (b - b')*K_1</code>\nThen they calculate r for this, and set\n<code>P = (a' + r*(a-a'))*(σ*K_0) + (b' + r*(b-b'))*(σ*K_1)</code>\nThis will then be accepted as a valid proof. Yet the first commitment point can be chosen completely independently of a and b, so in particular the malicious prover can use a constant for this, so that they will know the in-circuit challenge that will be added to the public inputs before they have to choose the witness assignments. For most use cases of such challenges (for proving things with Fiat-Shamir, random linear combinations etc.) this causes a critical soundness problem.</p>\n<p>The problem generalizes to more than two commitments and commitments to more than one circuit variable each; one can freely choose all but one commitment as arbitrary linear combinations of the basis elements for all commitments, and then must choose the one remaining commitment in such a way that the sum is correct.</p>\n<p>The root cause of the issue is that the σ used for the proofs of knowledge is the same, allowing to mix between the basis elements, as one has σ times them available for all of them.\nSo the fix is to have a separate σ for each commitment. So in our example above, the proving key would have the basis elements <code>K_0</code> and <code>K_1</code>, and for the proofs of knowledge now <code>σ_0*K_0</code> and <code>σ_1*K_1</code>. Folding the commitments would not be possible in the same way now, so the verifier will have to do more pairings. The prover could still provide a folded proof of knowledge however. With\n<code>D_0 = a*K_0</code>\n<code>D_1 = b*K_1</code>\nthe proof of knowledge would be\n<code>P = a*(σ_0*K_0) + r*b*(σ_1*K_1)</code>\nFor later, let us use notation for the unfolded proofs of knowledge\n<code>P_0 = a*(σ_0*K_0)</code>\n<code>P_1 = b*(σ_1*K_1)</code>\nso that\n<code>P = P_0 + r*P_1</code></p>\n<p>The verifying key would need <code>G</code> and <code>σ_0*G</code> and <code>σ_1*G</code>. To check the two unfolded proofs of knowledge would be the checks\n<code>e(P_0, G) = e(D_0, σ_0*G)</code>\n<code>e(P_1, G) = e(D_1, σ_1*G)</code>\nAs r is a challenge derived from D_0 and D_1, we may instead check\n<code>e(P_0, G) + r*e(P_1, G) = e(D_0, σ_0*G) + r*e(D_1, σ_1*G)</code>\nThe left hand side is\n<code>e(P_0, G) + r*e(P_1, G) = e(P_0 + r*P_1, G) = e(P, G)</code>\nSo the prover can just provide P and then the verifier checks\n<code>e(P, G) = e(D_0, σ_0*G) + r*e(D_1, σ_1*G)</code>\nUnfortunately, the right hand side can't be folded as before, as there isn't a side of the pairing that is kept constant between the pairings as before. So the verifier will need to have a pairing for each commitment on the right hand side.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>It is a soundness issue - in case of multiple commitments used inside the circuit the prover is able to choose all but the last commitment. As we use the commitments for optimized non-native multiplication, lookup checks etc. as random challenges, then it could impact the soundness of the whole circuit.</p>\n<p>However, using multiple commitments has been discouraged due to the additional cost to the verifier and it has not been supported in the recursive in-circuit Groth16 verifier and Solidity verifier. So we expect the impact of the issue be very small - only for the users who have implemented the native Groth16 verifier or are using it with multiple commitments. We do not have information of such users.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been patched in e7c66b000454f4d2a4ae48c005c34154d4cfc2a2</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The recommendation has been to use only a single commitment and then derive in-circuit commitments as needed using <a href=\"https://pkg.go.dev/github.com/consensys/gnark/std/multicommit\">std/multicommit</a> package.</p>\n<h3 id=\"references\">References</h3>\n<p>See the correspondence above.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Consensys/gnark/security/advisories/GHSA-q3hw-3gm4-w5cr\">https://github.com/Consensys/gnark/security/advisories/GHSA-q3hw-3gm4-w5cr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45039\">https://nvd.nist.gov/vuln/detail/CVE-2024-45039</a></li>\n<li><a href=\"https://github.com/Consensys/gnark/commit/e7c66b000454f4d2a4ae48c005c34154d4cfc2a2\">https://github.com/Consensys/gnark/commit/e7c66b000454f4d2a4ae48c005c34154d4cfc2a2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q3hw-3gm4-w5cr\">https://github.com/advisories/GHSA-q3hw-3gm4-w5cr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q3hw-3gm4-w5cr",
            "title": "[github.com/consensys/gnark] gnark's Groth16 commitment extension unsound for more than one commitment",
            "date_modified": "2024-09-06T19:53:21.000Z",
            "date_published": "2024-09-06T19:53:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q3hw-3gm4-w5cr"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}