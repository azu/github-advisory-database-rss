{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An attacker could send a JWE containing compressed data that used large amounts of memory and CPU when decompressed by Decrypt or DecryptMulti. Those functions now return an error if the decompressed data would exceed 250kB or 10x the compressed size (whichever is larger). Thanks to Enze Wang@Alioth and Jianjun Chen@Zhongguancun Lab (@zer0yu and @chenjj) for reporting.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem is fixed in v4.0.1, v3.0.3, v2.6.3</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298\">https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a\">https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502\">https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g",
            "title": "[gopkg.in/go-jose/go-jose.v2] Go JOSE vulnerable to Improper Handling of Highly Compressed Data (Data Amplification)",
            "date_modified": "2024-03-08T02:28:01.000Z",
            "date_published": "2024-03-07T22:54:44.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An attacker could send a JWE containing compressed data that used large amounts of memory and CPU when decompressed by Decrypt or DecryptMulti. Those functions now return an error if the decompressed data would exceed 250kB or 10x the compressed size (whichever is larger). Thanks to Enze Wang@Alioth and Jianjun Chen@Zhongguancun Lab (@zer0yu and @chenjj) for reporting.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem is fixed in v4.0.1, v3.0.3, v2.6.3</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298\">https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a\">https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502\">https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g",
            "title": "[github.com/go-jose/go-jose/v3] Go JOSE vulnerable to Improper Handling of Highly Compressed Data (Data Amplification)",
            "date_modified": "2024-03-08T02:28:01.000Z",
            "date_published": "2024-03-07T22:54:44.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An attacker could send a JWE containing compressed data that used large amounts of memory and CPU when decompressed by Decrypt or DecryptMulti. Those functions now return an error if the decompressed data would exceed 250kB or 10x the compressed size (whichever is larger). Thanks to Enze Wang@Alioth and Jianjun Chen@Zhongguancun Lab (@zer0yu and @chenjj) for reporting.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem is fixed in v4.0.1, v3.0.3, v2.6.3</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/go-jose/go-jose/security/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298\">https://github.com/go-jose/go-jose/commit/0dd4dd541c665fb292d664f77604ba694726f298</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a\">https://github.com/go-jose/go-jose/commit/add6a284ea0f844fd6628cba637be5451fe4b28a</a></li>\n<li><a href=\"https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502\">https://github.com/go-jose/go-jose/commit/f4c051a0653d78199a053892f7619ebf96339502</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c5q2-7r4c-mv6g\">https://github.com/advisories/GHSA-c5q2-7r4c-mv6g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g",
            "title": "[github.com/go-jose/go-jose/v4] Go JOSE vulnerable to Improper Handling of Highly Compressed Data (Data Amplification)",
            "date_modified": "2024-03-08T02:28:01.000Z",
            "date_published": "2024-03-07T22:54:44.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c5q2-7r4c-mv6g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p> A user with the permissions to create a data source can use Grafana API to create a data source with UID set to *.\nDoing this will grant the user access to read, query, edit and delete all data sources within the organization.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1442\">https://nvd.nist.gov/vuln/detail/CVE-2024-1442</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2024-1442\">https://grafana.com/security/security-advisories/cve-2024-1442</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5mxf-42f5-j782\">https://github.com/advisories/GHSA-5mxf-42f5-j782</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782",
            "title": "[github.com/grafana/grafana] Grafana's users with permissions to create a data source can CRUD all data sources",
            "date_modified": "2024-03-07T19:11:53.000Z",
            "date_published": "2024-03-07T18:30:28.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p> A user with the permissions to create a data source can use Grafana API to create a data source with UID set to *.\nDoing this will grant the user access to read, query, edit and delete all data sources within the organization.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1442\">https://nvd.nist.gov/vuln/detail/CVE-2024-1442</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2024-1442\">https://grafana.com/security/security-advisories/cve-2024-1442</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5mxf-42f5-j782\">https://github.com/advisories/GHSA-5mxf-42f5-j782</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782",
            "title": "[github.com/grafana/grafana] Grafana's users with permissions to create a data source can CRUD all data sources",
            "date_modified": "2024-03-07T19:11:53.000Z",
            "date_published": "2024-03-07T18:30:28.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p> A user with the permissions to create a data source can use Grafana API to create a data source with UID set to *.\nDoing this will grant the user access to read, query, edit and delete all data sources within the organization.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1442\">https://nvd.nist.gov/vuln/detail/CVE-2024-1442</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2024-1442\">https://grafana.com/security/security-advisories/cve-2024-1442</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5mxf-42f5-j782\">https://github.com/advisories/GHSA-5mxf-42f5-j782</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782",
            "title": "[github.com/grafana/grafana] Grafana's users with permissions to create a data source can CRUD all data sources",
            "date_modified": "2024-03-07T19:11:53.000Z",
            "date_published": "2024-03-07T18:30:28.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p> A user with the permissions to create a data source can use Grafana API to create a data source with UID set to *.\nDoing this will grant the user access to read, query, edit and delete all data sources within the organization.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1442\">https://nvd.nist.gov/vuln/detail/CVE-2024-1442</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2024-1442\">https://grafana.com/security/security-advisories/cve-2024-1442</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5mxf-42f5-j782\">https://github.com/advisories/GHSA-5mxf-42f5-j782</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782",
            "title": "[github.com/grafana/grafana] Grafana's users with permissions to create a data source can CRUD all data sources",
            "date_modified": "2024-03-07T19:11:53.000Z",
            "date_published": "2024-03-07T18:30:28.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p> A user with the permissions to create a data source can use Grafana API to create a data source with UID set to *.\nDoing this will grant the user access to read, query, edit and delete all data sources within the organization.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-1442\">https://nvd.nist.gov/vuln/detail/CVE-2024-1442</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2024-1442\">https://grafana.com/security/security-advisories/cve-2024-1442</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5mxf-42f5-j782\">https://github.com/advisories/GHSA-5mxf-42f5-j782</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782",
            "title": "[github.com/grafana/grafana] Grafana's users with permissions to create a data source can CRUD all data sources",
            "date_modified": "2024-03-07T19:11:53.000Z",
            "date_published": "2024-03-07T18:30:28.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5mxf-42f5-j782"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em>\nUsing cloudevents.WithRoundTripper to create a cloudevents.Client with an authenticated http.RoundTripper causes the go-sdk to leak credentials to arbitrary endpoints.</p>\n<p>The relevant code is <a href=\"https://github.com/cloudevents/sdk-go/blob/67e389964131d55d65cd14b4eb32d57a47312695/v2/protocol/http/protocol.go#L104-L110\">here</a> (also inline, emphasis added):</p>\n<pre>if p.Client == nil {\n  p.Client = **http.DefaultClient**\n}\n\nif p.roundTripper != nil {\n  p.Client.**Transport = p.roundTripper**\n}\n</pre>\n\n<p>When the transport is populated with an authenticated transport such as:</p>\n<ul>\n<li><a href=\"https://pkg.go.dev/golang.org/x/oauth2#Transport\">oauth2.Transport</a></li>\n<li><a href=\"https://pkg.go.dev/google.golang.org/api/idtoken#NewClient\">idtoken.NewClient(...).Transport</a></li>\n</ul>\n<p>... then http.DefaultClient is modified with the authenticated transport and will start to send Authorization tokens to\n<strong>any endpoint</strong> it is used to contact!</p>\n<p>Found and patched by: @tcnghia and @mattmoor</p>\n<h3 id=\"patches\">Patches</h3>\n<p>v.2.15.2</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cloudevents/sdk-go/security/advisories/GHSA-5pf6-2qwx-pxm2\">https://github.com/cloudevents/sdk-go/security/advisories/GHSA-5pf6-2qwx-pxm2</a></li>\n<li><a href=\"https://github.com/cloudevents/sdk-go/commit/de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851\">https://github.com/cloudevents/sdk-go/commit/de2f28370b0d2a0f64f92c0c6139fa4b8a7c3851</a></li>\n<li><a href=\"https://github.com/cloudevents/sdk-go/blob/67e389964131d55d65cd14b4eb32d57a47312695/v2/protocol/http/protocol.go#L104-L110\">https://github.com/cloudevents/sdk-go/blob/67e389964131d55d65cd14b4eb32d57a47312695/v2/protocol/http/protocol.go#L104-L110</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5pf6-2qwx-pxm2\">https://github.com/advisories/GHSA-5pf6-2qwx-pxm2</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5pf6-2qwx-pxm2",
            "title": "[github.com/cloudevents/sdk-go/v2] Go SDK for CloudEvents's use of WithRoundTripper to create a Client leaks credentials",
            "date_modified": "2024-03-06T20:11:59.000Z",
            "date_published": "2024-03-06T20:11:59.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5pf6-2qwx-pxm2"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault and Vault Enterprise (“Vault”) TLS certificate auth method did not correctly validate client certificates when configured with a non-CA certificate as trusted certificate. In this configuration, an attacker may be able to craft a malicious certificate that could be used to bypass authentication. Fixed in Vault 1.15.5 and 1.14.10.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-2048\">https://nvd.nist.gov/vuln/detail/CVE-2024-2048</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382\">https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r3w7-mfpm-c2vw\">https://github.com/advisories/GHSA-r3w7-mfpm-c2vw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r3w7-mfpm-c2vw",
            "title": "[github.com/hashicorp/vault] Incorrect TLS certificate auth method in Vault",
            "date_modified": "2024-03-06T16:59:19.000Z",
            "date_published": "2024-03-04T21:31:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r3w7-mfpm-c2vw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault and Vault Enterprise (“Vault”) TLS certificate auth method did not correctly validate client certificates when configured with a non-CA certificate as trusted certificate. In this configuration, an attacker may be able to craft a malicious certificate that could be used to bypass authentication. Fixed in Vault 1.15.5 and 1.14.10.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-2048\">https://nvd.nist.gov/vuln/detail/CVE-2024-2048</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382\">https://discuss.hashicorp.com/t/hcsec-2024-05-vault-cert-auth-method-did-not-correctly-validate-non-ca-certificates/63382</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-r3w7-mfpm-c2vw\">https://github.com/advisories/GHSA-r3w7-mfpm-c2vw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-r3w7-mfpm-c2vw",
            "title": "[github.com/hashicorp/vault] Incorrect TLS certificate auth method in Vault",
            "date_modified": "2024-03-06T16:59:19.000Z",
            "date_published": "2024-03-04T21:31:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-r3w7-mfpm-c2vw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The steps are as follows:</p>\n<ol>\n<li><p>Access <a href=\"https://IP:PORT/\">https://IP:PORT/</a> in the browser, which prompts the user to access with a secure entry point.\n<img alt=\"image\" src=\"https://github.com/1Panel-dev/1Panel/assets/46734380/8dc7d81c-6cc3-4b5d-a1d4-d3c5ed2de005\"></p>\n</li>\n<li><p>Use Burp to intercept:\n<img alt=\"image\" src=\"https://github.com/1Panel-dev/1Panel/assets/46734380/f8e93d08-1b66-4434-8923-2e8e3dedebe3\"></p>\n</li>\n</ol>\n<p>When opening the browser and entering the URL (allowing the first intercepted packet through Burp), the following is displayed:\n<img alt=\"image\" src=\"https://github.com/1Panel-dev/1Panel/assets/46734380/118c0102-7c89-404d-834a-88a644482afc\"></p>\n<p>It is found that in this situation, we can access the console page (although no data is returned and no modification operations can be performed).\"</p>\n<p>Affected versions: &lt;= 1.10.0-lts</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The vulnerability has been fixed in v1.10.1-lts.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It is recommended to upgrade the version to 1.10.1-lts.</p>\n<h3 id=\"references\">References</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<p>Open an issue in <a href=\"https://github.com/1Panel-dev/1Panel\">https://github.com/1Panel-dev/1Panel</a>\nEmail us at <a href=\"mailto:wanghe@fit2cloud.com\">wanghe@fit2cloud.com</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-26w3-q4j8-4xjp\">https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-26w3-q4j8-4xjp</a></li>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/releases/tag/v1.10.1-lts\">https://github.com/1Panel-dev/1Panel/releases/tag/v1.10.1-lts</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-27288\">https://nvd.nist.gov/vuln/detail/CVE-2024-27288</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-26w3-q4j8-4xjp\">https://github.com/advisories/GHSA-26w3-q4j8-4xjp</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-26w3-q4j8-4xjp",
            "title": "[github.com/1Panel-dev/1Panel] 1Panel open source panel project has an unauthorized vulnerability.",
            "date_modified": "2024-03-06T21:35:27.000Z",
            "date_published": "2024-03-06T15:29:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-26w3-q4j8-4xjp"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Here it is observed that the CasaOS doesn't defend against password brute force attacks, which leads to having full access to the server.</p>\n<h3 id=\"details\">Details</h3>\n<p>The web application lacks control over the login attempts i.e. why attacker can use a password brute force attack to find and get full access over the.</p>\n<h3 id=\"poc\">PoC</h3>\n<ol>\n<li>Capture login request in proxy tool like Burp Suite and select password field.</li>\n</ol>\n<p><img alt=\"1\" src=\"https://user-images.githubusercontent.com/63414468/297156515-0272bfd7-f386-4c22-b3bd-c4dbdc1298bf.PNG\"></p>\n<ol start=\"2\">\n<li>Here I have started attack with total number of 271 password tries where the last one is the correct password and as we can see in the following image we get a <strong>400 Bad Request</strong> status code with the message \"<strong>Invalid Password</strong>\" and response length <strong>769</strong> on 1st request which was sent at <strong><em>Tue, 16 Jan 2024 18:31:32 GMT</em></strong></li>\n</ol>\n<p><img alt=\"2\" src=\"https://user-images.githubusercontent.com/63414468/297157815-c158995b-7d46-4a5a-aef9-bcbbcf596b15.png\"></p>\n<p><strong>Note</strong>:  <em>We have tested this vulnerability with more than 3400 tries. We have used 271 request counts just for demo purposes.</em></p>\n<ol start=\"3\">\n<li>Here the attack is completed and we can see in the following image we get <strong>200 OK</strong> status code with the message \"<strong>Ok</strong>\" and response length <strong>1509</strong> on 271st request which was sent at <strong><em>Tue, 16 Jan 2024 18:32:01 GMT</em></strong>.</li>\n</ol>\n<p><img alt=\"3\" src=\"https://user-images.githubusercontent.com/63414468/297159282-3f4788b5-6217-4f32-8be6-40ac117710e3.png\"></p>\n<p>This means attacker can try 271 requests in 56 seconds.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability allows attackers to get super user-level access over the server.</p>\n<h3 id=\"mitigation\">Mitigation</h3>\n<p>It is recommended to implement a proper rate-limiting mechanism on the server side where the configuration might be like:\nIf a specific IP address fails to login more than 5 times concurrently then that IP address must be blocked for at least 30 seconds. This will reduce the possibility of password brute-forcing attacks.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-c69x-5xmw-v44x\">https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-c69x-5xmw-v44x</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/commit/62006f61b55951048dbace4ebd9e483274838699\">https://github.com/IceWhaleTech/CasaOS-UserService/commit/62006f61b55951048dbace4ebd9e483274838699</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7\">https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-24767\">https://nvd.nist.gov/vuln/detail/CVE-2024-24767</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c69x-5xmw-v44x\">https://github.com/advisories/GHSA-c69x-5xmw-v44x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c69x-5xmw-v44x",
            "title": "[github.com/IceWhaleTech/CasaOS-UserService] CasaOS Improper Restriction of Excessive Authentication Attempts vulnerability",
            "date_modified": "2024-03-06T20:05:39.000Z",
            "date_published": "2024-03-06T15:25:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c69x-5xmw-v44x"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>The Casa OS Login page has disclosed the username enumeration vulnerability in the login page.</p>\n<h3 id=\"details\">Details</h3>\n<p>It is observed that the attacker can enumerate the CasaOS username using the application response. If the username is incorrect application gives the error \"<strong>User does not exist</strong>\",  If the password is incorrect application gives the error \"<strong>Invalid password</strong>\". </p>\n<h3 id=\"poc\">PoC</h3>\n<p>Capture the login request in a tool like Burp Suit and use the intruder tab for trying multiple usernames. \nKeep checking the response of each request if the response says <strong>Invalid password</strong> then the username is right.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Using this error attacker can enumerate the username of CasaOS. </p>\n<h3 id=\"the-logic-behind-the-issue\">The logic behind the issue</h3>\n<p>If the username is incorrect, then throw an error \"User does not exist\" else throw an error \"Invalid password\".</p>\n<p>This condition can be vice versa like:</p>\n<p>If the password is incorrect, then throw an error \"Invalid password\" else throw an error \"User does not exist\".</p>\n<h3 id=\"mitigation\">Mitigation</h3>\n<p>Since this is the condition we have to implement a single error which can be \"Username/Password is Incorrect!!!\"</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-c967-2652-gfjm\">https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-c967-2652-gfjm</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/commit/c75063d7ca5800948e9c09c0a6efe9809b5d39f7\">https://github.com/IceWhaleTech/CasaOS-UserService/commit/c75063d7ca5800948e9c09c0a6efe9809b5d39f7</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7\">https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-24766\">https://nvd.nist.gov/vuln/detail/CVE-2024-24766</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c967-2652-gfjm\">https://github.com/advisories/GHSA-c967-2652-gfjm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c967-2652-gfjm",
            "title": "[github.com/IceWhaleTech/CasaOS-UserService] CasaOS Username Enumeration",
            "date_modified": "2024-03-06T21:35:10.000Z",
            "date_published": "2024-03-06T15:23:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c967-2652-gfjm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p><a href=\"http://demo.casaos.io/v1/users/image?path=/var/lib/casaos/1/avatar.png\">http://demo.casaos.io/v1/users/image?path=/var/lib/casaos/1/avatar.png</a></p>\n<p>Originally it was to get the url of the user's avatar, but the path filtering was not strict, making it possible to get any file on the system.</p>\n<h3 id=\"details\">Details</h3>\n<p>Construct paths to get any file.</p>\n<p>Such as the CasaOS user database, and furthermore can obtain system root privileges.</p>\n<h3 id=\"poc\">PoC</h3>\n<p><a href=\"http://demo.casaos.io/v1/users/image?path=/var/lib/casaos/conf/../db/user.db\">http://demo.casaos.io/v1/users/image?path=/var/lib/casaos/conf/../db/user.db</a></p>\n<h3 id=\"impact\">Impact</h3>\n<p>v0.4.6 all previous versions</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-h5gf-cmm8-cg7c\">https://github.com/IceWhaleTech/CasaOS-UserService/security/advisories/GHSA-h5gf-cmm8-cg7c</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/commit/3f4558e23c0a9958f9a0e20aabc64aa8fd51840e\">https://github.com/IceWhaleTech/CasaOS-UserService/commit/3f4558e23c0a9958f9a0e20aabc64aa8fd51840e</a></li>\n<li><a href=\"https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7\">https://github.com/IceWhaleTech/CasaOS-UserService/releases/tag/v0.4.7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-24765\">https://nvd.nist.gov/vuln/detail/CVE-2024-24765</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-h5gf-cmm8-cg7c\">https://github.com/advisories/GHSA-h5gf-cmm8-cg7c</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-h5gf-cmm8-cg7c",
            "title": "[github.com/IceWhaleTech/CasaOS-UserService] CasaOS-UserService allows unauthorized access to any file",
            "date_modified": "2024-03-06T20:05:26.000Z",
            "date_published": "2024-03-06T15:22:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-h5gf-cmm8-cg7c"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A Minder user can use the endpoints listed in the issue title to access any repository in the DB, irrespective of who owns the repo and any permissions that user may have.</p>\n<h3 id=\"details\">Details</h3>\n<p><a href=\"https://github.com/stacklok/minder/blob/e88e4b286e4bc04c03b0332a77961f085e1aa77f/database/query/repositories.sql#L22-L23\">https://github.com/stacklok/minder/blob/e88e4b286e4bc04c03b0332a77961f085e1aa77f/database/query/repositories.sql#L22-L23</a>\n<a href=\"https://github.com/stacklok/minder/blob/a115c8524fbd582b2b277eaadce024bebbded508/internal/controlplane/handlers_repositories.go#L277-L278\">https://github.com/stacklok/minder/blob/a115c8524fbd582b2b277eaadce024bebbded508/internal/controlplane/handlers_repositories.go#L277-L278</a></p>\n<p>The DB query used here checks by repo owner, repo name and provider name (which is always \"github\"). These query values are not distinct for the particular user - as long as the user has valid credentials and a provider, they can set the repo owner/name to any value they want and the server will return information on this repo.</p>\n<p><code>DeleteRepositoryByName</code> uses the same query and I have been able to delete another user's repo using this technique.</p>\n<p>The <code>GetArtifactByName</code> endpoint also uses this DB query. I have not reproduced the behaviour with this endpoint due to a lack of a suitable test case, but I do not see anything in the implementation of the endpoint to prevent it being exploited.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Setup:</p>\n<ol>\n<li>Fresh provider/project on the production minder instance which is owned by me.</li>\n<li>A repo registered by another user (in this case, Ozz)</li>\n</ol>\n<pre><code># show my identity\n$ minder auth whoami\nNo config file present, using default values.\n\n Here are your details:\n\n+----------------------------------------------------+----------------------------------------------------+\n|                        KEY                         |                       VALUE                        |\n+----------------------------------------------------+----------------------------------------------------+\n| Subject                                            | c93cc12e-999d-49f4-9ee3-593fdfb39204               |\n+----------------------------------------------------+----------------------------------------------------+\n| Created At                                         | 2024-02-26 15:53:29.228 +0000                      |\n|                                                    | UTC                                                |\n+----------------------------------------------------+----------------------------------------------------+\n| Updated At                                         | 2024-02-26 15:53:29.228 +0000                      |\n|                                                    | UTC                                                |\n+----------------------------------------------------+----------------------------------------------------+\n| Minder Server                                      | api.stacklok.com:443                               |\n+----------------------------------------------------+----------------------------------------------------+\n| Project                                            | dmjb /                                             |\n|                                                    | ca059552-7b8a-4c6e-918d-ca7e6cbd0bab               |\n+----------------------------------------------------+----------------------------------------------------+\n\n# show that I have no repos registered\n$ minder repo list\nNo config file present, using default values.\n+----+---------+----------+-------------+-------+------+\n| ID | PROJECT | PROVIDER | UPSTREAM ID | OWNER | NAME |\n+----+---------+----------+-------------+-------+------+\n\n# show details on one of Ozz's repos\n$ minder repo get -n JAORMX/auditevent\nNo config file present, using default values.\n{\n  \"id\":  \"a7e82080-9b6c-41f3-bc08-8e9442f8b2d2\",\n  \"context\":  {\n    \"provider\":  \"github\",\n    \"project\":  \"b513f7f0-26dc-42e6-81a0-577df5489e62\"\n  },\n  \"owner\":  \"JAORMX\",\n  \"name\":  \"auditevent\",\n  \"repoId\":  \"605597568\",\n  \"hookUrl\":  \"https://api.github.com/repos/JAORMX/auditevent/hooks/464564107\",\n  \"deployUrl\":  \"https://api.github.com/repos/JAORMX/auditevent/deployments\",\n  \"cloneUrl\":  \"https://github.com/JAORMX/auditevent.git\",\n  \"isFork\":  true,\n  \"createdAt\":  \"2024-03-04T13:27:54.019356Z\",\n  \"updatedAt\":  \"2024-03-04T13:27:54.019356Z\",\n  \"defaultBranch\":  \"main\"\n}\n\n# delete Ozz's repo\n$ minder repo delete -n JAORMX/auditevent\nNo config file present, using default values.\nSuccessfully deleted repo with name: JAORMX/auditevent\n\n# Ozz's repo no longer exists\n$ minder repo get -n JAORMX/auditevent\nNo config file present, using default values.\nMessage: Error getting repo by name\nDetails: NotFound means some requested entity (e.g., file or directory) was\nnot found.\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>Any user and project in a multi-tenant Minder instance.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/stacklok/minder/security/advisories/GHSA-v627-69v2-xx37\">https://github.com/stacklok/minder/security/advisories/GHSA-v627-69v2-xx37</a></li>\n<li><a href=\"https://github.com/stacklok/minder/commit/45750b4e9fb2de33365758366e06c19e999bd2eb\">https://github.com/stacklok/minder/commit/45750b4e9fb2de33365758366e06c19e999bd2eb</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-v627-69v2-xx37\">https://github.com/advisories/GHSA-v627-69v2-xx37</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-v627-69v2-xx37",
            "title": "[github.com/stacklok/minder] `GetRepositoryByName`, `DeleteRepositoryByName` and `GetArtifactByName` allow access of arbitrary repositories in Minder by any authenticated user",
            "date_modified": "2024-03-05T16:20:11.000Z",
            "date_published": "2024-03-05T16:20:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-v627-69v2-xx37"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>If a user has restricted access to a project that is configured with <code>restricted=true</code>, they can gain root access on the system by creating a disk device with <code>shift=true</code> and creating a setuid root executable. This is possible because the <code>shift</code> property is not restricted unless <code>restricted.devices.disk.paths</code> is set.</p>\n<h3 id=\"details\">Details</h3>\n<p>The following patch shows the offending code with a possible fix:</p>\n<pre><code class=\"language-patch\">--- a/lxd/device/disk.go\n+++ b/lxd/device/disk.go\n@@ -429,17 +429,19 @@ func (d *disk) validateEnvironmentSourcePath() error {\n        if instProject.Name != api.ProjectDefaultName {\n                // If restricted disk paths are in force, then check the disk's source is allowed, and record the\n                // allowed parent path for later user during device start up sequence.\n-               if shared.IsTrue(instProject.Config[\"restricted\"]) &amp;&amp; instProject.Config[\"restricted.devices.disk.paths\"] != \"\" {\n-                       allowed, restrictedParentSourcePath := project.CheckRestrictedDevicesDiskPaths(instProject.Config, d.config[\"source\"])\n-                       if !allowed {\n-                               return fmt.Errorf(\"Disk source path %q not allowed by project for disk %q\", d.config[\"source\"], d.name)\n+               if shared.IsTrue(instProject.Config[\"restricted\"]) {\n+                       if instProject.Config[\"restricted.devices.disk.paths\"] != \"\" {\n+                               allowed, restrictedParentSourcePath := project.CheckRestrictedDevicesDiskPaths(instProject.Config, d.config[\"source\"])\n+                               if !allowed {\n+                                       return fmt.Errorf(\"Disk source path %q not allowed by project for disk %q\", d.config[\"source\"], d.name)\n+                               }\n+\n+                               d.restrictedParentSourcePath = shared.HostPath(restrictedParentSourcePath)\n                        }\n\n                        if shared.IsTrue(d.config[\"shift\"]) {\n                                return fmt.Errorf(`The \"shift\" property cannot be used with a restricted source path`)\n                        }\n-\n-                       d.restrictedParentSourcePath = shared.HostPath(restrictedParentSourcePath)\n                }\n        }\n</code></pre>\n<h3 id=\"poc\">PoC</h3>\n<pre><code class=\"language-bash\">$ lxc project create restricted -c restricted=true -c restricted.devices.disk=allow\n$ lxc project switch restricted\n$ lxc profile device add default root disk path=/ pool=default\n$ lxc init ubuntu:22.04 c1\n$ lxc config device add c1 d1 disk source=/ path=/mnt shift=true\n$ lxc start c1  # no error\n\n$ lxc project set restricted restricted.devices.disk.paths=/  # explicitly allow mounting /\n$ lxc restart c1\nError: Failed to start device \"d1\": The \"shift\" property cannot be used with a restricted source path\n</code></pre>\n<p>Created <a href=\"https://github.com/canonical/lxd/issues/12606\">https://github.com/canonical/lxd/issues/12606</a> to improve the documentation as per <a href=\"https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97#advisory-comment-91918\">https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97#advisory-comment-91918</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97\">https://github.com/canonical/lxd/security/advisories/GHSA-x9qq-236j-gj97</a></li>\n<li><a href=\"https://github.com/canonical/lxd/issues/12606\">https://github.com/canonical/lxd/issues/12606</a></li>\n<li><a href=\"https://github.com/canonical/lxd/commit/ce1bd0dd37bb3810fe6f16c237a4b65257f231f1\">https://github.com/canonical/lxd/commit/ce1bd0dd37bb3810fe6f16c237a4b65257f231f1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-x9qq-236j-gj97\">https://github.com/advisories/GHSA-x9qq-236j-gj97</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-x9qq-236j-gj97",
            "title": "[github.com/canonical/lxd] Canonical LXD documentation improvement to make clear restricted.devices.disk=allow without restricted.devices.disk.paths also allows shift=true",
            "date_modified": "2024-03-05T15:26:24.000Z",
            "date_published": "2023-12-05T23:32:58.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-x9qq-236j-gj97"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue was discovered in Cloud Native Computing Foundation (CNCF) Helm. It displays values of secrets when the --dry-run flag is used. This is a security concern in some use cases, such as a --dry-run call by a CI/CD tool. NOTE: the vendor's position is that this behavior was introduced intentionally, and cannot be removed without breaking backwards compatibility (some users may be relying on these values).</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2019-25210\">https://nvd.nist.gov/vuln/detail/CVE-2019-25210</a></li>\n<li><a href=\"https://github.com/helm/helm/issues/7275\">https://github.com/helm/helm/issues/7275</a></li>\n<li><a href=\"https://www.cncf.io/projects/helm\">https://www.cncf.io/projects/helm</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jw44-4f3j-q396\">https://github.com/advisories/GHSA-jw44-4f3j-q396</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jw44-4f3j-q396",
            "title": "[helm.sh/helm/v3] Helm shows secrets in clear text",
            "date_modified": "2024-03-05T14:39:01.000Z",
            "date_published": "2024-03-03T21:31:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jw44-4f3j-q396"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>\n<h3 id=\"details\">Details</h3>\n<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>\n<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>\n<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>\n<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>\n<p>GitHub authentication and external authentication are not impacted.</p>\n<h3 id=\"was-my-deployment-impacted\">Was my deployment impacted?</h3>\n<p>To check if your deployment was exploited:</p>\n<ul>\n<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>\n<li>Check the users list for unexpected users<ul>\n<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"patched-versions\">Patched Versions</h3>\n<p>This vulnerability is remedied in</p>\n<ul>\n<li>v2.8.4</li>\n<li>v2.7.3</li>\n<li>v2.6.1</li>\n</ul>\n<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>\n<h3 id=\"thanks\">Thanks</h3>\n<ul>\n<li><a href=\"https://github.com/arcz\">https://github.com/arcz</a></li>\n<li><a href=\"https://www.trailofbits.com\">https://www.trailofbits.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>\n<a href=\"https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c\">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>\n<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-27918\">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0\">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31\">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb\">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c\">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7cc2-r658-7xpf",
            "title": "[github.com/coder/coder] Coder's OIDC authentication allows email with partially matching domain to register",
            "date_modified": "2024-03-04T21:28:54.000Z",
            "date_published": "2024-03-04T20:45:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7cc2-r658-7xpf"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A vulnerability in Coder's OIDC authentication could allow an attacker to bypass the <code>CODER_OIDC_EMAIL_DOMAIN</code> verification and create an account with an email not in the allowlist. Deployments are only affected if the OIDC provider allows users to create accounts on the provider (such as public providers like <code>google.com</code>).</p>\n<h3 id=\"details\">Details</h3>\n<p>During OIDC registration, the user's email was improperly validated against the allowed <code>CODER_OIDC_EMAIL_DOMAIN</code>s. This could allow a user with a domain that only partially matched an allowed domain to successfully login or register (e.g. <code>user@exploitcorp.com</code> would match the allowed domain <code>corp.com</code>).</p>\n<p>An attacker could register a domain name that exploited this vulnerability and register on a Coder instance with a public OIDC provider.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Coder instances with OIDC enabled and protected by the <code>CODER_OIDC_EMAIL_DOMAIN</code> configuration.</p>\n<p>Coder instances using a private OIDC provider are not affected, as arbitrary users cannot register through a private OIDC provider without first having an account on the provider.</p>\n<p>Public OIDC providers (such as <code>google.com</code> without permitted domains set on the OAuth2 App) are impacted.</p>\n<p>GitHub authentication and external authentication are not impacted.</p>\n<h3 id=\"was-my-deployment-impacted\">Was my deployment impacted?</h3>\n<p>To check if your deployment was exploited:</p>\n<ul>\n<li>View the audit log on your deployment for unexpected registered users (using the <code>action:register</code> filter)</li>\n<li>Check the users list for unexpected users<ul>\n<li>Users created via this exploit will have a domain that ends with one of the allowed domains but doesn’t fully match (e.g. <code>@exploitcorp.com</code> instead of <code>@corp.com</code>)</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"patched-versions\">Patched Versions</h3>\n<p>This vulnerability is remedied in</p>\n<ul>\n<li>v2.8.4</li>\n<li>v2.7.3</li>\n<li>v2.6.1</li>\n</ul>\n<p>All versions prior to these patches are affected by the vulnerability. <strong>It is recommended that customers upgrade their deployments as soon as possible if they are utilizing OIDC authentication with the <code>CODER_OIDC_EMAIL_DOMAIN</code> setting.</strong></p>\n<h3 id=\"thanks\">Thanks</h3>\n<ul>\n<li><a href=\"https://github.com/arcz\">https://github.com/arcz</a></li>\n<li><a href=\"https://www.trailofbits.com\">https://www.trailofbits.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a>\n<a href=\"https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c\">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a>\n<a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-27918\">https://nvd.nist.gov/vuln/detail/CVE-2024-27918</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/coder/coder/security/advisories/GHSA-7cc2-r658-7xpf</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0\">https://github.com/coder/coder/commit/1171ce7add017481d28441575024209ac160ecb0</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31\">https://github.com/coder/coder/commit/2ba84911f8b02605e5958d5e4a2fe3979ec50b31</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb\">https://github.com/coder/coder/commit/2d37eb42e7db656e343fe1f36de5ab1a1a62f4fb</a></li>\n<li><a href=\"https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c\">https://github.com/coder/coder/commit/4439a920e454a82565e445e4376c669e3b89591c</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7cc2-r658-7xpf\">https://github.com/advisories/GHSA-7cc2-r658-7xpf</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7cc2-r658-7xpf",
            "title": "[github.com/coder/coder/v2] Coder's OIDC authentication allows email with partially matching domain to register",
            "date_modified": "2024-03-04T21:28:54.000Z",
            "date_published": "2024-03-04T20:45:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7cc2-r658-7xpf"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}