{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h2 id=\"impact\">Impact</h2>\n<p>A bug was found in Moby (Docker Engine) where the data directory (typically <code>/var/lib/docker</code>) contained subdirectories with insufficiently restricted permissions, allowing otherwise unprivileged Linux users to traverse directory contents and execute programs.  When containers included executable programs with extended permission bits (such as <code>setuid</code>), unprivileged Linux users could discover and execute those programs.  When the UID of an unprivileged Linux user on the host collided with the file owner or group inside a container, the unprivileged Linux user on the host could discover, read, and modify those files.</p>\n<h2 id=\"patches\">Patches</h2>\n<p>This bug has been fixed in Moby (Docker Engine) 20.10.9.  Users should update to this version as soon as possible.  Running containers should be stopped and restarted for the permissions to be fixed.</p>\n<h2 id=\"workarounds\">Workarounds</h2>\n<p>Limit access to the host to trusted users.  Limit access to host volumes to trusted containers.</p>\n<h2 id=\"credits\">Credits</h2>\n<p>The Moby project would like to thank Joan Bruguera for responsibly disclosing this issue in accordance with the <a href=\"https://github.com/moby/moby/blob/master/SECURITY.md\">Moby security policy</a>.</p>\n<h2 id=\"for-more-information\">For more information</h2>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li><a href=\"https://github.com/moby/moby/issues/new\">Open an issue</a></li>\n<li>Email us at <a href=\"mailto:security@docker.com\">security@docker.com</a> if you think you’ve found a security bug</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558\">https://github.com/moby/moby/security/advisories/GHSA-3fwx-pjgw-3558</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41091\">https://nvd.nist.gov/vuln/detail/CVE-2021-41091</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/f0ab919f518c47240ea0e72d0999576bb8008e64\">https://github.com/moby/moby/commit/f0ab919f518c47240ea0e72d0999576bb8008e64</a></li>\n<li><a href=\"https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf\">https://cert-portal.siemens.com/productcert/pdf/ssa-222547.pdf</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/B5Q6G6I4W5COQE25QMC7FJY3I3PAYFBB/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/B5Q6G6I4W5COQE25QMC7FJY3I3PAYFBB/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNFADTCHHYWVM6W4NJ6CB4FNFM2VMBIB/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZNFADTCHHYWVM6W4NJ6CB4FNFM2VMBIB/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-3fwx-pjgw-3558\">https://github.com/advisories/GHSA-3fwx-pjgw-3558</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-3fwx-pjgw-3558",
            "title": "[github.com/moby/moby] Moby (Docker Engine) Insufficiently restricted permissions on data directory",
            "date_modified": "2024-01-31T23:29:01.000Z",
            "date_published": "2024-01-31T23:28:58.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-3fwx-pjgw-3558"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Grafana before 5.2.0-beta1 has XSS vulnerabilities in dashboard links.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-12099\">https://nvd.nist.gov/vuln/detail/CVE-2018-12099</a></li>\n<li><a href=\"https://github.com/grafana/grafana/pull/11813\">https://github.com/grafana/grafana/pull/11813</a></li>\n<li><a href=\"https://github.com/grafana/grafana/releases/tag/v5.2.0-beta1\">https://github.com/grafana/grafana/releases/tag/v5.2.0-beta1</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20190416-0004/\">https://security.netapp.com/advisory/ntap-20190416-0004/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-v5gq-qvjq-8p53\">https://github.com/advisories/GHSA-v5gq-qvjq-8p53</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-v5gq-qvjq-8p53",
            "title": "[github.com/grafana/grafana] Grafana Cross-site Scripting (XSS)",
            "date_modified": "2024-01-31T23:28:40.000Z",
            "date_published": "2024-01-31T23:28:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-v5gq-qvjq-8p53"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue was discovered in Docker Moby before 17.06.0. The Docker engine validated a client TLS certificate using both the configured client CA root certificate and all system roots on non-Windows systems. This allowed a client with any domain validated certificate signed by a system-trusted root CA (as opposed to one signed by the configured CA root certificate) to authenticate.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2018-12608\">https://nvd.nist.gov/vuln/detail/CVE-2018-12608</a></li>\n<li><a href=\"https://github.com/moby/moby/issues/33173\">https://github.com/moby/moby/issues/33173</a></li>\n<li><a href=\"https://github.com/moby/moby/pull/33182\">https://github.com/moby/moby/pull/33182</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/190c6e8cf8b893874a33d83f78307f1bed0bfbcd\">https://github.com/moby/moby/commit/190c6e8cf8b893874a33d83f78307f1bed0bfbcd</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qrqr-3x5j-2xw9\">https://github.com/advisories/GHSA-qrqr-3x5j-2xw9</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qrqr-3x5j-2xw9",
            "title": "[github.com/moby/moby] Docker Moby Authentication Bypass",
            "date_modified": "2024-01-31T23:28:25.000Z",
            "date_published": "2024-01-31T23:28:22.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qrqr-3x5j-2xw9"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"impact\">Impact</h2>\n<p>Containers launched through containerd's CRI implementation (through Kubernetes, crictl, or any other pod/container client that uses the containerd CRI service) that share the same image may receive incorrect environment variables, including values that are defined for other containers.  If the affected containers have different security contexts, this may allow sensitive information to be unintentionally shared.</p>\n<p>If you are not using containerd’s CRI implementation (through one of the mechanisms described above), you are not vulnerable to this issue.</p>\n<p>If you are not launching multiple containers or Kubernetes pods from the same image which have different environment variables, you are not vulnerable to this issue.</p>\n<p>If you are not launching multiple containers or Kubernetes pods from the same image in rapid succession, you have reduced likelihood of being vulnerable to this issue</p>\n<h2 id=\"patches\">Patches</h2>\n<p>This vulnerability has been fixed in containerd 1.3.10 and containerd 1.4.4.  Users should update to these versions as soon as they are released.</p>\n<h2 id=\"workarounds\">Workarounds</h2>\n<p>There are no known workarounds.</p>\n<h2 id=\"for-more-information\">For more information</h2>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/issues/new/choose\">Open an issue</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a> if you think you’ve found a security bug.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/GHSA-6g2q-w5j3-fwh4\">https://github.com/containerd/containerd/security/advisories/GHSA-6g2q-w5j3-fwh4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21334\">https://nvd.nist.gov/vuln/detail/CVE-2021-21334</a></li>\n<li><a href=\"https://github.com/containerd/cri/pull/1628\">https://github.com/containerd/cri/pull/1628</a></li>\n<li><a href=\"https://github.com/containerd/cri/pull/1629\">https://github.com/containerd/cri/pull/1629</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/05f951a3781f4f2c1911b05e61c160e9c30eaa8e\">https://github.com/containerd/containerd/commit/05f951a3781f4f2c1911b05e61c160e9c30eaa8e</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/2d9c8aa4b3f4313982c5c999af57212a1c5d144b\">https://github.com/containerd/containerd/commit/2d9c8aa4b3f4313982c5c999af57212a1c5d144b</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/cbcb2f57fbe221986f96b552855eb802f63193de\">https://github.com/containerd/containerd/commit/cbcb2f57fbe221986f96b552855eb802f63193de</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.3.10\">https://github.com/containerd/containerd/releases/tag/v1.3.10</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.4.4\">https://github.com/containerd/containerd/releases/tag/v1.4.4</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KUE2Z2ZUWBHRU36ZGBD2YSJCYB6ELPXE/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KUE2Z2ZUWBHRU36ZGBD2YSJCYB6ELPXE/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QIBPKSX5IOWPM3ZPFB3JVLXWDHSZTTWT/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QIBPKSX5IOWPM3ZPFB3JVLXWDHSZTTWT/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VTXHA5JOWQRCCUZH7ZQBEYN6KZKJEYSD/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VTXHA5JOWQRCCUZH7ZQBEYN6KZKJEYSD/</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202105-33\">https://security.gentoo.org/glsa/202105-33</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6g2q-w5j3-fwh4\">https://github.com/advisories/GHSA-6g2q-w5j3-fwh4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6g2q-w5j3-fwh4",
            "title": "[github.com/containerd/containerd] containerd environment variable leak",
            "date_modified": "2024-01-31T23:22:47.000Z",
            "date_published": "2024-01-31T23:22:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6g2q-w5j3-fwh4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"impact\">Impact</h2>\n<p>Containers launched through containerd's CRI implementation (through Kubernetes, crictl, or any other pod/container client that uses the containerd CRI service) that share the same image may receive incorrect environment variables, including values that are defined for other containers.  If the affected containers have different security contexts, this may allow sensitive information to be unintentionally shared.</p>\n<p>If you are not using containerd’s CRI implementation (through one of the mechanisms described above), you are not vulnerable to this issue.</p>\n<p>If you are not launching multiple containers or Kubernetes pods from the same image which have different environment variables, you are not vulnerable to this issue.</p>\n<p>If you are not launching multiple containers or Kubernetes pods from the same image in rapid succession, you have reduced likelihood of being vulnerable to this issue</p>\n<h2 id=\"patches\">Patches</h2>\n<p>This vulnerability has been fixed in containerd 1.3.10 and containerd 1.4.4.  Users should update to these versions as soon as they are released.</p>\n<h2 id=\"workarounds\">Workarounds</h2>\n<p>There are no known workarounds.</p>\n<h2 id=\"for-more-information\">For more information</h2>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/issues/new/choose\">Open an issue</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a> if you think you’ve found a security bug.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/GHSA-6g2q-w5j3-fwh4\">https://github.com/containerd/containerd/security/advisories/GHSA-6g2q-w5j3-fwh4</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21334\">https://nvd.nist.gov/vuln/detail/CVE-2021-21334</a></li>\n<li><a href=\"https://github.com/containerd/cri/pull/1628\">https://github.com/containerd/cri/pull/1628</a></li>\n<li><a href=\"https://github.com/containerd/cri/pull/1629\">https://github.com/containerd/cri/pull/1629</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/05f951a3781f4f2c1911b05e61c160e9c30eaa8e\">https://github.com/containerd/containerd/commit/05f951a3781f4f2c1911b05e61c160e9c30eaa8e</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/2d9c8aa4b3f4313982c5c999af57212a1c5d144b\">https://github.com/containerd/containerd/commit/2d9c8aa4b3f4313982c5c999af57212a1c5d144b</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/cbcb2f57fbe221986f96b552855eb802f63193de\">https://github.com/containerd/containerd/commit/cbcb2f57fbe221986f96b552855eb802f63193de</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.3.10\">https://github.com/containerd/containerd/releases/tag/v1.3.10</a></li>\n<li><a href=\"https://github.com/containerd/containerd/releases/tag/v1.4.4\">https://github.com/containerd/containerd/releases/tag/v1.4.4</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KUE2Z2ZUWBHRU36ZGBD2YSJCYB6ELPXE/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/KUE2Z2ZUWBHRU36ZGBD2YSJCYB6ELPXE/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QIBPKSX5IOWPM3ZPFB3JVLXWDHSZTTWT/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/QIBPKSX5IOWPM3ZPFB3JVLXWDHSZTTWT/</a></li>\n<li><a href=\"https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VTXHA5JOWQRCCUZH7ZQBEYN6KZKJEYSD/\">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VTXHA5JOWQRCCUZH7ZQBEYN6KZKJEYSD/</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202105-33\">https://security.gentoo.org/glsa/202105-33</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6g2q-w5j3-fwh4\">https://github.com/advisories/GHSA-6g2q-w5j3-fwh4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6g2q-w5j3-fwh4",
            "title": "[github.com/containerd/containerd] containerd environment variable leak",
            "date_modified": "2024-01-31T23:22:47.000Z",
            "date_published": "2024-01-31T23:22:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6g2q-w5j3-fwh4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Vault Enterprise 1.6.0 &amp; 1.6.1 allowed the <code>remove-peer</code> raft operator command to be executed against DR secondaries without authentication. Fixed in 1.6.2.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-3282\">https://nvd.nist.gov/vuln/detail/CVE-2021-3282</a></li>\n<li><a href=\"https://github.com/hashicorp/vault/commit/09f9068e22f762da123160233518b440e00bdb3b\">https://github.com/hashicorp/vault/commit/09f9068e22f762da123160233518b440e00bdb3b</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2021-04-vault-enterprise-s-dr-secondaries-allowed-raft-peer-removal-without-authentication/20337\">https://discuss.hashicorp.com/t/hcsec-2021-04-vault-enterprise-s-dr-secondaries-allowed-raft-peer-removal-without-authentication/20337</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202207-01\">https://security.gentoo.org/glsa/202207-01</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rq95-xf66-j689\">https://github.com/advisories/GHSA-rq95-xf66-j689</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rq95-xf66-j689",
            "title": "[github.com/hashicorp/vault] Improper Authentication in HashiCorp Vault",
            "date_modified": "2024-01-31T23:22:08.000Z",
            "date_published": "2024-01-31T23:22:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rq95-xf66-j689"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Pulling an intentionally malformed Docker image manifest crashes the <code>dockerd</code> daemon.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Versions 20.10.3 and 19.03.15 contain patches that prevent the daemon from crashing.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Maintainers would like to thank Josh Larsen, Ian Coldwater, Duffie Cooley, Rory McCune for working on the vulnerability and Brad Geesaman for responsibly disclosing it to <a href=\"mailto:security@docker.com\">security@docker.com</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/moby/security/advisories/GHSA-6fj5-m822-rqx8\">https://github.com/moby/moby/security/advisories/GHSA-6fj5-m822-rqx8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21285\">https://nvd.nist.gov/vuln/detail/CVE-2021-21285</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/8d3179546e79065adefa67cc697c09d0ab137d30\">https://github.com/moby/moby/commit/8d3179546e79065adefa67cc697c09d0ab137d30</a></li>\n<li><a href=\"https://docs.docker.com/engine/release-notes/#20103\">https://docs.docker.com/engine/release-notes/#20103</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v19.03.15\">https://github.com/moby/moby/releases/tag/v19.03.15</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v20.10.3\">https://github.com/moby/moby/releases/tag/v20.10.3</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202107-23\">https://security.gentoo.org/glsa/202107-23</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20210226-0005/\">https://security.netapp.com/advisory/ntap-20210226-0005/</a></li>\n<li><a href=\"https://www.debian.org/security/2021/dsa-4865\">https://www.debian.org/security/2021/dsa-4865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6fj5-m822-rqx8\">https://github.com/advisories/GHSA-6fj5-m822-rqx8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6fj5-m822-rqx8",
            "title": "[github.com/moby/moby] moby docker daemon crash during image pull of malicious image",
            "date_modified": "2024-01-31T23:16:48.000Z",
            "date_published": "2024-01-31T23:16:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6fj5-m822-rqx8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Pulling an intentionally malformed Docker image manifest crashes the <code>dockerd</code> daemon.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Versions 20.10.3 and 19.03.15 contain patches that prevent the daemon from crashing.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Maintainers would like to thank Josh Larsen, Ian Coldwater, Duffie Cooley, Rory McCune for working on the vulnerability and Brad Geesaman for responsibly disclosing it to <a href=\"mailto:security@docker.com\">security@docker.com</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/moby/security/advisories/GHSA-6fj5-m822-rqx8\">https://github.com/moby/moby/security/advisories/GHSA-6fj5-m822-rqx8</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21285\">https://nvd.nist.gov/vuln/detail/CVE-2021-21285</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/8d3179546e79065adefa67cc697c09d0ab137d30\">https://github.com/moby/moby/commit/8d3179546e79065adefa67cc697c09d0ab137d30</a></li>\n<li><a href=\"https://docs.docker.com/engine/release-notes/#20103\">https://docs.docker.com/engine/release-notes/#20103</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v19.03.15\">https://github.com/moby/moby/releases/tag/v19.03.15</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v20.10.3\">https://github.com/moby/moby/releases/tag/v20.10.3</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202107-23\">https://security.gentoo.org/glsa/202107-23</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20210226-0005/\">https://security.netapp.com/advisory/ntap-20210226-0005/</a></li>\n<li><a href=\"https://www.debian.org/security/2021/dsa-4865\">https://www.debian.org/security/2021/dsa-4865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6fj5-m822-rqx8\">https://github.com/advisories/GHSA-6fj5-m822-rqx8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6fj5-m822-rqx8",
            "title": "[github.com/moby/moby] moby docker daemon crash during image pull of malicious image",
            "date_modified": "2024-01-31T23:16:48.000Z",
            "date_published": "2024-01-31T23:16:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6fj5-m822-rqx8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When using <code>--userns-remap</code>, if the root user in the remapped namespace has access to the host filesystem they can modify files under <code>/var/lib/docker/&lt;remapping&gt;</code> that cause writing files with extended privileges.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Versions 20.10.3 and 19.03.15 contain patches that prevent privilege escalation from remapped user.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Maintainers would like to thank Alex Chapman for discovering the vulnerability; @awprice, @nathanburrell, @raulgomis, @chris-walz, @erin-jensby, @bassmatt, @mark-adams, @dbaxa for working on it and Zac Ellis for responsibly disclosing it to <a href=\"mailto:security@docker.com\">security@docker.com</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/moby/security/advisories/GHSA-7452-xqpj-6rpc\">https://github.com/moby/moby/security/advisories/GHSA-7452-xqpj-6rpc</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21284\">https://nvd.nist.gov/vuln/detail/CVE-2021-21284</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c\">https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c</a></li>\n<li><a href=\"https://docs.docker.com/engine/release-notes/#20103\">https://docs.docker.com/engine/release-notes/#20103</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v19.03.15\">https://github.com/moby/moby/releases/tag/v19.03.15</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v20.10.3\">https://github.com/moby/moby/releases/tag/v20.10.3</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202107-23\">https://security.gentoo.org/glsa/202107-23</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20210226-0005/\">https://security.netapp.com/advisory/ntap-20210226-0005/</a></li>\n<li><a href=\"https://www.debian.org/security/2021/dsa-4865\">https://www.debian.org/security/2021/dsa-4865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7452-xqpj-6rpc\">https://github.com/advisories/GHSA-7452-xqpj-6rpc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7452-xqpj-6rpc",
            "title": "[github.com/moby/moby] moby Access to remapped root allows privilege escalation to real root",
            "date_modified": "2024-01-31T23:14:27.000Z",
            "date_published": "2024-01-31T23:14:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7452-xqpj-6rpc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When using <code>--userns-remap</code>, if the root user in the remapped namespace has access to the host filesystem they can modify files under <code>/var/lib/docker/&lt;remapping&gt;</code> that cause writing files with extended privileges.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Versions 20.10.3 and 19.03.15 contain patches that prevent privilege escalation from remapped user.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Maintainers would like to thank Alex Chapman for discovering the vulnerability; @awprice, @nathanburrell, @raulgomis, @chris-walz, @erin-jensby, @bassmatt, @mark-adams, @dbaxa for working on it and Zac Ellis for responsibly disclosing it to <a href=\"mailto:security@docker.com\">security@docker.com</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/moby/security/advisories/GHSA-7452-xqpj-6rpc\">https://github.com/moby/moby/security/advisories/GHSA-7452-xqpj-6rpc</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-21284\">https://nvd.nist.gov/vuln/detail/CVE-2021-21284</a></li>\n<li><a href=\"https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c\">https://github.com/moby/moby/commit/64bd4485b3a66a597c02c95f5776395e540b2c7c</a></li>\n<li><a href=\"https://docs.docker.com/engine/release-notes/#20103\">https://docs.docker.com/engine/release-notes/#20103</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v19.03.15\">https://github.com/moby/moby/releases/tag/v19.03.15</a></li>\n<li><a href=\"https://github.com/moby/moby/releases/tag/v20.10.3\">https://github.com/moby/moby/releases/tag/v20.10.3</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202107-23\">https://security.gentoo.org/glsa/202107-23</a></li>\n<li><a href=\"https://security.netapp.com/advisory/ntap-20210226-0005/\">https://security.netapp.com/advisory/ntap-20210226-0005/</a></li>\n<li><a href=\"https://www.debian.org/security/2021/dsa-4865\">https://www.debian.org/security/2021/dsa-4865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7452-xqpj-6rpc\">https://github.com/advisories/GHSA-7452-xqpj-6rpc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7452-xqpj-6rpc",
            "title": "[github.com/moby/moby] moby Access to remapped root allows privilege escalation to real root",
            "date_modified": "2024-01-31T23:14:27.000Z",
            "date_published": "2024-01-31T23:14:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7452-xqpj-6rpc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>util/binfmt_misc/check.go in Builder in Docker Engine before 19.03.9 calls os.OpenFile with a potentially unsafe qemu-check temporary pathname, constructed with an empty first argument in an ioutil.TempDir call.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-27534\">https://nvd.nist.gov/vuln/detail/CVE-2020-27534</a></li>\n<li><a href=\"https://github.com/moby/buildkit/pull/1462\">https://github.com/moby/buildkit/pull/1462</a></li>\n<li><a href=\"https://github.com/moby/moby/pull/40877\">https://github.com/moby/moby/pull/40877</a></li>\n<li><a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=1921154\">https://bugzilla.redhat.com/show_bug.cgi?id=1921154</a></li>\n<li><a href=\"http://web.archive.org/web/20200530054359/https://docs.docker.com/engine/release-notes/\">http://web.archive.org/web/20200530054359/https://docs.docker.com/engine/release-notes/</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6hwg-w5jg-9c6x\">https://github.com/advisories/GHSA-6hwg-w5jg-9c6x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6hwg-w5jg-9c6x",
            "title": "[github.com/moby/moby] Path Traversal in Moby builder",
            "date_modified": "2024-01-31T23:13:12.000Z",
            "date_published": "2024-01-31T23:13:10.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6hwg-w5jg-9c6x"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Vault and Vault Enterprise allowed the enumeration of users via the LDAP auth method. Fixed in 1.5.6 and 1.6.1.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-35177\">https://nvd.nist.gov/vuln/detail/CVE-2020-35177</a></li>\n<li><a href=\"https://github.com/hashicorp/vault/pull/10537\">https://github.com/hashicorp/vault/pull/10537</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2020-25-vault-s-ldap-auth-method-allows-user-enumeration/18984\">https://discuss.hashicorp.com/t/hcsec-2020-25-vault-s-ldap-auth-method-allows-user-enumeration/18984</a></li>\n<li><a href=\"https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#161\">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#161</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rpgp-9hmg-j25x\">https://github.com/advisories/GHSA-rpgp-9hmg-j25x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rpgp-9hmg-j25x",
            "title": "[github.com/hashicorp/vault] Enumeration of users in HashiCorp Vault",
            "date_modified": "2024-01-31T23:11:41.000Z",
            "date_published": "2024-01-31T23:11:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rpgp-9hmg-j25x"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Vault and Vault Enterprise allowed the enumeration of users via the LDAP auth method. Fixed in 1.5.6 and 1.6.1.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-35177\">https://nvd.nist.gov/vuln/detail/CVE-2020-35177</a></li>\n<li><a href=\"https://github.com/hashicorp/vault/pull/10537\">https://github.com/hashicorp/vault/pull/10537</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2020-25-vault-s-ldap-auth-method-allows-user-enumeration/18984\">https://discuss.hashicorp.com/t/hcsec-2020-25-vault-s-ldap-auth-method-allows-user-enumeration/18984</a></li>\n<li><a href=\"https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#161\">https://github.com/hashicorp/vault/blob/master/CHANGELOG.md#161</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rpgp-9hmg-j25x\">https://github.com/advisories/GHSA-rpgp-9hmg-j25x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rpgp-9hmg-j25x",
            "title": "[github.com/hashicorp/vault] Enumeration of users in HashiCorp Vault",
            "date_modified": "2024-01-31T23:11:41.000Z",
            "date_published": "2024-01-31T23:11:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rpgp-9hmg-j25x"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Consul and Consul Enterprise 1.2.0 up to 1.8.5 allowed operators with operator:read ACL permissions to read the Connect CA private key configuration. Fixed in 1.6.10, 1.7.10, and 1.8.6.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-28053\">https://nvd.nist.gov/vuln/detail/CVE-2020-28053</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/pull/9240\">https://github.com/hashicorp/consul/pull/9240</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3\">https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020\">https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202208-09\">https://security.gentoo.org/glsa/202208-09</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/category/consul\">https://www.hashicorp.com/blog/category/consul</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6m72-467w-94rh\">https://github.com/advisories/GHSA-6m72-467w-94rh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6m72-467w-94rh",
            "title": "[github.com/hashicorp/consul] Privilege Escalation in HashiCorp Consul",
            "date_modified": "2024-01-31T23:11:34.000Z",
            "date_published": "2024-01-31T23:11:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6m72-467w-94rh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Consul and Consul Enterprise 1.2.0 up to 1.8.5 allowed operators with operator:read ACL permissions to read the Connect CA private key configuration. Fixed in 1.6.10, 1.7.10, and 1.8.6.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-28053\">https://nvd.nist.gov/vuln/detail/CVE-2020-28053</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/pull/9240\">https://github.com/hashicorp/consul/pull/9240</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3\">https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020\">https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202208-09\">https://security.gentoo.org/glsa/202208-09</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/category/consul\">https://www.hashicorp.com/blog/category/consul</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6m72-467w-94rh\">https://github.com/advisories/GHSA-6m72-467w-94rh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6m72-467w-94rh",
            "title": "[github.com/hashicorp/consul] Privilege Escalation in HashiCorp Consul",
            "date_modified": "2024-01-31T23:11:34.000Z",
            "date_published": "2024-01-31T23:11:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6m72-467w-94rh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Consul and Consul Enterprise 1.2.0 up to 1.8.5 allowed operators with operator:read ACL permissions to read the Connect CA private key configuration. Fixed in 1.6.10, 1.7.10, and 1.8.6.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-28053\">https://nvd.nist.gov/vuln/detail/CVE-2020-28053</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/pull/9240\">https://github.com/hashicorp/consul/pull/9240</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3\">https://github.com/hashicorp/consul/commit/ff5215d882ac51b49c2647aac46b42aa9c890ce3</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020\">https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#186-november-19-2020</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202208-09\">https://security.gentoo.org/glsa/202208-09</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/category/consul\">https://www.hashicorp.com/blog/category/consul</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6m72-467w-94rh\">https://github.com/advisories/GHSA-6m72-467w-94rh</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6m72-467w-94rh",
            "title": "[github.com/hashicorp/consul] Privilege Escalation in HashiCorp Consul",
            "date_modified": "2024-01-31T23:11:34.000Z",
            "date_published": "2024-01-31T23:11:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6m72-467w-94rh"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Consul Enterprise versions 1.7.0 up to 1.7.8 and 1.8.0 up to 1.8.4 includes a namespace replication bug which can be triggered to cause denial of service via infinite Raft writes. Fixed in 1.7.9 and 1.8.5.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-25201\">https://nvd.nist.gov/vuln/detail/CVE-2020-25201</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/pull/9024\">https://github.com/hashicorp/consul/pull/9024</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#185-october-23-2020\">https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#185-october-23-2020</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/releases/tag/v1.8.5\">https://github.com/hashicorp/consul/releases/tag/v1.8.5</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202208-09\">https://security.gentoo.org/glsa/202208-09</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/category/consul\">https://www.hashicorp.com/blog/category/consul</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-496g-fr33-whrf\">https://github.com/advisories/GHSA-496g-fr33-whrf</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-496g-fr33-whrf",
            "title": "[github.com/hashicorp/consul] Denial of service in HashiCorp Consul",
            "date_modified": "2024-01-31T23:11:25.000Z",
            "date_published": "2024-01-31T23:11:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-496g-fr33-whrf"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>HashiCorp Consul Enterprise versions 1.7.0 up to 1.7.8 and 1.8.0 up to 1.8.4 includes a namespace replication bug which can be triggered to cause denial of service via infinite Raft writes. Fixed in 1.7.9 and 1.8.5.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-25201\">https://nvd.nist.gov/vuln/detail/CVE-2020-25201</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/pull/9024\">https://github.com/hashicorp/consul/pull/9024</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#185-october-23-2020\">https://github.com/hashicorp/consul/blob/master/CHANGELOG.md#185-october-23-2020</a></li>\n<li><a href=\"https://github.com/hashicorp/consul/releases/tag/v1.8.5\">https://github.com/hashicorp/consul/releases/tag/v1.8.5</a></li>\n<li><a href=\"https://security.gentoo.org/glsa/202208-09\">https://security.gentoo.org/glsa/202208-09</a></li>\n<li><a href=\"https://www.hashicorp.com/blog/category/consul\">https://www.hashicorp.com/blog/category/consul</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-496g-fr33-whrf\">https://github.com/advisories/GHSA-496g-fr33-whrf</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-496g-fr33-whrf",
            "title": "[github.com/hashicorp/consul] Denial of service in HashiCorp Consul",
            "date_modified": "2024-01-31T23:11:25.000Z",
            "date_published": "2024-01-31T23:11:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-496g-fr33-whrf"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In runc 1.1.11 and earlier, due to an internal file descriptor leak, an attacker could cause a newly-spawned container process (from <code>runc exec</code>) to have a working directory in the host filesystem namespace, allowing for a container escape by giving access to the host filesystem (\"attack 2\"). The same attack could be used by a malicious image to allow a container process to gain access to the host filesystem through <code>runc run</code> (\"attack 1\"). Variants of attacks 1 and 2 could be also be used to overwrite semi-arbitrary host binaries, allowing for complete container escapes (\"attack 3a\" and \"attack 3b\").</p>\n<p>Strictly speaking, while attack 3a is the most severe from a CVSS perspective, attacks 2 and 3b are arguably more dangerous in practice because they allow for a breakout from inside a container as opposed to requiring a user execute a malicious image. The reason attacks 1 and 3a are scored higher is because being able to socially engineer users is treated as a given for UI:R vectors, despite attacks 2 and 3b requiring far more minimal user interaction (just reasonable <code>runc exec</code> operations on a container the attacker has access to). In any case, all four attacks can lead to full control of the host system.</p>\n<h4 id=\"attack-1-processcwd-mis-configuration\">Attack 1: <code>process.cwd</code> \"mis-configuration\"</h4>\n<p>In runc 1.1.11 and earlier, several file descriptors were inadvertently leaked internally within runc into <code>runc init</code>, including a handle to the host's <code>/sys/fs/cgroup</code> (this leak was added in v1.0.0-rc93). If the container was configured to have <code>process.cwd</code> set to <code>/proc/self/fd/7/</code> (the actual fd can change depending on file opening order in <code>runc</code>), the resulting pid1 process will have a working directory in the host mount namespace and thus the spawned process can access the entire host filesystem. This alone is not an exploit against runc, however a malicious image could make any innocuous-looking non-<code>/</code> path a symlink to <code>/proc/self/fd/7/</code> and thus trick a user into starting a container whose binary has access to the host filesystem.</p>\n<p>Furthermore, prior to runc 1.1.12, runc also did not verify that the final working directory was inside the container's mount namespace after calling <code>chdir(2)</code> (as we have already joined the container namespace, it was incorrectly assumed there would be no way to chdir outside the container after <code>pivot_root(2)</code>).</p>\n<p>The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:N (8.2, high severity).</p>\n<p>Note that this attack requires a privileged user to be tricked into running a malicious container image. It should be noted that when using higher-level runtimes (such as Docker or Kubernetes), this exploit can be considered critical as it can be done remotely by anyone with the rights to start a container image (and can be exploited from within Dockerfiles using <code>ONBUILD</code> in the case of Docker).</p>\n<h4 id=\"attack-2-runc-exec-container-breakout\">Attack 2: <code>runc exec</code> container breakout</h4>\n<p>(This is a modification of attack 1, constructed to allow for a process inside a container to break out.)</p>\n<p>The same fd leak and lack of verification of the working directory in attack 1 also apply to <code>runc exec</code>. If a malicious process inside the container knows that some administrative process will call <code>runc exec</code> with the <code>--cwd</code> argument and a given path, in most cases they can replace that path with a symlink to <code>/proc/self/fd/7/</code>. Once the container process has executed the container binary, <code>PR_SET_DUMPABLE</code> protections no longer apply and the attacker can open <code>/proc/$exec_pid/cwd</code> to get access to the host filesystem.</p>\n<p><code>runc exec</code> defaults to a cwd of <code>/</code> (which cannot be replaced with a symlink), so this attack depends on the attacker getting a user (or some administrative process) to use <code>--cwd</code> and figuring out what path the target working directory is. Note that if the target working directory is a parent of the program binary being executed, the attacker might be unable to replace the path with a symlink (the <code>execve</code> will fail in most cases, unless the host filesystem layout specifically matches the container layout in specific ways and the attacker knows which binary the <code>runc exec</code> is executing).</p>\n<p>The CVSS score for this attack is CVSS:3.1/AV:L/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N (7.2, high severity).</p>\n<h4 id=\"attacks-3a-and-3b-processargs-host-binary-overwrite-attack\">Attacks 3a and 3b: <code>process.args</code> host binary overwrite attack</h4>\n<p>(These are modifications of attacks 1 and 2, constructed to overwrite a host binary by using <code>execve</code> to bring a magic-link reference into the container.)</p>\n<p>Attacks 1 and 2 can be adapted to overwrite a host binary by using a path like <code>/proc/self/fd/7/../../../bin/bash</code> as the <code>process.args</code> binary argument, causing a host binary to be executed by a container process. The <code>/proc/$pid/exe</code> handle can then be used to overwrite the host binary, as seen in CVE-2019-5736 (note that the same <code>#!</code> trick can be used to avoid detection as an attacker). As the overwritten binary could be something like <code>/bin/bash</code>, as soon as a privileged user executes the target binary on the host, the attacker can pivot to gain full access to the host.</p>\n<p>For the purposes of CVSS scoring:</p>\n<ul>\n<li>Attack 3a is attack 1 but adapted to overwrite a host binary, where a malicious image is set up to execute <code>/proc/self/fd/7/../../../bin/bash</code> and run a shell script that overwrites <code>/proc/self/exe</code>, overwriting the host copy of <code>/bin/bash</code>. The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H (8.6, high severity).</li>\n<li>Attack 3b is attack 2 but adapted to overwrite a host binary, where the malicious container process overwrites all of the possible <code>runc exec</code> target binaries inside the container (such as <code>/bin/bash</code>) such that a host target binary is executed and then the container process opens <code>/proc/$pid/exe</code> to get access to the host binary and overwrite it. The CVSS score for this attack is CVSS:3.1/AV:L/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:H (8.2, high severity).</li>\n</ul>\n<p>As mentioned in attack 1, while 3b is scored lower it is more dangerous in practice as it doesn't require a user to run a malicious image.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>runc 1.1.12 has been released, and includes patches for this issue. Note that there are four separate fixes applied:</p>\n<ul>\n<li>Checking that the working directory is actually inside the container by checking whether <code>os.Getwd</code> returns <code>ENOENT</code> (Linux provides a way of detecting if cwd is outside the current namespace root). This explicitly blocks runc from executing a container process when inside a non-container path and thus eliminates attacks 1 and 2 even in the case of fd leaks.</li>\n<li>Close all internal runc file descriptors in the final stage of <code>runc init</code>, right before <code>execve</code>. This ensures that internal file descriptors cannot be used as an argument to <code>execve</code> and thus eliminates attacks 3a and 3b, even in the case of fd leaks. This requires hooking into some Go runtime internals to make sure we don't close critical Go internal file descriptors.</li>\n<li>Fixing the specific fd leaks that made these bug exploitable (mark <code>/sys/fs/cgroup</code> as <code>O_CLOEXEC</code> and backport a fix for some <code>*os.File</code> leaks).</li>\n<li>In order to protect against future <code>runc init</code> file descriptor leaks, mark all non-stdio files as <code>O_CLOEXEC</code> before executing <code>runc init</code>.</li>\n</ul>\n<h3 id=\"other-runtimes\">Other Runtimes</h3>\n<p>We have discovered that several other container runtimes are either potentially vulnerable to similar attacks, or do not have sufficient protection against attacks of this nature. We recommend other container runtime authors look at <a href=\"#Patches\">our patches</a> and make sure they at least add a <code>getcwd() != ENOENT</code> check as well as consider whether <code>close_range(3, UINT_MAX, CLOSE_RANGE_CLOEXEC)</code> before executing their equivalent of <code>runc init</code> is appropriate.</p>\n<ul>\n<li>crun 1.12 does not leak any useful file descriptors into the <code>runc init</code>-equivalent process (so this attack is <em>not exploitable</em> as far as we can tell), but no care is taken to make sure all non-stdio files are <code>O_CLOEXEC</code> and there is no check after <code>chdir(2)</code> to ensure the working directory is inside the container. If a file descriptor happened to be leaked in the future, this could be exploitable. In addition, any file descriptors passed to <code>crun</code> are not closed until the container process is executed, meaning that easily-overlooked programming errors by users of <code>crun</code> can lead to these attacks becoming exploitable.</li>\n<li>youki 0.3.1 does not leak any useful file descriptors into the <code>runc init</code>-equivalent process (so this attack is <em>not exploitable</em> as far as we can tell) however this appears to be pure luck. <code>youki</code> does leak a directory file descriptor from the host mount namespace, but it just so happens that the directory is the rootfs of the container (which then gets <code>pivot_root</code>'d into and so ends up as a in-root path thanks to <code>chroot_fs_refs</code>). In addition, no care is taken to make sure all non-stdio files are <code>O_CLOEXEC</code> and there is no check after <code>chdir(2)</code> to ensure the working directory is inside the container. If a file descriptor happened to be leaked in the future, this could be exploitable. In addition, any file descriptors passed to <code>youki</code> are not closed until the container process is executed, meaning that easily-overlooked programming errors by users of <code>youki</code> can lead to these attacks becoming exploitable.</li>\n<li>LXC 5.0.3 does not appear to leak any useful file descriptors, and they have comments noting the importance of not leaking file descriptors in <code>lxc-attach</code>. However, they don't seem to have any proactive protection against file descriptor leaks at the point of <code>chdir</code> such as using <code>close_range(...)</code> (they do have RAII-like <code>__do_fclose</code> closers but those don't necessarily stop all leaks in this context) nor do they have any check after <code>chdir(2)</code> to ensure the working directory is inside the container. Unfortunately it seems they cannot use <code>CLOSE_RANGE_CLOEXEC</code> because they don't need to re-exec themselves.</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>For attacks 1 and 2, only permit containers (and <code>runc exec</code>) to use a <code>process.cwd</code> of <code>/</code>. It is not possible for <code>/</code> to be replaced with a symlink (the path is resolved from within the container's mount namespace, and you cannot change the root of a mount namespace or an fs root to a symlink).</p>\n<p>For attacks 1 and 3a, only permit users to run trusted images.</p>\n<p>For attack 3b, there is no practical workaround other than never using <code>runc exec</code> because any binary you try to execute with <code>runc exec</code> could end up being a malicious binary target.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://www.cve.org/CVERecord?id=CVE-2024-21626\">https://www.cve.org/CVERecord?id=CVE-2024-21626</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/releases/tag/v1.1.12\">https://github.com/opencontainers/runc/releases/tag/v1.1.12</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/7362cd5afe9d40131fb62cb075092025c7c71064\">https://github.com/opencontainers/runc/commit/7362cd5afe9d40131fb62cb075092025c7c71064</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/2ed79a6c91e56dcd2d1da47f8ffd663066153746\">https://github.com/opencontainers/runc/commit/2ed79a6c91e56dcd2d1da47f8ffd663066153746</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/b2b5754eb34174e032f1048beb1b27db83e77c5a\">https://github.com/opencontainers/runc/commit/b2b5754eb34174e032f1048beb1b27db83e77c5a</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/996a33c0e468435c70a34a25be1cb023d7554563\">https://github.com/opencontainers/runc/commit/996a33c0e468435c70a34a25be1cb023d7554563</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f3429eda1a8d478d7dbcb9c07cef943d88e67671\">https://github.com/opencontainers/runc/commit/f3429eda1a8d478d7dbcb9c07cef943d88e67671</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/4f263985016276c2faf709e9db98fcc8677a8a13\">https://github.com/opencontainers/runc/commit/4f263985016276c2faf709e9db98fcc8677a8a13</a></li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Rory McNamara from Snyk for discovering and disclosing the original vulnerability (attack 1) to Docker, @lifubang from acmcoder for discovering how to adapt the attack to overwrite host binaries (attack 3a), and Aleksa Sarai from SUSE for discovering how to adapt the attacks to work as container breakouts using <code>runc exec</code> (attacks 2 and 3b).</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv\">https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/02120488a4c0fc487d1ed2867e901eeed7ce8ecf\">https://github.com/opencontainers/runc/commit/02120488a4c0fc487d1ed2867e901eeed7ce8ecf</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/releases/tag/v1.1.12\">https://github.com/opencontainers/runc/releases/tag/v1.1.12</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-xr7r-f8xq-vfvv\">https://github.com/advisories/GHSA-xr7r-f8xq-vfvv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-xr7r-f8xq-vfvv",
            "title": "[github.com/opencontainers/runc] runc vulnerable to container breakout through process.cwd trickery and leaked fds",
            "date_modified": "2024-01-31T22:44:11.000Z",
            "date_published": "2024-01-31T22:44:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-xr7r-f8xq-vfvv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A malicious BuildKit client or frontend could craft a request that could lead to BuildKit daemon crashing with a panic.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been fixed in v0.12.5</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Avoid using BuildKit frontends from untrusted sources. A frontend image is usually specified as the <code>#syntax</code> line on your Dockerfile, or with <code>--frontend</code> flag when using <code>buildctl build</code> command. </p>\n<h3 id=\"references\">References</h3>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/moby/buildkit/security/advisories/GHSA-9p26-698r-w4hx\">https://github.com/moby/buildkit/security/advisories/GHSA-9p26-698r-w4hx</a></li>\n<li><a href=\"https://github.com/moby/buildkit/pull/4601\">https://github.com/moby/buildkit/pull/4601</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9p26-698r-w4hx\">https://github.com/advisories/GHSA-9p26-698r-w4hx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9p26-698r-w4hx",
            "title": "[github.com/moby/buildkit] BuildKit vulnerable to possible panic when incorrect parameters sent from frontend",
            "date_modified": "2024-01-31T22:43:56.000Z",
            "date_published": "2024-01-31T22:43:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9p26-698r-w4hx"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}