{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user making use of a wildcard relationship under the right hand branch of an <code>exclusion</code> or within an <code>intersection</code> operation will see <code>Lookup</code>/<code>LookupResources</code> return a resource as \"accessible\" if it is <em>not</em> accessible by virtue of the inclusion of the wildcard in the intersection or the right side of the exclusion.</p>\n<p>For example, given schema:</p>\n<pre><code class=\"language-zed\">definition user {}\n\ndefinition resource {\n   relation viewer: user\n   relation banned: user | user:*\n   permission view = viewer - banned\n}\n</code></pre>\n<p>If <code>user:*</code> is placed into the <code>banned</code> relation for a particular resource, <code>view</code> should return false for <em>all</em> resources. in <code>v1.3.0</code>, the wildcard is ignored entirely in lookup's dispatch, resulting in the <code>banned</code> wildcard being ignored in the exclusion.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Don't make use of wildcards on the right side of intersections or within exclusions. </p>\n<h3 id=\"references\">References</h3>\n<p><a href=\"https://github.com/authzed/spicedb/issues/358\">https://github.com/authzed/spicedb/issues/358</a></p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/authzed/spicedb\">SpiceDB</a></li>\n<li>Ask a question in the <a href=\"https://authzed.com/discord\">SpiceDB Discord</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/authzed/spicedb/security/advisories/GHSA-7p8f-8hjm-wm92\">https://github.com/authzed/spicedb/security/advisories/GHSA-7p8f-8hjm-wm92</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2022-21646\">https://nvd.nist.gov/vuln/detail/CVE-2022-21646</a></li>\n<li><a href=\"https://github.com/authzed/spicedb/issues/358\">https://github.com/authzed/spicedb/issues/358</a></li>\n<li><a href=\"https://github.com/authzed/spicedb/commit/15bba2e2d2a4bda336a37a7fe8ef8a35028cd970\">https://github.com/authzed/spicedb/commit/15bba2e2d2a4bda336a37a7fe8ef8a35028cd970</a></li>\n<li><a href=\"https://github.com/authzed/spicedb/releases/tag/v1.4.0\">https://github.com/authzed/spicedb/releases/tag/v1.4.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7p8f-8hjm-wm92\">https://github.com/advisories/GHSA-7p8f-8hjm-wm92</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7p8f-8hjm-wm92",
            "title": "[github.com/authzed/spicedb] Lookup operations do not take into account wildcards in SpiceDB",
            "date_modified": "2022-01-13T15:05:41.000Z",
            "date_published": "2022-01-13T15:05:41.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7p8f-8hjm-wm92"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The net/http Go package has a reported vulnerability tracked under CVE-2021-44716 which allows attacker controlled HTTP/2 requests to trigger unbounded memory usage in HTTP/2 endpoints. gRPC endpoints are not vulnerable as they rely on their own HTTP/2 implementation instead of the net/http package. HTTP/2 endpoints consuming the net/http package within SPIRE server and agent (or other components in this repository) that are <em>on by default</em> include the following:</p>\n<ul>\n<li>OIDC Discovery Provider</li>\n<li>K8s Workload Registrar in webhook mode</li>\n</ul>\n<p>The following endpoints are vulnerable <em>when enabled</em>:</p>\n<ul>\n<li>SPIRE server bundle endpoint (i.e. Federation API)</li>\n</ul>\n<p>The following endpoints are <em>NOT</em> vulnerable, since HTTP/2 support in go is not enabled on non-TLS protected endpoints:</p>\n<ul>\n<li>SPIRE server/agent metrics endpoint when configured for Prometheus</li>\n<li>SPIRE server/agent health endpoints</li>\n<li>SPIRE server/agent profiling endpoints</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p>SPIRE 1.0.3 and 1.1.3 have been released with an upgraded Go toolchain which patches the vulnerability</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The vulnerability can be worked around entirely by including the <code>http2server=0</code> value in the <code>GODEBUG</code> environment variable (see <a href=\"https://github.com/golang/go/issues/50058\">https://github.com/golang/go/issues/50058</a>). This turns off HTTP/2 support on all non-gRPC endpoints. They will still function with HTTP/1.1.</p>\n<p>The risk associated with this vulnerability can be somewhat mitigated by limiting the exposure of the endpoints in question. If necessary, vulnerable components or endpoints that are optionally configured can be disabled temporarily.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/golang/go/issues/50058\">https://github.com/golang/go/issues/50058</a></li>\n<li><a href=\"https://go-review.googlesource.com/c/go/+/370574/\">https://go-review.googlesource.com/c/go/+/370574/</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44716\">https://nvd.nist.gov/vuln/detail/CVE-2021-44716</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/spiffe/spire/security/advisories/GHSA-m7vp-hqwv-7m5x\">https://github.com/spiffe/spire/security/advisories/GHSA-m7vp-hqwv-7m5x</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m7vp-hqwv-7m5x\">https://github.com/advisories/GHSA-m7vp-hqwv-7m5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m7vp-hqwv-7m5x",
            "title": "[github.com/spiffe/spire] Unbounded memory usage on exposed HTTP/2 (non-gRPC) endpoints",
            "date_modified": "2022-01-12T22:33:04.000Z",
            "date_published": "2022-01-12T22:33:04.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m7vp-hqwv-7m5x"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The net/http Go package has a reported vulnerability tracked under CVE-2021-44716 which allows attacker controlled HTTP/2 requests to trigger unbounded memory usage in HTTP/2 endpoints. gRPC endpoints are not vulnerable as they rely on their own HTTP/2 implementation instead of the net/http package. HTTP/2 endpoints consuming the net/http package within SPIRE server and agent (or other components in this repository) that are <em>on by default</em> include the following:</p>\n<ul>\n<li>OIDC Discovery Provider</li>\n<li>K8s Workload Registrar in webhook mode</li>\n</ul>\n<p>The following endpoints are vulnerable <em>when enabled</em>:</p>\n<ul>\n<li>SPIRE server bundle endpoint (i.e. Federation API)</li>\n</ul>\n<p>The following endpoints are <em>NOT</em> vulnerable, since HTTP/2 support in go is not enabled on non-TLS protected endpoints:</p>\n<ul>\n<li>SPIRE server/agent metrics endpoint when configured for Prometheus</li>\n<li>SPIRE server/agent health endpoints</li>\n<li>SPIRE server/agent profiling endpoints</li>\n</ul>\n<h3 id=\"patches\">Patches</h3>\n<p>SPIRE 1.0.3 and 1.1.3 have been released with an upgraded Go toolchain which patches the vulnerability</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The vulnerability can be worked around entirely by including the <code>http2server=0</code> value in the <code>GODEBUG</code> environment variable (see <a href=\"https://github.com/golang/go/issues/50058\">https://github.com/golang/go/issues/50058</a>). This turns off HTTP/2 support on all non-gRPC endpoints. They will still function with HTTP/1.1.</p>\n<p>The risk associated with this vulnerability can be somewhat mitigated by limiting the exposure of the endpoints in question. If necessary, vulnerable components or endpoints that are optionally configured can be disabled temporarily.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/golang/go/issues/50058\">https://github.com/golang/go/issues/50058</a></li>\n<li><a href=\"https://go-review.googlesource.com/c/go/+/370574/\">https://go-review.googlesource.com/c/go/+/370574/</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-44716\">https://nvd.nist.gov/vuln/detail/CVE-2021-44716</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/spiffe/spire/security/advisories/GHSA-m7vp-hqwv-7m5x\">https://github.com/spiffe/spire/security/advisories/GHSA-m7vp-hqwv-7m5x</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m7vp-hqwv-7m5x\">https://github.com/advisories/GHSA-m7vp-hqwv-7m5x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m7vp-hqwv-7m5x",
            "title": "[github.com/spiffe/spire] Unbounded memory usage on exposed HTTP/2 (non-gRPC) endpoints",
            "date_modified": "2022-01-12T22:33:04.000Z",
            "date_published": "2022-01-12T22:33:04.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m7vp-hqwv-7m5x"
            }
        },
        {
            "content_html": "<p>A Broken or Risky Cryptographic Algorithm exists in Max Mazurov Maddy before 0.5.2, which is an unnecessary risk that may result in the exposure of sensitive information.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-42583\">https://nvd.nist.gov/vuln/detail/CVE-2021-42583</a></li>\n<li><a href=\"https://github.com/foxcpp/maddy/blob/df40dce1284cd0fd0a9e8e7894029553d653d0a5/internal/auth/shadow/verify.go\">https://github.com/foxcpp/maddy/blob/df40dce1284cd0fd0a9e8e7894029553d653d0a5/internal/auth/shadow/verify.go</a></li>\n<li><a href=\"https://github.com/foxcpp/maddy/releases/tag/v0.5.2\">https://github.com/foxcpp/maddy/releases/tag/v0.5.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-5r5w-h76p-m726\">https://github.com/advisories/GHSA-5r5w-h76p-m726</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-5r5w-h76p-m726",
            "title": "[github.com/foxcpp/maddy] Use of a Broken or Risky Cryptographic Algorithm in Max Mazurov Maddy",
            "date_modified": "2022-01-13T18:32:44.000Z",
            "date_published": "2022-01-06T22:20:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-5r5w-h76p-m726"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Containers launched through containerd’s CRI implementation on Linux systems which use the SELinux security module and containerd versions since v1.5.0 can cause arbitrary files and directories on the host to be relabeled to match the container process label through the use of specially-configured bind mounts in a hostPath volume. This relabeling elevates permissions for the container, granting full read/write access over the affected files and directories. Kubernetes and crictl can both be configured to use containerd’s CRI implementation.</p>\n<p>If you are not using containerd’s CRI implementation (through one of the mechanisms described above), you are not affected by this issue.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This bug has been fixed in containerd 1.5.9.  Because file labels persist independently of containerd, users should both update to these versions as soon as they are released and validate that all files on their host are correctly labeled.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Ensure that no sensitive files or directories are used as a hostPath volume source location.  Policy enforcement mechanisms such a Kubernetes Pod Security Policy <a href=\"https://kubernetes.io/docs/concepts/policy/pod-security-policy/#volumes-and-file-systems\">AllowedHostPaths</a> may be specified to limit the files and directories that can be bind-mounted to containers.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/containerd/containerd/issues/new/choose\">containerd</a></li>\n<li>Email us at <a href=\"mailto:security@containerd.io\">security@containerd.io</a><h3 id=\"references\">References</h3>\n</li>\n</ul>\n<ul>\n<li><a href=\"https://github.com/containerd/containerd/security/advisories/GHSA-mvff-h3cj-wj9c\">https://github.com/containerd/containerd/security/advisories/GHSA-mvff-h3cj-wj9c</a></li>\n<li><a href=\"https://github.com/containerd/containerd/issues/6194\">https://github.com/containerd/containerd/issues/6194</a></li>\n<li><a href=\"https://github.com/containerd/containerd/commit/a731039238c62be081eb8c31525b988415745eea\">https://github.com/containerd/containerd/commit/a731039238c62be081eb8c31525b988415745eea</a></li>\n<li><a href=\"https://github.com/dweomer/containerd/commit/f7f08f0e34fb97392b0d382e58916d6865100299\">https://github.com/dweomer/containerd/commit/f7f08f0e34fb97392b0d382e58916d6865100299</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43816\">https://nvd.nist.gov/vuln/detail/CVE-2021-43816</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mvff-h3cj-wj9c\">https://github.com/advisories/GHSA-mvff-h3cj-wj9c</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mvff-h3cj-wj9c",
            "title": "[github.com/containerd/containerd] Unprivileged pod using `hostPath` can side-step active LSM when it is SELinux",
            "date_modified": "2022-01-19T19:58:30.000Z",
            "date_published": "2022-01-06T17:36:59.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mvff-h3cj-wj9c"
            }
        },
        {
            "content_html": "<p>This affects all versions of package github.com/kataras/iris; all versions of package github.com/kataras/iris/v12. The unsafe handling of file names during upload using UploadFormFiles method may enable attackers to write to arbitrary locations outside the designated target folder.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-23772\">https://nvd.nist.gov/vuln/detail/CVE-2021-23772</a></li>\n<li><a href=\"https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08\">https://github.com/kataras/iris/commit/e213dba0d32ff66653e0ef124bc5088817264b08</a></li>\n<li><a href=\"https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRIS-2325169\">https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRIS-2325169</a></li>\n<li><a href=\"https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRISV12-2325170\">https://snyk.io/vuln/SNYK-GOLANG-GITHUBCOMKATARASIRISV12-2325170</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jcxc-rh6w-wf49\">https://github.com/advisories/GHSA-jcxc-rh6w-wf49</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jcxc-rh6w-wf49",
            "title": "[github.com/kataras/iris/v12] Link Following in Iris",
            "date_modified": "2022-01-06T21:36:19.000Z",
            "date_published": "2022-01-06T21:36:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jcxc-rh6w-wf49"
            }
        },
        {
            "content_html": "<p>A flaw was found in podman. The <code>podman machine</code> function (used to create and manage Podman virtual machine containing a Podman process) spawns a <code>gvproxy</code> process on the host system. The <code>gvproxy</code> API is accessible on port 7777 on all IP addresses on the host. If that port is open on the host's firewall, an attacker can potentially use the <code>gvproxy</code> API to forward ports on the host to ports in the VM, making private services on the VM accessible to the network. This issue could be also used to interrupt the host's services by forwarding all ports to the VM.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-4024\">https://nvd.nist.gov/vuln/detail/CVE-2021-4024</a></li>\n<li><a href=\"https://bugzilla.redhat.com/show_bug.cgi?id=2026675,\">https://bugzilla.redhat.com/show_bug.cgi?id=2026675,</a></li>\n<li><a href=\"https://github.com/containers/podman/releases/tag/v3.4.3\">https://github.com/containers/podman/releases/tag/v3.4.3</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-3cf2-x423-x582\">https://github.com/advisories/GHSA-3cf2-x423-x582</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-3cf2-x423-x582",
            "title": "[github.com/containers/podman/v3] Exposure of Sensitive Information to an Unauthorized Actor and Origin Validation Error in podman",
            "date_modified": "2022-01-06T21:12:50.000Z",
            "date_published": "2022-01-06T21:12:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-3cf2-x423-x582"
            }
        },
        {
            "content_html": "<h1 id=\"summary\">Summary</h1>\n<p>In the threshold signature scheme, participants start by dividing secrets into shares using a secret sharing scheme. The Verifiable Secret Sharing scheme generates shares from the user’s IDs but does not properly validate them. Using a malicious ID will make other users reveal their secrets during the secret-sharing procedure. In addition, a second issue resulting from lack of validation could cause nodes to crash when sent maliciously formed user IDs.</p>\n<h1 id=\"details\">Details</h1>\n<p>The creation of Parties IDs does not properly validate for maliciously chosen IDs. Parties generate the secret shares in <code>binance-chain/tss-lib</code> codebase that <code>keep-network/keep-ecdsa</code> uses by evaluating the polynomial with the other parties’ IDs. It is critical that these party ids are non-zero because evaluating the polynomial at point 0 reveals the secret.</p>\n<p>There is a check that these ids are not zero, but this is insufficient since it is not performed modulo the curve order. Therefore, one can set their ID equal to the order of the elliptic curve, which equals 0 during the polynomial evaluation modulo the curve order.</p>\n<pre><code>    shares := make(Shares, num)\n    for i := 0; i &lt; num; i++ {\n        if indexes[i].Cmp(big.NewInt(0)) == 0 {\n            return nil, nil, fmt.Errorf(\"party index should not be 0\")\n        }\n        share := evaluatePolynomial(ec, threshold, poly, indexes[i])\n        shares[i] = &amp;Share{Threshold: threshold, ID: indexes[i], Share: share}\n    }\n</code></pre>\n<p>(<a href=\"https://github.com/binance-chain/tss-lib/blob/73560daec7f83d7355107ea9b5e59d16de8765be/crypto/vss/feldman_vss.go#L64-L70\">https://github.com/binance-chain/tss-lib/blob/73560daec7f83d7355107ea9b5e59d16de8765be/crypto/vss/feldman_vss.go#L64-L70</a>)</p>\n<p>Thus, a party with an ID equal to the order of the curve will receive the secret key as its share.</p>\n<p>Another issue with the tss-lib implementation was the lack of verification for modularly equal user IDs that can cause nodes to crash during key generation or resharing.</p>\n<h1 id=\"timeline\">Timeline</h1>\n<h3 id=\"6-december-2021-2028-cet\">6 December 2021, 20:28 CET</h3>\n<p>The team is informed by Trail of Bits about the issue in <code>binance-chain/tss-lib</code>. The vulnerability was already disclosed with Binance and they have implemented fixes in their recent commits. We are advised to update our dependency to the most recent <code>binance-chain/tss-lib</code> version.</p>\n<h3 id=\"7-december-2021-910-cet\">7 December 2021, 9:10 CET</h3>\n<p>The team confirms with Trail of Bits we started the work on a fix.</p>\n<h3 id=\"7-december-2021-2003-cet\">7 December 2021, 20:03 CET</h3>\n<p>The team informs Trail of Bits that we found a potential problem in Binance's fix that may lead to the signing code failing with Go panic. We identified the problematic line and suggested its removal.</p>\n<p>To address the vulnerability in the protocol, it is required to ensure that:</p>\n<ul>\n<li>all indexes are non-zero,</li>\n<li>all indexes are non-zero modulo the curve order,</li>\n<li>all indexes are unique modulo the curve order.</li>\n</ul>\n<p>The first two are guarded in <code>CheckIndexes</code> function by:</p>\n<pre><code>vMod := new(big.Int).Mod(v, ec.Params().N)\nif vMod.Cmp(zero) == 0 {\n  return nil, errors.New(\"party index should not be 0\")\n}\n</code></pre>\n<p>The last one is guarded by:</p>\n<pre><code>if sortutil.Dedupe(sortutil.BigIntSlice(dup)) &lt; len(indexes) {\n  return nil, errors.New(\"duplicate in indexes\")\n}\n</code></pre>\n<p>However, <code>CheckIndexes</code> was additionally modified to update values of passed indexes by doing <code>indexes[i] = vMod</code>.</p>\n<p>This line was not backward-compatible and caused signatures to fail with <code>panic: runtime error: invalid memory address or nil pointer dereference</code> in case the signing group was generated with at least one <code>PartyID.Key</code> higher than <code>ec.Params().N</code>. This would also be problematic for new code that constructs such <code>PartyID</code> - we tested that key generation completed successfully but signing failed with the mentioned panic.</p>\n<h3 id=\"8-december-2021-1249-cet\">8 December 2021, 12:49 CET</h3>\n<p>Trail of Bits confirmed the line we flagged is not critical to the security of the protocol.</p>\n<h3 id=\"8-december-2021-1529-cet\">8 December 2021, 15:29 CET</h3>\n<p>The team informed Trail of Bits we are planning to open a PR to <code>binance-chain/tss-lib</code> with a fix and we suggest extending the embargo for communicating this issue for one more week, until Friday, Dec 17h to give everyone more time update their code given the problem was found. We also ask Trail of Bits to get in touch with Binance to review our fix given that we are not going to provide a sufficient explanation in the commit and PR description to do not threaten the security of projects that have already upgraded their dependency.</p>\n<h3 id=\"8-december-2021-1817-cet\">8 December 2021, 18:17 CET</h3>\n<p>The team informs Trail of Bits about opening a PR <a href=\"https://github.com/binance-chain/tss-lib/pull/155\">https://github.com/binance-chain/tss-lib/pull/155</a> and explains all the details of the issue.</p>\n<p>The problematic scenario is:</p>\n<ol>\n<li>We start the keygen by creating <code>PartyID</code> for each member. The <code>PartyID</code> struct has <code>Id</code> and <code>Key</code> fields. We set <code>PartyID.Key</code> that is higher than the elliptic curve's <code>N</code>.</li>\n<li>This goes to tss-lib which starts the round 1 code (<code>ecdsa/keygen/round_1.go</code>). It takes <code>PartyID.Key</code> of each member and assembles the <code>ids</code> slice. This slice is thrown into <code>CheckIndexes</code> which overwrites each element by doing the modulo <code>N</code>.</li>\n<li>After returning from <code>CheckIndexes</code> the modified <code>ids</code> slice is used to set the <code>Ks</code> slice in the final <code>LocalPartySaveData</code> which is received by each group member as keygen final result.</li>\n<li>Each member takes this <code>LocalPartySaveData</code> and saves it on disk.</li>\n<li>Upon signing, we do the same as in point 1, so we construct <code>PartyID</code>s in the same way and start the protocol. At this point, <code>PartyID.Key</code> is higher than curve's <code>N</code>.</li>\n<li>Before starting round 1 of signing, <code>LocalPartySaveData</code> obtained at keygen and our <code>PartyID</code>s built at point 5 are used in <code>BuildLocalSaveDataSubset</code> to build a new <code>LocalPartySaveData</code> instance.</li>\n<li><code>BuildLocalSaveDataSubset</code> is the place where things go wrong because <code>Key</code> field of each <code>PartyID</code> from point 5 doesn't correspond to encoded <code>Ks</code> elements of <code>LocalPartySaveData</code> obtained after keygen, the final <code>LocalPartySaveData</code> is corrupted, and cause panic upon validation before signing round 1.</li>\n</ol>\n<h3 id=\"8-december-2021-2150-cet\">8 December 2021, 21:50 CET</h3>\n<p>Trail of Bits confirms they are going to followup with Binance and they agree to extend the embargo by a week.</p>\n<h3 id=\"8-december-2021-1516-cet\">8 December 2021, 15:16 CET</h3>\n<p>Trail of Bits validates the problematic scenario we described and our fix. Trail of Bits reaches to Binance and recommends merging our fix and in addition to some other fixes that would secure the code to do not panic even if <code>LocalPartySaveData</code> has corrupted data.</p>\n<h3 id=\"10-december-2021-816-cet\">10 December 2021, 8:16 CET</h3>\n<p>Binance merges our fix <a href=\"https://github.com/binance-chain/tss-lib/commit/cd95cee01ea2af6d4aa8316612803be944d5369a\">https://github.com/binance-chain/tss-lib/commit/cd95cee01ea2af6d4aa8316612803be944d5369a</a></p>\n<h3 id=\"13-december-2021-835-cet\">13 December 2021, 8:35 CET</h3>\n<p>Binance applies more fixes so that even in case of <code>LocalPartySaveData</code> corrupted, the code is not going to panic.</p>\n<h3 id=\"15-december-2021\">15 December 2021</h3>\n<p>The team releases a new version of the client, v1.8.1, and announces the need for an upgrade.\n<a href=\"https://github.com/keep-network/keep-ecdsa/releases/tag/v1.8.1\">https://github.com/keep-network/keep-ecdsa/releases/tag/v1.8.1</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/keep-network/keep-ecdsa/security/advisories/GHSA-gp6j-vx54-5pmf\">https://github.com/keep-network/keep-ecdsa/security/advisories/GHSA-gp6j-vx54-5pmf</a></li>\n<li><a href=\"https://github.com/keep-network/keep-ecdsa/releases/tag/v1.8.1\">https://github.com/keep-network/keep-ecdsa/releases/tag/v1.8.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-gp6j-vx54-5pmf\">https://github.com/advisories/GHSA-gp6j-vx54-5pmf</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gp6j-vx54-5pmf",
            "title": "[github.com/keep-network/keep-ecdsa] Incorrect validation of parties IDs leaks secret keys in Secret-sharing scheme",
            "date_modified": "2022-01-06T18:30:26.000Z",
            "date_published": "2022-01-06T18:30:26.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gp6j-vx54-5pmf"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In Cronos nodes running versions before v0.6.5, it is possible to take transaction fees from Cosmos SDK's FeeCollector for the current block by sending a custom crafted MsgEthereumTx.</p>\n<p>User funds and balances are safe.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in Cronos v0.6.5 on the mempool level.\nThe next network upgrade with consensus-breaking changes will patch it on the consensus level.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no tested workarounds. All validator node operators are recommended to upgrade to Cronos v0.6.5 at their earliest possible convenience.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thank you to @zb3 for reporting this issue on <a href=\"https://immunefi.com/bounty/cronos/\">Cronos Immunefi Bug Bounty Program</a>, to @cyril-crypto for reproducing the issue and to @yihuang and @thomas-nguy for patching the issue on the CheckTx (mempool) and the DeliverTx (consensus) levels.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open a discussion in <a href=\"https://github.com/crypto-org-chain/cronos/discussions/new\">crypto-org-chain/cronos</a></li>\n<li>Email us at <a href=\"mailto:chain@crypto.org\">chain@crypto.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43839\">https://nvd.nist.gov/vuln/detail/CVE-2021-43839</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/pull/270\">https://github.com/crypto-org-chain/cronos/pull/270</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8\">https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/advisories/GHSA-f854-hpxv-cw9r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r",
            "title": "[github.com/tharsis/ethermint] Drainage of FeeCollector's Block Transaction Fees in cronos",
            "date_modified": "2022-01-06T20:21:29.000Z",
            "date_published": "2022-01-06T18:30:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In Cronos nodes running versions before v0.6.5, it is possible to take transaction fees from Cosmos SDK's FeeCollector for the current block by sending a custom crafted MsgEthereumTx.</p>\n<p>User funds and balances are safe.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in Cronos v0.6.5 on the mempool level.\nThe next network upgrade with consensus-breaking changes will patch it on the consensus level.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no tested workarounds. All validator node operators are recommended to upgrade to Cronos v0.6.5 at their earliest possible convenience.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thank you to @zb3 for reporting this issue on <a href=\"https://immunefi.com/bounty/cronos/\">Cronos Immunefi Bug Bounty Program</a>, to @cyril-crypto for reproducing the issue and to @yihuang and @thomas-nguy for patching the issue on the CheckTx (mempool) and the DeliverTx (consensus) levels.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open a discussion in <a href=\"https://github.com/crypto-org-chain/cronos/discussions/new\">crypto-org-chain/cronos</a></li>\n<li>Email us at <a href=\"mailto:chain@crypto.org\">chain@crypto.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43839\">https://nvd.nist.gov/vuln/detail/CVE-2021-43839</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/pull/270\">https://github.com/crypto-org-chain/cronos/pull/270</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8\">https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/advisories/GHSA-f854-hpxv-cw9r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r",
            "title": "[github.com/tharsis/evmos] Drainage of FeeCollector's Block Transaction Fees in cronos",
            "date_modified": "2022-01-06T20:21:29.000Z",
            "date_published": "2022-01-06T18:30:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In Cronos nodes running versions before v0.6.5, it is possible to take transaction fees from Cosmos SDK's FeeCollector for the current block by sending a custom crafted MsgEthereumTx.</p>\n<p>User funds and balances are safe.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in Cronos v0.6.5 on the mempool level.\nThe next network upgrade with consensus-breaking changes will patch it on the consensus level.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no tested workarounds. All validator node operators are recommended to upgrade to Cronos v0.6.5 at their earliest possible convenience.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thank you to @zb3 for reporting this issue on <a href=\"https://immunefi.com/bounty/cronos/\">Cronos Immunefi Bug Bounty Program</a>, to @cyril-crypto for reproducing the issue and to @yihuang and @thomas-nguy for patching the issue on the CheckTx (mempool) and the DeliverTx (consensus) levels.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open a discussion in <a href=\"https://github.com/crypto-org-chain/cronos/discussions/new\">crypto-org-chain/cronos</a></li>\n<li>Email us at <a href=\"mailto:chain@crypto.org\">chain@crypto.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43839\">https://nvd.nist.gov/vuln/detail/CVE-2021-43839</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/pull/270\">https://github.com/crypto-org-chain/cronos/pull/270</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8\">https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/advisories/GHSA-f854-hpxv-cw9r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r",
            "title": "[github.com/tharsis/ethermint] Drainage of FeeCollector's Block Transaction Fees in cronos",
            "date_modified": "2022-01-06T20:21:29.000Z",
            "date_published": "2022-01-06T18:30:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>In Cronos nodes running versions before v0.6.5, it is possible to take transaction fees from Cosmos SDK's FeeCollector for the current block by sending a custom crafted MsgEthereumTx.</p>\n<p>User funds and balances are safe.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This problem has been patched in Cronos v0.6.5 on the mempool level.\nThe next network upgrade with consensus-breaking changes will patch it on the consensus level.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no tested workarounds. All validator node operators are recommended to upgrade to Cronos v0.6.5 at their earliest possible convenience.</p>\n<h3 id=\"credits\">Credits</h3>\n<p>Thank you to @zb3 for reporting this issue on <a href=\"https://immunefi.com/bounty/cronos/\">Cronos Immunefi Bug Bounty Program</a>, to @cyril-crypto for reproducing the issue and to @yihuang and @thomas-nguy for patching the issue on the CheckTx (mempool) and the DeliverTx (consensus) levels.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open a discussion in <a href=\"https://github.com/crypto-org-chain/cronos/discussions/new\">crypto-org-chain/cronos</a></li>\n<li>Email us at <a href=\"mailto:chain@crypto.org\">chain@crypto.org</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/crypto-org-chain/cronos/security/advisories/GHSA-f854-hpxv-cw9r</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-43839\">https://nvd.nist.gov/vuln/detail/CVE-2021-43839</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/pull/270\">https://github.com/crypto-org-chain/cronos/pull/270</a></li>\n<li><a href=\"https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8\">https://github.com/crypto-org-chain/cronos/commit/150ef237b37ac28c8136e1c0f494932860b9ebe8</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f854-hpxv-cw9r\">https://github.com/advisories/GHSA-f854-hpxv-cw9r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r",
            "title": "[github.com/crypto-org-chain/cronos] Drainage of FeeCollector's Block Transaction Fees in cronos",
            "date_modified": "2022-01-06T20:21:29.000Z",
            "date_published": "2022-01-06T18:30:54.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f854-hpxv-cw9r"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An open redirect vulnerability that allows users to be targeted for phishing attacks has been found in Sourcegraph instances configured with OAuth, OpenID, or SAML authentication enabled. Users targeted by these phishing attacks could have their authentication tokens silently harvested by an attacker.</p>\n<h3 id=\"resolution\">Resolution</h3>\n<p>Sourcegraph v3.14.4 and v3.15.1 have been released which resolve the vulnerability. (<a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">associated change</a>)</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Disabling OAuth, OpenID and/or SAML sign-in options until upgraded to the patched versions will secure Sourcegraph / workaround the issue.</p>\n<h3 id=\"timeline\">Timeline</h3>\n<ul>\n<li>Apr 23, 8 AM PST: GitHub Security Lab reported the issue to Sourcegraph.</li>\n<li>Apr 23, 11 PM PST: A Sourcegraph engineer proposed a resolution for the vulnerability. <a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">https://github.com/sourcegraph/sourcegraph/pull/10167</a></li>\n<li>Apr 24, 3 AM PST: The proposed resolution was reviewed, approved, and merged.</li>\n<li>Apr 28, 2 PM PST: Patch releases for 3.14.4 and 3.15.1 were published.</li>\n<li>Apr 29, 10 PM PST: Mitre publicly disclosed <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283\">CVE-2020-12283</a>.</li>\n<li>Apr 30, 11 AM PST: Sourcegraph issued a GitHub security advisory and notified all affected users.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283\">Mitre: CVE-2020-12283</a></li>\n<li><a href=\"https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph\">GitHub Security Lab: GHSL-2020-085</a></li>\n<li><a href=\"https://blog.detectify.com/2019/05/16/the-real-impact-of-an-open-redirect/\">detectify's blog post on open redirect vulnerabilities\n</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, please contact us at <a href=\"mailto:support@sourcegraph.com\">support@sourcegraph.com</a> and include <code>CVE-2020-12283</code> in the title.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-mx43-r985-5h4m\">https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-mx43-r985-5h4m</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-12283\">https://nvd.nist.gov/vuln/detail/CVE-2020-12283</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">https://github.com/sourcegraph/sourcegraph/pull/10167</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/commit/c0f48172e815c7f66471a38f0a06d1fc32a77a64\">https://github.com/sourcegraph/sourcegraph/commit/c0f48172e815c7f66471a38f0a06d1fc32a77a64</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/blob/master/CHANGELOG.md\">https://github.com/sourcegraph/sourcegraph/blob/master/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/compare/v3.15.0...v3.15.1\">https://github.com/sourcegraph/sourcegraph/compare/v3.15.0...v3.15.1</a></li>\n<li><a href=\"https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph\">https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mx43-r985-5h4m\">https://github.com/advisories/GHSA-mx43-r985-5h4m</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mx43-r985-5h4m",
            "title": "[github.com/sourcegraph/sourcegraph/cmd/frontend/auth] Open redirect vulnerability in Sourcegraph",
            "date_modified": "2021-12-20T18:12:47.000Z",
            "date_published": "2021-12-20T18:12:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mx43-r985-5h4m"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An open redirect vulnerability that allows users to be targeted for phishing attacks has been found in Sourcegraph instances configured with OAuth, OpenID, or SAML authentication enabled. Users targeted by these phishing attacks could have their authentication tokens silently harvested by an attacker.</p>\n<h3 id=\"resolution\">Resolution</h3>\n<p>Sourcegraph v3.14.4 and v3.15.1 have been released which resolve the vulnerability. (<a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">associated change</a>)</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Disabling OAuth, OpenID and/or SAML sign-in options until upgraded to the patched versions will secure Sourcegraph / workaround the issue.</p>\n<h3 id=\"timeline\">Timeline</h3>\n<ul>\n<li>Apr 23, 8 AM PST: GitHub Security Lab reported the issue to Sourcegraph.</li>\n<li>Apr 23, 11 PM PST: A Sourcegraph engineer proposed a resolution for the vulnerability. <a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">https://github.com/sourcegraph/sourcegraph/pull/10167</a></li>\n<li>Apr 24, 3 AM PST: The proposed resolution was reviewed, approved, and merged.</li>\n<li>Apr 28, 2 PM PST: Patch releases for 3.14.4 and 3.15.1 were published.</li>\n<li>Apr 29, 10 PM PST: Mitre publicly disclosed <a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283\">CVE-2020-12283</a>.</li>\n<li>Apr 30, 11 AM PST: Sourcegraph issued a GitHub security advisory and notified all affected users.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12283\">Mitre: CVE-2020-12283</a></li>\n<li><a href=\"https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph\">GitHub Security Lab: GHSL-2020-085</a></li>\n<li><a href=\"https://blog.detectify.com/2019/05/16/the-real-impact-of-an-open-redirect/\">detectify's blog post on open redirect vulnerabilities\n</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, please contact us at <a href=\"mailto:support@sourcegraph.com\">support@sourcegraph.com</a> and include <code>CVE-2020-12283</code> in the title.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-mx43-r985-5h4m\">https://github.com/sourcegraph/sourcegraph/security/advisories/GHSA-mx43-r985-5h4m</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-12283\">https://nvd.nist.gov/vuln/detail/CVE-2020-12283</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/pull/10167\">https://github.com/sourcegraph/sourcegraph/pull/10167</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/commit/c0f48172e815c7f66471a38f0a06d1fc32a77a64\">https://github.com/sourcegraph/sourcegraph/commit/c0f48172e815c7f66471a38f0a06d1fc32a77a64</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/blob/master/CHANGELOG.md\">https://github.com/sourcegraph/sourcegraph/blob/master/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/sourcegraph/sourcegraph/compare/v3.15.0...v3.15.1\">https://github.com/sourcegraph/sourcegraph/compare/v3.15.0...v3.15.1</a></li>\n<li><a href=\"https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph\">https://securitylab.github.com/advisories/GHSL-2020-085-sourcegraph</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mx43-r985-5h4m\">https://github.com/advisories/GHSA-mx43-r985-5h4m</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mx43-r985-5h4m",
            "title": "[github.com/sourcegraph/sourcegraph/cmd/frontend/auth] Open redirect vulnerability in Sourcegraph",
            "date_modified": "2021-12-20T18:12:47.000Z",
            "date_published": "2021-12-20T18:12:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mx43-r985-5h4m"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Installations which use the GitLab auth connector are vulnerable to identity spoofing by way of configuring a GitLab account with the same full name as another GitLab user who is granted access to a Concourse team by having their full name listed under <code>users</code> in the team configuration or given to the <code>--gitlab-user</code> flag.</p>\n<p>See the <a href=\"https://concourse-ci.org/gitlab-auth.html\">GitLab auth docs</a> for details.</p>\n<p>Concourse installations which do not configure the GitLab auth connector are not affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Concourse <a href=\"https://github.com/concourse/concourse/releases/tag/v6.3.1\">v6.3.1</a> and <a href=\"https://github.com/concourse/concourse/releases/tag/v6.4.1\">v6.4.1</a> were both released with a fix on August 4th, 2020.</p>\n<p>Both versions change the GitLab connector to use the username, rather than the full name. This was always the intent, and the previous behavior was originally reported as a bug (concourse/dex#7) prior to being reported as a security issue.</p>\n<p>Any Concourse teams which configure GitLab users will have to switch each user from their full name to their username upon upgrading to these versions.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>GitLab groups do not have this vulnerability, so GitLab users may be moved into groups which are then configured in the Concourse team.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>concourse/dex#12: PR with the fix</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, you may reach us privately at <a href=\"mailto:concourseteam+security@gmail.com\">concourseteam+security@gmail.com</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj\">https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-5415\">https://nvd.nist.gov/vuln/detail/CVE-2020-5415</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2020-5415\">https://tanzu.vmware.com/security/cve-2020-5415</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-627p-rr78-99rj\">https://github.com/advisories/GHSA-627p-rr78-99rj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-627p-rr78-99rj",
            "title": "[github.com/concourse/dex] GitLab auth uses full name instead of username as user ID, allowing impersonation",
            "date_modified": "2021-12-20T17:56:03.000Z",
            "date_published": "2021-12-20T17:56:03.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-627p-rr78-99rj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Installations which use the GitLab auth connector are vulnerable to identity spoofing by way of configuring a GitLab account with the same full name as another GitLab user who is granted access to a Concourse team by having their full name listed under <code>users</code> in the team configuration or given to the <code>--gitlab-user</code> flag.</p>\n<p>See the <a href=\"https://concourse-ci.org/gitlab-auth.html\">GitLab auth docs</a> for details.</p>\n<p>Concourse installations which do not configure the GitLab auth connector are not affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Concourse <a href=\"https://github.com/concourse/concourse/releases/tag/v6.3.1\">v6.3.1</a> and <a href=\"https://github.com/concourse/concourse/releases/tag/v6.4.1\">v6.4.1</a> were both released with a fix on August 4th, 2020.</p>\n<p>Both versions change the GitLab connector to use the username, rather than the full name. This was always the intent, and the previous behavior was originally reported as a bug (concourse/dex#7) prior to being reported as a security issue.</p>\n<p>Any Concourse teams which configure GitLab users will have to switch each user from their full name to their username upon upgrading to these versions.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>GitLab groups do not have this vulnerability, so GitLab users may be moved into groups which are then configured in the Concourse team.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>concourse/dex#12: PR with the fix</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, you may reach us privately at <a href=\"mailto:concourseteam+security@gmail.com\">concourseteam+security@gmail.com</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj\">https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-5415\">https://nvd.nist.gov/vuln/detail/CVE-2020-5415</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2020-5415\">https://tanzu.vmware.com/security/cve-2020-5415</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-627p-rr78-99rj\">https://github.com/advisories/GHSA-627p-rr78-99rj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-627p-rr78-99rj",
            "title": "[github.com/concourse/dex] GitLab auth uses full name instead of username as user ID, allowing impersonation",
            "date_modified": "2021-12-20T17:56:03.000Z",
            "date_published": "2021-12-20T17:56:03.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-627p-rr78-99rj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Installations which use the GitLab auth connector are vulnerable to identity spoofing by way of configuring a GitLab account with the same full name as another GitLab user who is granted access to a Concourse team by having their full name listed under <code>users</code> in the team configuration or given to the <code>--gitlab-user</code> flag.</p>\n<p>See the <a href=\"https://concourse-ci.org/gitlab-auth.html\">GitLab auth docs</a> for details.</p>\n<p>Concourse installations which do not configure the GitLab auth connector are not affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Concourse <a href=\"https://github.com/concourse/concourse/releases/tag/v6.3.1\">v6.3.1</a> and <a href=\"https://github.com/concourse/concourse/releases/tag/v6.4.1\">v6.4.1</a> were both released with a fix on August 4th, 2020.</p>\n<p>Both versions change the GitLab connector to use the username, rather than the full name. This was always the intent, and the previous behavior was originally reported as a bug (concourse/dex#7) prior to being reported as a security issue.</p>\n<p>Any Concourse teams which configure GitLab users will have to switch each user from their full name to their username upon upgrading to these versions.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>GitLab groups do not have this vulnerability, so GitLab users may be moved into groups which are then configured in the Concourse team.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>concourse/dex#12: PR with the fix</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, you may reach us privately at <a href=\"mailto:concourseteam+security@gmail.com\">concourseteam+security@gmail.com</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj\">https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-5415\">https://nvd.nist.gov/vuln/detail/CVE-2020-5415</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2020-5415\">https://tanzu.vmware.com/security/cve-2020-5415</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-627p-rr78-99rj\">https://github.com/advisories/GHSA-627p-rr78-99rj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-627p-rr78-99rj",
            "title": "[github.com/concourse/concourse] GitLab auth uses full name instead of username as user ID, allowing impersonation",
            "date_modified": "2021-12-20T17:56:03.000Z",
            "date_published": "2021-12-20T17:56:03.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-627p-rr78-99rj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Installations which use the GitLab auth connector are vulnerable to identity spoofing by way of configuring a GitLab account with the same full name as another GitLab user who is granted access to a Concourse team by having their full name listed under <code>users</code> in the team configuration or given to the <code>--gitlab-user</code> flag.</p>\n<p>See the <a href=\"https://concourse-ci.org/gitlab-auth.html\">GitLab auth docs</a> for details.</p>\n<p>Concourse installations which do not configure the GitLab auth connector are not affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Concourse <a href=\"https://github.com/concourse/concourse/releases/tag/v6.3.1\">v6.3.1</a> and <a href=\"https://github.com/concourse/concourse/releases/tag/v6.4.1\">v6.4.1</a> were both released with a fix on August 4th, 2020.</p>\n<p>Both versions change the GitLab connector to use the username, rather than the full name. This was always the intent, and the previous behavior was originally reported as a bug (concourse/dex#7) prior to being reported as a security issue.</p>\n<p>Any Concourse teams which configure GitLab users will have to switch each user from their full name to their username upon upgrading to these versions.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>GitLab groups do not have this vulnerability, so GitLab users may be moved into groups which are then configured in the Concourse team.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li>concourse/dex#12: PR with the fix</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, you may reach us privately at <a href=\"mailto:concourseteam+security@gmail.com\">concourseteam+security@gmail.com</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj\">https://github.com/concourse/concourse/security/advisories/GHSA-627p-rr78-99rj</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2020-5415\">https://nvd.nist.gov/vuln/detail/CVE-2020-5415</a></li>\n<li><a href=\"https://tanzu.vmware.com/security/cve-2020-5415\">https://tanzu.vmware.com/security/cve-2020-5415</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-627p-rr78-99rj\">https://github.com/advisories/GHSA-627p-rr78-99rj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-627p-rr78-99rj",
            "title": "[github.com/concourse/concourse] GitLab auth uses full name instead of username as user ID, allowing impersonation",
            "date_modified": "2021-12-20T17:56:03.000Z",
            "date_published": "2021-12-20T17:56:03.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-627p-rr78-99rj"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>This affects uses who are using nginx ngx_http_auth_request_module with Authelia, it allows a malicious individual who crafts a malformed HTTP request to bypass the authentication mechanism. It additionally could theoretically affect other proxy servers, but all of the ones we officially support except nginx do not allow malformed URI paths.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem is rectified entirely in v4.29.3. As this patch is relatively straightforward we can back port this to any version upon request. Alternatively we are supplying a git patch to 4.25.1 which should be relatively straightforward to apply to any version, the git patches for specific versions can be found below.</p>\n<details><summary>Patch for 4.25.1:</summary><p>\n\n</p><pre><code class=\"language-patch\">From ca22f3d2c44ca7bef043ffbeeb06d6659c1d550f Mon Sep 17 00:00:00 2001\nFrom: James Elliott &lt;james-d-elliott@users.noreply.github.com&gt;\nDate: Wed, 19 May 2021 12:10:13 +1000\nSubject: [PATCH] fix(handlers): verify returns 200 on malformed request\n\nThis is a git patch for commit at tag v4.25.1 to address a potential method to bypass authentication in proxies that forward malformed information to Authelia in the forward auth process. Instead of returning a 200 this ensures that Authelia returns a 401 when this occurs.\n---\n internal/handlers/handler_verify.go | 4 +++-\n 1 file changed, 3 insertions(+), 1 deletion(-)\n\ndiff --git a/internal/handlers/handler_verify.go b/internal/handlers/handler_verify.go\nindex 65c064ce..4dd9702d 100644\n--- a/internal/handlers/handler_verify.go\n+++ b/internal/handlers/handler_verify.go\n@@ -396,7 +396,9 @@ func VerifyGet(cfg schema.AuthenticationBackendConfiguration) middlewares.Reques\n         targetURL, err := getOriginalURL(ctx)\n \n         if err != nil {\n-            ctx.Error(fmt.Errorf(\"Unable to parse target URL: %s\", err), operationFailedMessage)\n+            ctx.Logger.Error(fmt.Errorf(\"Unable to parse target URL: %s\", err))\n+            ctx.ReplyUnauthorized()\n+\n             return\n         }\n \n-- \n2.31.1\n</code></pre>\n<p></p></details>\n\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The most relevant workaround is upgrading. <strong>If you need assistance with an upgrade please contact us on <a href=\"https://riot.im/app/#/room/#authelia:matrix.org\">Matrix</a> or <a href=\"https://discord.authelia.com\">Discord</a>.</strong> Please just let us know you're needing help upgrading to above 4.29.2. </p>\n<p>You can add an block which fails requests that contains a malformed URI in the internal location block. We have crafted one that should work in most instances, it basically checks no chars that are required to be URL-encoded for either the path or the query are in the URI. Basically this regex checks that the characters between the square braces are the only characters in the $request_uri header, if they exist, it returns a HTTP 401 status code. The characters in the regex match are tested to not cause a parsing error that would result in a failure, however they are not exhaustive since query strings seem to not always conform to the RFC.</p>\n<details><summary>authelia.conf:</summary><p>\n\n</p><pre><code class=\"language-nginx\">location /authelia {\n    internal;\n    # **IMPORTANT**\n    # This block rejects requests with a 401 which contain characters that are unable to be parsed.\n    # It is necessary for security prior to v4.29.3 due to the fact we returned an invalid code in the event of a parser error.\n    # You may comment this section if you're using Authelia v4.29.3 or above. We strongly recommend upgrading.\n    # RFC3986: http://tools.ietf.org/html/rfc3986\n    # Commentary on RFC regarding Query Strings: https://www.456bereastreet.com/archive/201008/what_characters_are_allowed_unencoded_in_query_strings/\n    if ($request_uri ~ [^a-zA-Z0-9_+-=\\!@$%&amp;*?~.:#'\\;\\(\\)\\[\\]]) {\n        return 401;\n    }\n\n    # Include the remainder of the block here. \n}\n</code></pre>\n<p></p></details>\n\n<h3 id=\"discovery\">Discovery</h3>\n<p>This issue was discovered by:</p>\n<p>Siemens Energy\nCybersecurity Red Team</p>\n<ul>\n<li>Silas Francisco</li>\n<li>Ricardo Pesqueira</li>\n</ul>\n<h3 id=\"identifying-active-exploitation-of-the-vulnerability\">Identifying active exploitation of the vulnerability</h3>\n<p>The following regex should match log entries that are an indication of the vulnerability being exploited:</p>\n<pre><code class=\"language-regex\">level=error msg=\"Unable to parse target URL: Unable to parse URL (extracted from X-Original-URL header)?.*?: parse.*?net/url:.*github\\.com/authelia/authelia/internal/handlers/handler_verify\\.go\n</code></pre>\n<p>Example log entry <em><strong>with</strong></em> X-Original-URL configured:</p>\n<pre><code class=\"language-log\">time=\"2021-05-21T16:31:15+10:00\" level=error msg=\"Unable to parse target URL: Unable to parse URL extracted from X-Original-URL header: parse \\\"https://example.com/\": net/url: invalid control character in URL\" method=GET path=/api/verify remote_ip=192.168.1.10 stack=\"github.com/authelia/authelia/internal/middlewares/authelia_context.go:65 (*AutheliaCtx).Error\\ngithub.com/authelia/authelia/internal/handlers/handler_verify.go:431     VerifyGet.func1\\ngithub.com/authelia/authelia/internal/middlewares/authelia_context.go:50 AutheliaMiddleware.func1.1\\ngithub.com/fasthttp/router@v1.3.12/router.go:414                         (*Router).Handler\\ngithub.com/authelia/authelia/internal/middlewares/log_request.go:14      LogRequestMiddleware.func1\\ngithub.com/valyala/fasthttp@v1.24.0/server.go:2219                       (*Server).serveConn\\ngithub.com/valyala/fasthttp@v1.24.0/workerpool.go:223                    (*workerPool).workerFunc\\ngithub.com/valyala/fasthttp@v1.24.0/workerpool.go:195                    (*workerPool).getCh.func1\\nruntime/asm_amd64.s:1371                                                 goexit\"\n</code></pre>\n<p>Example log entry <em><strong>without</strong></em> X-Original-URL configured:</p>\n<pre><code class=\"language-log\">time=\"2021-05-21T16:30:17+10:00\" level=error msg=\"Unable to parse target URL: Unable to parse URL https://example.com/: parse \\\"https://example.com/\": net/url: invalid control character in URL\" method=GET path=/api/verify remote_ip=192.168.1.10 stack=\"github.com/authelia/authelia/internal/middlewares/authelia_context.go:65 (*AutheliaCtx).Error\\ngithub.com/authelia/authelia/internal/handlers/handler_verify.go:431     VerifyGet.func1\\ngithub.com/authelia/authelia/internal/middlewares/authelia_context.go:50 AutheliaMiddleware.func1.1\\ngithub.com/fasthttp/router@v1.3.12/router.go:414                         (*Router).Handler\\ngithub.com/authelia/authelia/internal/middlewares/log_request.go:14      LogRequestMiddleware.func1\\ngithub.com/valyala/fasthttp@v1.24.0/server.go:2219                       (*Server).serveConn\\ngithub.com/valyala/fasthttp@v1.24.0/workerpool.go:223                    (*workerPool).workerFunc\\ngithub.com/valyala/fasthttp@v1.24.0/workerpool.go:195                    (*workerPool).getCh.func1\\nruntime/asm_amd64.s:1371                                                 goexit\"\n</code></pre>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue at <a href=\"https://github.com/authelia/authelia/issues\">authelia</a></li>\n<li>Email us at <a href=\"mailto:security@authelia.com\">security@authelia.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/authelia/authelia/security/advisories/GHSA-68wm-pfjf-wqp6\">https://github.com/authelia/authelia/security/advisories/GHSA-68wm-pfjf-wqp6</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-32637\">https://nvd.nist.gov/vuln/detail/CVE-2021-32637</a></li>\n<li><a href=\"https://github.com/authelia/authelia/commit/c62dbd43d6e69ae81530e7c4f8763857f8ff1dda\">https://github.com/authelia/authelia/commit/c62dbd43d6e69ae81530e7c4f8763857f8ff1dda</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-68wm-pfjf-wqp6\">https://github.com/advisories/GHSA-68wm-pfjf-wqp6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-68wm-pfjf-wqp6",
            "title": "[github.com/authelia/authelia/v4] Authentication bypassed with malformed request URI on nginx",
            "date_modified": "2021-12-20T16:57:16.000Z",
            "date_published": "2021-12-20T16:57:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-68wm-pfjf-wqp6"
            }
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Inline scripts are executed when Javascript is parsed via a paste action.</p>\n<ol>\n<li>Open <a href=\"https://watch.owncast.online/\">https://watch.owncast.online/</a></li>\n<li>Copy and then paste <code>&lt;img src=null onerror=alert('hello')&gt;</code> into the\nchat field.</li>\n<li>An alert should pop up.</li>\n</ol>\n<h3 id=\"patches\">Patches</h3>\n<pre><code>    ⋮ 13 │    // Content security policy\n    ⋮ 14 │    csp := []string{\n    ⋮ 15 │        \"script-src 'self' 'sha256-2HPCfJIJHnY0NrRDPTOdC7AOSJIcQyNxzUuut3TsYRY='\",\n    ⋮ 16 │        \"worker-src 'self' blob:\", // No single quotes around blob:\n    ⋮ 17 │    }\n</code></pre>\n<p>Will be patched in 0.0.9 by blocking <code>unsafe-inline</code> Content Security Policy and specifying the <code>script-src</code>.  The <code>worker-src</code> is required to be set to <code>blob</code> for the video player.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/owncast/owncast/issues\">owncast/owncast</a></li>\n<li>Email us at <a href=\"mailto:gabek@real-ity.com\">gabek@real-ity.com</a></li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/owncast/owncast/security/advisories/GHSA-2hfj-cxw7-g45p\">https://github.com/owncast/owncast/security/advisories/GHSA-2hfj-cxw7-g45p</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-39183\">https://nvd.nist.gov/vuln/detail/CVE-2021-39183</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2hfj-cxw7-g45p\">https://github.com/advisories/GHSA-2hfj-cxw7-g45p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2hfj-cxw7-g45p",
            "title": "[github.com/owncast/owncast] Unsafe inline XSS in pasting DOM element into chat",
            "date_modified": "2022-01-04T18:54:06.000Z",
            "date_published": "2021-12-14T21:48:16.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2hfj-cxw7-g45p"
            }
        }
    ]
}