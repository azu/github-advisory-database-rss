{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"description\">Description</h3>\n<p>The summary is that the proof of knowledge associated to a commitment is crucial to bind the commitment to the actual circuit variables that were supposed to be committed. However, the same σ is used for all proofs of knowledge for the commitments, which allows mixing between them, making it possible to fix the value of all but one commitment before choosing the circuit variable assignments.</p>\n<p>In more detail:\nTo simplify notation, let us consider the case of two commitments, each to only a single variable. Let's say the basis elements for those commitments are <code>K_0</code> and <code>K_1</code>. Then the proving key will contain <code>K_0</code> and <code>K_1</code>, and also <code>σ*K_0</code> and <code>σ*K_1</code> for the proof of knowledge. The honest prover assigning a to the first circuit variable and b to the second will then produce commitments\n<code>D_0 = a*K_0</code>\n<code>D_1 = b*K_1</code>\nOut of the two D's, a challenge r for the commitment folding will be generated. The folded commitment will then be\n<code>D_folded = D_0 + r*D_1 = a*K_0 + r*b*K_1</code>\nThe honest prover will supply a fitting proof of knowledge\n<code>P = a*(σ*K_0) + r*b*(σ*K_1)</code></p>\n<p>Now the verifier will only use all of this in two ways:</p>\n<ol>\n<li>In the check of the Groth16 proof itself, where only the sum <code>D_0 + D_1</code> is used.</li>\n<li>In the proof of knowledge check, where it will be verified that P is indeed <code>σ*(D_0 + r*D_1)</code>, with r calculated from <code>D_0</code> and <code>D_1</code> as before.</li>\n</ol>\n<p>This has the following implications. In the following, a malicious prover's points will have an apostrophe appended, and we keep <code>D_0</code> etc. for the legitimate values:</p>\n<ol>\n<li>A malicious prover is only forced to provide <code>D'_0</code> and <code>D'_1</code> such that the sum is correct. So they can use arbitrary <code>D'_0</code> as long as they set <code>D'_1 = D_0 + D_1 - D'_0</code>.</li>\n<li>After choosing <code>D'_0</code> and <code>D'_1</code>, the prover can always calculate r. Evaluating <code>σ*(D'_0 + r*D'_1)</code> is then possible as long as both <code>D'_0</code> and <code>D'_1</code> are linear combinations of basis elements for which σ times that basis element is known. In particular, this works as long as <code>D'_0</code> and <code>D'_1</code> are linear combinations of <code>K_0</code> and <code>K_1</code>.</li>\n</ol>\n<p>The upshot is that a malicious prover can choose arbitrary a' and b', and then set\n<code>D'_0 = a'*K_0 + b'*K_1</code>\n<code>D'_1 = (a - a')*K_0 + (b - b')*K_1</code>\nThen they calculate r for this, and set\n<code>P = (a' + r*(a-a'))*(σ*K_0) + (b' + r*(b-b'))*(σ*K_1)</code>\nThis will then be accepted as a valid proof. Yet the first commitment point can be chosen completely independently of a and b, so in particular the malicious prover can use a constant for this, so that they will know the in-circuit challenge that will be added to the public inputs before they have to choose the witness assignments. For most use cases of such challenges (for proving things with Fiat-Shamir, random linear combinations etc.) this causes a critical soundness problem.</p>\n<p>The problem generalizes to more than two commitments and commitments to more than one circuit variable each; one can freely choose all but one commitment as arbitrary linear combinations of the basis elements for all commitments, and then must choose the one remaining commitment in such a way that the sum is correct.</p>\n<p>The root cause of the issue is that the σ used for the proofs of knowledge is the same, allowing to mix between the basis elements, as one has σ times them available for all of them.\nSo the fix is to have a separate σ for each commitment. So in our example above, the proving key would have the basis elements <code>K_0</code> and <code>K_1</code>, and for the proofs of knowledge now <code>σ_0*K_0</code> and <code>σ_1*K_1</code>. Folding the commitments would not be possible in the same way now, so the verifier will have to do more pairings. The prover could still provide a folded proof of knowledge however. With\n<code>D_0 = a*K_0</code>\n<code>D_1 = b*K_1</code>\nthe proof of knowledge would be\n<code>P = a*(σ_0*K_0) + r*b*(σ_1*K_1)</code>\nFor later, let us use notation for the unfolded proofs of knowledge\n<code>P_0 = a*(σ_0*K_0)</code>\n<code>P_1 = b*(σ_1*K_1)</code>\nso that\n<code>P = P_0 + r*P_1</code></p>\n<p>The verifying key would need <code>G</code> and <code>σ_0*G</code> and <code>σ_1*G</code>. To check the two unfolded proofs of knowledge would be the checks\n<code>e(P_0, G) = e(D_0, σ_0*G)</code>\n<code>e(P_1, G) = e(D_1, σ_1*G)</code>\nAs r is a challenge derived from D_0 and D_1, we may instead check\n<code>e(P_0, G) + r*e(P_1, G) = e(D_0, σ_0*G) + r*e(D_1, σ_1*G)</code>\nThe left hand side is\n<code>e(P_0, G) + r*e(P_1, G) = e(P_0 + r*P_1, G) = e(P, G)</code>\nSo the prover can just provide P and then the verifier checks\n<code>e(P, G) = e(D_0, σ_0*G) + r*e(D_1, σ_1*G)</code>\nUnfortunately, the right hand side can't be folded as before, as there isn't a side of the pairing that is kept constant between the pairings as before. So the verifier will need to have a pairing for each commitment on the right hand side.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>It is a soundness issue - in case of multiple commitments used inside the circuit the prover is able to choose all but the last commitment. As we use the commitments for optimized non-native multiplication, lookup checks etc. as random challenges, then it could impact the soundness of the whole circuit.</p>\n<p>However, using multiple commitments has been discouraged due to the additional cost to the verifier and it has not been supported in the recursive in-circuit Groth16 verifier and Solidity verifier. So we expect the impact of the issue be very small - only for the users who have implemented the native Groth16 verifier or are using it with multiple commitments. We do not have information of such users.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The issue has been patched in e7c66b000454f4d2a4ae48c005c34154d4cfc2a2</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The recommendation has been to use only a single commitment and then derive in-circuit commitments as needed using <a href=\"https://pkg.go.dev/github.com/consensys/gnark/std/multicommit\">std/multicommit</a> package.</p>\n<h3 id=\"references\">References</h3>\n<p>See the correspondence above.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Consensys/gnark/security/advisories/GHSA-q3hw-3gm4-w5cr\">https://github.com/Consensys/gnark/security/advisories/GHSA-q3hw-3gm4-w5cr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45039\">https://nvd.nist.gov/vuln/detail/CVE-2024-45039</a></li>\n<li><a href=\"https://github.com/Consensys/gnark/commit/e7c66b000454f4d2a4ae48c005c34154d4cfc2a2\">https://github.com/Consensys/gnark/commit/e7c66b000454f4d2a4ae48c005c34154d4cfc2a2</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q3hw-3gm4-w5cr\">https://github.com/advisories/GHSA-q3hw-3gm4-w5cr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q3hw-3gm4-w5cr",
            "title": "[github.com/consensys/gnark] gnark's Groth16 commitment extension unsound for more than one commitment",
            "date_modified": "2024-09-06T19:53:21.000Z",
            "date_published": "2024-09-06T19:53:20.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q3hw-3gm4-w5cr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>This report concerns the Groth16 prover when used with commitments (as in <code>frontend.Committer</code>). To simplify exposition of the issue, I will focus on the case of a single commitment, to only private witnesses. But the issue should be present whenever commitments are used that include private witnesses.</p>\n<blockquote>\n</blockquote>\n<p>The commitment to private witnesses <code>w_i</code> is computed as</p>\n<pre><code>c = sum_i w_i * b_i\n</code></pre>\n<p>where <code>b_i</code> would be <code>ProvingKey.CommitmentKeys[0].Basis[i]</code> in the code.</p>\n<p>While this is a binding commitment, it is not hiding. In practice, an adversary will know the points <code>b_i</code>, as they are part of the proving key, and can verify correctness of a guess for the values of <code>w_i</code> by computing <code>c'</code> as the right hand side of the above formula, and checking whether <code>c'</code> is equal to <code>c</code>. I attach a proof of concept that demonstrates this.</p>\n<p>This breaks the perfect zero-knowledge property of Groth16, so the Groth16 scheme using commitments to private witnesses as implemented by gnark fails to be a zk-SNARK.</p>\n<p>The code indicates that the extension to Groth16 given by the commitments follows the paper \"Recursion over Public-Coin Interactive Proof Systems; Faster Hash Verification\" by Alexandre Belling, Azam Soleimanian, and Olivier Begassat. In that paper, it seems that commitments are applied to what were originally public inputs, which are moved to private witnesses for efficiency reasons. In any case, that paper does not discuss any hiding/privacy/zero-knowledge properties of their protocols.</p>\n<p>So for the use-cases envisioned by that paper, having the commitment not be hiding and losing zero-knowledge of Groth16 might be adequate. However, the documentation by gnark does not make clear that committing to private witnesses loses the zero-knowledge property. The documentation for <code>frontend.Committer</code> does not mention this, and the following snippet from <code>std/multicommit/doc_test.go</code>, where private witness variables are named <code>Secrets</code> and are committed, seems to actively suggest that committed witnesses are still private.</p>\n<pre><code class=\"language-go\">// MultipleCommitmentCircuit is an example circuit showing usage of multiple\n// independent commitments in-circuit.\ntype MultipleCommitmentsCircuit struct {\n    Secrets [4]frontend.Variable\n}\n\nfunc (c *MultipleCommitmentsCircuit) Define(api frontend.API) error {\n    // first callback receives first unique commitment derived from the root commitment\n    multicommit.WithCommitment(api, func(api frontend.API, commitment frontend.Variable) error {\n        // compute (X-s[0]) * (X-s[1]) for a random X\n        res := api.Mul(api.Sub(commitment, c.Secrets[0]), api.Sub(commitment, c.Secrets[1]))\n        api.AssertIsDifferent(res, 0)\n        return nil\n    }, c.Secrets[:2]...)\n   // ...\n</code></pre>\n<p>Thus it seems to me that the intention likely was (and users will be expecting) that gnark's implementation of Groth16 with these commitments should still have zero-knowledge and that the commitments should be hiding.</p>\n<p>The way to fix this is likely to adjust the commitment to be hiding the way that is done in the LegoSNARK paper (<a href=\"https://eprint.iacr.org/2019/142.pdf\">https://eprint.iacr.org/2019/142.pdf</a>). To expand:</p>\n<p>First, let me fix some notation.</p>\n<p>Currently, the verifying key has two points on G2 used for checking the proof of knowledge for the commitment: <code>g</code> and <code>g'=-1/σ * g</code> (in the code: <code>VerifyingKey.CommitmentKey.G</code> and <code>VerifyingKey.CommitmentKey.GRootSigmaNeg</code>).\nThe commitment itself is then <code>c = sum_i w_i * b_i</code>, where <code>b_i</code> are on G1, and the proof of knowledge associated to <code>c</code> is calculated as <code>pok = sum_i w_i * b'_i</code>, where <code>b'_i = σ*b_i</code> (in the code <code>b_i</code> and <code>b'_i</code> are <code>ProvingKey.CommitmentKeys.Basis[0][i]</code> and <code>ProvingKey.CommitmentKeys.BasisExpSigma[0][i]</code>). The proof of knowledge is then verified by checking <code>e(c, g) + e(pok, g') = 0</code> (I am using additive notation throughout here).</p>\n<p>The Groth16 proof is verified by checking</p>\n<pre><code>e(Krs, -[δ]₂) + e(c, -[γ]₂) + e(term involving public inputs, -[γ]₂) + other terms = 0\n</code></pre>\n<p>The construction ccGro16 from the LegoSNARK paper (page 73 in <a href=\"https://eprint.iacr.org/2019/142.pdf\">https://eprint.iacr.org/2019/142.pdf</a>) is a similar construction. They do not have a proof of knowledge accompanying the commitment because they are considering the case where there are no public inputs. However, they claim that their scheme is zero-knowledge, and the crucial difference for this is that their commitment has an extra blinding term as is usual for Pedersen commitments. Concretely, it is of the form:</p>\n<pre><code>c_new = sum_i w_i * b_i + v*[η/γ]₁\n</code></pre>\n<p>where <code>[η/γ]₁</code> is a new element of G1 that is part of the proving key, with <code>η</code> a new toxic waste field element. The value of <code>v</code> is randomly chosen by the prover.</p>\n<p>When adding this additional term to <code>c</code>, then to make the proof verification still succeeds, the proof point <code>Krs</code> is changed accordingly:</p>\n<pre><code>Krs_new = Krs_old -  v*[η/δ]₁\n</code></pre>\n<p>where <code>[η/δ]₁</code> is another new element of G1 that is part of the proving key. As <code>e([η/γ]₁, -[γ]₂) = e([η/δ]₁, -[δ]₂)</code>, the contributions from the new terms cancel each other in the proof verification pairing check.</p>\n<p>This modification should ensure that the commitment is hiding.</p>\n<p>The proof of knowledge would also need to be adapted accordingly, with</p>\n<pre><code>pok = sum_i w_i * b'_i + v*[σ*η/γ]₁\n</code></pre>\n<p>where <code>[σ*η/γ]₁</code> is another point of G1 to add to the proving key.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>The vulnerability affects only Groth16 proofs with commitments. Notably, PLONK proofs are not affected.</p>\n<p>The vulnerability affects the zero-knowledge property of the proofs - in case the witness (secret or internal) values are small, then the attacker may be able to enumerate all possible choices to deduce the actual value. If the possible choices for the variables to be committed is large or there are many values committed, then it would be computationally infeasible to enumerate all valid choices.</p>\n<p>It doesn't affect the completeness/soundness of the proofs.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The vulnerability has been fixed in <a href=\"https://github.com/Consensys/gnark/pull/1245\">https://github.com/Consensys/gnark/pull/1245</a>. Corresponding commit on the master branch <a href=\"https://github.com/Consensys/gnark/commit/afda68a38acca37becb8ba6d8982d03fee9559a0\">https://github.com/Consensys/gnark/commit/afda68a38acca37becb8ba6d8982d03fee9559a0</a>.</p>\n<p>The patch to fix the issue is to add additional randomized value to the list of committed value at proving time to mask the rest of the values which were committed.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The user can manually commit to a randomized value.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/Consensys/gnark/security/advisories/GHSA-9xcg-3q8v-7fq6\">https://github.com/Consensys/gnark/security/advisories/GHSA-9xcg-3q8v-7fq6</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45040\">https://nvd.nist.gov/vuln/detail/CVE-2024-45040</a></li>\n<li><a href=\"https://github.com/Consensys/gnark/pull/1245\">https://github.com/Consensys/gnark/pull/1245</a></li>\n<li><a href=\"https://github.com/Consensys/gnark/commit/afda68a38acca37becb8ba6d8982d03fee9559a0\">https://github.com/Consensys/gnark/commit/afda68a38acca37becb8ba6d8982d03fee9559a0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9xcg-3q8v-7fq6\">https://github.com/advisories/GHSA-9xcg-3q8v-7fq6</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9xcg-3q8v-7fq6",
            "title": "[github.com/consensys/gnark] gnark commitments to private witnesses in Groth16 as implemented break zero-knowledge property",
            "date_modified": "2024-09-06T19:52:45.000Z",
            "date_published": "2024-09-06T19:40:01.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9xcg-3q8v-7fq6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"context\">Context</h3>\n<p>ICS has the following four messages that enable validators on the provider chain to perform different actions:</p>\n<ul>\n<li><code>MsgOptIn</code> -- adds a validator to the consumer chain’s active set</li>\n<li><code>MsgOptOut</code> -- removes a validator from the consumer chain’s active set </li>\n<li><code>MsgAssignConsumerKey</code> -- changes the consensus key used for a validator’s operations on a consumer chain</li>\n<li><code>MsgSetConsumerCommissionRate</code> -- sets a validator’s consumer-specific commission rate</li>\n</ul>\n<p>Normally, only the respective validators are allowed to perform these actions. </p>\n<h3 id=\"issue\">Issue</h3>\n<p>The upgrade to SDK 0.50, introduced a <a href=\"https://docs.cosmos.network/v0.50/build/building-modules/protobuf-annotations#signer\">signer</a> field to these messages. This field is used to authenticate the user sending the message to the system. However, there was no validation on the ICS side to check if the signer matches the provider address.  </p>\n<p>As a result, any user could opt-in, opt-out, change the commission rate, or change what public key a validator uses on a consumer chain. </p>\n<p>For more context, check out the code:</p>\n<ul>\n<li>proto files <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/proto/interchain_security/ccv/provider/v1/tx.proto#L52</a></li>\n<li>message validation <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/types/msg.go#L106</a></li>\n<li>message handling <a href=\"https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52\">https://github.com/cosmos/interchain-security/blob/v5.1.1/x/ccv/provider/keeper/msg_server.go#L52</a></li>\n</ul>\n<h3 id=\"severity-assessment\">Severity assessment</h3>\n<p>The severity assessment is based on <a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">this framework</a>. </p>\n<p><strong>Potential impact:</strong> Catastrophic </p>\n<ul>\n<li>By changing consumer keys for 1/3+ of a consumer chain's validator set, any user could cause a consumer chain to halt. Given that the consumer is down, the provider will jail provider validators for consumer downtime, so this exploit would not have impacted the provider directly. Consumer chain halts would need to be addressed by a provider-side patch.</li>\n<li>By changing consumer keys on a consumer node, double signing, and submitting evidence back to the provider, any user could tombstone any provider validator. This would cause the provider's active set to change. At scale, this exploit could be applied to all active provider validators and a well-funded attacker could then run their own nodes and take over consensus on the provider and on consumer chains.</li>\n</ul>\n<p><strong>Likelihood:</strong> Rare</p>\n<ul>\n<li>The bug was discovered internally. There is no evidence that any external party has identified this vulnerability. </li>\n<li>The bug has been live for two weeks with no issues. </li>\n<li>All four message types are ones that only validators use, and rarely use in daily operations.</li>\n<li>In the Cosmos Hub’s recent history (May - Aug), there has been only one instance of any of these message types, which was performed in accordance with chain rules.</li>\n<li>The catastrophic exploits (such as tombstoning the entire validator set of the provider) are also extremely complex. They involve several operations that are not well-understood by many people, and the entire exploit must occur quickly and at-scale to avoid other node operators responding defensively.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g\">https://github.com/cosmos/interchain-security/security/advisories/GHSA-7q74-g774-7x3g</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7q74-g774-7x3g\">https://github.com/advisories/GHSA-7q74-g774-7x3g</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g",
            "title": "[github.com/cosmos/interchain-security/v5] Interchain Security: The signers of ICS messages do not need to match the provider address ",
            "date_modified": "2024-09-05T21:19:37.000Z",
            "date_published": "2024-09-05T21:19:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7q74-g774-7x3g"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability exists in stripe-cli versions 1.11.1 and higher where a plugin package containing a manifest with a malformed plugin shortname installed using the --archive-url or --archive-path flags can overwrite arbitrary files.</p>\n<p>The update addresses the path traversal vulnerability by removing the ability to install plugins from an archive URL or path.</p>\n<p>There has been no evidence of exploitation of this vulnerability.</p>\n<h3 id=\"recommendation\">Recommendation</h3>\n<p>Upgrade to stripe-cli v1.21.3.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>Email us at <a href=\"mailto:security@stripe.com\">security@stripe.com</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/stripe/stripe-cli/security/advisories/GHSA-fv4g-gwpj-74gr\">https://github.com/stripe/stripe-cli/security/advisories/GHSA-fv4g-gwpj-74gr</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45401\">https://nvd.nist.gov/vuln/detail/CVE-2024-45401</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fv4g-gwpj-74gr\">https://github.com/advisories/GHSA-fv4g-gwpj-74gr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fv4g-gwpj-74gr",
            "title": "[github.com/stripe/stripe-cli] Path traversal vulnerability in stripe-cli ",
            "date_modified": "2024-09-05T18:39:39.000Z",
            "date_published": "2024-09-05T16:40:41.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fv4g-gwpj-74gr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>runc 1.1.13 and earlier as well as 1.2.0-rc2 and earlier can be tricked into\ncreating empty files or directories in arbitrary locations in the host\nfilesystem by sharing a volume between two containers and exploiting a race\nwith os.MkdirAll. While this can be used to create empty files, existing\nfiles <strong>will not</strong> be truncated.</p>\n<p>An attacker must have the ability to start containers using some kind of custom\nvolume configuration. Containers using user namespaces are still affected, but\nthe scope of places an attacker can create inodes can be significantly reduced.\nSufficiently strict LSM policies (SELinux/Apparmor) can also in principle block\nthis attack -- we suspect the industry standard SELinux policy may restrict\nthis attack's scope but the exact scope of protection hasn't been analysed.</p>\n<p>This is exploitable using runc directly as well as through Docker and\nKubernetes.</p>\n<p>The CVSS score for this vulnerability is\nCVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N (Low severity, 3.6).</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Using user namespaces restricts this attack fairly significantly such that the\nattacker can only create inodes in directories that the remapped root\nuser/group has write access to. Unless the root user is remapped to an actual\nuser on the host (such as with rootless containers that don't use\n/etc/sub[ug]id), this in practice means that an attacker would only be able to\ncreate inodes in world-writable directories.</p>\n<p>A strict enough SELinux or AppArmor policy could in principle also restrict the\nscope if a specific label is applied to the runc runtime, though we haven't\nthoroughly tested to what extent the standard existing policies block this\nattack nor what exact policies are needed to sufficiently restrict this attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed in runc v1.1.14 and v1.2.0-rc3.</p>\n<ul>\n<li><code>main</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n</ul>\n</li>\n<li><code>release-1.1</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Rodrigo Campos Catelin (@rata) and Alban Crequy (@alban) from\nMicrosoft for discovering and reporting this vulnerability.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45310\">https://nvd.nist.gov/vuln/detail/CVE-2024-45310</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv",
            "title": "[github.com/opencontainers/runc] runc can be confused to create empty files/directories on the host",
            "date_modified": "2024-09-05T14:04:57.000Z",
            "date_published": "2024-09-03T19:49:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>sigstore-go is susceptible to a denial of service attack when a verifier is provided a maliciously crafted Sigstore Bundle containing large amounts of verifiable data, in the form of signed transparency log entries, RFC 3161 timestamps, and attestation subjects. The verification of these data structures is computationally expensive. This can be used to consume excessive CPU resources, leading to a denial of service attack. TUF's security model labels this type of vulnerability an \"Endless data attack,\" and can lead to verification failing to complete and disrupting services that rely on sigstore-go for verification.</p>\n<p>The vulnerable loops are in the verification functions in the package <code>github.com/sigstore/sigstore-go/pkg/verify</code>. The first is the DSSE envelope verification loop in <code>verifyEnvelopeWithArtifact</code>, which decodes all the digests in an attestation can be found here:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193</a></p>\n<p>The next loop is in the <code>VerifyArtifactTransparencyLog</code> function, which verifies all the signed entries in a bundle:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178</a></p>\n<p>The next loop is the <code>VerifyTimestampAuthority</code> function, which verifies all the RFC 3161 timestamps in a bundle:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68</a></p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability is addressed with sigstore-go 0.6.1, which adds hard limits to the number of verifiable data structures that can be processed in a bundle. Verification will fail if a bundle has data that exceeds these limits. The limits are:</p>\n<ul>\n<li>32 signed transparency log entries</li>\n<li>32 RFC 3161 timestamps</li>\n<li>1024 attestation subjects</li>\n<li>32 digests per attestation subject</li>\n</ul>\n<p>These limits are intended to be high enough to accommodate the vast majority of use cases, while preventing the verification of maliciously crafted bundles that contain large amounts of verifiable data.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The best way to mitigate the risk is to upgrade to sigstore-go 0.6.1 or later. Users who are vulnerable but unable to quickly upgrade may consider adding manual bundle validation to enforce limits similar to those in the referenced patch prior to calling sigstore-go's verification functions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/sigstore/sigstore-go/security/advisories/GHSA-cq38-jh5f-37mq\">https://github.com/sigstore/sigstore-go/security/advisories/GHSA-cq38-jh5f-37mq</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/commit/01e70e89e58226286d7977b4dba43b6be472b12c\">https://github.com/sigstore/sigstore-go/commit/01e70e89e58226286d7977b4dba43b6be472b12c</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45395\">https://nvd.nist.gov/vuln/detail/CVE-2024-45395</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cq38-jh5f-37mq\">https://github.com/advisories/GHSA-cq38-jh5f-37mq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cq38-jh5f-37mq",
            "title": "[github.com/sigstore/sigstore-go] sigstore-go has an unbounded loop over untrusted input can lead to endless data attack",
            "date_modified": "2024-09-04T21:34:55.000Z",
            "date_published": "2024-09-04T20:18:18.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cq38-jh5f-37mq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"summary\">Summary</h2>\n<p>A vulnerability has been identified in Nuclei's template signature verification system that could allow an attacker to bypass the signature check and possibly execute malicious code via custom code template.</p>\n<h2 id=\"affected-component\">Affected Component</h2>\n<p>The vulnerability is present in the template signature verification process, specifically in the <code>signer</code> package.</p>\n<h2 id=\"description\">Description</h2>\n<p>The vulnerability stems from a discrepancy between how the signature verification process and the YAML parser handle newline characters, combined with the way multiple signatures are processed. This allows an attacker to inject malicious content into a template while maintaining a valid signature for the benign part of the template.</p>\n<h3 id=\"affected-users\">Affected Users</h3>\n<ol>\n<li><strong>CLI Users:</strong> Those executing <strong>custom code templates</strong> from unverified sources. This includes templates authored by third parties or obtained from unverified repositories.</li>\n<li><strong>SDK Users:</strong> Developers integrating Nuclei into their platforms, particularly if they permit the execution of <strong>custom code templates</strong> by end-users.</li>\n</ol>\n<blockquote>\n<p>[!NOTE]\nCode templates are disabled as default, users have to explicitly enable with <code>-code</code> option. </p>\n</blockquote>\n<h2 id=\"proof-of-concept\">Proof of Concept</h2>\n<pre><code class=\"language-yaml\">id: example-template\ninfo:\n  name: Example Template\n# Other benign content...\n# digest: &lt;valid_signature_for_benign_content&gt;\n# digest: &lt;another_signature&gt;\\r\ncode:\\r\n  - engine:\\r\n      - sh\\r\n      - bash\\r\n    source: |\\r\n      id\\r\n</code></pre>\n<h3 id=\"patches\">Patches</h3>\n<ol>\n<li>The vulnerability is addressed in Nuclei v3.3.2 Users are strongly recommended to update to this version to mitigate the security risk.</li>\n<li>Fix reference - <a href=\"https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a\">https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a</a></li>\n</ol>\n<h3 id=\"mitigation\">Mitigation</h3>\n<ul>\n<li><strong>Immediate Upgrade</strong>: The primary recommendation is to upgrade to Nuclei v3.2.0, where the vulnerability has been patched.</li>\n<li><strong>Avoid Unverified Templates</strong>: As an interim measure, users should refrain from using custom templates if unable to upgrade immediately. Only trusted, <a href=\"https://github.com/projectdiscovery/nuclei-templates\">verified templates</a> should be executed.</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If you are unable to upgrade nuclei, disable running custom code templates as workaround.</p>\n<h2 id=\"acknowledgments\">Acknowledgments</h2>\n<p>We would like to thank <a href=\"https://github.com/GuyGoldenberg\">Guy Goldenberg</a> from Wiz who reported this to us via our security email, <a href=\"mailto:security@projectdiscovery.io\">security@projectdiscovery.io</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-7h5p-mmpp-hgmm\">https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-7h5p-mmpp-hgmm</a></li>\n<li><a href=\"https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a\">https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43405\">https://nvd.nist.gov/vuln/detail/CVE-2024-43405</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7h5p-mmpp-hgmm\">https://github.com/advisories/GHSA-7h5p-mmpp-hgmm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7h5p-mmpp-hgmm",
            "title": "[github.com/projectdiscovery/nuclei] Nuclei Template Signature Verification Bypass",
            "date_modified": "2024-09-04T20:24:43.000Z",
            "date_published": "2024-09-04T17:38:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7h5p-mmpp-hgmm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"details\">Details</h3>\n<p>The <code>/api/v2/simulation</code> <a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87\">POST handler</a> allows users to create new simulation views from the contents of a user-specified file. This feature can be abused by an attacker to read arbitrary files from the Hoverfly server.</p>\n<pre><code class=\"language-go\"># https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/hoverfly_funcs.go#L186\nfunc (hf *Hoverfly) readResponseBodyFile(filePath string) (string, error) {\n    if filepath.IsAbs(filePath) {\n        return \"\", fmt.Errorf(\"bodyFile contains absolute path (%s). only relative is supported\", filePath)\n    }\n\n    fileContents, err := ioutil.ReadFile(filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath))\n    if err != nil {\n        return \"\", err\n    }\n\n    return string(fileContents[:]), nil\n}\n</code></pre>\n<p>Note that, although the code prevents absolute paths from being specified, an attacker can escape out of the <code>hf.Cfg.ResponsesBodyFilesPath</code> base path by using <code>../</code> segments and reach any arbitrary files.</p>\n<p>This issue was found using the <a href=\"https://codeql.github.com/codeql-query-help/go/go-path-injection/\">Uncontrolled data used in path expression CodeQL query for python</a>.</p>\n<h4 id=\"proof-of-concept\">Proof of Concept</h4>\n<p>Send the following <code>POST</code> request to read the <code>/etc/passwd</code> file:</p>\n<pre><code class=\"language-http\">POST /api/v2/simulation HTTP/1.1\nHost: localhost:8888\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 128\n\n{\"data\":{\"pairs\":[{\n\"request\":{},\"response\": {\n\"bodyFile\": \"../../../../../etc/passwd\"}} ]},\"meta\":{\"schemaVersion\":\"v5.2\"}}\n</code></pre>\n<p>Response will contain the Hoverfly's server <code>/etc/passwd</code></p>\n<pre><code>HTTP/1.1 200 OK\nContent-Type: application/json; charset=utf-8\nDate: Tue, 19 Dec 2023 20:59:16 GMT\nContent-Length: 1494\nConnection: close\n\n{\"data\":{\"pairs\":[{\"request\":{},\"response\":{\"status\":0,\"body\":\"root:x:0:0:root:/root:/bin/ash\\nbin:x:1:1:bin:/bin:/sbin/nologin\\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\\nadm:x:3:4:adm:/var/adm:/sbin/nologin\\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\\nsync:x:5:0:sync:/sbin:/bin/sync\\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\\nhalt:x:7:0:halt:/sbin:/sbin/halt\\nmail:x:8:12:mail:/var/mail:/sbin/nologin\\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\\noperator:x:11:0:operator:/root:/sbin/nologin\\nman:x:13:15:man:/usr/man:/sbin/nologin\\npostmaster:x:14:12:postmaster:/var/mail:/sbin/nologin\\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\\ngames:x:35:35:games:/usr/games:/sbin/nologin\\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\\nguest:x:405:100:guest:/dev/null:/sbin/nologin\\nnobody:x:65534:65534:nobody:/:/sbin/nologin\\n\",\"bodyFile\":\"../../../../../etc/passwd\",\"encodedBody\":false,\"templated\":false}}],\"globalActions\":{\"delays\":[],\"delaysLogNormal\":[]}},\"meta\":{\"schemaVersion\":\"v5.2\",\"hoverflyVersion\":\"v1.6.1\",\"timeExported\":\"2023-12-19T20:59:16Z\"}}\n</code></pre>\n<h4 id=\"impact\">Impact</h4>\n<p>This issue may lead to Information Disclosure.</p>\n<h4 id=\"remediation\">Remediation</h4>\n<p>The code is <a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/hoverfly_funcs.go#L186\">preventing absolute paths from being read</a>. Make sure the final path (<code>filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)</code>) is contained within the expected base path (<code>filepath.Join(hf.Cfg.ResponsesBodyFilesPath, \"/\")</code>)</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897\">https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45388\">https://nvd.nist.gov/vuln/detail/CVE-2024-45388</a></li>\n<li><a href=\"https://codeql.github.com/codeql-query-help/go/go-path-injection\">https://codeql.github.com/codeql-query-help/go/go-path-injection</a></li>\n<li><a href=\"https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3\">https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3</a></li>\n<li><a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87\">https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6xx4-x46f-f897\">https://github.com/advisories/GHSA-6xx4-x46f-f897</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6xx4-x46f-f897",
            "title": "[github.com/spectolabs/hoverfly] Hoverfly allows an arbitrary file read in the `/api/v2/simulation` endpoint (`GHSL-2023-274`)",
            "date_modified": "2024-09-03T21:01:54.000Z",
            "date_published": "2024-09-03T21:01:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6xx4-x46f-f897"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC’d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-8365\">https://nvd.nist.gov/vuln/detail/CVE-2024-8365</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices\">https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jjxf-26c9-77gm\">https://github.com/advisories/GHSA-jjxf-26c9-77gm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jjxf-26c9-77gm",
            "title": "[github.com/hashicorp/vault] Vault Leaks Client Token and Token Accessor in Audit Devices",
            "date_modified": "2024-09-04T17:02:28.000Z",
            "date_published": "2024-09-02T06:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jjxf-26c9-77gm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>runc 1.1.13 and earlier as well as 1.2.0-rc2 and earlier can be tricked into\ncreating empty files or directories in arbitrary locations in the host\nfilesystem by sharing a volume between two containers and exploiting a race\nwith os.MkdirAll. While this can be used to create empty files, existing\nfiles <strong>will not</strong> be truncated.</p>\n<p>An attacker must have the ability to start containers using some kind of custom\nvolume configuration. Containers using user namespaces are still affected, but\nthe scope of places an attacker can create inodes can be significantly reduced.\nSufficiently strict LSM policies (SELinux/Apparmor) can also in principle block\nthis attack -- we suspect the industry standard SELinux policy may restrict\nthis attack's scope but the exact scope of protection hasn't been analysed.</p>\n<p>This is exploitable using runc directly as well as through Docker and\nKubernetes.</p>\n<p>The CVSS score for this vulnerability is\nCVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N (Low severity, 3.6).</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Using user namespaces restricts this attack fairly significantly such that the\nattacker can only create inodes in directories that the remapped root\nuser/group has write access to. Unless the root user is remapped to an actual\nuser on the host (such as with rootless containers that don't use\n/etc/sub[ug]id), this in practice means that an attacker would only be able to\ncreate inodes in world-writable directories.</p>\n<p>A strict enough SELinux or AppArmor policy could in principle also restrict the\nscope if a specific label is applied to the runc runtime, though we haven't\nthoroughly tested to what extent the standard existing policies block this\nattack nor what exact policies are needed to sufficiently restrict this attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed in runc v1.1.14 and v1.2.0-rc3.</p>\n<ul>\n<li><code>main</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n</ul>\n</li>\n<li><code>release-1.1</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Rodrigo Campos Catelin (@rata) and Alban Crequy (@alban) from\nMicrosoft for discovering and reporting this vulnerability.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45310\">https://nvd.nist.gov/vuln/detail/CVE-2024-45310</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv",
            "title": "[github.com/opencontainers/runc] runc can be confused to create empty files/directories on the host",
            "date_modified": "2024-09-05T14:04:57.000Z",
            "date_published": "2024-09-03T19:49:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>extractFromZipFile</code> in <code>model.go</code> in Ollama before 0.1.47 can extract members of a ZIP archive outside of the parent directory.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45436\">https://nvd.nist.gov/vuln/detail/CVE-2024-45436</a></li>\n<li><a href=\"https://github.com/ollama/ollama/pull/5314\">https://github.com/ollama/ollama/pull/5314</a></li>\n<li><a href=\"https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47\">https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47</a></li>\n<li><a href=\"https://github.com/ollama/ollama/commit/123a722a6f541e300bc8e34297ac378ebe23f527\">https://github.com/ollama/ollama/commit/123a722a6f541e300bc8e34297ac378ebe23f527</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-846m-99qv-67mg\">https://github.com/advisories/GHSA-846m-99qv-67mg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-846m-99qv-67mg",
            "title": "[github.com/ollama/ollama] Ollama can extract members of a ZIP archive outside of the parent directory",
            "date_modified": "2024-08-29T18:05:19.000Z",
            "date_published": "2024-08-29T03:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-846m-99qv-67mg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em>\nThis ClusterRole has * verbs of * resources. If a malicious user can access the worker node which has hwameistor's deployment, he/she can abuse these excessive permissions to do whatever he/she likes to the whole cluster, resulting in a cluster-level privilege escalation.</p>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<blockquote>\n<p>= v0.14.6</p>\n</blockquote>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em>\nUpdate and Limit the ClusterRole using <a href=\"https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml\">security-role</a>.</p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em>\nissues:\n<a href=\"https://github.com/hwameistor/hwameistor/issues/1457\">https://github.com/hwameistor/hwameistor/issues/1457</a>\n<a href=\"https://github.com/hwameistor/hwameistor/issues/1460\">https://github.com/hwameistor/hwameistor/issues/1460</a></p>\n<p>also reported by users via mails: \n<a href=\"https://github.com/sparkEchooo\">sparkEchooo</a>, <a href=\"https://github.com/younaman\">younaman</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/hwameistor/hwameistor/security/advisories/GHSA-mgwr-h7mv-fh29\">https://github.com/hwameistor/hwameistor/security/advisories/GHSA-mgwr-h7mv-fh29</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45054\">https://nvd.nist.gov/vuln/detail/CVE-2024-45054</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/issues/1457\">https://github.com/hwameistor/hwameistor/issues/1457</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/issues/1460\">https://github.com/hwameistor/hwameistor/issues/1460</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/commit/edf4cebed73cadd230bf97eab65c5311f2858450\">https://github.com/hwameistor/hwameistor/commit/edf4cebed73cadd230bf97eab65c5311f2858450</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml\">https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mgwr-h7mv-fh29\">https://github.com/advisories/GHSA-mgwr-h7mv-fh29</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mgwr-h7mv-fh29",
            "title": "[github.com/hwameistor/hwameistor] Hwameistor Potential Permission Leakage of Cluster Level ",
            "date_modified": "2024-08-29T18:00:47.000Z",
            "date_published": "2024-08-29T18:00:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mgwr-h7mv-fh29"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>OpenTelemetry Collector module <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver\"><code>awsfirehosereceiver</code></a> allows unauthenticated remote requests, even when configured to require a key.</p>\n<p>OpenTelemetry Collector can be configured to receive CloudWatch metrics via an AWS Firehose Stream. <a href=\"https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html\">Firehose sets the header</a> <code>X-Amz-Firehose-Access-Key</code> with an arbitrary configured string. The OpenTelemetry Collector awsfirehosereceiver can optionally be configured to require this key on incoming requests. However, when this is configured it <strong>still accepts incoming requests with no key</strong>.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Only OpenTelemetry Collector users configured with the “<a href=\"https://github.com/open-telemetry/opentelemetry-collector#alpha\">alpha</a>” <code>awsfirehosereceiver</code> module are affected. This module was <a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74\">added</a> in version v0.49.0 of the <a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib\">“Contrib” distribution</a> (or may be included in custom builds).</p>\n<p>There is a risk of unauthorized users writing metrics. Carefully crafted metrics could hide other malicious activity. There is no risk of exfiltrating data. It’s likely these endpoints will be exposed to the public internet, as Firehose <a href=\"https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http\">does not support private HTTP endpoints</a>.</p>\n<h3 id=\"fix\">Fix</h3>\n<p>A fix was introduced in <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847\">https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847</a> and released with v0.108.0 (<a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0\">https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0</a>).</p>\n<h3 id=\"details\">Details</h3>\n<details>\n  <summary>Details</summary>\n\n<h4 id=\"poc\">PoC</h4>\n<p>When simulating Firehose requests against vulnerable versions of the Collector, we can see “UNAUTHORIZED METRICS” printed to the console via the debug exporter.\n(Note this script doesn’t run on some older still-vulnerable versions that do not have the “debug” exporter.)</p>\n<pre><code class=\"language-shell\">#!/bin/bash\n\nOTELCOL_VERSION=0.107.0\nOTELCOL_BINARY=\"otelcol-contrib-${OTELCOL_VERSION}\"\nOTELCOL_PLATFORM=\"linux_amd64\"\nHOST_PORT=8081\n\ncat &gt; config.yaml &lt;&lt; END\n# https://opentelemetry.io/docs/collector/configuration/\nexporters:\n  debug:\n    verbosity: normal\nreceivers:\n  awsfirehose:\n    endpoint : \"127.0.0.1:${HOST_PORT}\"\n    record_type : \"cwmetrics\"\n    access_key : \"1234\"\nservice:\n  pipelines:\n    metrics:\n      receivers:\n      - awsfirehose\n      exporters:\n      - debug\n  telemetry:\n    logs:\n      encoding: \"json\"\n      level: \"debug\"\nEND\n\n\nif [ ! -x \"${OTELCOL_BINARY}\" ]; then\n    curl --proto '=https' --tlsv1.2 -fOL https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v${OTELCOL_VERSION}/otelcol-contrib_${OTELCOL_VERSION}_${OTELCOL_PLATFORM}.tar.gz\n    tar -xvf otelcol-contrib_${OTELCOL_VERSION}_${OTELCOL_PLATFORM}.tar.gz otelcol-contrib\n    mv otelcol-contrib ${OTELCOL_BINARY}\nfi\n\n\"./${OTELCOL_BINARY}\" --config=config.yaml &amp;\nOTELCOL_PID=$!\n\necho \"Running OTel Collector with PID ${OTELCOL_PID}\"\n\nsleep 3\n\n# Send metrics with correct access key\nif ! curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-valid\"\\\n  -H \"X-Amz-Firehose-Access-Key: 1234\"\\\n  --data '{\"requestId\":\"requestId-valid\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJSZXF1ZXN0cyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjkuMCwiY291bnQiOjkuMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo \"Unexpected – Request with valid access key did not succeed\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\n# Send metrics with incorrect access key\nif curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-invalid\"\\\n  -H \"X-Amz-Firehose-Access-Key: 5678\"\\\n  --data '{\"requestId\":\"requestId-invalid\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJVTkFVVEhPUklaRUQgTUVUUklDUyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjU2NzguMCwiY291bnQiOjU2NzguMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo \"Unexpected – Request succeeded with invalid access key\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\n# Send unauthorized metrics without an access key\nif curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-unauthorized\"\\\n  --data '{\"requestId\":\"requestId-unauthorized\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJVTkFVVEhPUklaRUQgTUVUUklDUyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjU2NzguMCwiY291bnQiOjU2NzguMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo -e \"\\n*** Vulnerability present - request with no access key succeeded ***\\n\"\nelse\n    echo \"Not vulnerable - request with no key was denied.\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\nkill ${OTELCOL_PID}\n</code></pre>\n<h4 id=\"patch\">Patch</h4>\n<p>The <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/v0.107.0/receiver/awsfirehosereceiver/receiver.go#L235\"><code>if</code> statement</a> makes the access key header optional, rather than the configuration optional.</p>\n<p>This has been patched in #34847 to separately handle the case where access_key is not configured, and use a default-deny style:</p>\n<pre><code class=\"language-diff\">diff --git a/receiver/awsfirehosereceiver/receiver.go b/receiver/awsfirehosereceiver/receiver.go\nindex 6211f61221..4d78eb2778 100644\n--- a/receiver/awsfirehosereceiver/receiver.go\n+++ b/receiver/awsfirehosereceiver/receiver.go\n@@ -233,10 +233,14 @@ func (fmr *firehoseReceiver) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n // validate checks the Firehose access key in the header against\n // the one passed into the Config\n func (fmr *firehoseReceiver) validate(r *http.Request) (int, error) {\n-       if accessKey := r.Header.Get(headerFirehoseAccessKey); accessKey != \"\" &amp;&amp; accessKey != string(fmr.config.AccessKey) {\n-               return http.StatusUnauthorized, errInvalidAccessKey\n+       if string(fmr.config.AccessKey) == \"\" {\n+               // No access key is configured - accept all requests.\n+               return http.StatusAccepted, nil\n+       }\n+       if accessKey := r.Header.Get(headerFirehoseAccessKey); accessKey == string(fmr.config.AccessKey) {\n+               return http.StatusAccepted, nil\n        }\n-       return http.StatusAccepted, nil\n+       return http.StatusUnauthorized, errInvalidAccessKey\n }\n\ndiff --git a/receiver/awsfirehosereceiver/receiver_test.go b/receiver/awsfirehosereceiver/receiver_test.go\nindex b02a391dd5..1ef5bdf4d3 100644\n--- a/receiver/awsfirehosereceiver/receiver_test.go\n+++ b/receiver/awsfirehosereceiver/receiver_test.go\n@@ -123,6 +123,14 @@ func TestFirehoseRequest(t *testing.T) {\n                        wantStatusCode: http.StatusUnauthorized,\n                        wantErr:        errInvalidAccessKey,\n                },\n+               \"WithNoAccessKey\": {\n+                       headers: map[string]string{\n+                               headerFirehoseAccessKey: \"\",\n+                       },\n+                       body:           testFirehoseRequest(testFirehoseRequestID, noRecords),\n+                       wantStatusCode: http.StatusUnauthorized,\n+                       wantErr:        errInvalidAccessKey,\n+               },\n                \"WithoutRequestId/Body\": {\n                        headers: map[string]string{\n                                headerFirehoseRequestID: testFirehoseRequestID,\n</code></pre>\n</details>\n### References\n\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/security/advisories/GHSA-prf6-xjxh-p698\">https://github.com/open-telemetry/opentelemetry-collector-contrib/security/advisories/GHSA-prf6-xjxh-p698</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45043\">https://nvd.nist.gov/vuln/detail/CVE-2024-45043</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847\">https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74\">https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/commit/371bf6afbd7cfa3253fa1674f5444064e86ef0ac\">https://github.com/open-telemetry/opentelemetry-collector-contrib/commit/371bf6afbd7cfa3253fa1674f5444064e86ef0ac</a></li>\n<li><a href=\"https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http\">https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http</a></li>\n<li><a href=\"https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html\">https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector#alpha\">https://github.com/open-telemetry/opentelemetry-collector#alpha</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver\">https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0\">https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib\">https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-prf6-xjxh-p698\">https://github.com/advisories/GHSA-prf6-xjxh-p698</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-prf6-xjxh-p698",
            "title": "[github.com/open-telemetry/opentelemetry-collector-contrib/receiver/awsfirehosereceiver] OpenTelemetry Collector module AWS Firehose Receiver Authentication Bypass Vulnerability",
            "date_modified": "2024-08-29T17:56:37.000Z",
            "date_published": "2024-08-29T17:56:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-prf6-xjxh-p698"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.\nThis can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,\npreventing any further interaction with contracts.</p>\n<p>For more information, see <a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">CWA-2023-004</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840\">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>\n<li><a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>\n<li><a href=\"https://rustsec.org/advisories/RUSTSEC-2024-0366.html\">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>\n<li><a href=\"https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023\">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-75qh-gg76-p2w4\">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4",
            "title": "[github.com/CosmWasm/wasmvm] CWA-2023-004: Excessive number of function parameters in compiled Wasm",
            "date_modified": "2024-08-27T19:55:41.000Z",
            "date_published": "2024-08-27T19:55:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}