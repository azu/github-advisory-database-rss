{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for Go modules",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Ago",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/go.json",
    "description": "Security Advisory for Go modules on GitHub",
    "items": [
        {
            "content_html": "<p>Minder's Git provider is vulnerable to a denial of service from a maliciously configured GitHub repository. The Git provider clones users repositories using the <code>github.com/go-git/go-git/v5</code> library on these lines:</p>\n<p><a href=\"https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89\">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L55-L89</a></p>\n<p>The Git provider does the following on these lines:</p>\n<p>First, it sets the <code>CloneOptions</code>, specifying the url, the depth etc:</p>\n<p><a href=\"https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62\">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L56-L62</a></p>\n<p>It then validates the options: </p>\n<p><a href=\"https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L66-L68\">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L66-L68</a></p>\n<p>It then sets up an in-memory filesystem, to which it clones:</p>\n<p><a href=\"https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L70-L71\">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L70-L71</a></p>\n<p>Finally, it clones the repository:</p>\n<p><a href=\"https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L77\">https://github.com/stacklok/minder/blob/85985445c8ac3e51f03372e99c7b2f08a6d274aa/internal/providers/git/git.go#L77</a></p>\n<p>This <code>(g *Git) Clone()</code> method is vulnerable to a DoS attack: A Minder user can instruct Minder to clone a large repository which will exhaust memory and crash the Minder server. The root cause of this vulnerability is a combination of the following conditions:</p>\n<ol>\n<li>Users can control the Git URL which Minder clones.</li>\n<li>Minder does not enforce a size limit to the repository.</li>\n<li>Minder clones the entire repository into memory.</li>\n</ol>\n<h2 id=\"poc\">PoC</h2>\n<p>Here, we share a PoC of how the logic of <code>(g *Git) Clone()</code> behaves isolated from Minder. To get a true assessment of whether this is 100% identical to its behavior in the context of Minder instead of an isolated PoC, this should be tested out by creating a large repository and instructing Minder to clone it. However, even in that case, it might not be possible to deterministically trigger a DoS because of noise from network calls.</p>\n<p>We believe the below PoC is a correct representation because:</p>\n<ol>\n<li>We have replicated the important and impactful parts of <code>(g *Git) Clone()</code></li>\n<li>We run this in multiple goroutines which Minder does here: <a href=\"https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L128\">https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L128</a></li>\n<li>Minders timeout is set to 5 minutes: <a href=\"https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L114\">https://github.com/stacklok/minder/blob/3afa50ef2e06269ed619d390d266cf1988c2068b/internal/engine/executor.go#L114</a>. With a reasonable connection, Minder can download many GBs in that period.</li>\n</ol>\n<p>In our PoC, we demonstrate that under these two conditions, a large repository can perform a SigKill of the Go process which in Minders case is the Minder server.</p>\n<p>First, create a local Git repository:</p>\n<pre><code>cd /tmp\nmkdir upstream-repo\ncd upstream-repo\ngit init --bare\ncd /tmp\ngit clone /tmp/upstream-repo ./upstream-repo-clone\ncd ./upstream-repo-clone\n# Add large file:\nfallocate -l 8G large-file\ngit add .\ngit commit -m \"add large file\"\ngit push\ncd /tmp\n</code></pre>\n<p>Create and run the following script in <code>/tmp/dos-poc/main.go</code>:</p>\n<pre><code class=\"language-go\">package main\n\nimport (\n        \"context\"\n        \"fmt\"\n        \"github.com/go-git/go-billy/v5/memfs\"\n        \"github.com/go-git/go-git/v5\"\n        \"github.com/go-git/go-git/v5/storage/memory\"\n        \"runtime\"\n        \"sync\"\n)\n\nfunc main() {\n        var (\n                wg  sync.WaitGroup\n        )\n\n        for i := 0; i &lt; 2; i++ {\n                fmt.Println(\"Starting one...\")\n                wg.Add(1)\n                go func() {\n                        defer wg.Done()\n                        opts := &amp;git.CloneOptions{\n                                URL:          \"/tmp/upstream-repo\",\n                                SingleBranch: true,\n                                Depth:        1,\n                                Tags:         git.NoTags,\n                        }\n\n                        storer := memory.NewStorage()\n                        fs := memfs.New()\n                        git.CloneContext(context.Background(), storer, fs, opts)\n                }()\n        }\n        fmt.Println(\"Finished\")\n        PrintMemUsage()\n        wg.Wait()\n\n}\n\nfunc PrintMemUsage() {\n        var m runtime.MemStats\n        runtime.ReadMemStats(&amp;m)\n        // For info on each, see: https://golang.org/pkg/runtime/#MemStats\n        fmt.Printf(\"Alloc = %v MiB\", bToMb(m.Alloc))\n        fmt.Printf(\"\\tTotalAlloc = %v MiB\", bToMb(m.TotalAlloc))\n        fmt.Printf(\"\\tSys = %v MiB\", bToMb(m.Sys))\n        fmt.Printf(\"\\tNumGC = %v\\n\", m.NumGC)\n}\n\nfunc bToMb(b uint64) uint64 {\n        return b / 1024 / 1024\n}\n</code></pre>\n<p>On my local machine, this Go program is killed before it prints \"Finished\" in the terminal. Observing the memory by way of <code>top</code>, we can see that the memory climbs steadily until the program crashes around 93% memory consumption.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/stacklok/minder/security/advisories/GHSA-hpcg-xjq5-g666\">https://github.com/stacklok/minder/security/advisories/GHSA-hpcg-xjq5-g666</a></li>\n<li><a href=\"https://github.com/stacklok/minder/commit/35bab8f9a6025eea9e6e3cef6bd80707ac03d2a9\">https://github.com/stacklok/minder/commit/35bab8f9a6025eea9e6e3cef6bd80707ac03d2a9</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-hpcg-xjq5-g666\">https://github.com/advisories/GHSA-hpcg-xjq5-g666</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-hpcg-xjq5-g666",
            "title": "[github.com/stacklok/minder] Minder affected by denial of service from maliciously configured Git repository",
            "date_modified": "2024-06-18T16:46:48.000Z",
            "date_published": "2024-06-18T16:34:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-hpcg-xjq5-g666"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability has been identified whereby privilege escalation checks are not properly enforced for <code>RoleTemplate</code>objects when external=true, which in specific scenarios can lead to privilege escalation.</p>\n<p>The bug in the webhook rule resolver ignores rules from a <code>ClusterRole</code> for external <code>RoleTemplates</code> when its context is set to either <code>project</code> or is left empty. The fix introduces a new field to the <code>RoleTemplate</code> CRD named <code>ExternalRules</code>. The new field will be used to resolve rules directly from the <code>RoleTemplate</code>. Additionally, rules from the backing <code>ClusterRole</code> will be used if <code>ExternalRules</code> is not provided. The new field will always take precedence when it is set, and serve as the source of truth for rules used when creating Rancher resources on the local cluster.</p>\n<p>Please note that this is a breaking change for external <code>RoleTemplates</code>, when context is set to <code>project</code> or empty and the backing <code>ClusterRole</code> does not exist, as this was not previously required.</p>\n<p><strong>Important:</strong> The fix is automatically applied when upgrading to the release lines <code>2.8</code>and above. For users still on the <code>2.7</code> release line, after the upgrade to a patched version, users are required to opt-in to the fix by enabling the <code>external-rules</code> <a href=\"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags\">feature flag</a>.</p>\n<p>Please consult the associated <a href=\"https://attack.mitre.org/techniques/T1068/\">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The following script was developed for Rancher Manager administrators to identify <code>RoleTemplates</code> impacted by this vulnerability. The script requires <code>jq</code> installed and a <code>kubeconfig</code> with access to Rancher local cluster; it can also be executed in Rancher's kubectl shell.</p>\n<pre><code class=\"language-bash\">#!/bin/bash\nset -euo pipefail\n\n# get all RoleTemplates with .context == \"project\" or .context == \"\" that don't have externalRules.\nrts=$(kubectl get roletemplates -o json | jq -r  '.items[] | select((.context == \"project\" or .context == \"\") and .external == true and .externalRules == null) | .metadata.name')\nfound_invalid_rt=false\n\nfor rt in $rts; do\n  if ! kubectl get clusterrole \"$rt\" &gt; /dev/null 2&gt;&amp;1; then\n     echo \"$rt\" # prints RoleTemplate names that don't have a backing ClusterRole\n     found_invalid_rt=true\n  fi\ndone\n\nif ! $found_invalid_rt ; then\n    echo 'This cluster is not affected by CVE-2023-32197: no RoleTemplate objects found'\nfi\n</code></pre>\n<p>It will return all objects affected by this vulnerability. The administrator can fix those objects by creating the backing <code>ClusterRole</code> that they refer to.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32196\">CVE-2023-32196</a></li>\n</ul>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security-related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h\">https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-64jq-m7rq-768h\">https://github.com/advisories/GHSA-64jq-m7rq-768h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-64jq-m7rq-768h",
            "title": "[github.com/rancher/rancher] Rancher's External RoleTemplates can lead to privilege escalation",
            "date_modified": "2024-06-17T22:30:53.000Z",
            "date_published": "2024-06-17T22:30:51.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-64jq-m7rq-768h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability has been identified whereby privilege escalation checks are not properly enforced for <code>RoleTemplate</code>objects when external=true, which in specific scenarios can lead to privilege escalation.</p>\n<p>The bug in the webhook rule resolver ignores rules from a <code>ClusterRole</code> for external <code>RoleTemplates</code> when its context is set to either <code>project</code> or is left empty. The fix introduces a new field to the <code>RoleTemplate</code> CRD named <code>ExternalRules</code>. The new field will be used to resolve rules directly from the <code>RoleTemplate</code>. Additionally, rules from the backing <code>ClusterRole</code> will be used if <code>ExternalRules</code> is not provided. The new field will always take precedence when it is set, and serve as the source of truth for rules used when creating Rancher resources on the local cluster.</p>\n<p>Please note that this is a breaking change for external <code>RoleTemplates</code>, when context is set to <code>project</code> or empty and the backing <code>ClusterRole</code> does not exist, as this was not previously required.</p>\n<p><strong>Important:</strong> The fix is automatically applied when upgrading to the release lines <code>2.8</code>and above. For users still on the <code>2.7</code> release line, after the upgrade to a patched version, users are required to opt-in to the fix by enabling the <code>external-rules</code> <a href=\"https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-references/feature-flags\">feature flag</a>.</p>\n<p>Please consult the associated <a href=\"https://attack.mitre.org/techniques/T1068/\">MITRE ATT&amp;CK - Technique - Exploitation for Privilege Escalation</a> for further information about this category of attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>The following script was developed for Rancher Manager administrators to identify <code>RoleTemplates</code> impacted by this vulnerability. The script requires <code>jq</code> installed and a <code>kubeconfig</code> with access to Rancher local cluster; it can also be executed in Rancher's kubectl shell.</p>\n<pre><code class=\"language-bash\">#!/bin/bash\nset -euo pipefail\n\n# get all RoleTemplates with .context == \"project\" or .context == \"\" that don't have externalRules.\nrts=$(kubectl get roletemplates -o json | jq -r  '.items[] | select((.context == \"project\" or .context == \"\") and .external == true and .externalRules == null) | .metadata.name')\nfound_invalid_rt=false\n\nfor rt in $rts; do\n  if ! kubectl get clusterrole \"$rt\" &gt; /dev/null 2&gt;&amp;1; then\n     echo \"$rt\" # prints RoleTemplate names that don't have a backing ClusterRole\n     found_invalid_rt=true\n  fi\ndone\n\nif ! $found_invalid_rt ; then\n    echo 'This cluster is not affected by CVE-2023-32197: no RoleTemplate objects found'\nfi\n</code></pre>\n<p>It will return all objects affected by this vulnerability. The administrator can fix those objects by creating the backing <code>ClusterRole</code> that they refer to.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-32196\">CVE-2023-32196</a></li>\n</ul>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security-related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h\">https://github.com/rancher/rancher/security/advisories/GHSA-64jq-m7rq-768h</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-64jq-m7rq-768h\">https://github.com/advisories/GHSA-64jq-m7rq-768h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-64jq-m7rq-768h",
            "title": "[github.com/rancher/rancher] Rancher's External RoleTemplates can lead to privilege escalation",
            "date_modified": "2024-06-17T22:30:53.000Z",
            "date_published": "2024-06-17T22:30:51.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-64jq-m7rq-768h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>This issue is only relevant to clusters provisioned using RKE1 with secrets encryption configuration enabled.</p>\n<p>A vulnerability has been identified in which an RKE1 cluster keeps constantly reconciling when secrets encryption configuration is enabled (please see the <a href=\"https://rke.docs.rancher.com/config-options/secrets-encryption\">RKE documentation</a>). When reconciling, the Kube API secret values are written in plaintext on the AppliedSpec. Cluster owners, Cluster members, and Project members (for projects within the cluster), all have RBAC permissions to view the cluster object from the apiserver.</p>\n<p>This could lead to an unauthorized user gaining access to the entire secrets encryption config specific for the cluster, only on the applied spec.</p>\n<p>Since this affects only custom encryption configurations, users need to manually rotate the keys by editing the cluster. For more information, please refer to the <a href=\"https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation\">RKE secrets encryption documentation</a>.</p>\n<p>The full custom configuration example:</p>\n<pre><code class=\"language-yaml\">services:\n  kube-api:\n    secrets_encryption_config:\n      enabled: true\n      custom_config:\n        apiVersion: apiserver.config.k8s.io/v1\n        kind: EncryptionConfiguration\n        resources:\n        - resources:\n          - secrets\n          providers:\n          - aescbc:\n              keys:\n              - name: k-fw5hn\n                secret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I= #&lt;--- needs to be changed\n          - identity: {}\n</code></pre>\n<p>Please consult the associated  <a href=\"https://attack.mitre.org/techniques/T1552/\">MITRE ATT&amp;CK - Technique - Unsecured Credentials</a> for further information about this category of attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>To address this issue, the fix introduces a new change that copies the AppliedSpec before mutating. As such, the next time the cluster is reconciled and the AppliedSpec is set, all references to sensitive data will be removed. </p>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22032\">CVE-2024-22032</a></li>\n</ul>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security-related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm\">https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q6c7-56cq-g2wm\">https://github.com/advisories/GHSA-q6c7-56cq-g2wm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q6c7-56cq-g2wm",
            "title": "[github.com/rancher/rancher] Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec",
            "date_modified": "2024-06-17T22:30:53.000Z",
            "date_published": "2024-06-17T22:30:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q6c7-56cq-g2wm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>This issue is only relevant to clusters provisioned using RKE1 with secrets encryption configuration enabled.</p>\n<p>A vulnerability has been identified in which an RKE1 cluster keeps constantly reconciling when secrets encryption configuration is enabled (please see the <a href=\"https://rke.docs.rancher.com/config-options/secrets-encryption\">RKE documentation</a>). When reconciling, the Kube API secret values are written in plaintext on the AppliedSpec. Cluster owners, Cluster members, and Project members (for projects within the cluster), all have RBAC permissions to view the cluster object from the apiserver.</p>\n<p>This could lead to an unauthorized user gaining access to the entire secrets encryption config specific for the cluster, only on the applied spec.</p>\n<p>Since this affects only custom encryption configurations, users need to manually rotate the keys by editing the cluster. For more information, please refer to the <a href=\"https://rke.docs.rancher.com/config-options/secrets-encryption#key-rotation\">RKE secrets encryption documentation</a>.</p>\n<p>The full custom configuration example:</p>\n<pre><code class=\"language-yaml\">services:\n  kube-api:\n    secrets_encryption_config:\n      enabled: true\n      custom_config:\n        apiVersion: apiserver.config.k8s.io/v1\n        kind: EncryptionConfiguration\n        resources:\n        - resources:\n          - secrets\n          providers:\n          - aescbc:\n              keys:\n              - name: k-fw5hn\n                secret: RTczRjFDODMwQzAyMDVBREU4NDJBMUZFNDhCNzM5N0I= #&lt;--- needs to be changed\n          - identity: {}\n</code></pre>\n<p>Please consult the associated  <a href=\"https://attack.mitre.org/techniques/T1552/\">MITRE ATT&amp;CK - Technique - Unsecured Credentials</a> for further information about this category of attack.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>To address this issue, the fix introduces a new change that copies the AppliedSpec before mutating. As such, the next time the cluster is reconciled and the AppliedSpec is set, all references to sensitive data will be removed. </p>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes. </p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-22032\">CVE-2024-22032</a></li>\n</ul>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security-related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm\">https://github.com/rancher/rancher/security/advisories/GHSA-q6c7-56cq-g2wm</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-q6c7-56cq-g2wm\">https://github.com/advisories/GHSA-q6c7-56cq-g2wm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-q6c7-56cq-g2wm",
            "title": "[github.com/rancher/rancher] Rancher's RKE1 Encryption Config kept in plain-text within cluster AppliedSpec",
            "date_modified": "2024-06-17T22:30:53.000Z",
            "date_published": "2024-06-17T22:30:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-q6c7-56cq-g2wm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When RKE provisions a cluster, it stores the cluster state in a configmap called <code>full-cluster-state</code> inside the <code>kube-system</code> namespace of the cluster itself. This cluster state object contains information used to set up the K8s cluster, which may include the following sensitive data:</p>\n<ul>\n<li>RancherKubernetesEngineConfig<ul>\n<li>RKENodeConfig<ul>\n<li>SSH username</li>\n<li>SSH private key</li>\n<li>SSH private key path</li>\n</ul>\n</li>\n<li>RKEConfigServices<ul>\n<li>ETCDService<ul>\n<li>External client key</li>\n<li>BackupConfig<ul>\n<li>S3BackupConfig<ul>\n<li>AWS access key</li>\n<li>AWS secret key</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>KubeAPIService<ul>\n<li>SecretsEncryptionConfig<ul>\n<li>K8s encryption configuration (contains encryption keys)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PrivateRegistries<ul>\n<li>User</li>\n<li>Password</li>\n<li>ECRCredentialPlugin<ul>\n<li>AWS access key</li>\n<li>AWS secret key</li>\n<li>AWS session token</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CloudProvider<ul>\n<li>AzureCloudProvider<ul>\n<li>AAD client ID</li>\n<li>AAD client secret</li>\n<li>AAD client cert password</li>\n</ul>\n</li>\n<li>OpenstackCloudProvider<ul>\n<li>Username</li>\n<li>User ID</li>\n<li>Password</li>\n</ul>\n</li>\n<li>VsphereCloudProvider<ul>\n<li>GlobalVsphereOpts<ul>\n<li>User</li>\n<li>Password</li>\n</ul>\n</li>\n<li>VirtualCenterConfig<ul>\n<li>User</li>\n<li>Password</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>HarvesterCloudProvider<ul>\n<li>CloudConfig</li>\n</ul>\n</li>\n<li>CustomCloudProvider</li>\n</ul>\n</li>\n<li>BastionHost<ul>\n<li>User</li>\n<li>SSH key</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CertificatesBundle<ul>\n<li>Private key</li>\n</ul>\n</li>\n<li>EncryptionConfig<ul>\n<li>Private key</li>\n</ul>\n</li>\n</ul>\n<p>The <code>State</code> type that contains the above info and more can viewed <a href=\"https://github.com/rancher/rke/blob/8714c3c06e0bad55c61684fd5d94f1481128c58d/cluster/state.go#L37\">here</a>.</p>\n<p>While the <code>full-cluster-state</code> configmap is not publicly available (reading it requires access to the RKE cluster), it being a configmap makes it available to non-administrators of the cluster. Because this configmap contains essentially all the information and credentials required to administer the cluster, anyone with permission to read it thereby achieves admin-level access to the cluster (please consult the <a href=\"https://attack.mitre.org/techniques/T1552/001/\">MITRE ATT&amp;CK - Technique - Unsecured Credentials : Credentials In Files</a> for further information about the associated technique of attack).</p>\n<p><strong>Important:</strong>\nFor the exposure of credentials not related to Rancher and RKE, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>\n<p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability is being fixed in RKE versions <code>1.4.19</code> and <code>1.5.10</code> which are included in Rancher versions <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<p>The patches include changes that will cause RKE to automatically migrate the cluster state configmap to a <code>full-cluster-state</code> secret in the <code>kube-system</code> namespace. The migrated secret will only be accessible to those who have read access to the <code>kube-system</code> namespace in the downstream RKE cluster. In Rancher, only admin and cluster-owner roles can access the secret. The old configmap will be removed after successful migration.</p>\n<p>All downstream clusters provisioned using RKE via Rancher will be migrated automatically on Rancher upgrade. Note that any downstream clusters that are unavailable or otherwise non migratable on Rancher upgrade will still be migrated automatically as soon as they become available.</p>\n<p>Clusters provisioned using RKE outside of Rancher will be migrated automatically upon the next invocation of <code>rke up</code> (i.e. the next cluster reconciliation) after upgrading RKE.</p>\n<p>If a rollback needs to be performed after an upgrade to a patched Rancher or RKE version, downstream RKE clusters that were migrated need to have their migrations manually reversed using this script: <a href=\"https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations\">https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations</a>. \n<strong>Please be sure to back up downstream clusters before performing the reverse migration</strong>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes.</p>\n<p>Users should not attempt to perform this migration manually without upgrading their RKE/Rancher versions as only post-patch versions of RKE are capable of reading the cluster state from a secret instead of a configmap. In other words, migrating the cluster state to a secret without upgrading RKE/Rancher would cause RKE to be unable to read the cluster state, making it incapable of managing the cluster until an RKE/Rancher upgrade is performed.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support life cycle</a>.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx\">https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx</a></li>\n<li><a href=\"https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd\">https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd</a></li>\n<li><a href=\"https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf\">https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6gr4-52w6-vmqx\">https://github.com/advisories/GHSA-6gr4-52w6-vmqx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6gr4-52w6-vmqx",
            "title": "[github.com/rancher/rke] rke's credentials are stored in the RKE1 Cluster state ConfigMap",
            "date_modified": "2024-06-17T22:30:49.000Z",
            "date_published": "2024-06-17T22:30:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6gr4-52w6-vmqx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>When RKE provisions a cluster, it stores the cluster state in a configmap called <code>full-cluster-state</code> inside the <code>kube-system</code> namespace of the cluster itself. This cluster state object contains information used to set up the K8s cluster, which may include the following sensitive data:</p>\n<ul>\n<li>RancherKubernetesEngineConfig<ul>\n<li>RKENodeConfig<ul>\n<li>SSH username</li>\n<li>SSH private key</li>\n<li>SSH private key path</li>\n</ul>\n</li>\n<li>RKEConfigServices<ul>\n<li>ETCDService<ul>\n<li>External client key</li>\n<li>BackupConfig<ul>\n<li>S3BackupConfig<ul>\n<li>AWS access key</li>\n<li>AWS secret key</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>KubeAPIService<ul>\n<li>SecretsEncryptionConfig<ul>\n<li>K8s encryption configuration (contains encryption keys)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PrivateRegistries<ul>\n<li>User</li>\n<li>Password</li>\n<li>ECRCredentialPlugin<ul>\n<li>AWS access key</li>\n<li>AWS secret key</li>\n<li>AWS session token</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CloudProvider<ul>\n<li>AzureCloudProvider<ul>\n<li>AAD client ID</li>\n<li>AAD client secret</li>\n<li>AAD client cert password</li>\n</ul>\n</li>\n<li>OpenstackCloudProvider<ul>\n<li>Username</li>\n<li>User ID</li>\n<li>Password</li>\n</ul>\n</li>\n<li>VsphereCloudProvider<ul>\n<li>GlobalVsphereOpts<ul>\n<li>User</li>\n<li>Password</li>\n</ul>\n</li>\n<li>VirtualCenterConfig<ul>\n<li>User</li>\n<li>Password</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>HarvesterCloudProvider<ul>\n<li>CloudConfig</li>\n</ul>\n</li>\n<li>CustomCloudProvider</li>\n</ul>\n</li>\n<li>BastionHost<ul>\n<li>User</li>\n<li>SSH key</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CertificatesBundle<ul>\n<li>Private key</li>\n</ul>\n</li>\n<li>EncryptionConfig<ul>\n<li>Private key</li>\n</ul>\n</li>\n</ul>\n<p>The <code>State</code> type that contains the above info and more can viewed <a href=\"https://github.com/rancher/rke/blob/8714c3c06e0bad55c61684fd5d94f1481128c58d/cluster/state.go#L37\">here</a>.</p>\n<p>While the <code>full-cluster-state</code> configmap is not publicly available (reading it requires access to the RKE cluster), it being a configmap makes it available to non-administrators of the cluster. Because this configmap contains essentially all the information and credentials required to administer the cluster, anyone with permission to read it thereby achieves admin-level access to the cluster (please consult the <a href=\"https://attack.mitre.org/techniques/T1552/001/\">MITRE ATT&amp;CK - Technique - Unsecured Credentials : Credentials In Files</a> for further information about the associated technique of attack).</p>\n<p><strong>Important:</strong>\nFor the exposure of credentials not related to Rancher and RKE, the final impact severity for confidentiality, integrity and availability is dependent on the permissions the leaked credentials have on their services.</p>\n<p>It is recommended to review for potentially leaked credentials in this scenario and to change them if deemed necessary.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This vulnerability is being fixed in RKE versions <code>1.4.19</code> and <code>1.5.10</code> which are included in Rancher versions <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<p>The patches include changes that will cause RKE to automatically migrate the cluster state configmap to a <code>full-cluster-state</code> secret in the <code>kube-system</code> namespace. The migrated secret will only be accessible to those who have read access to the <code>kube-system</code> namespace in the downstream RKE cluster. In Rancher, only admin and cluster-owner roles can access the secret. The old configmap will be removed after successful migration.</p>\n<p>All downstream clusters provisioned using RKE via Rancher will be migrated automatically on Rancher upgrade. Note that any downstream clusters that are unavailable or otherwise non migratable on Rancher upgrade will still be migrated automatically as soon as they become available.</p>\n<p>Clusters provisioned using RKE outside of Rancher will be migrated automatically upon the next invocation of <code>rke up</code> (i.e. the next cluster reconciliation) after upgrading RKE.</p>\n<p>If a rollback needs to be performed after an upgrade to a patched Rancher or RKE version, downstream RKE clusters that were migrated need to have their migrations manually reversed using this script: <a href=\"https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations\">https://github.com/rancherlabs/support-tools/tree/master/reverse-rke-state-migrations</a>. \n<strong>Please be sure to back up downstream clusters before performing the reverse migration</strong>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There are no workarounds for this issue. Users are recommended to upgrade, as soon as possible, to a version of RKE/Rancher Manager which contains the fixes.</p>\n<p>Users should not attempt to perform this migration manually without upgrading their RKE/Rancher versions as only post-patch versions of RKE are capable of reading the cluster state from a secret instead of a configmap. In other words, migrating the cluster state to a secret without upgrading RKE/Rancher would cause RKE to be unable to read the cluster state, making it incapable of managing the cluster until an RKE/Rancher upgrade is performed.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support life cycle</a>.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx\">https://github.com/rancher/rke/security/advisories/GHSA-6gr4-52w6-vmqx</a></li>\n<li><a href=\"https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd\">https://github.com/rancher/rke/commit/cf49199481a1891909acb1384eed73a5c987d5bd</a></li>\n<li><a href=\"https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf\">https://github.com/rancher/rke/commit/f7485b8dce376db0fc15a7c3ceb3de7029c8d0cf</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-6gr4-52w6-vmqx\">https://github.com/advisories/GHSA-6gr4-52w6-vmqx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-6gr4-52w6-vmqx",
            "title": "[github.com/rancher/rke] rke's credentials are stored in the RKE1 Cluster state ConfigMap",
            "date_modified": "2024-06-17T22:30:49.000Z",
            "date_published": "2024-06-17T22:30:48.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-6gr4-52w6-vmqx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability has been identified in which Rancher does not automatically clean up a user which has been deleted from the configured authentication provider (AP). This characteristic also applies to disabled or revoked users, Rancher will not reflect these modifications which may leave the user’s tokens still usable.</p>\n<p>An AP must be enabled to be affected by this, as the built-in User Management feature is not affected by this vulnerability.\nThis issue may lead to an adversary gaining unauthorized access, as the user’s access privileges may still be active within Rancher even though they are no longer valid on the configured AP (please consult the <a href=\"https://attack.mitre.org/techniques/T1078/\">MITRE ATT&amp;CK - Technique - Valid Accounts</a> for further information about the associated technique of attack).</p>\n<p>It’s important to note that all configurable APs are impacted, see <a href=\"https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config#external-vs-local-authentication\">Rancher Docs - Configuring Authentication - External vs. Local Authentication</a> to get the full authentication providers list.</p>\n<p>To address this issue, the fix introduces a new user retention process that can be configured to run periodically and disable and/or delete inactive users. If enabled a user becomes subject to retention if they don't login for a configurable period of time. It's possible to set overrides for users that are used mainly for programmatic access (e.g. CI, scripts etc.) so that they don't become subject to retention for a longer period of time or at all. The user retention process is disabled by default, to avoid deleting wrong accounts. It is up to each user to enable it and configure the retention period as it best suits its environment.</p>\n<p>Be aware that once the process is enabled, it might take a few days for previous users that have been revoked or deleted from the AP to be automatically removed from Rancher. To attenuate the risk of this condition, we recommend to regularly audit the AP’s user accounts for activity and manually deactivate or remove them from Rancher, if they are no longer needed.</p>\n<p>For further information about the user retention process configuration, please refer to the dedicated documentation <a href=\"https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-user-retention\">Rancher Docs - Advanced User Guides - Enable User Retention</a>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Administrators that are unable to update to a patched Rancher Manager version, are advised to delete Rancher users, via kubectl or through the UI, as soon as those users are deleted from the Authentication Provider. If a user needs to be temporarily disabled on the Authentication Provider, similar intervention will need to take place to reflect that change on Rancher Manager.</p>\n<p>Below is a procedure to list and remove a deleted/disabled user in Rancher using <code>kubectl</code> (with a privileged kubeconfig).</p>\n<ol>\n<li>List all users bound to a supported external auth provider, then returns <code>username</code>, <code>uid</code>, <code>displayName</code> and <code>PrincipalIds</code> which contains the related <code>authprovider_user://ID</code></li>\n</ol>\n<pre><code class=\"language-shell\">#!/bin/bash\n\nfor authprovider in {activedirectory,azure,common,genericoidc,github googleauth, keycloakoidc,ldap,oidc,publicapi,saml}\ndo \n    kubectl get users -o json | jq --arg authprovider \"$authprovider\" '.items[] | select(.principalIds[] | test(\"^\" + $authprovider + \"_user://\")) | {username: .metadata.name, uid: .metadata.uid, displayName: .displayName, principalIds: .principalIds}'\ndone\n</code></pre>\n<ol start=\"2\">\n<li>Once the <code>authprovider_user://ID</code> (and/or <code>DisplayName</code>) is confirmed, remove the user from the Rancher UI or using <code>kubectl delete users &lt;USERNAME&gt;</code>.</li>\n</ol>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc\">https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9ghh-mmcq-8phc\">https://github.com/advisories/GHSA-9ghh-mmcq-8phc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9ghh-mmcq-8phc",
            "title": "[github.com/rancher/rancher] Rancher does not automatically clean up a user deleted or disabled from the configured Authentication Provider",
            "date_modified": "2024-06-17T22:30:48.000Z",
            "date_published": "2024-06-17T22:30:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9ghh-mmcq-8phc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>A vulnerability has been identified in which Rancher does not automatically clean up a user which has been deleted from the configured authentication provider (AP). This characteristic also applies to disabled or revoked users, Rancher will not reflect these modifications which may leave the user’s tokens still usable.</p>\n<p>An AP must be enabled to be affected by this, as the built-in User Management feature is not affected by this vulnerability.\nThis issue may lead to an adversary gaining unauthorized access, as the user’s access privileges may still be active within Rancher even though they are no longer valid on the configured AP (please consult the <a href=\"https://attack.mitre.org/techniques/T1078/\">MITRE ATT&amp;CK - Technique - Valid Accounts</a> for further information about the associated technique of attack).</p>\n<p>It’s important to note that all configurable APs are impacted, see <a href=\"https://ranchermanager.docs.rancher.com/how-to-guides/new-user-guides/authentication-permissions-and-global-configuration/authentication-config#external-vs-local-authentication\">Rancher Docs - Configuring Authentication - External vs. Local Authentication</a> to get the full authentication providers list.</p>\n<p>To address this issue, the fix introduces a new user retention process that can be configured to run periodically and disable and/or delete inactive users. If enabled a user becomes subject to retention if they don't login for a configurable period of time. It's possible to set overrides for users that are used mainly for programmatic access (e.g. CI, scripts etc.) so that they don't become subject to retention for a longer period of time or at all. The user retention process is disabled by default, to avoid deleting wrong accounts. It is up to each user to enable it and configure the retention period as it best suits its environment.</p>\n<p>Be aware that once the process is enabled, it might take a few days for previous users that have been revoked or deleted from the AP to be automatically removed from Rancher. To attenuate the risk of this condition, we recommend to regularly audit the AP’s user accounts for activity and manually deactivate or remove them from Rancher, if they are no longer needed.</p>\n<p>For further information about the user retention process configuration, please refer to the dedicated documentation <a href=\"https://ranchermanager.docs.rancher.com/how-to-guides/advanced-user-guides/enable-user-retention\">Rancher Docs - Advanced User Guides - Enable User Retention</a>.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Patched versions include releases <code>2.7.14</code> and <code>2.8.5</code>.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>Administrators that are unable to update to a patched Rancher Manager version, are advised to delete Rancher users, via kubectl or through the UI, as soon as those users are deleted from the Authentication Provider. If a user needs to be temporarily disabled on the Authentication Provider, similar intervention will need to take place to reflect that change on Rancher Manager.</p>\n<p>Below is a procedure to list and remove a deleted/disabled user in Rancher using <code>kubectl</code> (with a privileged kubeconfig).</p>\n<ol>\n<li>List all users bound to a supported external auth provider, then returns <code>username</code>, <code>uid</code>, <code>displayName</code> and <code>PrincipalIds</code> which contains the related <code>authprovider_user://ID</code></li>\n</ol>\n<pre><code class=\"language-shell\">#!/bin/bash\n\nfor authprovider in {activedirectory,azure,common,genericoidc,github googleauth, keycloakoidc,ldap,oidc,publicapi,saml}\ndo \n    kubectl get users -o json | jq --arg authprovider \"$authprovider\" '.items[] | select(.principalIds[] | test(\"^\" + $authprovider + \"_user://\")) | {username: .metadata.name, uid: .metadata.uid, displayName: .displayName, principalIds: .principalIds}'\ndone\n</code></pre>\n<ol start=\"2\">\n<li>Once the <code>authprovider_user://ID</code> (and/or <code>DisplayName</code>) is confirmed, remove the user from the Rancher UI or using <code>kubectl delete users &lt;USERNAME&gt;</code>.</li>\n</ol>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory:</p>\n<ul>\n<li>Reach out to the <a href=\"https://github.com/rancher/rancher/security/policy\">SUSE Rancher Security team</a> for security related inquiries.</li>\n<li>Open an issue in the <a href=\"https://github.com/rancher/rancher/issues/new/choose\">Rancher</a> repository.</li>\n<li>Verify with our <a href=\"https://www.suse.com/suse-rancher/support-matrix/all-supported-versions/\">support matrix</a> and <a href=\"https://www.suse.com/lifecycle/\">product support lifecycle</a>.</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc\">https://github.com/rancher/rancher/security/advisories/GHSA-9ghh-mmcq-8phc</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-9ghh-mmcq-8phc\">https://github.com/advisories/GHSA-9ghh-mmcq-8phc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-9ghh-mmcq-8phc",
            "title": "[github.com/rancher/rancher] Rancher does not automatically clean up a user deleted or disabled from the configured Authentication Provider",
            "date_modified": "2024-06-17T22:30:48.000Z",
            "date_published": "2024-06-17T22:30:46.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-9ghh-mmcq-8phc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue in AdGuardHome v0.93 to latest allows unprivileged attackers to escalate privileges via overwriting the AdGuardHome binary.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-36586\">https://nvd.nist.gov/vuln/detail/CVE-2024-36586</a></li>\n<li><a href=\"https://github.com/go-compile/security-advisories/blob/master/vulns/CVE-2024-36586.md\">https://github.com/go-compile/security-advisories/blob/master/vulns/CVE-2024-36586.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7jp9-vgmq-c8r5\">https://github.com/advisories/GHSA-7jp9-vgmq-c8r5</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7jp9-vgmq-c8r5",
            "title": "[github.com/AdguardTeam/AdGuardHome] AdGuardHome privilege escalation vulnerability",
            "date_modified": "2024-06-13T23:18:27.000Z",
            "date_published": "2024-06-13T21:30:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7jp9-vgmq-c8r5"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>Bunch of vulnerabilities found in k8sGPT.  Fixed in release <a href=\"https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33\">https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/k8sgpt-ai/k8sgpt/security/advisories/GHSA-85rg-8m6h-825p\">https://github.com/k8sgpt-ai/k8sgpt/security/advisories/GHSA-85rg-8m6h-825p</a></li>\n<li><a href=\"https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33\">https://github.com/k8sgpt-ai/k8sgpt/releases/tag/v0.3.33</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-85rg-8m6h-825p\">https://github.com/advisories/GHSA-85rg-8m6h-825p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-85rg-8m6h-825p",
            "title": "[github.com/k8sgpt-ai/k8sgpt] Vulnerabilities with the k8sGPT",
            "date_modified": "2024-06-13T19:39:12.000Z",
            "date_published": "2024-06-13T19:39:11.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-85rg-8m6h-825p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The output of <code>cilium-bugtool</code> can contain sensitive data when the tool is run (with the <code>--envoy-dump</code> flag set) against Cilium deployments with the Envoy proxy enabled.</p>\n<p>Users of the following features are affected:</p>\n<ul>\n<li><a href=\"https://docs.cilium.io/en/stable/security/tls-visibility/#gs-tls-inspection\">TLS inspection</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/tls-termination/#gs-ingress-tls\">Ingress with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/https/\">Gateway API with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/security/policy/language/#kafka-beta\">Kafka network policies with API key filtering</a></li>\n</ul>\n<p>The sensitive data includes:</p>\n<ul>\n<li>The CA certificate, certificate chain, and private key used by Cilium HTTP Network Policies, and when using Ingress/Gateway API</li>\n<li>The API keys used in Kafka-related network policy</li>\n</ul>\n<p><code>cilium-bugtool</code> is a debugging tool that is typically invoked manually and does not run during the normal operation of a Cilium cluster.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This issue affects:</p>\n<ul>\n<li>Cilium v1.13 between v1.13.0 and v1.13.16 inclusive</li>\n<li>Cilium v1.14 between v1.14.0 and v1.14.11 inclusive</li>\n<li>Cilium v1.15 between v1.15.0 and v1.15.5 inclusive</li>\n</ul>\n<p>This issue has been patched in:</p>\n<ul>\n<li>Cilium v1.15.6</li>\n<li>Cilium v1.14.12</li>\n<li>Cilium v1.13.17</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround to this issue.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @sayboras for their work on triaging and remediating this issue.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, please reach out on <a href=\"https://docs.cilium.io/en/latest/community/community/#slack\">Slack</a>.</p>\n<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href=\"mailto:security@cilium.io\">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j\">https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-37307\">https://nvd.nist.gov/vuln/detail/CVE-2024-37307</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407\">https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a\">https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741\">https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653\">https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b\">https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61\">https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wh78-7948-358j\">https://github.com/advisories/GHSA-wh78-7948-358j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wh78-7948-358j",
            "title": "[github.com/cilium/cilium] Cilium leaks sensitive information in cilium-bugtool",
            "date_modified": "2024-06-13T19:29:37.000Z",
            "date_published": "2024-06-13T19:29:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wh78-7948-358j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The output of <code>cilium-bugtool</code> can contain sensitive data when the tool is run (with the <code>--envoy-dump</code> flag set) against Cilium deployments with the Envoy proxy enabled.</p>\n<p>Users of the following features are affected:</p>\n<ul>\n<li><a href=\"https://docs.cilium.io/en/stable/security/tls-visibility/#gs-tls-inspection\">TLS inspection</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/tls-termination/#gs-ingress-tls\">Ingress with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/https/\">Gateway API with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/security/policy/language/#kafka-beta\">Kafka network policies with API key filtering</a></li>\n</ul>\n<p>The sensitive data includes:</p>\n<ul>\n<li>The CA certificate, certificate chain, and private key used by Cilium HTTP Network Policies, and when using Ingress/Gateway API</li>\n<li>The API keys used in Kafka-related network policy</li>\n</ul>\n<p><code>cilium-bugtool</code> is a debugging tool that is typically invoked manually and does not run during the normal operation of a Cilium cluster.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This issue affects:</p>\n<ul>\n<li>Cilium v1.13 between v1.13.0 and v1.13.16 inclusive</li>\n<li>Cilium v1.14 between v1.14.0 and v1.14.11 inclusive</li>\n<li>Cilium v1.15 between v1.15.0 and v1.15.5 inclusive</li>\n</ul>\n<p>This issue has been patched in:</p>\n<ul>\n<li>Cilium v1.15.6</li>\n<li>Cilium v1.14.12</li>\n<li>Cilium v1.13.17</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround to this issue.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @sayboras for their work on triaging and remediating this issue.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, please reach out on <a href=\"https://docs.cilium.io/en/latest/community/community/#slack\">Slack</a>.</p>\n<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href=\"mailto:security@cilium.io\">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j\">https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-37307\">https://nvd.nist.gov/vuln/detail/CVE-2024-37307</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407\">https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a\">https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741\">https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653\">https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b\">https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61\">https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wh78-7948-358j\">https://github.com/advisories/GHSA-wh78-7948-358j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wh78-7948-358j",
            "title": "[github.com/cilium/cilium] Cilium leaks sensitive information in cilium-bugtool",
            "date_modified": "2024-06-13T19:29:37.000Z",
            "date_published": "2024-06-13T19:29:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wh78-7948-358j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>The output of <code>cilium-bugtool</code> can contain sensitive data when the tool is run (with the <code>--envoy-dump</code> flag set) against Cilium deployments with the Envoy proxy enabled.</p>\n<p>Users of the following features are affected:</p>\n<ul>\n<li><a href=\"https://docs.cilium.io/en/stable/security/tls-visibility/#gs-tls-inspection\">TLS inspection</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/tls-termination/#gs-ingress-tls\">Ingress with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/https/\">Gateway API with TLS termination</a></li>\n<li><a href=\"https://docs.cilium.io/en/stable/security/policy/language/#kafka-beta\">Kafka network policies with API key filtering</a></li>\n</ul>\n<p>The sensitive data includes:</p>\n<ul>\n<li>The CA certificate, certificate chain, and private key used by Cilium HTTP Network Policies, and when using Ingress/Gateway API</li>\n<li>The API keys used in Kafka-related network policy</li>\n</ul>\n<p><code>cilium-bugtool</code> is a debugging tool that is typically invoked manually and does not run during the normal operation of a Cilium cluster.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>This issue affects:</p>\n<ul>\n<li>Cilium v1.13 between v1.13.0 and v1.13.16 inclusive</li>\n<li>Cilium v1.14 between v1.14.0 and v1.14.11 inclusive</li>\n<li>Cilium v1.15 between v1.15.0 and v1.15.5 inclusive</li>\n</ul>\n<p>This issue has been patched in:</p>\n<ul>\n<li>Cilium v1.15.6</li>\n<li>Cilium v1.14.12</li>\n<li>Cilium v1.13.17</li>\n</ul>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>There is no workaround to this issue.</p>\n<h3 id=\"acknowledgements\">Acknowledgements</h3>\n<p>The Cilium community has worked together with members of Isovalent to prepare these mitigations. Special thanks to @sayboras for their work on triaging and remediating this issue.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory, please reach out on <a href=\"https://docs.cilium.io/en/latest/community/community/#slack\">Slack</a>.</p>\n<p>If you think you have found a vulnerability affecting Cilium, we strongly encourage you to report it to our security mailing list at <a href=\"mailto:security@cilium.io\">security@cilium.io</a>. This is a private mailing list for the Cilium security team, and your report will be treated as top priority.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j\">https://github.com/cilium/cilium/security/advisories/GHSA-wh78-7948-358j</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-37307\">https://nvd.nist.gov/vuln/detail/CVE-2024-37307</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407\">https://github.com/cilium/cilium/commit/0191b1ebcfdd61cefd06da0315a0e7d504167407</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a\">https://github.com/cilium/cilium/commit/224e288a5bf40d0bb0f16c9413693b319633431a</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741\">https://github.com/cilium/cilium/commit/9299c0fd0024e33397cffc666ff851e82af28741</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653\">https://github.com/cilium/cilium/commit/958d7b77274bf2c272d8cdfd812631d644250653</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b\">https://github.com/cilium/cilium/commit/9eb25ba40391a9b035d7e66401b862818f4aac4b</a></li>\n<li><a href=\"https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61\">https://github.com/cilium/cilium/commit/bf9a1ae1b2d2b2c9cca329d7aa96aa4858032a61</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-wh78-7948-358j\">https://github.com/advisories/GHSA-wh78-7948-358j</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-wh78-7948-358j",
            "title": "[github.com/cilium/cilium] Cilium leaks sensitive information in cilium-bugtool",
            "date_modified": "2024-06-13T19:29:37.000Z",
            "date_published": "2024-06-13T19:29:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-wh78-7948-358j"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue in vektah gqlparser open-source-library v.2.5.10 allows a remote attacker to cause a denial of service via a crafted script to the parserDirectives function.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-49559\">https://nvd.nist.gov/vuln/detail/CVE-2023-49559</a></li>\n<li><a href=\"https://gist.github.com/uvzz/d3ed9d4532be16ec1040a2cf3dfec8d1\">https://gist.github.com/uvzz/d3ed9d4532be16ec1040a2cf3dfec8d1</a></li>\n<li><a href=\"https://github.com/99designs/gqlgen/issues/3118\">https://github.com/99designs/gqlgen/issues/3118</a></li>\n<li><a href=\"https://github.com/vektah/gqlparser/commit/36a3658873bf5a107f42488dfc392949cdd02977\">https://github.com/vektah/gqlparser/commit/36a3658873bf5a107f42488dfc392949cdd02977</a></li>\n<li><a href=\"https://github.com/vektah/gqlparser/blob/master/parser/query.go#L316\">https://github.com/vektah/gqlparser/blob/master/parser/query.go#L316</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2hmf-46v7-v6fx\">https://github.com/advisories/GHSA-2hmf-46v7-v6fx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2hmf-46v7-v6fx",
            "title": "[github.com/vektah/gqlparser] gqlparser denial of service vulnerability via the parserDirectives function",
            "date_modified": "2024-06-12T22:53:35.000Z",
            "date_published": "2024-06-12T21:31:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2hmf-46v7-v6fx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>An issue in vektah gqlparser open-source-library v.2.5.10 allows a remote attacker to cause a denial of service via a crafted script to the parserDirectives function.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2023-49559\">https://nvd.nist.gov/vuln/detail/CVE-2023-49559</a></li>\n<li><a href=\"https://gist.github.com/uvzz/d3ed9d4532be16ec1040a2cf3dfec8d1\">https://gist.github.com/uvzz/d3ed9d4532be16ec1040a2cf3dfec8d1</a></li>\n<li><a href=\"https://github.com/99designs/gqlgen/issues/3118\">https://github.com/99designs/gqlgen/issues/3118</a></li>\n<li><a href=\"https://github.com/vektah/gqlparser/commit/36a3658873bf5a107f42488dfc392949cdd02977\">https://github.com/vektah/gqlparser/commit/36a3658873bf5a107f42488dfc392949cdd02977</a></li>\n<li><a href=\"https://github.com/vektah/gqlparser/blob/master/parser/query.go#L316\">https://github.com/vektah/gqlparser/blob/master/parser/query.go#L316</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-2hmf-46v7-v6fx\">https://github.com/advisories/GHSA-2hmf-46v7-v6fx</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-2hmf-46v7-v6fx",
            "title": "[github.com/vektah/gqlparser/v2] gqlparser denial of service vulnerability via the parserDirectives function",
            "date_modified": "2024-06-12T22:53:35.000Z",
            "date_published": "2024-06-12T21:31:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-2hmf-46v7-v6fx"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault and Vault Enterprise did not properly validate the JSON Web Token (JWT) role-bound audience claim when using the Vault JWT auth method. This may have resulted in Vault validating a JWT the audience and role-bound claims do not match, allowing an invalid login to succeed when it should have been rejected.</p>\n<p>This vulnerability, CVE-2024-5798, was fixed in Vault and Vault Enterprise 1.17.0, 1.16.3, and 1.15.9</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5798\">https://nvd.nist.gov/vuln/detail/CVE-2024-5798</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770\">https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-32cj-5wx4-gq8p\">https://github.com/advisories/GHSA-32cj-5wx4-gq8p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p",
            "title": "[github.com/hashicorp/vault] HashiCorp Vault Incorrectly Validated JSON Web Tokens (JWT) Audience Claims",
            "date_modified": "2024-06-12T22:25:55.000Z",
            "date_published": "2024-06-12T21:31:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault and Vault Enterprise did not properly validate the JSON Web Token (JWT) role-bound audience claim when using the Vault JWT auth method. This may have resulted in Vault validating a JWT the audience and role-bound claims do not match, allowing an invalid login to succeed when it should have been rejected.</p>\n<p>This vulnerability, CVE-2024-5798, was fixed in Vault and Vault Enterprise 1.17.0, 1.16.3, and 1.15.9</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5798\">https://nvd.nist.gov/vuln/detail/CVE-2024-5798</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770\">https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-32cj-5wx4-gq8p\">https://github.com/advisories/GHSA-32cj-5wx4-gq8p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p",
            "title": "[github.com/hashicorp/vault] HashiCorp Vault Incorrectly Validated JSON Web Tokens (JWT) Audience Claims",
            "date_modified": "2024-06-12T22:25:55.000Z",
            "date_published": "2024-06-12T21:31:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Vault and Vault Enterprise did not properly validate the JSON Web Token (JWT) role-bound audience claim when using the Vault JWT auth method. This may have resulted in Vault validating a JWT the audience and role-bound claims do not match, allowing an invalid login to succeed when it should have been rejected.</p>\n<p>This vulnerability, CVE-2024-5798, was fixed in Vault and Vault Enterprise 1.17.0, 1.16.3, and 1.15.9</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-5798\">https://nvd.nist.gov/vuln/detail/CVE-2024-5798</a></li>\n<li><a href=\"https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770\">https://discuss.hashicorp.com/t/hcsec-2024-11-vault-incorrectly-validated-json-web-tokens-jwt-audience-claims/67770</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-32cj-5wx4-gq8p\">https://github.com/advisories/GHSA-32cj-5wx4-gq8p</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p",
            "title": "[github.com/hashicorp/vault] HashiCorp Vault Incorrectly Validated JSON Web Tokens (JWT) Audience Claims",
            "date_modified": "2024-06-12T22:25:55.000Z",
            "date_published": "2024-06-12T21:31:19.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-32cj-5wx4-gq8p"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-35255\">https://nvd.nist.gov/vuln/detail/CVE-2024-35255</a></li>\n<li><a href=\"https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255\">https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-35255</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499\">https://github.com/Azure/azure-sdk-for-go/commit/50774cd9709905523136fb05e8c85a50e8984499</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492\">https://github.com/Azure/azure-sdk-for-js/commit/c6aa75d312ae463e744163cedfd8fc480cc8d492</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178\">https://github.com/Azure/azure-sdk-for-python/commit/cb065acd7d0f957327dc4f02d1646d4e51a94178</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d\">https://github.com/Azure/azure-sdk-for-java/commit/5bf020d6ea056de40e2738e3647a4e06f902c18d</a></li>\n<li><a href=\"https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53\">https://github.com/Azure/azure-sdk-for-net/commit/9279a4f38bf69b457cfb9b354f210e0a540a5c53</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m5vv-6r4h-3vj9\">https://github.com/advisories/GHSA-m5vv-6r4h-3vj9</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m5vv-6r4h-3vj9",
            "title": "[github.com/Azure/azure-sdk-for-go/sdk/azidentity] Azure Identity Libraries and Microsoft Authentication Library Elevation of Privilege Vulnerability",
            "date_modified": "2024-06-13T18:44:18.000Z",
            "date_published": "2024-06-11T18:30:50.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m5vv-6r4h-3vj9"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}