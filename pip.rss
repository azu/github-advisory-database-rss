<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2024-08-28T05:01:17.454Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Denial of service in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-hjmq-236j-8m87</id>
        <link href="https://github.com/advisories/GHSA-hjmq-236j-8m87"/>
        <updated>2024-08-27T22:52:52.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite models using segment sum can trigger a denial of service by causing an out of memory allocation in the implementation of segment sum. Since code uses the last element of the tensor holding them to determine the dimensionality of output tensor, attackers can use a very large value to trigger a large allocation:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44</a></p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in 204945b and will release patch releases for all affected versions.</p>
<p>We recommend users to upgrade to TensorFlow 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to limit the maximum value in the segment ids tensor. This only handles the case when the segment ids are stored statically in the model, but a similar validation could be done if the segment ids are generated at runtime, between inference steps.</p>
<p>However, if the segment ids are generated as outputs of a tensor during inference steps, then there are no possible workaround and users are advised to upgrade to patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been discovered from a variant analysis of <a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-p2cq-cprg-frvm">GHSA-p2cq-cprg-frvm</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hjmq-236j-8m87">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hjmq-236j-8m87</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a">https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15213">https://nvd.nist.gov/vuln/detail/CVE-2020-15213</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a">https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827">https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44</a></li>
<li><a href="https://github.com/advisories/GHSA-hjmq-236j-8m87">https://github.com/advisories/GHSA-hjmq-236j-8m87</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hjmq-236j-8m87</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Denial of service in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-hjmq-236j-8m87</id>
        <link href="https://github.com/advisories/GHSA-hjmq-236j-8m87"/>
        <updated>2024-08-27T22:52:52.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite models using segment sum can trigger a denial of service by causing an out of memory allocation in the implementation of segment sum. Since code uses the last element of the tensor holding them to determine the dimensionality of output tensor, attackers can use a very large value to trigger a large allocation:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44</a></p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in 204945b and will release patch releases for all affected versions.</p>
<p>We recommend users to upgrade to TensorFlow 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to limit the maximum value in the segment ids tensor. This only handles the case when the segment ids are stored statically in the model, but a similar validation could be done if the segment ids are generated at runtime, between inference steps.</p>
<p>However, if the segment ids are generated as outputs of a tensor during inference steps, then there are no possible workaround and users are advised to upgrade to patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been discovered from a variant analysis of <a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-p2cq-cprg-frvm">GHSA-p2cq-cprg-frvm</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hjmq-236j-8m87">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hjmq-236j-8m87</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a">https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15213">https://nvd.nist.gov/vuln/detail/CVE-2020-15213</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a">https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827">https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/segment_sum.cc#L39-L44</a></li>
<li><a href="https://github.com/advisories/GHSA-hjmq-236j-8m87">https://github.com/advisories/GHSA-hjmq-236j-8m87</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hjmq-236j-8m87</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:53.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-hx2x-85gr-wrpq</id>
        <link href="https://github.com/advisories/GHSA-hx2x-85gr-wrpq"/>
        <updated>2024-08-27T22:47:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite models using segment sum can trigger writes outside of bounds of heap allocated buffers by inserting negative elements in the segment ids tensor:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631</a></p>
<p>Users having access to <code>segment_ids_data</code> can alter <code>output_index</code> and then write to outside of <code>output_data</code> buffer.</p>
<p>This might result in a segmentation fault but it can also be used to further corrupt the memory and can be chained with other vulnerabilities to create more advanced exploits.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in 204945b and will release patch releases for all affected versions.</p>
<p>We recommend users to upgrade to TensorFlow 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that the segment ids are all positive, although this only handles the case when the segment ids are stored statically in the model.</p>
<p>A similar validation could be done if the segment ids are generated at runtime between inference steps.</p>
<p>If the segment ids are generated as outputs of a tensor during inference steps, then there are no possible workaround and users are advised to upgrade to patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been discovered from a variant analysis of <a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-p2cq-cprg-frvm">GHSA-p2cq-cprg-frvm</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hx2x-85gr-wrpq">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hx2x-85gr-wrpq</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a">https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15212">https://nvd.nist.gov/vuln/detail/CVE-2020-15212</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a">https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827">https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631</a></li>
<li><a href="https://github.com/advisories/GHSA-hx2x-85gr-wrpq">https://github.com/advisories/GHSA-hx2x-85gr-wrpq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hx2x-85gr-wrpq</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2020-09-25T18:29:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-hx2x-85gr-wrpq</id>
        <link href="https://github.com/advisories/GHSA-hx2x-85gr-wrpq"/>
        <updated>2024-08-27T22:47:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite models using segment sum can trigger writes outside of bounds of heap allocated buffers by inserting negative elements in the segment ids tensor:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631</a></p>
<p>Users having access to <code>segment_ids_data</code> can alter <code>output_index</code> and then write to outside of <code>output_data</code> buffer.</p>
<p>This might result in a segmentation fault but it can also be used to further corrupt the memory and can be chained with other vulnerabilities to create more advanced exploits.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in 204945b and will release patch releases for all affected versions.</p>
<p>We recommend users to upgrade to TensorFlow 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that the segment ids are all positive, although this only handles the case when the segment ids are stored statically in the model.</p>
<p>A similar validation could be done if the segment ids are generated at runtime between inference steps.</p>
<p>If the segment ids are generated as outputs of a tensor during inference steps, then there are no possible workaround and users are advised to upgrade to patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been discovered from a variant analysis of <a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-p2cq-cprg-frvm">GHSA-p2cq-cprg-frvm</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hx2x-85gr-wrpq">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-hx2x-85gr-wrpq</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a">https://github.com/tensorflow/tensorflow/commit/204945b19e44b57906c9344c0d00120eeeae178a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15212">https://nvd.nist.gov/vuln/detail/CVE-2020-15212</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a">https://github.com/tensorflow/tensorflow/commit/00c7ed7ce81c2126ebc17dfe7073b5c0efd5ec0a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827">https://github.com/tensorflow/tensorflow/commit/a4030d8ba3692c438997c27be2dd95f3d5f54827</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/internal/reference/reference_ops.h#L2625-L2631</a></li>
<li><a href="https://github.com/advisories/GHSA-hx2x-85gr-wrpq">https://github.com/advisories/GHSA-hx2x-85gr-wrpq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hx2x-85gr-wrpq</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2020-09-25T18:29:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Out of bounds access in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-cvpc-8phh-8f45</id>
        <link href="https://github.com/advisories/GHSA-cvpc-8phh-8f45"/>
        <updated>2024-08-27T22:44:31.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>In TensorFlow Lite, saved models in the flatbuffer format use a double indexing scheme: a model has a set of subgraphs, each subgraph has a set of operators and each operator has a set of input/output tensors. The flatbuffer format uses indices for the tensors, indexing into an array of tensors that is owned by the subgraph. This results in a pattern of double array indexing when trying to get the data of each tensor: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></p>
<p>However, some operators can have some tensors be optional. To handle this scenario, the flatbuffer model uses a negative <code>-1</code> value as index for these tensors:
<a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></p>
<p>This results in special casing during validation at model loading time: <a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></p>
<p>Unfortunately, this means that the <code>-1</code> index is a valid tensor index for any operator, including those that don't expect optional inputs and including for output tensors. Thus, this allows writing and reading from outside the bounds of heap allocated arrays, although only at a specific offset from the start of these arrays.</p>
<p>This results in both read and write gadgets, albeit very limited in scope.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in several commits (46d5b0852, 00302787b7, e11f5558, cd31fd0ce, 1970c21, and fff2c83). We will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that only operators which accept optional inputs use the <code>-1</code> special value and only for the tensors that they expect to be optional. Since this allow-list type approach is erro-prone, we advise upgrading to the patched code.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0">https://github.com/tensorflow/tensorflow/commit/00302787b788c5ff04cb6f62aed5a74d936e86c0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35">https://github.com/tensorflow/tensorflow/commit/1970c2158b1ffa416d159d03c3370b9a462aee35</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9">https://github.com/tensorflow/tensorflow/commit/46d5b0852528ddfd614ded79bccc75589f801bd9</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f">https://github.com/tensorflow/tensorflow/commit/cd31fd0ce0449a9e0f83dcad08d6ed7f1d6bef3f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162">https://github.com/tensorflow/tensorflow/commit/e11f55585f614645b360563072ffeb5c3eeff162</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859">https://github.com/tensorflow/tensorflow/commit/fff2c8326280c07733828f990548979bdc893859</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15211">https://nvd.nist.gov/vuln/detail/CVE-2020-15211</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e">https://github.com/tensorflow/tensorflow/commit/f911af101dc0ce0eec17a8740bec9b613ae4195e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c">https://github.com/tensorflow/tensorflow/commit/e6b213cebb56f485bd400961a2ed109aeeac9d3c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69">https://github.com/tensorflow/tensorflow/commit/e47eb1453f35666795a31e208c28922b08756c69</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c">https://github.com/tensorflow/tensorflow/commit/d8f8236c29744b8e3247c083fd21c9a87180505c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7">https://github.com/tensorflow/tensorflow/commit/c22736982844d19af623ccd7d33e2d199493eee7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239">https://github.com/tensorflow/tensorflow/commit/7e283f97d8c784d3eae5062d9de25d0f432ad239</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c">https://github.com/tensorflow/tensorflow/commit/42ed6ac86856956da65b5957a26fab130ff9471c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c">https://github.com/tensorflow/tensorflow/commit/38cbad757b2e1c0d64b95e4582408fa66627a67c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47">https://github.com/tensorflow/tensorflow/commit/1a8528bfb572884eb8137dab1bf649705c960c47</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d">https://github.com/tensorflow/tensorflow/commit/0b5be2717a19ca7bf505369eb8bdd341405d263d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/kernels/kernel_util.cc#L36</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/core/subgraph.cc#L566-L580</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82">https://github.com/tensorflow/tensorflow/blob/0e68f4d3295eb0281a517c3662f6698992b7b2cf/tensorflow/lite/c/common.h#L82</a></li>
<li><a href="https://github.com/advisories/GHSA-cvpc-8phh-8f45">https://github.com/advisories/GHSA-cvpc-8phh-8f45</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cvpc-8phh-8f45</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Segmentation fault in tensorflow-lite]]></title>
        <id>https://github.com/advisories/GHSA-x9j7-x98r-r4w2</id>
        <link href="https://github.com/advisories/GHSA-x9j7-x98r-r4w2"/>
        <updated>2024-08-27T20:05:36.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>If a TFLite saved model uses the same tensor as both input and output of an operator, then, depending on the operator, we can observe a segmentation fault or just memory corruption.</p>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in d58c96946b and will release patch releases for all versions between 1.15 and 2.3.</p>
<p>We recommend users to upgrade to TensorFlow 1.15.4, 2.0.3, 2.1.2, 2.2.1, or 2.3.1.</p>
<h3 id="workarounds">Workarounds</h3>
<p>A potential workaround would be to add a custom <code>Verifier</code> to the model loading code to ensure that no operator reuses tensors as both inputs and outputs. Care should be taken to check all types of inputs (i.e., constant or variable tensors as well as optional tensors).</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been discovered from a variant analysis of <a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-cvpc-8phh-8f45">GHSA-cvpc-8phh-8f45</a>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-x9j7-x98r-r4w2">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-x9j7-x98r-r4w2</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d58c96946b2880991d63d1dacacb32f0a4dfa453">https://github.com/tensorflow/tensorflow/commit/d58c96946b2880991d63d1dacacb32f0a4dfa453</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1">https://github.com/tensorflow/tensorflow/releases/tag/v2.3.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15210">https://nvd.nist.gov/vuln/detail/CVE-2020-15210</a></li>
<li><a href="http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html">http://lists.opensuse.org/opensuse-security-announce/2020-10/msg00065.html</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/094329d0dcb8290bed2b1ee420934971f422c86d">https://github.com/tensorflow/tensorflow/commit/094329d0dcb8290bed2b1ee420934971f422c86d</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/1c8709b437fec10875b0cf271889afec9bbf582e">https://github.com/tensorflow/tensorflow/commit/1c8709b437fec10875b0cf271889afec9bbf582e</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/8c2092e9f9ef78b3f9060f8bf5ce7a49d1ccdc8f">https://github.com/tensorflow/tensorflow/commit/8c2092e9f9ef78b3f9060f8bf5ce7a49d1ccdc8f</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f4159ccef23d11eb58ee4263beaaeac1be3343c7">https://github.com/tensorflow/tensorflow/commit/f4159ccef23d11eb58ee4263beaaeac1be3343c7</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f50a14b00560a383865c2273e4a9094add3888d5">https://github.com/tensorflow/tensorflow/commit/f50a14b00560a383865c2273e4a9094add3888d5</a></li>
<li><a href="https://github.com/advisories/GHSA-x9j7-x98r-r4w2">https://github.com/advisories/GHSA-x9j7-x98r-r4w2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x9j7-x98r-r4w2</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2020-09-25T18:28:51.000Z</published>
    </entry>
</feed>