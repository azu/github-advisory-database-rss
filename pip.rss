<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2023-02-02T13:05:53.056Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[werkzeug] Pallets Werkzeug vulnerable to Path Traversal]]></title>
        <id>https://github.com/advisories/GHSA-j544-7q9p-6xp8</id>
        <link href="https://github.com/advisories/GHSA-j544-7q9p-6xp8"/>
        <updated>2023-02-02T01:32:53.000Z</updated>
        <content type="html"><![CDATA[<p>In Pallets Werkzeug before 0.15.5, SharedDataMiddleware mishandles drive names (such as C:) in Windows pathnames.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-14322">https://nvd.nist.gov/vuln/detail/CVE-2019-14322</a></li>
<li><a href="https://palletsprojects.com/blog/werkzeug-0-15-5-released/">https://palletsprojects.com/blog/werkzeug-0-15-5-released/</a></li>
<li><a href="http://packetstormsecurity.com/files/163398/Pallets-Werkzeug-0.15.4-Path-Traversal.html">http://packetstormsecurity.com/files/163398/Pallets-Werkzeug-0.15.4-Path-Traversal.html</a></li>
<li><a href="https://github.com/advisories/GHSA-j544-7q9p-6xp8">https://github.com/advisories/GHSA-j544-7q9p-6xp8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j544-7q9p-6xp8</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-24T16:51:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[safeurl-python] Withdrawn: safeurl-python contains Server-Side Request Forgery]]></title>
        <id>https://github.com/advisories/GHSA-rw83-v3pw-m362</id>
        <link href="https://github.com/advisories/GHSA-rw83-v3pw-m362"/>
        <updated>2023-02-01T20:04:52.000Z</updated>
        <content type="html"><![CDATA[<h2 id="withdrawn">Withdrawn</h2>
<p>This advisory has been withdrawn as a duplicate of <a href="https://github.com/advisories/GHSA-jgh8-vchw-q3g7">GHSA-jgh8-vchw-q3g7</a>.</p>
<h2 id="original-description">Original Description</h2>
<p>isInList in the safeurl-python package before 1.2 for Python has an insufficiently restrictive regular expression for external domains, leading to SSRF.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/IncludeSecurity/safeurl-python/security/advisories/GHSA-jgh8-vchw-q3g7">https://github.com/IncludeSecurity/safeurl-python/security/advisories/GHSA-jgh8-vchw-q3g7</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-24622">https://nvd.nist.gov/vuln/detail/CVE-2023-24622</a></li>
<li><a href="https://github.com/advisories/GHSA-rw83-v3pw-m362">https://github.com/advisories/GHSA-rw83-v3pw-m362</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-rw83-v3pw-m362</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-01-30T06:30:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[psiTurk] NYUCCL psiTurk vulnerable to Improper Neutralization of Special Elements]]></title>
        <id>https://github.com/advisories/GHSA-9mq4-9556-6qxq</id>
        <link href="https://github.com/advisories/GHSA-9mq4-9556-6qxq"/>
        <updated>2023-01-31T22:53:23.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability has been found in NYUCCL psiTurk up to 3.2.0 and classified as critical. This vulnerability affects unknown code of the file psiturk/experiment.py. The manipulation of the argument mode leads to improper neutralization of special elements used in a template engine. The exploit has been disclosed to the public and may be used. Upgrading to version 3.2.1 is able to address this issue. The name of the patch is 47787e15cecd66f2aa87687bf852ae0194a4335f. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-219676.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-4315">https://nvd.nist.gov/vuln/detail/CVE-2021-4315</a></li>
<li><a href="https://github.com/NYUCCL/psiTurk/pull/517">https://github.com/NYUCCL/psiTurk/pull/517</a></li>
<li><a href="https://github.com/NYUCCL/psiTurk/commit/47787e15cecd66f2aa87687bf852ae0194a4335f">https://github.com/NYUCCL/psiTurk/commit/47787e15cecd66f2aa87687bf852ae0194a4335f</a></li>
<li><a href="https://github.com/NYUCCL/psiTurk/releases/tag/v3.2.1">https://github.com/NYUCCL/psiTurk/releases/tag/v3.2.1</a></li>
<li><a href="https://vuldb.com/?ctiid.219676">https://vuldb.com/?ctiid.219676</a></li>
<li><a href="https://vuldb.com/?id.219676">https://vuldb.com/?id.219676</a></li>
<li><a href="https://github.com/advisories/GHSA-9mq4-9556-6qxq">https://github.com/advisories/GHSA-9mq4-9556-6qxq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9mq4-9556-6qxq</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-29T00:30:34.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[invenio-records] Cross-site scripting invenio-records]]></title>
        <id>https://github.com/advisories/GHSA-vxh3-mvv7-265j</id>
        <link href="https://github.com/advisories/GHSA-vxh3-mvv7-265j"/>
        <updated>2023-01-31T20:41:43.000Z</updated>
        <content type="html"><![CDATA[<h2 id="cross-site-scripting-xss-vulnerability-in-administration-interface">Cross-Site Scripting (XSS) vulnerability in administration interface</h2>
<h3 id="impact">Impact</h3>
<p>A Cross-Site Scripting (XSS) vulnerability was discovered when rendering JSON for a record in the administration interface. The vulnerability could be exploited by e.g. a user who had access to upload a new record, that an admin user would then later view in the admin interface.</p>
<h3 id="patches">Patches</h3>
<p>All supported versions of Invenio-Records have been patched. You should upgrade to either v1.0.1, v1.1.1 or v1.2.2</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Email us at <a href="mailto:info@inveniosoftware.org">info@inveniosoftware.org</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/inveniosoftware/invenio-records/security/advisories/GHSA-vxh3-mvv7-265j">https://github.com/inveniosoftware/invenio-records/security/advisories/GHSA-vxh3-mvv7-265j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-1020003">https://nvd.nist.gov/vuln/detail/CVE-2019-1020003</a></li>
<li><a href="https://github.com/advisories/GHSA-vxh3-mvv7-265j">https://github.com/advisories/GHSA-vxh3-mvv7-265j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vxh3-mvv7-265j</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2019-07-16T00:52:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[invenio-records] Cross-site scripting invenio-records]]></title>
        <id>https://github.com/advisories/GHSA-vxh3-mvv7-265j</id>
        <link href="https://github.com/advisories/GHSA-vxh3-mvv7-265j"/>
        <updated>2023-01-31T20:41:43.000Z</updated>
        <content type="html"><![CDATA[<h2 id="cross-site-scripting-xss-vulnerability-in-administration-interface">Cross-Site Scripting (XSS) vulnerability in administration interface</h2>
<h3 id="impact">Impact</h3>
<p>A Cross-Site Scripting (XSS) vulnerability was discovered when rendering JSON for a record in the administration interface. The vulnerability could be exploited by e.g. a user who had access to upload a new record, that an admin user would then later view in the admin interface.</p>
<h3 id="patches">Patches</h3>
<p>All supported versions of Invenio-Records have been patched. You should upgrade to either v1.0.1, v1.1.1 or v1.2.2</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory:</p>
<ul>
<li>Email us at <a href="mailto:info@inveniosoftware.org">info@inveniosoftware.org</a></li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/inveniosoftware/invenio-records/security/advisories/GHSA-vxh3-mvv7-265j">https://github.com/inveniosoftware/invenio-records/security/advisories/GHSA-vxh3-mvv7-265j</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2019-1020003">https://nvd.nist.gov/vuln/detail/CVE-2019-1020003</a></li>
<li><a href="https://github.com/advisories/GHSA-vxh3-mvv7-265j">https://github.com/advisories/GHSA-vxh3-mvv7-265j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vxh3-mvv7-265j</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2019-07-16T00:52:15.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ubi-reader] Path traversal in ubi-reader]]></title>
        <id>https://github.com/advisories/GHSA-vp2x-3mc3-3cj4</id>
        <link href="https://github.com/advisories/GHSA-vp2x-3mc3-3cj4"/>
        <updated>2023-01-31T19:01:53.000Z</updated>
        <content type="html"><![CDATA[<p>ubireader_extract_files is vulnerable to path traversal when run against specifically crafted UBIFS files, allowing the attacker to overwrite files outside of the extraction directory (provided the process has write access to that file or directory). This is due to the fact that a node name (dent_node.name) is considered trusted and joined to the extraction directory path during processing, then the node content is written to that joined path. By crafting a malicious UBIFS file with node names holding path traversal payloads (e.g. ../../tmp/outside.txt), it's possible to force ubi_reader to write outside of the extraction directory. This issue affects ubi-reader before 0.8.5.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0591">https://nvd.nist.gov/vuln/detail/CVE-2023-0591</a></li>
<li><a href="https://github.com/jrspruitt/ubi_reader/pull/57">https://github.com/jrspruitt/ubi_reader/pull/57</a></li>
<li><a href="https://onekey.com/blog/security-advisory-remote-command-execution-in-binwalk/">https://onekey.com/blog/security-advisory-remote-command-execution-in-binwalk/</a></li>
<li><a href="https://github.com/jrspruitt/ubi_reader/commit/d5d68e6b1b9f7070c29df5f67fc060f579ae9139">https://github.com/jrspruitt/ubi_reader/commit/d5d68e6b1b9f7070c29df5f67fc060f579ae9139</a></li>
<li><a href="https://github.com/advisories/GHSA-vp2x-3mc3-3cj4">https://github.com/advisories/GHSA-vp2x-3mc3-3cj4</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vp2x-3mc3-3cj4</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-31T12:30:24.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[modoboa] Cross-Site Request Forgery in modoboa]]></title>
        <id>https://github.com/advisories/GHSA-g298-59pg-93h7</id>
        <link href="https://github.com/advisories/GHSA-g298-59pg-93h7"/>
        <updated>2023-01-28T01:20:07.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-Site Request Forgery (CSRF) in GitHub repository modoboa/modoboa prior to 2.0.4.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0406">https://nvd.nist.gov/vuln/detail/CVE-2023-0406</a></li>
<li><a href="https://github.com/modoboa/modoboa/commit/7f0573e917227686d2cc127be1364e2908740807">https://github.com/modoboa/modoboa/commit/7f0573e917227686d2cc127be1364e2908740807</a></li>
<li><a href="https://huntr.dev/bounties/d7007f76-3dbc-48a7-a2fb-377040fe100c">https://huntr.dev/bounties/d7007f76-3dbc-48a7-a2fb-377040fe100c</a></li>
<li><a href="https://github.com/advisories/GHSA-g298-59pg-93h7">https://github.com/advisories/GHSA-g298-59pg-93h7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-g298-59pg-93h7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-19T18:30:19.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[modoboa] Cross-site Scripting in modoboa]]></title>
        <id>https://github.com/advisories/GHSA-c467-5c2g-jp86</id>
        <link href="https://github.com/advisories/GHSA-c467-5c2g-jp86"/>
        <updated>2023-01-27T01:16:05.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-site Scripting (XSS) - Stored in GitHub repository modoboa/modoboa prior to 2.0.4.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0470">https://nvd.nist.gov/vuln/detail/CVE-2023-0470</a></li>
<li><a href="https://github.com/modoboa/modoboa/commit/354ab6884019009249097a7f3a1881d81ecd2fd2">https://github.com/modoboa/modoboa/commit/354ab6884019009249097a7f3a1881d81ecd2fd2</a></li>
<li><a href="https://huntr.dev/bounties/baae3180-b63b-4880-b2af-1a3f30056c2b">https://huntr.dev/bounties/baae3180-b63b-4880-b2af-1a3f30056c2b</a></li>
<li><a href="https://github.com/advisories/GHSA-c467-5c2g-jp86">https://github.com/advisories/GHSA-c467-5c2g-jp86</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c467-5c2g-jp86</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-27T00:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pyload-ng] Cross-site Scripting in pyload-ng]]></title>
        <id>https://github.com/advisories/GHSA-wcm6-wv95-7jw6</id>
        <link href="https://github.com/advisories/GHSA-wcm6-wv95-7jw6"/>
        <updated>2023-01-27T01:15:38.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-site Scripting (XSS) - Stored in GitHub repository pyload/pyload prior to 0.5.0b3.dev42.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0488">https://nvd.nist.gov/vuln/detail/CVE-2023-0488</a></li>
<li><a href="https://github.com/pyload/pyload/commit/46d75a3087f3237d06530d55998938e2e2bda6bd">https://github.com/pyload/pyload/commit/46d75a3087f3237d06530d55998938e2e2bda6bd</a></li>
<li><a href="https://huntr.dev/bounties/4311d8d7-682c-4f2a-b92c-3f9f1a36255a">https://huntr.dev/bounties/4311d8d7-682c-4f2a-b92c-3f9f1a36255a</a></li>
<li><a href="https://github.com/advisories/GHSA-wcm6-wv95-7jw6">https://github.com/advisories/GHSA-wcm6-wv95-7jw6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wcm6-wv95-7jw6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-27T00:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pyload-ng] Improper Certificate Validation in pyload-ng]]></title>
        <id>https://github.com/advisories/GHSA-8v53-23mx-hcf9</id>
        <link href="https://github.com/advisories/GHSA-8v53-23mx-hcf9"/>
        <updated>2023-01-27T01:15:08.000Z</updated>
        <content type="html"><![CDATA[<p>Improper Certificate Validation in GitHub repository pyload/pyload prior to 0.5.0b3.dev44.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0509">https://nvd.nist.gov/vuln/detail/CVE-2023-0509</a></li>
<li><a href="https://github.com/pyload/pyload/commit/a9098bdf7406e6faf9df3da6ff2d584e90c13bbb">https://github.com/pyload/pyload/commit/a9098bdf7406e6faf9df3da6ff2d584e90c13bbb</a></li>
<li><a href="https://huntr.dev/bounties/a370e0c2-a41c-4871-ad91-bc6f31a8e839">https://huntr.dev/bounties/a370e0c2-a41c-4871-ad91-bc6f31a8e839</a></li>
<li><a href="https://github.com/advisories/GHSA-8v53-23mx-hcf9">https://github.com/advisories/GHSA-8v53-23mx-hcf9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8v53-23mx-hcf9</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-27T00:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[modoboa] Cross-site Scripting in modoboa]]></title>
        <id>https://github.com/advisories/GHSA-jm3m-wr3p-hjrq</id>
        <link href="https://github.com/advisories/GHSA-jm3m-wr3p-hjrq"/>
        <updated>2023-01-27T01:05:12.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-site Scripting (XSS) - Stored in GitHub repository modoboa/modoboa prior to 2.0.4.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0519">https://nvd.nist.gov/vuln/detail/CVE-2023-0519</a></li>
<li><a href="https://github.com/modoboa/modoboa/commit/eef9ab72b5305578a3ad7a7463bd284aa645e98b">https://github.com/modoboa/modoboa/commit/eef9ab72b5305578a3ad7a7463bd284aa645e98b</a></li>
<li><a href="https://huntr.dev/bounties/891ad0cb-d12f-4c5e-aac8-d7326caf2129">https://huntr.dev/bounties/891ad0cb-d12f-4c5e-aac8-d7326caf2129</a></li>
<li><a href="https://github.com/advisories/GHSA-jm3m-wr3p-hjrq">https://github.com/advisories/GHSA-jm3m-wr3p-hjrq</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jm3m-wr3p-hjrq</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-27T00:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[onnx] Directory Traversal in onnx]]></title>
        <id>https://github.com/advisories/GHSA-ffxj-547x-5j7c</id>
        <link href="https://github.com/advisories/GHSA-ffxj-547x-5j7c"/>
        <updated>2023-01-27T01:04:53.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of the package onnx before 1.13.0 are vulnerable to Directory Traversal as the external_data field of the tensor proto can have a path to the file which is outside the model current directory or user-provided directory, for example "../../../etc/passwd"</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-25882">https://nvd.nist.gov/vuln/detail/CVE-2022-25882</a></li>
<li><a href="https://github.com/onnx/onnx/issues/3991">https://github.com/onnx/onnx/issues/3991</a></li>
<li><a href="https://github.com/onnx/onnx/pull/4400">https://github.com/onnx/onnx/pull/4400</a></li>
<li><a href="https://github.com/onnx/onnx/commit/f369b0e859024095d721f1d1612da5a8fa38988d">https://github.com/onnx/onnx/commit/f369b0e859024095d721f1d1612da5a8fa38988d</a></li>
<li><a href="https://gist.github.com/jnovikov/02a9aff9bf2188033e77bd91ff062856">https://gist.github.com/jnovikov/02a9aff9bf2188033e77bd91ff062856</a></li>
<li><a href="https://github.com/onnx/onnx/blob/96516aecd4c110b0ac57eba08ac236ebf7205728/onnx/checker.cc%23L129">https://github.com/onnx/onnx/blob/96516aecd4c110b0ac57eba08ac236ebf7205728/onnx/checker.cc%23L129</a></li>
<li><a href="https://security.snyk.io/vuln/SNYK-PYTHON-ONNX-2395479">https://security.snyk.io/vuln/SNYK-PYTHON-ONNX-2395479</a></li>
<li><a href="https://github.com/advisories/GHSA-ffxj-547x-5j7c">https://github.com/advisories/GHSA-ffxj-547x-5j7c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-ffxj-547x-5j7c</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-01-26T21:30:25.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[safeurl-python] Permissive regex leads to domain filter bypass]]></title>
        <id>https://github.com/advisories/GHSA-jgh8-vchw-q3g7</id>
        <link href="https://github.com/advisories/GHSA-jgh8-vchw-q3g7"/>
        <updated>2023-02-01T20:10:56.000Z</updated>
        <content type="html"><![CDATA[<h3 id="description">Description</h3>
<p>In SafeURL it is possible to specify a list of domains that should be matched before a request is sent out. The regex used to compare domains did not work as intended.</p>
<h3 id="impact">Impact</h3>
<p>The regex used was:</p>
<p><code>re.match("(?i)^%s" % domain, value)</code></p>
<p>This has two problems, first that only the beginning and not the end of the string is anchored. Second, that a dot in the domain matches any character as part of regex syntax.</p>
<p>Therefore, an allowlist of ["victim.com"] could allow the domain "victimacomattacker.com" to be requested.</p>
<p>This has lower impact since the usual attacker aim in an SSRF is to request internal resources such as private IP addresses rather than an attacker's own domain. But, in a case where SafeURL had specifically been used to try to limit requests to a particular allowlist, say for example a PDF renderer, the finding would be more severe.</p>
<h3 id="patches">Patches</h3>
<p>Fixed in <a href="https://github.com/IncludeSecurity/safeurl-python/pull/5">https://github.com/IncludeSecurity/safeurl-python/pull/5</a></p>
<h3 id="references">References</h3>
<p><a href="https://portswigger.net/web-security/ssrf">Server-side request forgery (SSRF)</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/IncludeSecurity/safeurl-python/security/advisories/GHSA-jgh8-vchw-q3g7">https://github.com/IncludeSecurity/safeurl-python/security/advisories/GHSA-jgh8-vchw-q3g7</a></li>
<li><a href="https://github.com/IncludeSecurity/safeurl-python/pull/5/commits/42dd0c8e5fc84e17e1d3578d18aaea169eece474">https://github.com/IncludeSecurity/safeurl-python/pull/5/commits/42dd0c8e5fc84e17e1d3578d18aaea169eece474</a></li>
<li><a href="https://github.com/advisories/GHSA-jgh8-vchw-q3g7">https://github.com/advisories/GHSA-jgh8-vchw-q3g7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jgh8-vchw-q3g7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-27T01:04:27.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pyload-ng] Code Injection in pyload-ng]]></title>
        <id>https://github.com/advisories/GHSA-pf38-5p22-x6h6</id>
        <link href="https://github.com/advisories/GHSA-pf38-5p22-x6h6"/>
        <updated>2023-01-25T22:04:27.000Z</updated>
        <content type="html"><![CDATA[<p>Code Injection in GitHub repository pyload/pyload prior to 0.5.0b3.dev31.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0297">https://nvd.nist.gov/vuln/detail/CVE-2023-0297</a></li>
<li><a href="https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d">https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d</a></li>
<li><a href="https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65">https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65</a></li>
<li><a href="https://github.com/advisories/GHSA-pf38-5p22-x6h6">https://github.com/advisories/GHSA-pf38-5p22-x6h6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-pf38-5p22-x6h6</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-14T03:30:21.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pgadmin4] pgAdmin 4 Open Redirect vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-894c-rg7f-3c62</id>
        <link href="https://github.com/advisories/GHSA-894c-rg7f-3c62"/>
        <updated>2023-02-02T10:33:05.000Z</updated>
        <content type="html"><![CDATA[<p>Open redirect vulnerability in pgAdmin 4 versions prior to v6.14 allows a remote unauthenticated attacker to redirect a user to an arbitrary web site and conduct a phishing attack by having a user to access a specially crafted URL.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22298">https://nvd.nist.gov/vuln/detail/CVE-2023-22298</a></li>
<li><a href="https://github.com/pgadmin-org/pgadmin4/issues/5343">https://github.com/pgadmin-org/pgadmin4/issues/5343</a></li>
<li><a href="https://jvn.jp/en/jp/JVN03832974/index.html">https://jvn.jp/en/jp/JVN03832974/index.html</a></li>
<li><a href="https://www.pgadmin.org/">https://www.pgadmin.org/</a></li>
<li><a href="https://github.com/pgadmin-org/pgadmin4">https://github.com/pgadmin-org/pgadmin4</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VHY2B25YHIIFQ3G44TR7NNEST7FJGJPH/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/VHY2B25YHIIFQ3G44TR7NNEST7FJGJPH/</a></li>
<li><a href="https://github.com/advisories/GHSA-894c-rg7f-3c62">https://github.com/advisories/GHSA-894c-rg7f-3c62</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-894c-rg7f-3c62</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-17T12:30:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ansible] amazon.aws.ec2_instance leaks passwords into logs when tower_callback.windows is set]]></title>
        <id>https://github.com/advisories/GHSA-cpx3-93w7-457x</id>
        <link href="https://github.com/advisories/GHSA-cpx3-93w7-457x"/>
        <updated>2023-01-24T23:11:22.000Z</updated>
        <content type="html"><![CDATA[<p>A flaw was found in Ansible in the amazon.aws collection when using the <code>tower_callback</code> parameter from the <code>amazon.aws.ec2_instance</code> module. This flaw allows an attacker to take advantage of this issue as the module is handling the parameter insecurely, leading to the password leaking in the logs.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-3697">https://nvd.nist.gov/vuln/detail/CVE-2022-3697</a></li>
<li><a href="https://github.com/ansible-collections/amazon.aws/pull/1199">https://github.com/ansible-collections/amazon.aws/pull/1199</a></li>
<li><a href="https://github.com/ansible/ansible/pull/35749">https://github.com/ansible/ansible/pull/35749</a></li>
<li><a href="https://github.com/ansible-community/ansible-build-data/blob/main/6/CHANGELOG-v6.rst">https://github.com/ansible-community/ansible-build-data/blob/main/6/CHANGELOG-v6.rst</a></li>
<li><a href="https://github.com/advisories/GHSA-cpx3-93w7-457x">https://github.com/advisories/GHSA-cpx3-93w7-457x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-cpx3-93w7-457x</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-10-28T19:00:38.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[spotipy] Path traversal in spotipy]]></title>
        <id>https://github.com/advisories/GHSA-q764-g6fm-555v</id>
        <link href="https://github.com/advisories/GHSA-q764-g6fm-555v"/>
        <updated>2023-01-26T21:57:12.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>If a malicious URI is passed to the library, the library can be tricked into performing an operation on a different API endpoint than intended.</p>
<h3 id="details">Details</h3>
<p>The <a href="https://github.com/spotipy-dev/spotipy/blob/master/spotipy/client.py#L1942">code Spotipy uses to parse URIs and URLs </a> accepts user data too liberally which allows a malicious user to insert arbitrary characters into the path that is used for API requests. Because it is possible to include <code>..</code>, an attacker can redirect for example a track lookup via <code>spotifyApi.track()</code> to an arbitrary API endpoint like playlists, but this is possible for other endpoints as well.</p>
<p>Before the security advisory feature was enabled on GitHub, I was already in contact with Stéphane Bruckert via e-mail, and he asked me to look into a potential fix. </p>
<p>My recommendation is to perform stricter parsing of URLs and URIs, which I implemented in the patch included at the end of the report. If you prefer, I can also invite you to a private fork of the repository.</p>
<h3 id="poc">PoC</h3>
<p>The POC expects <code>SPOTIFY_CLIENT_ID</code> and <code>SPOTIFY_CLIENT_SECRET</code> environment variables to be set to authenticate against the API.</p>
<pre><code class="language-python">import spotipy
from spotipy.oauth2 import SpotifyClientCredentials


def main():
    spotifyApi = spotipy.Spotify(client_credentials_manager=SpotifyClientCredentials())

    # This URL contains the example playlist ID from the spotify docs, a malicious
    # playlist could instead contain a XSS payload in their title. A playlist with 
    # such a title was also included in the initial report via mail to maintainer.
    malicious_spotify_url = 'spotify:track:../playlists/3cEYpjA9oz9GiPac4AsH4n'
    

    # Usage of the track function, expecting to get a non-user-controllable track name
    # e.g. for displaying in a website.
    # Our modified track uri however makes the library return the name of a playlist which
    # may be created by anyone containing anything.
    track = spotifyApi.track(malicious_spotify_url)

    # Prints:
    # 'Name of the track: Spotify Web API Testing playlist'
    # A malicious playlist could also have an XSS payload as title, which would result in:
    # 'Name of the track: &lt;img src=x onerror=prompt(1)&gt;'
    print(f"Name of the track: {track['name']}")

if __name__ == '__main__':
    main()
</code></pre>
<h3 id="impact">Impact</h3>
<p>The impact of this vulnerability depends heavily on what operations a client application performs when it handles a URI from a user and how it uses the responses it receives from the API.</p>
<h3 id="possible-patch">Possible Patch</h3>
<h4 id="caviats-of-this-patch">Caviats of this patch</h4>
<ul>
<li>The ID parsing functionality now newly raises <code>ValueError</code> if it cannot parse an ID, instead of logging a warning or silently passing back whatever it received as input.<ul>
<li><strong>WARNING</strong> I only adjusted unit tests to expect <code>ValueError</code> that didn't require a valid user session, other tests may also need adjustment</li>
</ul>
</li>
<li>Unfortunately, I could not find conclusive documentation on what constitutes a valid Spotify username, but apparently some exist that contain alphanumeric characters, mine just contains numbers and the ones of newly created accounts seem to follow the base-62 scheme. You as developers probably have deeper insight into this, otherwise it probably will have to be discovered via bug reports if additional characters are valid as well.</li>
</ul>
<pre><code>From 30cf29b16e893dcac974dbd7481fb58a073b853c Mon Sep 17 00:00:00 2001
From: Shaderbug &lt;119610832+Shaderbug@users.noreply.github.com&gt;
Date: Tue, 10 Jan 2023 19:26:18 +0100
Subject: [PATCH] Improve URL and URI handling

---
 spotipy/client.py                            | 61 +++++++++++++++-----
 tests/integration/non_user_endpoints/test.py |  6 +-
 2 files changed, 49 insertions(+), 18 deletions(-)

diff --git a/spotipy/client.py b/spotipy/client.py
index d7025a9..b094947 100644
--- a/spotipy/client.py
+++ b/spotipy/client.py
@@ -6,6 +6,7 @@ __all__ = ["Spotify", "SpotifyException"]
 
 import json
 import logging
+import re
 import warnings
 
 import requests
@@ -96,6 +97,29 @@ class Spotify(object):
         "US",
         "UY"]
 
+    # Spotify URI scheme defined in [1], and the ID format as base-62 in [2].
+    #
+    # Unfortunately the IANA specification is out of date and doesn't include the new types
+    # show and episode. Additionally, for the user URI, it does not specify which characters
+    # are valid for usernames, so the assumption is alphanumeric which coincidentially are also
+    # the same ones base-62 uses.
+    # In limited manual exploration this seems to hold true, as newly accounts are assigned an
+    # identifier that looks like the base-62 of all other IDs, but some older accounts only have
+    # numbers and even older ones seemed to have been allowed to freely pick this name.
+    #
+    # [1] https://www.iana.org/assignments/uri-schemes/prov/spotify
+    # [2] https://developer.spotify.com/documentation/web-api/#spotify-uris-and-ids
+    _regex_spotify_uri = r'^spotify:(?P&lt;type&gt;track|artist|album|playlist|show|episode|user):(?P&lt;id&gt;[0-9A-Za-z]+)$'
+
+    # Spotify URLs are defined at [1]. The assumption is made that they are all
+    # pointing to open.spotify.com, so a regex is used to parse them as well,
+    # instead of a more complex URL parsing function.
+    #
+    # [1] https://developer.spotify.com/documentation/web-api/#spotify-uris-and-ids
+    _regex_spotify_url = r'^(http[s]?:\/\/)?open.spotify.com\/(?P&lt;type&gt;track|artist|album|playlist|show|episode|user)\/(?P&lt;id&gt;[0-9A-Za-z]+)(\?.*)?$'
+
+    _regex_base62 = r'^[0-9A-Za-z]+$'
+
     def __init__(
         self,
         auth=None,
@@ -1940,20 +1964,27 @@ class Spotify(object):
         return path
 
     def _get_id(self, type, id):
-        fields = id.split(":")
-        if len(fields) &gt;= 3:
-            if type != fields[-2]:
-                logger.warning('Expected id of type %s but found type %s %s',
-                               type, fields[-2], id)
-            return fields[-1].split("?")[0]
-        fields = id.split("/")
-        if len(fields) &gt;= 3:
-            itype = fields[-2]
-            if type != itype:
-                logger.warning('Expected id of type %s but found type %s %s',
-                               type, itype, id)
-            return fields[-1].split("?")[0]
-        return id
+        uri_match = re.search(Spotify._regex_spotify_uri, id)
+        if uri_match is not None:
+            uri_match_groups = uri_match.groupdict()
+            if uri_match_groups['type'] != type:
+                raise ValueError("Unexpected Spotify URI type.")
+            else:
+                return uri_match_groups['id']
+
+        url_match = re.search(Spotify._regex_spotify_url, id)
+        if url_match is not None:
+            url_match_groups = url_match.groupdict()
+            if url_match_groups['type'] != type:
+                raise ValueError("Unexpected Spotify URL type.")
+            else:
+                return url_match_groups['id']
+
+        # Raw identifiers might be passed, ensure they are also base-62
+        if re.search(Spotify._regex_base62, id) is not None:
+            return id
+
+        raise ValueError("Unsupported URL / URI")
 
     def _get_uri(self, type, id):
         if self._is_uri(id):
@@ -1962,7 +1993,7 @@ class Spotify(object):
             return "spotify:" + type + ":" + self._get_id(type, id)
 
     def _is_uri(self, uri):
-        return uri.startswith("spotify:") and len(uri.split(':')) == 3
+        return re.search(Spotify._regex_spotify_uri, uri) is not None
 
     def _search_multiple_markets(self, q, limit, offset, type, markets, total):
         if total and limit &gt; total:
diff --git a/tests/integration/non_user_endpoints/test.py b/tests/integration/non_user_endpoints/test.py
index 96ee4da..116e1d9 100644
--- a/tests/integration/non_user_endpoints/test.py
+++ b/tests/integration/non_user_endpoints/test.py
@@ -280,7 +280,7 @@ class AuthTestSpotipy(unittest.TestCase):
         try:
             self.spotify.track(self.bad_id)
             self.assertTrue(False)
-        except SpotifyException:
+        except ValueError:
             self.assertTrue(True)
 
     def test_show_urn(self):
@@ -296,7 +296,7 @@ class AuthTestSpotipy(unittest.TestCase):
         self.assertTrue(show['name'] == 'Heavyweight')
 
     def test_show_bad_urn(self):
-        with self.assertRaises(SpotifyException):
+        with self.assertRaises(ValueError):
             self.spotify.show("bogus_urn", market="US")
 
     def test_shows(self):
@@ -333,7 +333,7 @@ class AuthTestSpotipy(unittest.TestCase):
         self.assertTrue(episode['name'] == '#1 Buzz')
 
     def test_episode_bad_urn(self):
-        with self.assertRaises(SpotifyException):
+        with self.assertRaises(ValueError):
             self.spotify.episode("bogus_urn", market="US")
 
     def test_episodes(self):
-- 
2.34.1
</code></pre>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/spotipy-dev/spotipy/security/advisories/GHSA-q764-g6fm-555v">https://github.com/spotipy-dev/spotipy/security/advisories/GHSA-q764-g6fm-555v</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-23608">https://nvd.nist.gov/vuln/detail/CVE-2023-23608</a></li>
<li><a href="https://github.com/advisories/GHSA-q764-g6fm-555v">https://github.com/advisories/GHSA-q764-g6fm-555v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q764-g6fm-555v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-23T22:05:11.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[apache-airflow-providers-mysql] Command Injection in Apache Airflow and Apache Airflow MySQL Provider]]></title>
        <id>https://github.com/advisories/GHSA-c732-xvv8-g94c</id>
        <link href="https://github.com/advisories/GHSA-c732-xvv8-g94c"/>
        <updated>2023-02-01T09:17:23.000Z</updated>
        <content type="html"><![CDATA[<p>Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability in Apache Software Foundation Apache Airflow, Apache Software Foundation Apache Airflow MySQL Provider.This issue affects Apache Airflow: before 2.5.1; Apache Airflow MySQL Provider: before 4.0.0.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22884">https://nvd.nist.gov/vuln/detail/CVE-2023-22884</a></li>
<li><a href="https://github.com/apache/airflow/pull/28811">https://github.com/apache/airflow/pull/28811</a></li>
<li><a href="https://lists.apache.org/thread/0l0j3nt0t7fzrcjl2ch0jgj6c58kxs5h">https://lists.apache.org/thread/0l0j3nt0t7fzrcjl2ch0jgj6c58kxs5h</a></li>
<li><a href="https://github.com/advisories/GHSA-c732-xvv8-g94c">https://github.com/advisories/GHSA-c732-xvv8-g94c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c732-xvv8-g94c</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-21T15:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[apache-airflow] Command Injection in Apache Airflow and Apache Airflow MySQL Provider]]></title>
        <id>https://github.com/advisories/GHSA-c732-xvv8-g94c</id>
        <link href="https://github.com/advisories/GHSA-c732-xvv8-g94c"/>
        <updated>2023-02-01T09:17:23.000Z</updated>
        <content type="html"><![CDATA[<p>Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability in Apache Software Foundation Apache Airflow, Apache Software Foundation Apache Airflow MySQL Provider.This issue affects Apache Airflow: before 2.5.1; Apache Airflow MySQL Provider: before 4.0.0.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-22884">https://nvd.nist.gov/vuln/detail/CVE-2023-22884</a></li>
<li><a href="https://github.com/apache/airflow/pull/28811">https://github.com/apache/airflow/pull/28811</a></li>
<li><a href="https://lists.apache.org/thread/0l0j3nt0t7fzrcjl2ch0jgj6c58kxs5h">https://lists.apache.org/thread/0l0j3nt0t7fzrcjl2ch0jgj6c58kxs5h</a></li>
<li><a href="https://github.com/advisories/GHSA-c732-xvv8-g94c">https://github.com/advisories/GHSA-c732-xvv8-g94c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-c732-xvv8-g94c</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-01-21T15:30:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pyload-ng] Excessive Attack Surface in pyload-ng]]></title>
        <id>https://github.com/advisories/GHSA-6jmx-pv77-wm5w</id>
        <link href="https://github.com/advisories/GHSA-6jmx-pv77-wm5w"/>
        <updated>2023-01-23T20:40:32.000Z</updated>
        <content type="html"><![CDATA[<p>Excessive Attack Surface in GitHub repository pyload/pyload prior to 0.5.0b3.dev41.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-0435">https://nvd.nist.gov/vuln/detail/CVE-2023-0435</a></li>
<li><a href="https://github.com/pyload/pyload/commit/431ea6f0371d748df66b344a05ca1a8e0310cff3">https://github.com/pyload/pyload/commit/431ea6f0371d748df66b344a05ca1a8e0310cff3</a></li>
<li><a href="https://huntr.dev/bounties/a3e32ad5-caee-4f43-b10a-4a876d4e3f1d">https://huntr.dev/bounties/a3e32ad5-caee-4f43-b10a-4a876d4e3f1d</a></li>
<li><a href="https://github.com/advisories/GHSA-6jmx-pv77-wm5w">https://github.com/advisories/GHSA-6jmx-pv77-wm5w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-6jmx-pv77-wm5w</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-01-23T00:30:26.000Z</published>
    </entry>
</feed>