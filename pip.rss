<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://azu.github.io/github-advisory-database-rss/pip.rss</id>
    <title>Security Advisory for Python packages hosted at PyPI.org</title>
    <updated>2023-06-01T17:01:33.341Z</updated>
    <generator>github-advisory-database-rss</generator>
    <link rel="alternate" href="https://github.com/advisories?query=type%3Areviewed+ecosystem%3Apip"/>
    <subtitle>Security Advisory for Python packages hosted at PyPI.org on GitHub</subtitle>
    <rights>github-advisory-database-rss</rights>
    <category term="CRITICAL"/>
    <category term="HIGH"/>
    <category term="MODERATE"/>
    <category term="LOW"/>
    <entry>
        <title type="html"><![CDATA[[redis] redis-py Race Condition due to incomplete fix]]></title>
        <id>https://github.com/advisories/GHSA-8fww-64cx-x8p5</id>
        <link href="https://github.com/advisories/GHSA-8fww-64cx-x8p5"/>
        <updated>2023-05-31T18:23:58.000Z</updated>
        <content type="html"><![CDATA[<p>redis-py through 4.5.3 and 4.4.3 leaves a connection open after canceling an async Redis command at an inopportune time (in the case of a non-pipeline operation), and can send response data to the client of an unrelated request. NOTE: this issue exists because of an incomplete fix for CVE-2023-28858.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28859">https://nvd.nist.gov/vuln/detail/CVE-2023-28859</a></li>
<li><a href="https://github.com/redis/redis-py/issues/2665">https://github.com/redis/redis-py/issues/2665</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2641">https://github.com/redis/redis-py/pull/2641</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2666">https://github.com/redis/redis-py/pull/2666</a></li>
<li><a href="https://github.com/redis/redis-py/pull/2671">https://github.com/redis/redis-py/pull/2671</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.4.4">https://github.com/redis/redis-py/releases/tag/v4.4.4</a></li>
<li><a href="https://github.com/redis/redis-py/releases/tag/v4.5.4">https://github.com/redis/redis-py/releases/tag/v4.5.4</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/redis/PYSEC-2023-46.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/redis/PYSEC-2023-46.yaml</a></li>
<li><a href="https://github.com/redis/redis-py/pull/1899">https://github.com/redis/redis-py/pull/1899</a></li>
<li><a href="https://github.com/advisories/GHSA-8fww-64cx-x8p5">https://github.com/advisories/GHSA-8fww-64cx-x8p5</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-8fww-64cx-x8p5</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-03-26T21:30:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[tornado] Open redirect in Tornado]]></title>
        <id>https://github.com/advisories/GHSA-hj3f-6gcp-jg8j</id>
        <link href="https://github.com/advisories/GHSA-hj3f-6gcp-jg8j"/>
        <updated>2023-05-26T21:17:00.000Z</updated>
        <content type="html"><![CDATA[<p>Open redirect vulnerability in Tornado versions 6.3.1 and earlier allows a remote unauthenticated attacker to redirect a user to an arbitrary web site and conduct a phishing attack by having user access a specially crafted URL.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-28370">https://nvd.nist.gov/vuln/detail/CVE-2023-28370</a></li>
<li><a href="https://github.com/tornadoweb/tornado/releases/tag/v6.3.2">https://github.com/tornadoweb/tornado/releases/tag/v6.3.2</a></li>
<li><a href="https://jvn.jp/en/jp/JVN45127776/">https://jvn.jp/en/jp/JVN45127776/</a></li>
<li><a href="https://github.com/tornadoweb/tornado/commit/32ad07c54e607839273b4e1819c347f5c8976b2f">https://github.com/tornadoweb/tornado/commit/32ad07c54e607839273b4e1819c347f5c8976b2f</a></li>
<li><a href="https://github.com/advisories/GHSA-hj3f-6gcp-jg8j">https://github.com/advisories/GHSA-hj3f-6gcp-jg8j</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hj3f-6gcp-jg8j</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-25T12:30:16.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[toui] toui allows user-specific variables to be shared between users]]></title>
        <id>https://github.com/advisories/GHSA-hh7j-pg39-q563</id>
        <link href="https://github.com/advisories/GHSA-hh7j-pg39-q563"/>
        <updated>2023-05-30T06:41:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Websites that use <code>Website.user_vars</code> property in versions.</p>
<h3 id="patches">Patches</h3>
<p>It affects versions v2.0.1 to v2.4.0. Please upgrade to v2.4.1</p>
<h3 id="workarounds">Workarounds</h3>
<p>Do not use <code>Website.user_vars</code> in websites when using versions v2.0.1 to v2.4.0. Also, do not use <code>Website.signin_user()</code> in version v2.4.0 only.</p>
<h3 id="explanation">Explanation</h3>
<p>ToUI is using Flask-Caching (SimpleCache) to store user variables. My misunderstanding was that these caches are stored in the client's browser, but it seems that these are stored in the server side.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/mubarakalmehairbi/ToUI/security/advisories/GHSA-hh7j-pg39-q563">https://github.com/mubarakalmehairbi/ToUI/security/advisories/GHSA-hh7j-pg39-q563</a></li>
<li><a href="https://github.com/mubarakalmehairbi/ToUI/releases/tag/v2.4.1">https://github.com/mubarakalmehairbi/ToUI/releases/tag/v2.4.1</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-33175">https://nvd.nist.gov/vuln/detail/CVE-2023-33175</a></li>
<li><a href="https://github.com/advisories/GHSA-hh7j-pg39-q563">https://github.com/advisories/GHSA-hh7j-pg39-q563</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-hh7j-pg39-q563</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-24T17:38:52.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[matrix-synapse] Synapse Outgoing federation to specific hosts can be disabled by sending malicious invites]]></title>
        <id>https://github.com/advisories/GHSA-f3wc-3vxv-xmvr</id>
        <link href="https://github.com/advisories/GHSA-f3wc-3vxv-xmvr"/>
        <updated>2023-05-26T17:57:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>A malicious user on a Synapse homeserver X with permission to create certain state events can disable outbound federation from X to an arbitrary homeserver Y.</p>
<p>Synapse instances with federation disabled are not affected.</p>
<h4 id="details">Details</h4>
<p>The Matrix protocol allows homeservers to provide an <code>invite_room_state</code> field on a <a href="https://spec.matrix.org/v1.5/client-server-api/#mroommember">room invite</a> containing a <a href="https://spec.matrix.org/v1.5/client-server-api/#stripped-state">summary of room state</a>.  In versions of Synapse up to and including v1.73.0, Synapse did not limit the size of <code>invite_room_state</code>, meaning that it was possible to create an arbitrarily large invite event.</p>
<p>An attacker with an account on a vulnerable Synapse homeserver X could exploit this by having X create an over-sized invite event in a room with a user from another homeserver Y. Once acknowledged by the invitee's homeserver, the invite event would be sent in a batch of events to Y. If the malicious invite is so large that the entire batch is rejected as too large, X's outgoing traffic to Y would become "stuck", meaning that messages and state events created by X would remain unseen by Y.</p>
<h3 id="patches">Patches</h3>
<p>Synapse 1.74 refuses to create oversized <code>invite_room_state</code> fields. Server operators should upgrade to Synapse 1.74 or newer urgently.</p>
<h3 id="workarounds">Workarounds</h3>
<p>There are no robust workarounds.</p>
<p>This attack needs an account on Synapse homeserver X to deny federation from X to another homeserver Y. As a partial mitigation, Synapse operators can disable open registration to limit the ability of attackers to create new accounts on homeserver X.</p>
<p>If homeserver X has been attacked in this way, restarting it will resume outgoing federation by entering "catchup mode". For catchup mode to ignore the oversized invites, every attacked room must have a correctly-sized event sent by X which is newer than any oversized invite. This is difficult to arrange, and does not prevent the attacker from repeating their attack.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/matrix-org/synapse/issues/14492">https://github.com/matrix-org/synapse/issues/14492</a> was caused by this issue.</li>
<li><a href="https://github.com/matrix-org/synapse/issues/14642">https://github.com/matrix-org/synapse/issues/14642</a>  includes the patch described above.</li>
</ul>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, e-mail us at <a href="mailto:security@matrix.org">security@matrix.org</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-f3wc-3vxv-xmvr">https://github.com/matrix-org/synapse/security/advisories/GHSA-f3wc-3vxv-xmvr</a></li>
<li><a href="https://github.com/matrix-org/synapse/issues/14492">https://github.com/matrix-org/synapse/issues/14492</a></li>
<li><a href="https://github.com/matrix-org/synapse/pull/14642">https://github.com/matrix-org/synapse/pull/14642</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32323">https://nvd.nist.gov/vuln/detail/CVE-2023-32323</a></li>
<li><a href="https://github.com/advisories/GHSA-f3wc-3vxv-xmvr">https://github.com/advisories/GHSA-f3wc-3vxv-xmvr</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f3wc-3vxv-xmvr</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-24T17:28:26.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ckan] Ckan remote code execution and private information access via crafted resource ids]]></title>
        <id>https://github.com/advisories/GHSA-446m-hmmm-hm8m</id>
        <link href="https://github.com/advisories/GHSA-446m-hmmm-hm8m"/>
        <updated>2023-05-29T16:12:23.000Z</updated>
        <content type="html"><![CDATA[<p>Specific vulnerabilities:</p>
<ul>
<li>Arbitrary file write in <code>resource_create</code> and <code>package_update</code> actions, using the <code>ResourceUploader</code> object.  Also reachable via <code>package_create</code>, <code>package_revise</code>, and <code>package_patch</code> via calls to <code>package_update</code>.</li>
<li>Remote code execution via unsafe pickle loading, via Beaker's session store when configured to use the file session store backend.</li>
<li>Potential DOS due to lack of a length check on the resource id.</li>
<li>Information disclosure: A user with permission to create a resource can access any other resource on the system if they know the id, even if they don't have access to it.</li>
<li>Resource overwrite: A user with permission to create a resource can overwrite any resource if they know the id, even if they don't have access to it.</li>
</ul>
<h3 id="impact">Impact</h3>
<p>A user with permissions to create or edit a dataset can upload a resource with a specially crafted id to write the uploaded file in an arbitrary location. This can be leveraged to Remote Code Execution via Beaker's insecure pickle loading. </p>
<h3 id="patches">Patches</h3>
<p>All the above listed vulnerabilities have been fixed in CKAN 2.9.9 and CKAN 2.10.1
The patches for CKAN 2.9 should apply easily to previous CKAN versions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ckan/ckan/security/advisories/GHSA-446m-hmmm-hm8m">https://github.com/ckan/ckan/security/advisories/GHSA-446m-hmmm-hm8m</a></li>
<li><a href="https://github.com/ckan/ckan/blob/2a6080e61d5601fa0e2a0317afd6a8e9b7abf6dd/CHANGELOG.rst">https://github.com/ckan/ckan/blob/2a6080e61d5601fa0e2a0317afd6a8e9b7abf6dd/CHANGELOG.rst</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32321">https://nvd.nist.gov/vuln/detail/CVE-2023-32321</a></li>
<li><a href="https://github.com/advisories/GHSA-446m-hmmm-hm8m">https://github.com/advisories/GHSA-446m-hmmm-hm8m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-446m-hmmm-hm8m</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-24T17:24:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[ckan] Ckan remote code execution and private information access via crafted resource ids]]></title>
        <id>https://github.com/advisories/GHSA-446m-hmmm-hm8m</id>
        <link href="https://github.com/advisories/GHSA-446m-hmmm-hm8m"/>
        <updated>2023-05-29T16:12:23.000Z</updated>
        <content type="html"><![CDATA[<p>Specific vulnerabilities:</p>
<ul>
<li>Arbitrary file write in <code>resource_create</code> and <code>package_update</code> actions, using the <code>ResourceUploader</code> object.  Also reachable via <code>package_create</code>, <code>package_revise</code>, and <code>package_patch</code> via calls to <code>package_update</code>.</li>
<li>Remote code execution via unsafe pickle loading, via Beaker's session store when configured to use the file session store backend.</li>
<li>Potential DOS due to lack of a length check on the resource id.</li>
<li>Information disclosure: A user with permission to create a resource can access any other resource on the system if they know the id, even if they don't have access to it.</li>
<li>Resource overwrite: A user with permission to create a resource can overwrite any resource if they know the id, even if they don't have access to it.</li>
</ul>
<h3 id="impact">Impact</h3>
<p>A user with permissions to create or edit a dataset can upload a resource with a specially crafted id to write the uploaded file in an arbitrary location. This can be leveraged to Remote Code Execution via Beaker's insecure pickle loading. </p>
<h3 id="patches">Patches</h3>
<p>All the above listed vulnerabilities have been fixed in CKAN 2.9.9 and CKAN 2.10.1
The patches for CKAN 2.9 should apply easily to previous CKAN versions.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/ckan/ckan/security/advisories/GHSA-446m-hmmm-hm8m">https://github.com/ckan/ckan/security/advisories/GHSA-446m-hmmm-hm8m</a></li>
<li><a href="https://github.com/ckan/ckan/blob/2a6080e61d5601fa0e2a0317afd6a8e9b7abf6dd/CHANGELOG.rst">https://github.com/ckan/ckan/blob/2a6080e61d5601fa0e2a0317afd6a8e9b7abf6dd/CHANGELOG.rst</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32321">https://nvd.nist.gov/vuln/detail/CVE-2023-32321</a></li>
<li><a href="https://github.com/advisories/GHSA-446m-hmmm-hm8m">https://github.com/advisories/GHSA-446m-hmmm-hm8m</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-446m-hmmm-hm8m</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-24T17:24:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[matrix-synapse] Synapse Denial of service due to incorrect application of event authorization rules during state resolution]]></title>
        <id>https://github.com/advisories/GHSA-p9qp-c452-f9r7</id>
        <link href="https://github.com/advisories/GHSA-p9qp-c452-f9r7"/>
        <updated>2023-05-26T17:57:42.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>If Synapse and a malicious homeserver are both joined to the same room, the malicious homeserver can trick Synapse into accepting previously rejected events into its view of the current state of that room. This can be exploited in a way that causes all further messages and state changes sent in that room from the vulnerable homeserver to be rejected.</p>
<p>Synapse homeservers are affected by this issue if and only if they are joined to rooms which members of untrusted homeservers are joined or invited to. </p>
<ul>
<li>Synapse homeservers in rooms available over public federation <strong>are</strong> affected.</li>
<li>Synapse homeservers with federation disabled are not affected.</li>
<li>Synapse homeservers in a closed federation containing only trusted servers are not affected.</li>
<li>Synapse homeservers which are only joined to rooms with federation disabled[^1] are not affected.</li>
</ul>
<h3 id="patches">Patches</h3>
<p>Administrators of homeservers with federation enabled are advised to upgrade to 1.68.0 or higher.</p>
<h3 id="workarounds">Workarounds</h3>
<ul>
<li>Federation can be disabled by setting <a href="https://matrix-org.github.io/synapse/latest/usage/configuration/config_documentation.html#federation_domain_whitelist"><code>federation_domain_whitelist</code></a> to an empty list (<code>[]</code>).</li>
</ul>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/matrix-org/synapse/pull/13723">https://github.com/matrix-org/synapse/pull/13723</a></li>
</ul>
<p>[^1]: See <code>m.federate</code> in the <a href="https://spec.matrix.org/v1.4/client-server-api/#mroomcreate"><code>m.room.create</code> definition</a>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, e-mail us at <a href="mailto:security@matrix.org">security@matrix.org</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7">https://github.com/matrix-org/synapse/security/advisories/GHSA-p9qp-c452-f9r7</a></li>
<li><a href="https://github.com/matrix-org/synapse/pull/13723">https://github.com/matrix-org/synapse/pull/13723</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-39374">https://nvd.nist.gov/vuln/detail/CVE-2022-39374</a></li>
<li><a href="https://github.com/advisories/GHSA-p9qp-c452-f9r7">https://github.com/advisories/GHSA-p9qp-c452-f9r7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-p9qp-c452-f9r7</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-24T17:21:33.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[matrix-synapse] Synapse does not apply enough checks to servers requesting auth events of events in a room]]></title>
        <id>https://github.com/advisories/GHSA-45cj-f97f-ggwv</id>
        <link href="https://github.com/advisories/GHSA-45cj-f97f-ggwv"/>
        <updated>2023-05-26T17:57:45.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>The Matrix Federation API allows remote homeservers to request the <em>authorisation events</em> of events in a room. This is necessary so that a homeserver receiving some events can validate that those events are legitimate and permitted in their room.
However, in versions of Synapse up to and including 1.68.0, a Synapse homeserver answering a query for authorisation events does not sufficiently check that the requesting server should be able to access them.</p>
<p>Authorisation events include power level events (the list of user IDs and their power levels at the time) and relevant membership events (including the display name of the sender of that event), as well as events like <code>m.room.create</code>, <code>m.room.third_party_invite</code> and <code>m.room.join_rules</code>. Non-authorisation events are unaffected, so it isn't possible to e.g. extract message contents this way.</p>
<p>This issue is only exploitable when a malicious actor knows the ID of a target room and the ID of an event from that room. In most cases, this makes exploitation infeasible. This issue is of negligible consequence for public rooms given that any server can easily join the room in order to be allowed to view authorisation events. Further, deployments in a closed federation where all homeservers are trustworthy are not affected.</p>
<h3 id="patches">Patches</h3>
<p>The issue was patched in Synapse 1.69.0. Homeserver administrators are advised to upgrade.</p>
<h3 id="workarounds">Workarounds</h3>
<p>Synapse can be configured with a list of servers that it is allowed to federate with <a href="https://matrix-org.github.io/synapse/v1.68/usage/configuration/config_documentation.html#federation_domain_whitelist"><code>federation_domain_whitelist</code></a>. If this list is in use and all the servers on the list are trusted not to exploit this issue, then this issue is of no consequence.</p>
<p>This workaround is not practical for homeservers participating in open federation as interaction with any server not on the list would have to happen indirectly through servers that are, leading to inconsistent delays in message delivery.</p>
<h3 id="references">References</h3>
<p>Fixed in <a href="https://github.com/matrix-org/synapse/pull/13823">https://github.com/matrix-org/synapse/pull/13823</a>.</p>
<h3 id="for-more-information">For more information</h3>
<p>If you have any questions or comments about this advisory, e-mail us at <a href="mailto:security@matrix.org">security@matrix.org</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv">https://github.com/matrix-org/synapse/security/advisories/GHSA-45cj-f97f-ggwv</a></li>
<li><a href="https://github.com/matrix-org/synapse/issues/13288">https://github.com/matrix-org/synapse/issues/13288</a></li>
<li><a href="https://github.com/matrix-org/synapse/pull/13823">https://github.com/matrix-org/synapse/pull/13823</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-39335">https://nvd.nist.gov/vuln/detail/CVE-2022-39335</a></li>
<li><a href="https://github.com/advisories/GHSA-45cj-f97f-ggwv">https://github.com/advisories/GHSA-45cj-f97f-ggwv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-45cj-f97f-ggwv</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-24T17:20:43.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[requests] Unintended leak of Proxy-Authorization header in requests]]></title>
        <id>https://github.com/advisories/GHSA-j8r2-6x86-q33q</id>
        <link href="https://github.com/advisories/GHSA-j8r2-6x86-q33q"/>
        <updated>2023-05-30T06:48:49.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Since Requests v2.3.0, Requests has been vulnerable to potentially leaking <code>Proxy-Authorization</code> headers to destination servers, specifically during redirects to an HTTPS origin. This is a product of how <code>rebuild_proxies</code> is used to recompute and <a href="https://github.com/psf/requests/blob/f2629e9e3c7ce3c3c8c025bcd8db551101cbc773/requests/sessions.py#L319-L328">reattach the <code>Proxy-Authorization</code> header</a> to requests when redirected. Note this behavior has <em>only</em> been observed to affect proxied requests when credentials are supplied in the URL user information component (e.g. <code>https://username:password@proxy:8080</code>).</p>
<p><strong>Current vulnerable behavior(s):</strong></p>
<ol>
<li>HTTP → HTTPS: <strong>leak</strong></li>
<li>HTTPS → HTTP: <strong>no leak</strong></li>
<li>HTTPS → HTTPS: <strong>leak</strong></li>
<li>HTTP → HTTP: <strong>no leak</strong></li>
</ol>
<p>For HTTP connections sent through the proxy, the proxy will identify the header in the request itself and remove it prior to forwarding to the destination server. However when sent over HTTPS, the <code>Proxy-Authorization</code> header must be sent in the CONNECT request as the proxy has no visibility into further tunneled requests. This results in Requests forwarding the header to the destination server unintentionally, allowing a malicious actor to potentially exfiltrate those credentials.</p>
<p>The reason this currently works for HTTPS connections in Requests is the <code>Proxy-Authorization</code> header is also handled by urllib3 with our usage of the ProxyManager in adapters.py with <a href="https://github.com/psf/requests/blob/f2629e9e3c7ce3c3c8c025bcd8db551101cbc773/requests/adapters.py#L199-L235"><code>proxy_manager_for</code></a>. This will compute the required proxy headers in <code>proxy_headers</code> and pass them to the Proxy Manager, avoiding attaching them directly to the Request object. This will be our preferred option going forward for default usage.</p>
<h3 id="patches">Patches</h3>
<p>Starting in Requests v2.31.0, Requests will no longer attach this header to redirects with an HTTPS destination. This should have no negative impacts on the default behavior of the library as the proxy credentials are already properly being handled by urllib3's ProxyManager.</p>
<p>For users with custom adapters, this <em>may</em> be potentially breaking if you were already working around this behavior. The previous functionality of <code>rebuild_proxies</code> doesn't make sense in any case, so we would encourage any users impacted to migrate any handling of Proxy-Authorization directly into their custom adapter.</p>
<h3 id="workarounds">Workarounds</h3>
<p>For users who are not able to update Requests immediately, there is one potential workaround.</p>
<p>You may disable redirects by setting <code>allow_redirects</code> to <code>False</code> on all calls through Requests top-level APIs. Note that if you're currently relying on redirect behaviors, you will need to capture the 3xx response codes and ensure a new request is made to the redirect destination.</p>
<pre><code>import requests
r = requests.get('http://github.com/', allow_redirects=False)
</code></pre>
<h3 id="credits">Credits</h3>
<p>This vulnerability was discovered and disclosed by the following individuals.</p>
<p>Dennis Brinkrolf, Haxolot (<a href="https://haxolot.com/">https://haxolot.com/</a>)
Tobias Funke, (<a href="mailto:tobiasfunke93@gmail.com">tobiasfunke93@gmail.com</a>)</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/psf/requests/security/advisories/GHSA-j8r2-6x86-q33q">https://github.com/psf/requests/security/advisories/GHSA-j8r2-6x86-q33q</a></li>
<li><a href="https://github.com/psf/requests/commit/74ea7cf7a6a27a4eeb2ae24e162bcc942a6706d5">https://github.com/psf/requests/commit/74ea7cf7a6a27a4eeb2ae24e162bcc942a6706d5</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32681">https://nvd.nist.gov/vuln/detail/CVE-2023-32681</a></li>
<li><a href="https://github.com/psf/requests/releases/tag/v2.31.0">https://github.com/psf/requests/releases/tag/v2.31.0</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AW7HNFGYP44RT3DUDQXG2QT3OEV2PJ7Y/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/AW7HNFGYP44RT3DUDQXG2QT3OEV2PJ7Y/</a></li>
<li><a href="https://github.com/advisories/GHSA-j8r2-6x86-q33q">https://github.com/advisories/GHSA-j8r2-6x86-q33q</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-j8r2-6x86-q33q</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-22T20:36:32.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[vyper] Vyper's nonpayable default functions are sometimes payable]]></title>
        <id>https://github.com/advisories/GHSA-vxmm-cwh2-q762</id>
        <link href="https://github.com/advisories/GHSA-vxmm-cwh2-q762"/>
        <updated>2023-05-22T20:35:47.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>in contracts with at least one regular nonpayable function, due to the callvalue check being inside of the selector section, it is possible to send funds to the default function by using less than 4 bytes of calldata, even if the default function is marked <code>nonpayable</code>. this applies to contracts compiled with vyper&lt;=0.3.7.</p>
<pre><code class="language-vyper"># @version 0.3.7

# implicitly nonpayable
@external
def foo() -&gt; uint256:
    return 1

# implicitly nonpayable
@external
def __default__():
    # could receive ether here
    pass
</code></pre>
<h3 id="patches">Patches</h3>
<p>this was fixed by the removal of the global calldatasize check in <a href="https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520">https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520</a>.</p>
<h3 id="workarounds">Workarounds</h3>
<p>don't use nonpayable default functions</p>
<h3 id="references">References</h3>
<p><em>Are there any links users can visit to find out more?</em></p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/vyperlang/vyper/security/advisories/GHSA-vxmm-cwh2-q762">https://github.com/vyperlang/vyper/security/advisories/GHSA-vxmm-cwh2-q762</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32675">https://nvd.nist.gov/vuln/detail/CVE-2023-32675</a></li>
<li><a href="https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520">https://github.com/vyperlang/vyper/commit/02339dfda0f3caabad142060d511d10bfe93c520</a></li>
<li><a href="https://github.com/vyperlang/vyper/commit/903727006c1e5ebef99fa9fd5d51d62bd33d72a9">https://github.com/vyperlang/vyper/commit/903727006c1e5ebef99fa9fd5d51d62bd33d72a9</a></li>
<li><a href="https://github.com/advisories/GHSA-vxmm-cwh2-q762">https://github.com/advisories/GHSA-vxmm-cwh2-q762</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-vxmm-cwh2-q762</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-22T20:35:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[django-ses] Incorrect signature verification in django-ses]]></title>
        <id>https://github.com/advisories/GHSA-qg36-9jxh-fj25</id>
        <link href="https://github.com/advisories/GHSA-qg36-9jxh-fj25"/>
        <updated>2023-05-26T21:50:47.000Z</updated>
        <content type="html"><![CDATA[<p>The django_ses library implements a mail backend for Django using AWS Simple Email Service. The library exports the <code>SESEventWebhookView class</code> intended to receive signed requests from AWS to handle email bounces, subscriptions, etc. These requests are signed by AWS and are verified by django_ses, however the verification of this signature was found to be flawed as it allowed users to specify arbitrary public certificates.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/django-ses/django-ses/security/advisories/GHSA-qg36-9jxh-fj25">https://github.com/django-ses/django-ses/security/advisories/GHSA-qg36-9jxh-fj25</a></li>
<li><a href="https://github.com/django-ses/django-ses/commit/b71b5f413293a13997b6e6314086cb9c22629795">https://github.com/django-ses/django-ses/commit/b71b5f413293a13997b6e6314086cb9c22629795</a></li>
<li><a href="https://github.com/django-ses/django-ses/blob/3d627067935876487f9938310d5e1fbb249a7778/CVE/001-cert-url-signature-verification.md">https://github.com/django-ses/django-ses/blob/3d627067935876487f9938310d5e1fbb249a7778/CVE/001-cert-url-signature-verification.md</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-33185">https://nvd.nist.gov/vuln/detail/CVE-2023-33185</a></li>
<li><a href="https://github.com/advisories/GHSA-qg36-9jxh-fj25">https://github.com/advisories/GHSA-qg36-9jxh-fj25</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-qg36-9jxh-fj25</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-22T19:41:56.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[kiwitcms] kiwitcms vulnerable to stored XSS via unrestricted files upload]]></title>
        <id>https://github.com/advisories/GHSA-x7c2-7wvg-jpx7</id>
        <link href="https://github.com/advisories/GHSA-x7c2-7wvg-jpx7"/>
        <updated>2023-05-30T06:47:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="impact">Impact</h3>
<p>Kiwi TCMS allows users to upload attachments to test plans, test cases, etc. Earlier versions of Kiwi TCMS had introduced upload validators in order to prevent potentially dangerous files from being uploaded, see <a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj">GHSA-fwcf-753v-fgcj</a> and Content-Security-Policy definition to prevent cross-site-scripting attacks, see <a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j">GHSA-2wcr-87wf-cf9j</a>.</p>
<p>The upload validation checks were not robust enough which left the possibility of an attacker to circumvent them and upload a potentially dangerous file. Exploting this flaw a combination of files could be uploaded so that they work together to circumvent the existing Content-Security-Policy and allow execution of arbitrary JavaScript in the browser.</p>
<h3 id="patches">Patches</h3>
<ul>
<li>File upload validation code has been improved</li>
<li>Kiwi TCMS will now force <code>Content-Type: text/plain</code>  when serving uploaded files</li>
</ul>
<h3 id="workarounds">Workarounds</h3>
<ol>
<li>Force the Content-Type header via a custom Django middleware, see <code>ExtraHeadersMiddleware</code> in <a href="https://github.com/kiwitcms/Kiwi/blob/master/tcms/core/middleware.py#L23">https://github.com/kiwitcms/Kiwi/blob/master/tcms/core/middleware.py#L23</a> and/or</li>
<li>Force the Content-Type header via Nginx overrides, see <code>location /uploads/</code> in <a href="https://github.com/kiwitcms/Kiwi/blob/master/etc/nginx.conf">https://github.com/kiwitcms/Kiwi/blob/master/etc/nginx.conf</a></li>
</ol>
<h3 id="references">References</h3>
<p>Disclosed by <a href="https://huntr.dev/bounties/db75275f-8bcd-482b-ae12-feff660d4794">Antonio Spataro</a> and <a href="https://huntr.dev/bounties/46d5b535-bdff-4b98-8691-a907591fcf10/">ek1ng</a>. Additional credits to <a href="https://huntr.dev/bounties/cbc2676a-90ff-457f-9cdc-2a7981f960f3/">Ahmed Rabeaa Mosa</a>.</p>
<h3 id="references-1">References</h3>
<ul>
<li><a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j">https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-2wcr-87wf-cf9j</a></li>
<li><a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj">https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-fwcf-753v-fgcj</a></li>
<li><a href="https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-x7c2-7wvg-jpx7">https://github.com/kiwitcms/Kiwi/security/advisories/GHSA-x7c2-7wvg-jpx7</a></li>
<li><a href="https://kiwitcms.org/blog/kiwi-tcms-team/2023/05/22/kiwi-tcms-123/">https://kiwitcms.org/blog/kiwi-tcms-team/2023/05/22/kiwi-tcms-123/</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32686">https://nvd.nist.gov/vuln/detail/CVE-2023-32686</a></li>
<li><a href="https://github.com/advisories/GHSA-x7c2-7wvg-jpx7">https://github.com/advisories/GHSA-x7c2-7wvg-jpx7</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-x7c2-7wvg-jpx7</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-22T19:39:46.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mpmath] ReDOS in Mpmath]]></title>
        <id>https://github.com/advisories/GHSA-f865-m6cq-j9vx</id>
        <link href="https://github.com/advisories/GHSA-f865-m6cq-j9vx"/>
        <updated>2023-05-22T16:13:54.000Z</updated>
        <content type="html"><![CDATA[<p>A Regular Expression Denial of Service (ReDOS) vulnerability was discovered in Mpmath v1.0.0 when the mpmathify function is called.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2021-29063">https://nvd.nist.gov/vuln/detail/CVE-2021-29063</a></li>
<li><a href="https://github.com/npm/hosted-git-info/pull/76">https://github.com/npm/hosted-git-info/pull/76</a></li>
<li><a href="https://github.com/fredrik-johansson/mpmath/commit/c811b37c65a4372a7ce613111d2a508c204f9833">https://github.com/fredrik-johansson/mpmath/commit/c811b37c65a4372a7ce613111d2a508c204f9833</a></li>
<li><a href="https://github.com/yetingli/PoCs/blob/main/CVE-2021-29063/Mpmath.md">https://github.com/yetingli/PoCs/blob/main/CVE-2021-29063/Mpmath.md</a></li>
<li><a href="https://github.com/yetingli/SaveResults/blob/main/js/hosted-git-info.js">https://github.com/yetingli/SaveResults/blob/main/js/hosted-git-info.js</a></li>
<li><a href="https://www.npmjs.com/package/hosted-git-info">https://www.npmjs.com/package/hosted-git-info</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3M5O55E7VUDMXCPQR6MQTOIFDKHP36AA/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/3M5O55E7VUDMXCPQR6MQTOIFDKHP36AA/</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MS2U6GLXQSRZJE2HVUAUMVFR2DWQLCZG/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/MS2U6GLXQSRZJE2HVUAUMVFR2DWQLCZG/</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EIUX3XWY2K3MSO7QXMZXQQYAURARSPC5/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/EIUX3XWY2K3MSO7QXMZXQQYAURARSPC5/</a></li>
<li><a href="https://github.com/fredrik-johansson/mpmath/issues/548">https://github.com/fredrik-johansson/mpmath/issues/548</a></li>
<li><a href="https://github.com/fredrik-johansson/mpmath/commit/46d44c3c8f3244017fe1eb102d564eb4ab8ef750">https://github.com/fredrik-johansson/mpmath/commit/46d44c3c8f3244017fe1eb102d564eb4ab8ef750</a></li>
<li><a href="https://github.com/mpmath/mpmath/pull/570">https://github.com/mpmath/mpmath/pull/570</a></li>
<li><a href="https://github.com/mpmath/mpmath/commit/c811b37c65a4372a7ce613111d2a508c204f9833">https://github.com/mpmath/mpmath/commit/c811b37c65a4372a7ce613111d2a508c204f9833</a></li>
<li><a href="https://github.com/mpmath/mpmath/releases/tag/1.3.0">https://github.com/mpmath/mpmath/releases/tag/1.3.0</a></li>
<li><a href="https://github.com/advisories/GHSA-f865-m6cq-j9vx">https://github.com/advisories/GHSA-f865-m6cq-j9vx</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-f865-m6cq-j9vx</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2021-08-09T20:44:51.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[scrapy] Scrapy denial of service vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-h7wm-ph43-c39p</id>
        <link href="https://github.com/advisories/GHSA-h7wm-ph43-c39p"/>
        <updated>2023-05-22T14:53:42.000Z</updated>
        <content type="html"><![CDATA[<p>Scrapy 1.4 allows remote attackers to cause a denial of service (memory consumption) via large files because arbitrarily many files are read into memory, which is especially problematic if the files are then individually written in a separate thread to a slow storage resource, as demonstrated by interaction between dataReceived (in core/downloader/handlers/http11.py) and S3FilesStore.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2017-14158">https://nvd.nist.gov/vuln/detail/CVE-2017-14158</a></li>
<li><a href="https://github.com/scrapy/scrapy/issues/482">https://github.com/scrapy/scrapy/issues/482</a></li>
<li><a href="http://blog.csdn.net/wangtua/article/details/75228728">http://blog.csdn.net/wangtua/article/details/75228728</a></li>
<li><a href="https://github.com/pypa/advisory-database/blob/8b7a4d62a95e8f605e5dfb4e0b4f299e6403dc12/vulns/scrapy/PYSEC-2017-83.yaml">https://github.com/pypa/advisory-database/blob/8b7a4d62a95e8f605e5dfb4e0b4f299e6403dc12/vulns/scrapy/PYSEC-2017-83.yaml</a></li>
<li><a href="https://github.com/advisories/GHSA-h7wm-ph43-c39p">https://github.com/advisories/GHSA-h7wm-ph43-c39p</a></li>
<li><a href="https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2017-83.yaml">https://github.com/pypa/advisory-database/tree/main/vulns/scrapy/PYSEC-2017-83.yaml</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-h7wm-ph43-c39p</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2022-05-17T01:16:31.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[transformers] transformers has Insecure Temporary File]]></title>
        <id>https://github.com/advisories/GHSA-282v-666c-3fvg</id>
        <link href="https://github.com/advisories/GHSA-282v-666c-3fvg"/>
        <updated>2023-05-26T19:30:41.000Z</updated>
        <content type="html"><![CDATA[<p>Insecure Temporary File in GitHub repository huggingface/transformers 4.29.2 and prior. A fix is available at commit 80ca92470938bbcc348e2d9cf4734c7c25cb1c43 and anticipated to be part of version 4.30.0.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2800">https://nvd.nist.gov/vuln/detail/CVE-2023-2800</a></li>
<li><a href="https://github.com/huggingface/transformers/commit/80ca92470938bbcc348e2d9cf4734c7c25cb1c43">https://github.com/huggingface/transformers/commit/80ca92470938bbcc348e2d9cf4734c7c25cb1c43</a></li>
<li><a href="https://huntr.dev/bounties/a3867b4e-6701-4418-8c20-3c6e7084a44a">https://huntr.dev/bounties/a3867b4e-6701-4418-8c20-3c6e7084a44a</a></li>
<li><a href="https://github.com/advisories/GHSA-282v-666c-3fvg">https://github.com/advisories/GHSA-282v-666c-3fvg</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-282v-666c-3fvg</uri>
        </author>
        <category label="severity" term="MODERATE"/>
        <published>2023-05-18T18:30:35.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[mlflow] mlflow Path Traversal vulnerability]]></title>
        <id>https://github.com/advisories/GHSA-wjq3-7jxx-whj9</id>
        <link href="https://github.com/advisories/GHSA-wjq3-7jxx-whj9"/>
        <updated>2023-05-18T02:01:54.000Z</updated>
        <content type="html"><![CDATA[<p>mlflow prior to 2.3.0 is vulnerable to path traversal due to a bypass of the fix for CVE-2023-1177.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-2780">https://nvd.nist.gov/vuln/detail/CVE-2023-2780</a></li>
<li><a href="https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857">https://github.com/mlflow/mlflow/commit/fae77a525dd908c56d6204a4cef1c1c75b4e9857</a></li>
<li><a href="https://huntr.dev/bounties/b12b0073-0bb0-4bd1-8fc2-ec7f17fd7689">https://huntr.dev/bounties/b12b0073-0bb0-4bd1-8fc2-ec7f17fd7689</a></li>
<li><a href="https://github.com/advisories/GHSA-wjq3-7jxx-whj9">https://github.com/advisories/GHSA-wjq3-7jxx-whj9</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-wjq3-7jxx-whj9</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-17T21:30:22.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[starlette] Starlette has Path Traversal vulnerability in StaticFiles]]></title>
        <id>https://github.com/advisories/GHSA-v5gw-mw7f-84px</id>
        <link href="https://github.com/advisories/GHSA-v5gw-mw7f-84px"/>
        <updated>2023-05-17T03:49:15.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>When using <code>StaticFiles</code>, if there's a file or directory that starts with the same name as the <code>StaticFiles</code> directory, that file or directory is also exposed via <code>StaticFiles</code> which is a path traversal vulnerability.</p>
<h3 id="details">Details</h3>
<p>The root cause of this issue is the usage of <code>os.path.commonprefix()</code>:
<a href="https://github.com/encode/starlette/blob/4bab981d9e870f6cee1bd4cd59b87ddaf355b2dc/starlette/staticfiles.py#L172-L174">https://github.com/encode/starlette/blob/4bab981d9e870f6cee1bd4cd59b87ddaf355b2dc/starlette/staticfiles.py#L172-L174</a></p>
<p>As stated in the Python documentation (<a href="https://docs.python.org/3/library/os.path.html#os.path.commonprefix">https://docs.python.org/3/library/os.path.html#os.path.commonprefix</a>) this function returns the longest prefix common to paths.</p>
<p>When passing a path like <code>/static/../static1.txt</code>, <code>os.path.commonprefix([full_path, directory])</code> returns <code>./static</code> which is the common part of <code>./static1.txt</code> and <code>./static</code>, It refers to <code>/static/../static1.txt</code> because it is considered in the staticfiles directory. As a result, it becomes possible to view files that should not be open to the public.</p>
<p>The solution is to use <code>os.path.commonpath</code> as the Python documentation explains that <code>os.path.commonprefix</code> works a character at a time, it does not treat the arguments as paths.</p>
<h3 id="poc">PoC</h3>
<p>In order to reproduce the issue, you need to create the following structure:</p>
<pre><code>├── static
│   ├── index.html
├── static_disallow
│   ├── index.html
└── static1.txt
</code></pre>
<p>And run the <code>Starlette</code> app with:</p>
<pre><code class="language-py">import uvicorn
from starlette.applications import Starlette
from starlette.routing import Mount
from starlette.staticfiles import StaticFiles


routes = [
    Mount("/static", app=StaticFiles(directory="static", html=True), name="static"),
]

app = Starlette(routes=routes)


if __name__ == "__main__":
    uvicorn.run(app, host="0.0.0.0", port=8000)
</code></pre>
<p>And running the commands:</p>
<pre><code class="language-shell">curl --path-as-is 'localhost:8000/static/../static_disallow/'
curl --path-as-is 'localhost:8000/static/../static1.txt'
</code></pre>
<p>The <code>static1.txt</code> and the directory <code>static_disallow</code> are exposed.</p>
<h3 id="impact">Impact</h3>
<p>Confidentiality is breached: An attacker may obtain files that should not be open to the public.</p>
<h3 id="credits">Credits</h3>
<p>Security researcher <strong>Masashi Yamane of LAC Co., Ltd</strong> reported this vulnerability to <strong>JPCERT/CC Vulnerability Coordination Group</strong> and they contacted us to coordinate a patch for the security issue.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/encode/starlette/security/advisories/GHSA-v5gw-mw7f-84px">https://github.com/encode/starlette/security/advisories/GHSA-v5gw-mw7f-84px</a></li>
<li><a href="https://github.com/encode/starlette/commit/1797de464124b090f10cf570441e8292936d63e3">https://github.com/encode/starlette/commit/1797de464124b090f10cf570441e8292936d63e3</a></li>
<li><a href="https://github.com/encode/starlette/blob/4bab981d9e870f6cee1bd4cd59b87ddaf355b2dc/starlette/staticfiles.py#L172-L174">https://github.com/encode/starlette/blob/4bab981d9e870f6cee1bd4cd59b87ddaf355b2dc/starlette/staticfiles.py#L172-L174</a></li>
<li><a href="https://github.com/encode/starlette/releases/tag/0.27.0">https://github.com/encode/starlette/releases/tag/0.27.0</a></li>
<li><a href="https://github.com/advisories/GHSA-v5gw-mw7f-84px">https://github.com/advisories/GHSA-v5gw-mw7f-84px</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-v5gw-mw7f-84px</uri>
        </author>
        <category label="severity" term="LOW"/>
        <published>2023-05-17T03:49:14.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[pymdown-extensions] Any file can be included with the pymdowm-snippets extension]]></title>
        <id>https://github.com/advisories/GHSA-jh85-wwv9-24hv</id>
        <link href="https://github.com/advisories/GHSA-jh85-wwv9-24hv"/>
        <updated>2023-05-15T21:42:57.000Z</updated>
        <content type="html"><![CDATA[<h3 id="summary">Summary</h3>
<p>Arbitrary file read when using include file syntax.</p>
<h3 id="details">Details</h3>
<p>By using the syntax <code>--8&lt;--"/etc/passwd"</code> or <code>--8&lt;--"/proc/self/environ"</code> the content of these files will be rendered in the generated documentation. Additionally, a path relative to a specified, allowed base path can also be used to render the content of a file outside the specified base paths: <code>--8&lt;-- "../../../../etc/passwd"</code>.</p>
<p>Within the Snippets extension, there exists a <code>base_path</code> option but the implementation is vulnerable to Directory Traversal.
The vulnerable section exists in <code>get_snippet_path(self, path)</code> lines 155 to 174 in snippets.py.</p>
<pre><code>base = "docs"
path = "/etc/passwd"
filename = os.path.join(base,path) # Filename is now /etc/passwd
</code></pre>
<h3 id="poc">PoC</h3>
<pre><code class="language-py">import markdown

payload = "--8&lt;-- \"/etc/passwd\""
html = markdown.markdown(payload, extensions=['pymdownx.snippets'])

print(html)
</code></pre>
<h3 id="impact">Impact</h3>
<p>Any readable file on the host where the plugin is executing may have its content exposed. This can impact any use of Snippets that exposes the use of Snippets to external users. </p>
<p>It is never recommended to use Snippets to process user-facing, dynamic content. It is designed to process known content on the backend under the control of the host, but if someone were to accidentally enable it for user-facing content, undesired information could be exposed.</p>
<h3 id="suggestion">Suggestion</h3>
<p>Specified snippets should be restricted to the configured, specified base paths as a safe default. Allowing relative or absolute paths that escape the specified base paths would need to be behind a feature switch that must be opt-in and would be at the developer's own risk.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://github.com/facelessuser/pymdown-extensions/security/advisories/GHSA-jh85-wwv9-24hv">https://github.com/facelessuser/pymdown-extensions/security/advisories/GHSA-jh85-wwv9-24hv</a></li>
<li><a href="https://github.com/facelessuser/pymdown-extensions/commit/b7bb4878d6017c03c8dc97c42d8d3bb6ee81db9d">https://github.com/facelessuser/pymdown-extensions/commit/b7bb4878d6017c03c8dc97c42d8d3bb6ee81db9d</a></li>
<li><a href="https://github.com/facelessuser/pymdown-extensions/releases/tag/10.0">https://github.com/facelessuser/pymdown-extensions/releases/tag/10.0</a></li>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-32309">https://nvd.nist.gov/vuln/detail/CVE-2023-32309</a></li>
<li><a href="https://github.com/advisories/GHSA-jh85-wwv9-24hv">https://github.com/advisories/GHSA-jh85-wwv9-24hv</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-jh85-wwv9-24hv</uri>
        </author>
        <category label="severity" term="HIGH"/>
        <published>2023-05-15T20:50:23.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Django] Django bypasses validation when using one form field to upload multiple files]]></title>
        <id>https://github.com/advisories/GHSA-r3xc-prgr-mg9p</id>
        <link href="https://github.com/advisories/GHSA-r3xc-prgr-mg9p"/>
        <updated>2023-05-16T12:22:49.000Z</updated>
        <content type="html"><![CDATA[<p>In Django 3.2 before 3.2.19, 4.x before 4.1.9, and 4.2 before 4.2.1, it was possible to bypass validation when using one form field to upload multiple files. This multiple upload has never been supported by forms.FileField or forms.ImageField (only the last uploaded file was validated). However, Django's "Uploading multiple files" documentation suggested otherwise.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-31047">https://nvd.nist.gov/vuln/detail/CVE-2023-31047</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/security/">https://docs.djangoproject.com/en/4.2/releases/security/</a></li>
<li><a href="https://groups.google.com/forum/#!forum/django-announce">https://groups.google.com/forum/#!forum/django-announce</a></li>
<li><a href="https://www.djangoproject.com/weblog/2023/may/03/security-releases/">https://www.djangoproject.com/weblog/2023/may/03/security-releases/</a></li>
<li><a href="https://github.com/django/django/commit/21b1b1fc03e5f9e9f8c977ee6e35618dd3b353dd">https://github.com/django/django/commit/21b1b1fc03e5f9e9f8c977ee6e35618dd3b353dd</a></li>
<li><a href="https://github.com/django/django/commit/e7c3a2ccc3a562328600be05068ed9149e12ce64">https://github.com/django/django/commit/e7c3a2ccc3a562328600be05068ed9149e12ce64</a></li>
<li><a href="https://github.com/django/django/commit/eed53d0011622e70b936e203005f0e6f4ac48965">https://github.com/django/django/commit/eed53d0011622e70b936e203005f0e6f4ac48965</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A45VKTUVQ2BN6D5ZLZGCM774R6QGFOHW/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A45VKTUVQ2BN6D5ZLZGCM774R6QGFOHW/</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DNEHD6N435OE2XUFGDAAVAXSYWLCUBFD/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DNEHD6N435OE2XUFGDAAVAXSYWLCUBFD/</a></li>
<li><a href="https://github.com/advisories/GHSA-r3xc-prgr-mg9p">https://github.com/advisories/GHSA-r3xc-prgr-mg9p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r3xc-prgr-mg9p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-07T03:30:17.000Z</published>
    </entry>
    <entry>
        <title type="html"><![CDATA[[Django] Django bypasses validation when using one form field to upload multiple files]]></title>
        <id>https://github.com/advisories/GHSA-r3xc-prgr-mg9p</id>
        <link href="https://github.com/advisories/GHSA-r3xc-prgr-mg9p"/>
        <updated>2023-05-16T12:22:49.000Z</updated>
        <content type="html"><![CDATA[<p>In Django 3.2 before 3.2.19, 4.x before 4.1.9, and 4.2 before 4.2.1, it was possible to bypass validation when using one form field to upload multiple files. This multiple upload has never been supported by forms.FileField or forms.ImageField (only the last uploaded file was validated). However, Django's "Uploading multiple files" documentation suggested otherwise.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://nvd.nist.gov/vuln/detail/CVE-2023-31047">https://nvd.nist.gov/vuln/detail/CVE-2023-31047</a></li>
<li><a href="https://docs.djangoproject.com/en/4.2/releases/security/">https://docs.djangoproject.com/en/4.2/releases/security/</a></li>
<li><a href="https://groups.google.com/forum/#!forum/django-announce">https://groups.google.com/forum/#!forum/django-announce</a></li>
<li><a href="https://www.djangoproject.com/weblog/2023/may/03/security-releases/">https://www.djangoproject.com/weblog/2023/may/03/security-releases/</a></li>
<li><a href="https://github.com/django/django/commit/21b1b1fc03e5f9e9f8c977ee6e35618dd3b353dd">https://github.com/django/django/commit/21b1b1fc03e5f9e9f8c977ee6e35618dd3b353dd</a></li>
<li><a href="https://github.com/django/django/commit/e7c3a2ccc3a562328600be05068ed9149e12ce64">https://github.com/django/django/commit/e7c3a2ccc3a562328600be05068ed9149e12ce64</a></li>
<li><a href="https://github.com/django/django/commit/eed53d0011622e70b936e203005f0e6f4ac48965">https://github.com/django/django/commit/eed53d0011622e70b936e203005f0e6f4ac48965</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A45VKTUVQ2BN6D5ZLZGCM774R6QGFOHW/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/A45VKTUVQ2BN6D5ZLZGCM774R6QGFOHW/</a></li>
<li><a href="https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DNEHD6N435OE2XUFGDAAVAXSYWLCUBFD/">https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/DNEHD6N435OE2XUFGDAAVAXSYWLCUBFD/</a></li>
<li><a href="https://github.com/advisories/GHSA-r3xc-prgr-mg9p">https://github.com/advisories/GHSA-r3xc-prgr-mg9p</a></li>
</ul>
]]></content>
        <author>
            <name>GitHub</name>
            <email>GitHub@noreply.github.com</email>
            <uri>https://github.com/advisories/GHSA-r3xc-prgr-mg9p</uri>
        </author>
        <category label="severity" term="CRITICAL"/>
        <published>2023-05-07T03:30:17.000Z</published>
    </entry>
</feed>